{"version":3,"sources":["/Users/cloud/develop/webviz/packages/webviz-core/src/hooksImporter.js","/Users/cloud/develop/src/utils/getOrthographicBounds.js","/Users/cloud/develop/src/camera/cameraProject.js","/Users/cloud/develop/src/utils/commandUtils.js","/Users/cloud/develop/src/camera/cameraStateSelectors.js","/Users/cloud/develop/src/camera/CameraStore.js","/Users/cloud/develop/src/camera/camera.js","/Users/cloud/develop/src/camera/CameraListener.js","/Users/cloud/develop/src/utils/common.js","/Users/cloud/develop/src/utils/Raycast.js","/Users/cloud/develop/src/WorldviewReactContext.js","/Users/cloud/develop/src/commands/Command.js","/Users/cloud/develop/src/utils/Dimensions.js","/Users/cloud/develop/src/utils/HitmapObjectIdManager.js","/Users/cloud/develop/src/utils/queuePromise.js","/Users/cloud/develop/src/utils/signal.js","/Users/cloud/develop/src/WorldviewContext.js","/Users/cloud/develop/src/Worldview.js","/Users/cloud/develop/src/utils/aggregate.js","/Users/cloud/develop/src/utils/Bounds.js","/Users/cloud/develop/src/utils/eulerFromQuaternion.js","/Users/cloud/develop/src/utils/fromGeometry.js","/Users/cloud/develop/src/utils/draco.js","/Users/cloud/develop/src/utils/parseGLB.js","/Users/cloud/develop/src/utils/getChildrenForHitmapDefaults.js","/Users/cloud/develop/src/utils/withRenderStateOverrides.js","/Users/cloud/develop/src/commands/Cylinders.js","/Users/cloud/develop/src/commands/Cones.js","/Users/cloud/develop/src/commands/Arrows.js","/Users/cloud/develop/src/commands/Lines.js","/Users/cloud/develop/src/commands/Axes.js","/Users/cloud/develop/src/commands/Cubes.js","/Users/cloud/develop/src/commands/Spheres.js","/Users/cloud/develop/src/commands/DrawPolygon/index.js","/Users/cloud/develop/src/commands/DrawPolygon/PolygonBuilder.js","/Users/cloud/develop/src/commands/Triangles.js","/Users/cloud/develop/src/commands/FilledPolygons.js","/Users/cloud/develop/src/commands/Text.js","/Users/cloud/develop/src/commands/GLText.js","/Users/cloud/develop/src/commands/GLTFScene.js","/Users/cloud/develop/src/commands/Grid.js","/Users/cloud/develop/src/commands/Overlay.js","/Users/cloud/develop/src/commands/Points.js","/Users/cloud/develop/src/utils/SDFGenerator.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Panel.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/ColorPickerForTopicSettings.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/EmptyState.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/parseRosPath.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Transforms/index.js","webpack:///./packages/webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss?964d","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/common.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TreeNodeRow.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/constants.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/types.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TopicToRenderMenu.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/isTypicalFilterName.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Autocomplete.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/interactionUtils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/ThreeDimensionalVizContext.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useTopicTree.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/util.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/messagePathsForDatatype.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GLCanvas/utils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/supportsOffscreenCanvas.js","webpack:///./packages/webviz-core/src/styles/mixins.module.scss?a4da","/Users/cloud/develop/webviz/packages/webviz-core/src/util/plotColors.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessageHistoryDEPRECATED/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TextField.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/OverlayProjector/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/Pose.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Checkbox.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/ExpandingToolbar.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/ValidatedInput.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicTree.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicViewModeSelector.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TimeBasedChart/utils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/toolsColorScheme.js","/Users/cloud/develop/webviz/packages/webviz-core/shared/panelToolbarStyles.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/StateTransitions/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/useLatestMessageDataItem.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/buffers.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/getDiff.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/util.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/TabDndContext.js","/Users/cloud/develop/webviz/packages/webviz-core/shared/validators.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/renderTreeNodes.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/generateNodeKey.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/VisibilityToggle.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Audio/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Audio/utils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/fuzzyFilter.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/constants.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/synchronizeMessages.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TimeBasedChart/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GLChart/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/ReactChartjs/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/WebWorkerManager.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/internalTypes.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/useDiagnostics.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/toggle.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/input/JSONInput.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/IconOverlay/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/UnlinkGlobalVariables.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/UnlinkWrapper.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/selection.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/ObjectDetails.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/TopicLink.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/index.js","webpack:///./packages/webviz-core/src/panels/RawMessages/index.module.scss?cd11","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/utils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/index.js","webpack:///./packages/webviz-core/src/panels/ImageView/ImageCanvas.module.scss?4411","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/CameraModel.js","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/projectConfig.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/LevelToString.js","webpack:///./packages/webviz-core/src/panels/Rosout/LogMessage.module.scss?21e5","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/yaml.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout/WorkerDataRpc.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/SearchText.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/IconMarkerSettingsEditor.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Select/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/NodeName.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Table/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Table/utils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PoseMarkers.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/utils/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/decodeMarker.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/RpcWorkerUtils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Audio/AudioPlayer.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Audio/AudioToolbar.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Audio/VolumeControl.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Audio/index.help.md","webpack:///./packages/webviz-core/src/components/Panel.module.scss?f553","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Panel.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Audio/BlockLoadingProgress.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticStatusPanel.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.js","webpack:///./packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.module.scss?2a11","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/grammar.ne","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotChart.js","webpack:///./packages/webviz-core/src/panels/Plot/PlotChart.module.scss?b8b1","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotChart.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.js","webpack:///./packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.module.scss?13c1","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GLChart/gridRenderer.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GLChart/linesRenderer.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GLChart/pointRenderer.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/ReactChartjs/ChartJSWorker.worker.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/FakeRpc.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartLegend.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/TimeBasedChart/constants.js","/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/transformPlotRange.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotLegend.js","webpack:///./packages/webviz-core/src/panels/Plot/PlotLegend.module.scss?fcfd","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotLegend.module.scss","webpack:///./packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.module.scss?59cc","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.module.scss","webpack:///./packages/webviz-core/src/components/Autocomplete.module.scss?9176","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Autocomplete.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotMenu.js","webpack:///./packages/webviz-core/src/panels/Plot/PlotMenu.module.scss?6c53","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotMenu.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/StateTransitions/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticStatusPanel.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.help.md","webpack:///./packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.module.scss?2347","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/GlobalVariables/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/GlobalVariables/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GlobalVariablesTable.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/input/ValidatedResizingInput.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/GlobalVariableSlider/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GlobalVariableSlider.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/SliderWithTicks.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/GlobalVariableDropdown/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/GlobalVariableDropdown/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/ImageCanvas.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/IconMarkers.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/LinkedGlobalVariableList.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableName.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/LinkToGlobalVariable.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/UnlinkGlobalVariable.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/InteractionContextMenu.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/readers.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/logger.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/utils/maybeConvertSphericalCoordinatePointCloudToCartesian.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/PointCloudDetails.js","webpack:///./packages/webviz-core/src/components/ExpandingToolbar.module.scss?155f","/Users/cloud/develop/webviz/packages/webviz-core/src/components/ExpandingToolbar.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/Diff.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/getValueActionForValue.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/index.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/Metadata.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/RawMessagesIcons.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/MessageCollector.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/ImageCanvas.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/ImageCanvas.worker.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/ImageCanvasRenderer.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/renderImage.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/decodings.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/ContextMenu/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/index.help.md","webpack:///./packages/webviz-core/src/panels/ImageView/index.module.scss?5030","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/index.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/IconTextMenu.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Internals.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/ResizableSplitFlex.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/BottomBar/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/BottomBar/DiagnosticsSection.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/BottomBar/LogsSection.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/playground-icon.svg","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/Sidebar.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/assets/file-document-edit.svg","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/assets/hammer-wrench.svg","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NodePlayground/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/lib.js","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/DEPRECATED_ros.js","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/colors.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/lodash.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/markers.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/pointClouds.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/readers.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/time.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/types.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/vectors.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/templates/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/templates/markerArray.template.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/templates/twoDimensionalPlot.template.ts","/Users/cloud/develop/webviz/packages/webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/README.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Note/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Note/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/NumberOfRenders.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/PlaybackPerformance/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/PlaybackPerformance/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Sparkline.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Publish/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Publish/buildSampleMessage.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Publisher.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/index.help.md","webpack:///./packages/webviz-core/src/panels/Rosout/index.module.scss?0c9f","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/index.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/LogMessage.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/LogMessage.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/components/LogList.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/SourceInfo/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/SelectableTimestamp.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/CopyText.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/SubscribeToList.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/TabbedToolbar.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/DraggableToolbarTab.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/ToolbarTab.js","webpack:///./packages/webviz-core/src/panels/Tab/Tab.module.scss?6766","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/Tab.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/TwoDimensionalPlot/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/TwoDimensionalPlot/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/FrameCompatibility.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/DebugStats/Overlay.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/Polygons.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/drawToolUtils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/LayoutToolbar.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/CameraInfo/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/FollowTFControl.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/MainToolbar.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/PanelToolbarMenu.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/stories/waitFor3dPanelEvents.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicSettingsModal.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/LaserScanSettingsEditor.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/MarkerOverrideColorSettingsEditor.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/MarkerSettingsEditor.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/PointCloudSettingsEditor.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/GradientPicker.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Select/Option.js","webpack:///./packages/webviz-core/src/components/Select/Option.module.scss?97a3","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Select/Option.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Select/Select.js","webpack:///./packages/webviz-core/src/components/Select/Select.module.scss?0516","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Select/Select.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/PoseSettingsEditor.js","webpack:///./packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/TopicSettingsEditor.module.scss?e5e1","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/TopicSettingsEditor.module.scss","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/DiffModeSettings.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/Switch.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/noMatches.svg","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/renderNamespaceNodes.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/NamespaceMenu.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TextHighlight.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TextMiddleTruncate.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TreeNodeMenu.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/renderStyleExpressionNodes.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/GlobalVariableStyles.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicTreeSwitcher.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Transforms/useTransformsNear.js","/Users/cloud/develop/webviz/packages/webviz-core/src/PanelAPI/useBlocksByTopicWithFallback.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Transforms/utils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Table/index.help.md","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Table/TableSettings.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/defaultHooks.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/CarModel/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/CarModel/carModel.glb","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/LaserScanVert.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout/LayoutWorker.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/DebugStats/Collector.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useSceneBuilderAndTransformsData.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Transforms/TransformsBuilder.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/World.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Crosshair.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/MeasureMarker.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/diffModeUtils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/searchTextUtils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/withWorldMarkerHighlights.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/Cover.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/WorldMarkers.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/glTextAtlasLoader.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/textureAtlasData.bin","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/groupingUtils.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/LaserScans.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/OccupancyGrids.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/memoization.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/VertexBufferCache.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/LinedConvexHulls.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/RadarPointClusters/index.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/WorldContext.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/NoopReactRenderer.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Transforms/useStaticTransformsData.js","/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/useArbitraryPreloadedMessageDataItems.js","/Users/cloud/develop/webviz/packages/webviz-core/src/util/quaternionFromEuler.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/useWorldContextValue.js","/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout/Layout.worker.js"],"names":["hooks","getGlobalHooks","panelsByCategory","perPanelHooks","areHooksImported","Audio","require","default","DiagnosticStatusPanel","DiagnosticSummary","GlobalVariables","GlobalVariableSlider","GlobalVariableDropdown","ImageViewPanel","Internals","NodePlayground","Note","NumberOfRenders","PlaybackPerformance","Plot","Publish","RawMessages","Rosout","SourceInfo","StateTransitions","SubscribeToList","Tab","TwoDimensionalPlot","ThreeDimensionalViz","ndash","ros","title","component","utilities","debugging","BlurIcon","GridIcon","ChartIcon","HexagonIcon","HexagonMultipleIcon","PentagonOutlineIcon","RadarIcon","RobotIcon","GEOMETRY_MSGS$POLYGON_STAMPED","NAV_MSGS$OCCUPANCY_GRID","NAV_MSGS$PATH","SENSOR_MSGS$POINT_CLOUD_2","GEOMETRY_MSGS$POSE_STAMPED","SENSOR_MSGS$LASER_SCAN","TF2_MSGS$TF_MESSAGE","VISUALIZATION_MSGS$MARKER","VISUALIZATION_MSGS$MARKER_ARRAY","VISUALIZATION_MSGS$WEBVIZ_MARKER","VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY","WEBVIZ_ICON_MSGS$WEBVIZ_3D_ICON_ARRAY","$DIAGNOSTICS","RADAR_POINT_CLOUD","WRAPPED_POINT_CLOUD","sceneBuilderHooks","supportsOffscreenCanvas","initLayoutNonWorker","useStaticTransformsData","defaultTopic","defaultConfig","pinnedIds","hardwareIdFilter","topicToRender","ImageView","cameraTopic","enabledMarkerTopics","customMarkerTopicOptions","scale","transformMarkers","synchronize","mode","zoomPercentage","offset","imageMarkerDatatypes","canTransformMarkersByTopic","topic","includes","getVariableSpecificOutput","paths","customStateTransitionColors","checkedKeys","expandedKeys","followTf","cameraState","modifiedNamespaceTopics","pinTopics","settingsByKey","autoSyncCameraState","autoTextBackgroundColor","topicSettingsEditors","SUPPORTED_MARKER_DATATYPES","BLACKLIST_TOPICS","additionalSubscriptions","iconsByDatatype","icons","AdditionalToolbarItems","useWorldContextValue","getLayoutWorker","skipTransformFrame","useDynamicTransformsData","ungroupedNodesCategory","rootTransformFrame","defaultFollowTransformFrame","docLinkFunction","filename","BoundingBox","constructor","left","this","Math","getOrthographicBounds","zDistance","aspect","width","distanceToGround","tmp4","DEFAULT_TEXT_COLOR","r","g","b","a","pointToVec3","z","x","y","orientationToVec4","w","vec3ToPoint","vec4ToOrientation","pointToVec3Array","points","result","Float32Array","i","toRGBA","val","vec4ToRGBA","color","toColor","Array","getCSSColor","toRGBAArray","colors","defaultReglBlend","enable","func","src","dst","srcAlpha","dstAlpha","equation","rgb","alpha","defaultReglDepth","mask","defaultDepth","context","props","defaultBlend","blend","withPose","command","uniforms","newVert","vert","newUniforms","_position","position","_rotation","orientation","getVertexColors","shouldConvert","count","constantRGBAArray","colorBuffer","regl","buffer","usage","data","divisor","arr","isNaN","intToRGB","getIdFromPixel","fromSpherical","out","rSinPhi","UNIT_X_VECTOR","Object","TEMP_VEC3","TEMP_MAT","TEMP_QUAT","stateSelector","state","perspectiveSelector","createSelector","perspective","distanceSelector","distance","phiSelector","phi","thetaOffsetSelector","thetaOffset","targetOrientationSelector","targetOrientation","targetHeadingSelector","vec3","orientationSelector","quat","positionSelector","targetHeading","view","m","mat4","billboardRotation","UNIT_Z_VECTOR","DEFAULT_CAMERA_STATE","target","targetOffset","fovy","near","far","CameraStore","handler","initialCameraState","key","zoomPercent","newDistance","startingDistance","distanceAfterZoom","Error","projection","viewportHeight","selectors","isPerspective","getProjection","bounds","top","viewportWidth","getView","toScreenCoord","viewport","combinedProjView","vX","vY","vWidth","vHeight","vec4","vec","project","point","diffY","DEFAULT_KEYMAP","KeyA","KeyD","KeyE","KeyF","KeyQ","KeyR","KeyS","KeyW","KeyX","KeyZ","CameraListener","React","mouse","clientY","height","clientX","e","_el","_getMouseOnScreen","_buttons","cameraStore","document","moveX","_rect","moveY","_initialMouse","magnitude","_getMagnitude","cameraRotate","cameraMove","code","moveSpeed","zoomSpeed","spinSpeed","shiftKeys","action","keyMap","_shiftKey","zoom","yaw","tilt","console","_keys","has","_getKeyMotion","pixelY","normalizeWheel","wheelAmount","dir","amount","percentage","componentDidMount","listen","fn","window","passive","componentWillUnmount","listener","focus","_isLeftMouseDown","_isRightMouseDown","base","_getMoveMagnitude","startDragging","_endDragging","_moveKeyboard","dt","motion","cameraZoom","_startKeyTimer","lastStamp","requestAnimationFrame","stamp","_stopKeyTimer","cancelAnimationFrame","render","children","tabIndex","style","outline","draggable","ref","el","onMouseDown","onMouseUp","onBlur","onContextMenu","onKeyDown","onKeyUp","_onKeyUp","getNodeEnv","process","tempVec","tempMat","Ray","origin","distanceToPoint","planeIntersection","planeCoordinate","d","cosine","getRayFromClick","camera","projectionMatrix","viewMatrix","vp","invVp","mouseX","mouseY","rayPoint","rayOrigin","rayDir","Command","super","nextProps","componentDidUpdate","_updateContext","getChildrenForHitmap","instance","handleMouseEvent","mouseHandler","objects","WorldviewReactContext","ctx","ResizeObserverImpl","global","WorkerGlobalScope","self","callback","observe","contentRect","unobserve","Dimensions","parentElement","setParentElement","useState","dimensions","setDimensions","resizeObserver","entries","newWidth","newHeight","newLeft","newTop","setParentElementRef","useCallback","element","useEffect","HitmapObjectIdManager","ids","start","fill","map","_","index","last","id","objectHitmapId","object","_objectsByObjectHitmapIdMap","instanceIndex","_instanceIndexByObjectHitmapIdMap","_commandsByObjectMap","get","queuePromise","calling","nextCalls","returnPromise","promise","Promise","res","rej","resolve","reject","signal","queuedFn","args","nextArgs","nextPromise","error","compile","cmd","WorldviewContext","contextAttributes","Set","Map","undefined","canvasX","initializedData","canvasY","enableStackedObjectEvents","cachedReadHitmapCall","shallowequal","mouseEventObject","_fbo","framebuffer","depth","currentObjectId","excludedObjects","mouseEventsWithCommands","counter","maxStackedObjectCount","pixel","Uint8Array","_hitmapObjectIdManager","getObjectByObjectHitmapId","getCommandForObject","arguments","isHitmap","_drawCalls","drawCalls","drawInput","_compiled","hitmapProps","assignNextColors","onCameraStateChange","initialize","canvas","_instrumentCommands","createREGL","attributes","extensions","profile","uncompiledCommand","compiledCommand","compiledCameraCommand","fbo","dimension","destroy","onMount","_commands","onUnmount","unregisterPaintCallback","paintFn","registerDrawCall","registerPaintCallback","setDimension","paint","_paint","Date","paintCall","Proxy","apply","thisArg","DEFAULT_BACKGROUND_COLOR","handleWorldviewMouseInteraction","err","WorldviewBase","mouseEventName","_dragStartPos","deltaX","deltaY","worldviewContext","worldviewHandler","fromOffscreenTarget","clientLeft","ray","disableHitmapForEvents","hitmapOnMouseMove","mouseEventsByCommand","aggregationMap","array","item","existingItems","aggregate","canvasBackgroundColor","backgroundColor","_canvas","_cameraListener","_renderDebug","mem","reglCommandObjects","mapValues","total","pickBy","rows","border","paddingRight","bottom","right","fontFamily","fontSize","isFixedCamera","canvasScale","resolutionScale","canvasHtml","maxWidth","maxHeight","onDoubleClick","onMouseMove","_onMouseMove","showDebug","overflow","current","value","Worldview","Bound","Number","update","scratch","positions","vertexArray","concat","elements","face","elementsArray","Uint16Array","buff","colorBuff","frag","instances","decodePrimitive","draco","decoder","json","binary","primitive","dracoCompression","dracoGeometry","bufferView","bufferViewIndex","Int8Array","geometryType","status","errorMsg","decodeGeometry","accessors","attributeId","attribute","numComponents","numValues","attributeType","byteLength","dataType","ptr","decodeAttributes","numIndices","indices","Uint32Array","decodeIndices","async","decodeCompressedGLB","extensionsRequired","draco3dWasm","locateFile","createDracoModule","mesh","parseGLB","arrayBuffer","DataView","magic","readUint32","version","totalLength","chunkLength","chunkData","jsonData","findNextChunkOfType","JSON","TextDecoder","decode","accessorInfo","WebGLRenderingContext","arrayType","componentType","type","images","imgInfo","Blob","mimeType","nonInstancedGetChildrenForHitmapFromSingleProp","useOriginalMarkerProp","eventCallbackMarker","prop","hitmapProp","hitmapColor","nonInstancedGetChildrenForHitmap","getChildrenForHitmapWithOriginalMarker","instancedGetChildrenForHitmapFromSingleProp","matchedExcludedObjects","filteredIndices","instanceCount","idColors","startColor","allColors","j","idx","createInstancedGetChildrenForHitmap","pointCountPerInstance","withRenderStateOverrides","reglCommand","memoizedRender","memoize","renderElement","createCylinderGeometry","numSegments","sideFaces","endCapFaces","theta","bottomLeftPt","topRightPt","cone","bottomRightPt","topLeftPt","cylinders","fromGeometry","Cylinders","cones","Cones","generateArrowPrimitives","markers","marker","end","basePosition","tipPosition","length","headWidthX","headWidthY","headLength","shaftWidthX","shaftWidthY","shaftLength","shaftPosition","headPosition","originalMarker","pose","memo","passedProps","omit","Fragment","FLOAT_BYTES","POINT_BYTES","DEFAULT_MONOCHROME_COLOR","POINT_TYPES","BL","TR","BR","TL","VERTICES_PER_INSTANCE","k","lines","pointTypeBuffer","debugColorBuffer","defaultPosePositionBuffer","flatten","defaultPoseRotationBuffer","positionBuffer1","positionBuffer2","posePositionBuffer","poseRotationBuffer","thickness","joined","scaleInvariant","pointType","colorB","debug","stride","monochrome","colorC","positionA","positionB","positionC","positionD","posePosition","hasInstancedPoses","poseRotation","colorArray","pointArray","allocatedPoints","positionArray","rotationArray","numInputPoints","alreadyClosed","ax","ay","az","bx","by","bz","pointsEqual","shouldClose","pointData","numTotalPoints","off","n","fillPointArray","colorData","monochromeColor","convertedMonochromeColor","convertColors","convertedColors","lastIndex","fillColorArray","effectiveNumPoints","poses","rotationData","positionOffset","rotationOffset","convertedPosition","convertedRotation","positionData","fillPoseArrays","inProps","renderLine","Lines","p","xAxis","yAxis","zAxis","Axes","cubes","faces","prevMeridianPt","pt","prevPt","spheres","Spheres","multiplyScale","factor","DEFAULT_COLOR","ACTIVE_POLYGON_COLOR","ACTIVE_POINT_COLOR","DRAW_SCALE","DRAW_POINT_SCALE","HITMAP_SCALE","HITMAP_POINT_SCALE","POSE","PolygonPoint","Polygon","name","polygonLinesGetChildrenForHitmap","PolygonLines","polygons","poly","polygonPointsGetChildrenForHitmap","PolygonPoints","originalMarkers","convertedPoint","sphereList","areEqual","point1","x1","y1","z1","x2","y2","z2","point2","isClosed","polygon","defaultSingleColorDepth","defaultVetexColorDepth","singleColor","vertexColors","triangles","single","vertex","items","singleColorItems","vertexColorItems","makeTrianglesCommand","Triangles","NO_POSE","DEFAULT_SCALE","getEarcutPoints","flattenedPoints","flatten3D","earcut","newPoints","originalIndex","generateTriangles","earcutPoints","DEFAULT_BG_COLOR","cssHasBeenInserted","isColorDark","isColorEqual","TextElement","insertGlobalCss","hasBgColor","textColor","autoBackgroundColor","_prevBgColor","hexBgColor","_text","textContent","Text","textComponents","textContainer","componentsToRemove","coord","_textContainerRef","createElement","OffscreenCanvas","BG_COLOR_LIGHT","BG_COLOR_DARK","BG_COLOR_TRANSPARENT","hashMarkerPosition","getMarkerYOffset","offsets","setMarkerYOffset","generateAtlas","atlasConfigs","sdfDataByChar","atlasConfig","tinySDF","TinySDF","fontWeight","fontStyle","radius","cutoff","charSet","char","charInfo","textureWidth","glyphHeight","lineHeight","dx","yOffset","glyphTop","textureHeight","textureData","makeTextCommand","alphabet","memoizedGetAtlasConfig","memoizeOne","charSetSize","memoizedGenerateAtlas","memoizedDrawAtlasTexture","textAtlas","atlasTexture","format","wrap","mag","min","drawText","atlas","atlasSize","scaleInvariantSize","borderRadiusSize","cameraFovY","texCoord","srcOffset","charOffset","destOffset","srcSize","roundedBackgroundSize","backgroundDestSize","alignmentOffset","billboard","poseOrientation","estimatedInstances","markersWithSplitText","text","charsByLine","line","maybeGeneratedAtlas","generatedAtlasChars","textChars","generatedAtlasHasAllChars","difference","maxAtlasWidth","generatedAtlas","destOffsets","backgroundDestSizes","srcSizes","srcOffsets","charOffsets","lineSizes","totalInstances","yOffsets","totalWidth","markerInstances","fgColor","bgColor","hlColor","hlColorText","paddingScaleX","paddingScaleY","paddingX","paddingY","charDescenderLineShift","runningGlyphCount","lineIndex","chars","totalLineWidth","info","firstCharOnLine","lastCharOnLine","charIndex","charHighlighted","charTextColor","charBackgroundColor","totalHeight","resolution","makeGLTextCommand","glConstantToRegl","drawModel","globalAlpha","poseMatrix","baseColorTexture","baseColorFactor","nodeMatrix","normal","singleTexCoord","whiteTexture","getDrawCalls","memoizeWeak","model","textures","textureInfo","sampler","minFilter","magFilter","wrapS","wrapT","REPEAT","bitmap","node","material","texInfo","primitiveAccessors","dracoCompressionEXT","normals","texCoords","drawMesh","drawNode","keys","getSceneToDraw","rootTransform","withContext","useModel","useDebugValue","setValue","unloaded","deps","useAsyncValue","response","fetch","DEFAULT_GRID_COLOR","grid","bound","Grid","rest","Overlay","coordinates","renderItem","makePointsCommand","useWorldSpaceSize","minLimitPointSize","maxLimitPointSize","pointSize","minPointSize","maxPointSize","downloadURL","fileName","href","download","useContext","loadedModel","activePolygon","pointX","pointY","dX","dY","uniquePoints","acc","shortestDistance","shortestIndex","px","py","dist","newPoint","isFirstClick","isCtrlClick","clickObject","isActivePolygonClosed","addPolygon","pushPoint","floatingPoint","updateActivePoint","closeActivePolygon","deletePolygon","filter","deletePoint","selectObject","isActive","canvasRef","atlasData","regenerateAtlas","canEl","alphaChannel","imageData","makeRGBAImageData","downloadAtlasFiles","textAtlasJson","textAtlasJsonStr","encodeURIComponent","blob","url","setTimeout","useLayoutEffect","margin","onClick","mat3","m11","m12","m13","m22","m23","m32","m33","cylindersCommand","conesCommand","conePrimitives","trianglesCommand","PanelComponent","ConnectedPanel","childId","config","originalConfig","saveConfig","tabId","mosaicActions","MosaicContext","mosaicWindowActions","MosaicWindowContext","layout","useSelector","persistedState","panels","savedProps","stableSavedProps","useRef","selectedPanelIds","mosaic","isSelected","isFocused","isOnlyPanel","useMemo","isParent","EMPTY_CONFIG","topics","datatypes","capabilities","PanelAPI","useDataSourceInfo","dispatch","useDispatch","actions","bindActionCreators","savePanelConfigs","saveFullPanelConfig","changePanelLayout","addSelectedPanelId","removeSelectedPanelId","setSelectedPanelIds","createTabPanel","setFullScreenPanel","clearFullScreenPanel","quickActionsKeyPressed","setQuickActionsKeyPressed","shiftKeyPressed","setShiftKeyPressed","fullScreen","fullScreenPanel","panelId","fullScreenLocked","locked","isHovered","setIsHovered","panelsByType","getPanelsByType","panelType","panelComponentConfig","saveCompleteConfig","configToSave","options","configs","historyOptions","updatePanelConfig","perPanelFunc","openSiblingPanel","siblingConfigCreator","siblingComponent","PanelList","getComponentForType","siblingDefaultConfig","ownPath","getPath","siblingPathEnd","getOtherBranch","siblingPath","slice","siblingId","getNodeAtPath","getRoot","getPanelTypeFromId","siblingConfig","newPanelPath","split","then","newPanelId","selectPanel","toggleSelection","panelIdsToDeselect","savedConfig","isTabPanel","activeTabIdx","tabs","activeTabLayout","childrenPanelIds","getAllPanelIds","push","parentTabPanelByPanelId","getParentTabPanelByPanelId","nextParentId","parentTabPanelIds","nextSelectedPanelIds","xor","nextValidSelectedPanelIds","without","getSelection","removeAllRanges","onOverlayClick","stopPropagation","metaKey","groupPanels","idToReplace","idsToRemove","singleTab","createTabs","closePanel","splitPanel","logEventAction","getEventInfos","PANEL_REMOVE","getEventTags","PANEL_TYPE","remove","newId","getPanelIdForType","pathToPanelInTab","getPathFromNode","newTabLayout","updateTree","path","spec","$set","first","second","direction","newTabConfig","updateTabPanelLayout","PANEL_SPLIT","onMouseEnter","onMouseLeave","enterFullScreen","exitFullScreen","onReleaseQuickActionsKey","keyUpHandlers","keyDownHandlers","Shift","Escape","onBlurDocument","child","isDemoMode","useExperimentalFeature","Provider","enabled","className","styles","root","rootFullScreen","selected","col","dataAttrs","dataTest","clip","notClickable","data-tab-options","tabActionsOverlay","BLUE","small","marginBottom","TAB_PANEL_TYPE","quickActionsOverlay","data-panel-overlay","disabled","data-panel-overlay-exit","displayName","assign","shortcuts","freeze","onChange","hexColor","getHexFromColorSettingWithDefault","enableAlpha","newColor","getRGBAFromColor","placement","size","isSmallSize","PICKER_SIZE","SMALL","SWrapper","animation","NORMAL","styled","span","tinyColor","fromRatio","toRgbString","rgbaColor","setAlpha","toRgb","linkedGlobalVariables","setLinkedGlobalVariables","Container","div","alignLeft","GRAY","DARK9","EmptyState","Component","uniq","rosPath","parseRosPath","topicName","grammarObj","Grammar","fromCompiled","grammar","parser","Parser","feed","results","addLinkTooltip","hasNestedValue","highlight","label","linkedGlobalVariable","markerKeyPath","nestedValueStyle","marginLeft","onlyRenderAddLink","unlinkTooltip","variableValue","linkedGlobalVariableLocal","getLinkedGlobalVariable","isArrayBuffer","ArrayBuffer","isView","renderUnlink","addToLinkedGlobalVariable","renderAddLink","wrapperStyle","cursor","SValue","SGlobalVariableLink","tooltip","setIsOpen","linkedVar","SPath","SP","SGlobalVariableForm","form","DARK3","tempPos","tempScale","tempOrient","stripLeadingSlash","startsWith","Transform","create","set","fromRotationTranslation","matrix","_hasValidMatrix","isValid","rootId","isChildOfTransform","parent","output","input","multiply","getTranslation","getScaling","determinant","inverse","getRotation","TfStore","objectValues","storage","transformElements","values","empty","rawTransforms","forEach","childFrame","parentFrame","tf","original","frameId","rootOfTransform","transformID","content","module","transform","locals","exports","SLabel","strikethrough","SDescription","SInput","checkedKeysSet","derivedCustomSettings","filterText","hasChildren","hasFeatureColumn","isXSWidth","availableByColumn","providerAvailable","featureKey","nodeVisibleInScene","sceneErrors","setCurrentEditingTopic","structuralDatatypes","tooltips","visibleByColumn","visibleTopicsCount","diffModeEnabled","datatype","isDefaultSettings","showTopicSettings","canEditDatatype","showTopicSettingsChanged","showTopicError","showGroupError","rowWidth","TREE_SPACING","togglesWidth","TOGGLE_WRAPPER_SIZE","rightActionWidth","DOT_MENU_WIDTH","maxNodeNameWidth","errorTooltip","SErrorList","errStr","SErrorItem","showVisibleTopicsCount","VISIBLE_COUNT_WIDTH","setHoveredMarkerMatchers","ThreeDimensionalVizContext","updateHoveredMarkerMatchers","columnIndex","visible","joinTopics","$WEBVIZ_SOURCE_2","mouseEventHandlersByColumnIdx","toggleCheckAllAncestors","toggleNodeChecked","toggleNodeExpanded","toggleCheckAllDescendants","useGuaranteedContext","TopicTreeContext","STreeNodeRow","visibleInScene","SLeft","data-test","searchText","additionalElem","contents","SVisibleCount","padding","HIGHLIGHT","fade","SErrorCount","SIconWrapper","RED","display","alignItems","tooltipProps","SRightActions","SToggles","available","columnIdx","checked","overrideColor","overrideColorByColumn","onToggle","onShiftToggle","onAltToggle","unavailableTooltip","disableBaseColumn","disableFeatureColumn","nodeKey","TEXT_MUTED","TOPIC_ROW_PADDING","ul","li","SDotMenuPlaceholder","ROW_HEIGHT","useCachedGetMessagePathDataItems","providerTopics","globalVariables","memoizedPaths","useShallowMemo","unmemoizedFilledInPaths","filledInPaths","fillInGlobalVariablesInPath","memoizedFilledInPaths","useDeepMemo","cachesByPath","useChangeDetector","filledInPath","isEqual","message","bigInt","weakMap","WeakMap","messagePathDataItems","getMessagePathDataItems","filterMatches","currentValue","getField","messagePath","messagePathPart","variableName","Infinity","variable","TIME_NEXT_BY_NAME","sec","structureType","primitiveType","nsec","structures","messagePathStructures","find","queriedData","traverse","pathIndex","structureItem","pathItem","nextPathItem","structureIsJson","next","nextByName","nextStructIsJson","repr","warn","startIdx","endIdx","arrayLength","arrayElement","getIndex","newPath","fieldNames","isTypicalFilterName","constantName","prevPathItem","fieldName","enumMap","enumValuesByDatatypeAndField","cachedGetMessagePathDataItems","messagesByTopic","obj","tryToSetDefaultGlobalVar","setGlobalVariables","defaultGlobalVars","getDefaultPersistedState","getFirstInvalidVariableFromRosPath","globalVars","flatMap","messagePathParts","loc","startLoc","valueLoc","getExamplePrimitive","MessagePathInputUnconnected","PureComponent","event","nativeEvent","newCursorPosition","selectionEnd","setImmediate","setSelectionRange","onTimestampMethodChange","autocomplete","autocompleteType","autocompleteRange","keepGoingAfterTopicName","validTypes","substr","blur","focused","prioritizedDatatype","autoSize","placeholder","noMultiSlices","timestampMethod","inputStyle","disableAutocomplete","structureTraversalResult","traverseStructure","valid","validTerminatingStructureItem","autocompleteItems","autocompleteFilterText","getTopicNames","msgPathPart","join","nameLoc","messagePathsForDatatype","msgPath","endsWith","initialFilterLength","replace","invalidGlobalVariablesVariable","noHeaderStamp","topicHasNoHeaderStamp","orderedAutocompleteItems","partition","getTopicsByTopicName","flex","minWidth","justifyContent","_onChange","onSelect","_onSelect","hasError","autocompleteKey","disableAutoSelect","timestampMethodDropdownContainer","_onTimestampMethodChange","toggleComponent","timestampMethodDropdown","timestampMethodDropdownError","timestampItemError","ICON_BY_TYPE","AlphaR","AlphaT","ArrowCollapseDown","ArrowCollapseLeft","ArrowCollapseRight","ArrowCollapseUp","ArrowDecision","ArrowLeft","ArrowRight","ArrowTopLeft","ArrowTopRight","BusSchool","CarBrakeAlert","CarParkingLights","HazardLights","HelpCircleOutline","RoadVariant","SignalOff","RobotOutline","RobotOffOutline","bike","Bike","bus","Bus","car","Car","DEFAULT","CubeOutline","help","Help","motorbike","Motorbike","octagon","Octagon","train","Train","truck","Truck","walk","Walk","configCameraState","followOrientation","transforms","transformedCameraState","targetPose","getTargetPose","lastTargetPoseRef","lastTargetPose","params","URLSearchParams","location","search","parseFloat","getZoomDistanceFromURLParam","mergeWith","objVal","srcVal","selectedObject","getObject","interactionData","getInteractionData","newGlobalVariables","objectForPath","reverse","prevCameraState","prevTargetPose","prevFollowTf","prevFollowOrientation","newFollowTf","newFollowOrientation","newCameraState","heading","cameraStateSelectors","rotateZ","add","getEquivalentOffsetsWithoutTarget","emptyPose","pz","ox","oy","oz","ow","getInstanceObj","isBobject","metadataByIndex","deepParse","instanceObject","originalMessage","parsedMessage","interestingObjectFields","field","clickedPointDetails","getClickedPointColor","decodedData","uint8","uint16","int16","int32","float32","topicsGroups","singleTopicDatatype","defaultTopicToRender","availableTopics","topicGroup","suffix","parentTopic","renderTopics","t","group","LIGHT1","ORANGE","icon","SDiv","SSpan","topicDiv","parentTopicSpan","SIconSpan","test","measureText","family","rowHeight","parseInt","defaultGetText","Autocomplete","_ignoreFocus","clearOnFocus","_autocomplete","refs","activeElement","setState","_event","removeEventListener","selectionStart","select","preventDefault","addEventListener","_ignoreBlur","currentTarget","scrollTop","showAllItems","createRef","menu","scrollHeight","clientHeight","getItemValue","getItemText","selectedItem","sortWhenFiltering","menuStyle","open","selectedItemValue","isHighlighted","itemValue","data-highlighted","data-test-auto-item","autocompleteItem","highlighted","inputProps","inputError","autoCorrect","autoCapitalize","spellCheck","max","onFocus","_onFocus","_onBlur","_onMouseDown","_onKeyDown","renderMenu","menuItems","maxNumberOfItems","ceil","innerHeight","menuItemsToShow","maxBy","innerWidth","onScroll","_onScroll","renderMenuWrapper","body","createPortal","linkedGlobalVariablesKeyByTopicWithPath","memoizedGetLinkedVariablesKeyByTopicWithPath","topicWithPath","getTopicWithPath","getLinkedGlobalVariableKeyByTopicWithPath","keyBy","memoizedGetLinkedGlobalVariablesKeyByName","reduce","createContext","noop","colorOverrideBySourceIdxByVariable","setColorOverrideBySourceIdxByVariable","defaultPointSize","defaultPointShape","settings","onFieldChange","pointSizeVal","pointShape","pointShapeVal","pointShapeOpts","Option","upperFirst","toString","step","isInputValid","Select","decayTime","decayTimeValue","topicSettingsEditorForDatatype","editor","canEditNamespaceOverrideColor","editors","PointCloudSettingsEditor","PoseSettingsEditor","LaserScanSettingsEditor","MarkerSettingsEditor","IconMarkerSettingsEditor","MarkerOverrideColorSettingsEditor","TopicSettingsEditor","onSettingsChange","newSettings","Editor","container","hot","availableNamespacesByTopic","defaultTopicSettings","sceneErrorsByTopicKey","topicDisplayMode","topicTreeConfig","uncategorizedGroupName","staticallyAvailableNamespacesByTopic","topicTreeTopics","from","flattenNode","namespace","Boolean","some","rootTreeNode","allTopicNames","nonPrefixedTopicNames","availableTopicsNamesSet","uncategorizedTopicNames","datatypesByTopic","newChildren","generateTreeNode","parentKey","nodesByKey","flattenNodes","selections","isSelectedMemo","baseKey","isFeatureColumn","selectedTopicNamesSet","getBaseKey","selectedNamespacesByTopic","parseNamespaceKey","selectedTopicNames","getIsTreeNodeVisibleInScene","prefixedTopicName","visibleTopicsCountByKey","DEFAULT_TOPICS_COUNT_BY_KEY","ret","baseTopicName","topicKey","parentNode","memoizedSelectedTopicNames","derivedCustomSettingsByKey","topicKeyOrNamespaceKey","isFeatureTopicOrNamespace","onNamespaceOverrideColorChange","prefixedNamespaceKey","newSettingsByKey","checkedNamespacesByTopicName","checkedNamespaces","getIsNamespaceCheckedByDefault","toggleNamespaceChecked","newCheckedKeys","allNsKeys","ns","otherNamespaceKeys","keyWithPrefix","isNowChecked","nodeAndChildren","nodeAndChildrenKeys","topicNames","namespaceChildrenKeys","newModififiedNamespaceTopics","nodeKeysToToggle","namespaceParentTopicName","prevChecked","nodeAndAncestorKeys","keyToToggle","filterTextRef","sceneErrorsByKey","collectGroupErrors","groupKey","errors","errorsWithTopicName","topicNode","debouncedFilterText","useDebounce","getIsTreeNodeVisibleInTree","showVisible","TOPIC_DISPLAY_MODES","SHOW_SELECTED","showAvailable","SHOW_AVAILABLE","hasCalculatedVisibility","isVisibleByKey","toLowerCase","trim","calculateIsVisible","isAncestorVisible","unavailable","invisibleInScene","isAncestorOrCurrentVisible","getIfTextMatches","isChildVisible","namespaces","thisNamespacesMatches","isVisible","allKeys","shouldExpandAllKeys","description","childrenNodes","subNode","namespaceParts","stringify","getDisplayName","hardware_id","kv","truncate","getDiagnosticId","LEVELS","OK","WARN","ERROR","STALE","diagnosticsByName","diagnosticsByNameByTrimmedHardwareId","diagnostic","level","LEVEL_NAMES","trimHardwareId","hardwareId","trimmedHardwareId","indexOf","nodes","unpinnedNodes","sortBy","getPlotDataByPath","itemsByPath","getTooltipItemForMessageHistoryItem","getMessagePathItemsForBlock","decodeMessagePathsForMessagesByTopic","block","ZERO_TIME","followingViewWidth","yAxisPaths","minYValue","maxYValue","showLegend","xAxisVal","xAxisPath","currentMinY","currentMaxY","currentViewWidth","saveCurrentView","minY","maxY","setWidth","setMinMax","showSingleCurrentMessage","historySize","allPaths","compact","subscribeTopics","getTopicsFromPaths","useMessagesByTopic","preloadingFallback","useDecodeMessagePathsForMessagesByTopic","streamedItemsByPath","blocks","useBlocksByTopic","blockItemsByPath","lastBlockIndexForPath","messagePathItemsForBlock","pathItems","currentRange","getBlockItemsByPath","startTime","mergedItems","every","datasets","pathsWithMismatchedDataLengths","getDatasetsAndTooltips","currentTime","endTime","seekPlayback","seek","useMessagePipeline","playerState","activeData","timeToXValueForPreloading","toSec","subtractTimes","preloadingDisplayTime","preloadingStartTime","preloadingEndTime","hasPreloadingDisplayTime","defaultView","minXValue","maxXValue","__","X_AXIS_ID","seekSeconds","seekTime","TimeUtil","fromSec","getDatasets","useGetCurrentValue","getTooltips","plotMenu","displayWidth","center","helpContent","floating","menuContent","clonedMessagePath","messagePaths","builtString","typicalFilterName","matchingFilterPart","pathPart","filterVal","sort","lastDatatypes","lastStructures","structureFor","rosDatatype","fields","msgField","isConstant","rosPrimitives","isArray","currentItem","gl","getError","NO_ERROR","INVALID_ENUM","msg","INVALID_VALUE","INVALID_OPERATION","INVALID_FRAMEBUFFER_OPERATION","OUT_OF_MEMORY","CONTEXT_LOST_WEBGL","createShader","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","rect","scissor","clearColor","clear","COLOR_BUFFER_BIT","transferControlToOffscreen","lineColors","toolsColorScheme","blue","medium","orange","yellow","purple","dark","cyan","green","paleGreen","lightColor","brighten","darkColor","darken","STextField","STextFieldLabel","LIGHT","SError","TextField","defaultValue","focusOnMount","hideInlineError","onError","validateOnBlur","validator","setError","inputStr","setInputStr","prevIncomingVal","inputRef","validationResult","validate","handleChange","handleBlur","errorStyle","defaultProps","sentNotification","sendIconTypeDeprecatedNotification","getIconName","projectItem","metadata","icon_type","markerStyle","iconTypes","icon_types","iconType","iconOffset","setOverlayIcons","renderItems","nonEmptyChildren","dummy","sceneBuilderDrawables","PoseClass","PointClass","OrientationClass","disableAutoOpenClickedObject","PanelContext","InteractionsBaseComponent","SRow","SEmptyState","interactionsTabType","setInteractionsTabType","findTopicInTopicTree","findTopic","buttons","selectedTab","onSelectTab","newSelectedTab","ToolGroup","ToolGroupFixedSizePane","pointDetails","labelStyle","labelDirection","CheckboxMarkedIcon","CheckboxBlankOutlineIcon","styledLabel","SCheckbox","SToolGroupFixedSizePane","PANE_WIDTH","selectedTabLocal","Children","selectedChild","expanded","row","tabBar","tab","spaceSeparator","tabBody","EDIT_FORMAT","YAML","editFormat","setEditFormat","ValidatedInput","onSelectFormat","newFormat","SEditBox","STransparentDropdownButton","StyledTextarea","textarea","ValidatedInputBase","dataValidator","parse","isEditing","setIsEditing","memorizedInputValidation","newInputVal","onChangeFcn","newVal","newError","validationErrorToString","inputElem","JsonInput","YamlInput","InputComponent","toUpperCase","STopicTreeWrapper","MAX_CONTAINER_WIDTH_RATIO","STopicTree","animated","TEXT","DARK2","STopicTreeInner","SWITCHER_WIDTH","DARK4","STopicTreeHeader","DARK5","SFilter","SSwitcherIcon","SNoMatches","SNoMatchesText","TopicTree","setEditingNamespace","setFilterText","setShowTopicTree","showTopicTree","showDiffMode","treeHeight","treeWidth","renderTopicTree","scrollContainerRef","filterTextFieldRef","expandedKeysRef","hasRootNodeChanged","filterTextFieldEl","topLevelNodesCollapsed","showNoMatchesState","headerRightIconStyle","linkedGlobalVariablesByTopic","groupBy","treeData","itemHeight","selectable","onExpand","newExpandedKeys","autoExpandParent","switcherIcon","visibility","containerWidth","containerHeight","defaultTreeWidth","clamp","isPlaying","springProps","useSpring","native","unique","precision","immediate","to","opacity","transformX","tension","friction","treeHeightRaw","SWITCHER_HEIGHT","CONTAINER_SPACING","resize","ev","showErrorBadge","pointerEvents","interpolate","topicDisplayModeProp","DEFAULT_DISPLAY_MODE","STopicViewModeSelector","btnStyle","newValue","dropdownOptions","SHOW_ALL","boundsById","forceUpdateById","minX","maxX","hasRenderedIds","throttledForceUpdate","throttle","forceUpdateId","leading","trailing","isSynced","uuid","v4","forceUpdate","useForceUpdate","recompute","allBounds","calculatedBounds","useDeepChangeDetector","headerStamp","maybeGetBobjectHeaderStamp","defaultGetHeaderStamp","receiveTime","STEP_SIZES","minValue","maxValue","minAlongAxis","maxAlongAxis","secondsPer50Pixels","abs","screenCoord","valuePerPixel","trunc","datumStringPixel","pointBackgroundColor","xScale","yScale","linesToHide","xScalePerPixel","yScalePerPixel","dataset","oldData","oldColors","oldDisplay","datalabels","oldPointBackgroundColor","includeColors","includeDisplay","includePointBackgroundColor","groupedData","datum","uniqData","showLine","sortedUniqBy","uniqBy","onVisibilityChange","visibilityState","light","red","grey","toHexString","PanelToolbarLabel","PanelToolbarInput","transitionableRosTypes","SRoot","SAddButton","show","SChartContainerOuter","SChartContainerInner","inputColor","inputColorBright","lighten","SInputContainer","shrink","css","SInputDelete","yAxes","ticks","mixins","monospaceFont","fontColor","maxRotation","plugins","anchor","align","font","weight","multicolorLineYOffset","scaleOptions","yAxisTicks","onlyTopicsHeight","heightPerTopic","onInputChange","newPaths","onInputTimestampMethodChange","yLabels","_path","dataItem","borderWidth","pointBorderColor","pointHoverRadius","pointRadius","pointStyle","baseColors","previousValue","previousTimestamp","timestamp","valueForColor","round","positiveModulo","unshift","String","dataPoint","showDatalabel","labelColor","xAxisIsPlaybackTime","splice","bigInts","addMessages","prevMessageAndData","messages","restore","requestBackfill","messagePipeline","addMessageCallbackName","messageAndData","useMessageReducer","Interactions","reader","getReader","pointCount","sphericalRangeScale","FLOAT_SIZE","hasValidStride","reinterpretBufferToFloat","extractValues","readers","colorMode","rgbOffset","expandBufferToFloat","Uint8Reader","colorField","DATATYPE","BYTES_PER_ELEMENT","pointStart","NaN","read","getDiff","before","after","idLabel","showFullMessageForDiff","idToCompareWith","allItems","candidateIdsToCompareWith","idKey","beforeItem","afterItem","candidateIdBefore","candidateIdAfter","unmatchedAfterById","diff","innerDiff","isEmpty","isDeleted","diffLabels","DELETED","labelText","ID","is","afterIsNotObj","ADDED","idLabelObj","beforeIsNotObj","CHANGED","DARK6","indicator","jsonTreeTheme","base0B","diffLabelsByLabelText","imageTopic","allCameraNamespaces","cameraNamespace","getCameraNamespace","availableMarkerTopics","enabledTopic","pop","imageTopicsByNamespace","vals","outsideWidth","outsideHeight","insideWidth","insideHeight","rightX","bottomY","rawMarkerData","cameraInfo","cameraModel","originalHeight","originalWidth","CameraModel","splitTopic","topicPart","TabDndContext","preventTabDrop","layoutNameRegex","isRequired","isNumber","isBoolean","isNumberArray","expectArrLen","isOrientation","isNumberArrayErr","quaternionSum","minLen","minLength","maxLen","maxLength","len","getWebsocketUrlError","websocketUrl","RegExp","createValidator","rules","rule","createPrimitiveValidator","isXYPointArray","isPolygons","getLayoutNameError","layoutName","layoutNameValidator","MeasuringTool","newMeasureState","measureState","onMeasureInfoChange","measurePoints","_clickInfo","mouseDownCoords","mouseUpCoords","clickInfo","arrayToPoint","measureActive","_canvasMouseMoveHandler","_canvasMouseUpHandler","_canvasMouseDownHandler","dist_string","hypot","toFixed","renderTreeNodes","titleWidth","nodeAvailable","itemChildren","namespaceNodes","getNamespaceNodes","canEditNamespaceOverrideColorDatatype","TooltipRow","TooltipTable","TooltipDescription","renderStyleExpressionNodes","SToggle","table","baseNamespacesSet","featureNamespacesSet","uniqueNamespaces","columns","namespaceKey","topicNodeKey","hasNamespaceOverrideColorChangedByColumn","namespaceOverrideColorByColumn","topicOverrideColorByColumn","namespaceNode","checkedByColumn","visibleInSceneByColumn","shiftKey","altKey","clickable","transition","getStyles","DISABLED_COLOR","TOGGLE_SIZE_CONFIG","sizeInNumber","borderRadius","firstColor","DIFF_MODE_SOURCE_1","DIFF_MODE_SOURCE_BOTH","secondColor","DIFF_MODE_SOURCE_2","background","diffModeStyleOverrides","overrideHexColor","enabledColor","disabledColor","SContainer","SLoading","SLoadingToolbarWrapper","DARK1","SSpinningWrapper","memoizedGetAudioDataFromBlocks","audioBlocks","firstAudioMsg","frames","sampling_rate_hz","channelCnt","channels","audioMsgTimestamps","audioSamples","header","msgFrames","generateSamplesFromFrames","channelIdx","messageTimestamps","samplingRate","samples","channelCount","configTopic","sortedTopics","isAudioDatatype","isAudioTopicAvailable","blockLoadingStates","isAllAudioBlocksLoaded","blockLoadingInfo","loaded","defaultBlocks","frame_id","seq","processedAudioData","nonEmptyBlocks","audioBlock","renderAudioPlayer","additionalIcons","showAllChannels","volume","playbackRate","selectedChannel","c","selectedChanel","audioContext","sample","newBuffer","floatArray","copyToChannel","pointWidth","wave","getChannelData","getBound","getBoundArray","waveformConfig","playedRatio","getContext","clearRect","hasMultiWaveForms","heightScaleFactor","multiChannelHeightScaleFactor","maxAmp","maxPlayedBound","playedAll","playedBounds","unplayedBounds","channelBounds","useActiveChannelColor","unplayedDrawColor","activeChannelColor","offsetX","drawPoints","missingDataColor","offsetY","playedDrawColor","activeChannelPlayedColor","playedColor","fillStyle","markerColor","fillRect","wav","missingData","DEFAULT_SAMPLE_VALUE","floor","typeName","isNumberType","getText","needle","option","haystack","charPos","score","bool","int8","uint32","int64","uint64","float64","string","time","duration","getHeaderStamp","allMessageStampsNewestFirst","synchronizedMessagesByTopic","messagesMatchingStamp","getSynchronizedState","synchronizedMessages","addBobjects","newMessages","newMessagesByTopic","cast","stamps","compare","synchronizedMessage","thisStamp","areSame","getSynchronizedMessages","matchingMessage","newSynchronizedMessages","headerStamps","syncedMsgs","msgsByTopic","isLessThan","SResetZoom","SLegend","SCurrentTimeBar","MemoizedTooltips","delay","chartCallbacks","hasUnmounted","hasUserPannedOrZoomed","setHasUserPannedOrZoomed","hasUserPannedOrZoomedRef","followPlaybackState","setFollowPlaybackState","useForceRerenderOnVisibilityChange","scaleBounds","hoverBar","onScaleBoundsUpdate","scales","previousScaleBounds","firstYScale","axes","firstXScale","lastPanTime","onClickAddingValues","datalabel","chartPx","getBoundingClientRect","getChartValue","currentTimeRef","onPanZoom","newScaleBounds","currentTimeFromRef","xOffsetMin","xOffsetMax","onResetZoom","resetZoom","hasVerticalExclusiveZoom","setHasVerticalExclusiveZoom","hasBothAxesZoom","setHasBothAxesZoom","zoomMode","v","keyUphandlers","removeTooltip","ReactDOM","unmountComponentAtNode","removeChild","updateTooltip","tooltipItem","tooltipData","_tooltip","appendChild","hoverComponentId","clearHoverValue","useClearHoverValue","setHoverValue","useSetHoverValue","clearGlobalHoverTime","setGlobalHoverTime","componentId","canvasRect","xBounds","yBounds","xMousePosition","pageX","yMousePosition","pageY","isTargetingCanvas","inBounds","tooltipElement","getElementAtXAxis","xScaleOptions","stepSize","filteredData","filterDatasets","scalePerPixel","xVals","pts","hasData","usingSyncedBounds","syncedBounds","useSyncedTimeAxis","syncedMinX","syncedMaxX","enableFollowingPlayback","followPlaybackCurrentTime","chartJsOptions","annotations","defaultXTicksSettings","defaultYTicksSettings","defaultXAxis","gridLines","zeroLineColor","maintainAspectRatio","responsiveAnimationDuration","legend","hover","intersect","xAxes","annotation","datasetId","drawLegend","canToggleLines","toggleLine","xAxisTicks","zoomOptions","DEFAULT_PROPS","currentTimePx","getChartPx","chartTopAndHeight","getChartTopAndHeight","ChartComponent","renderPath","GLChart","ReactChartjs","isTimestampScale","SBar","topPx","heightPx","panOptions","callbacksRef","capture","elRef","prevRectRef","glContext","useGLContext","renderGrid","renderPoints","renderLines","memoizedData","memoizedOptions","computeDataBounds","proj","computeProjectionMatrix","computePaddingMatrix","forceDisableWorkerRendering","onClickHandler","usingWebWorker","chartRpc","initialized","panning","currentDeltaX","currentDeltaY","currentPinchScaling","nodeRef","getRpc","rpc","webWorkerManager","registerWorkerListener","mainThreadRpc","workerRpc","getFakeRpcs","MainThreadChartJSWorker","sendToRpc","dataToSend","transferrables","send","handleScaleBoundsUpdate","scaleBoundsUpdate","handlePanZoom","onWheel","percentZoomX","percentZoomY","focalPoint","wheelZoomHandler","whichAxesParam","newEvent","persist","boundingRect","setupPanAndPinchHandlers","threshold","hammerManager","Hammer","Manager","Pinch","Pan","hammerPanHandler","on","handlePinch","pointers","xy","devicePixelRatio","memoizedScaleOptions","pauseFrame","resumeFrameRefs","chartUpdateId","resumeFrame","resumeFrameCallbacks","unregisterWorkerListener","WebWorkerManager","ChartJSWorker","sensitivity","speed","classType","maxWorkerCount","_classType","_maxWorkerCount","_workerStates","_allListeners","testing_getWorkerState","workerState","listenerIds","worker","Rpc","setupMainThreadRpc","emptyIndex","delete","workerStateIndex","_id","terminate","defaultDiagnosticsBuffer","maybeAddMessageToBuffer","statusArray","computeDiagnosticInfo","newHardwareId","newDiagnostic","hardwareDiagnosticsByName","previousNumberOfDiagnostics","newEntry","sortKey","sortedIndexBy","sortedAutocompleteEntries","newHardwareEntry","hardwareIdx","modified","predicate","newArray","internalValue","setInternalValue","lastPropsValue","parsedValue","parseJson","newParsedValue","keyValMap","ArrowDown","ArrowUp","SText","BG_COLOR","ICON_WIDTH","getIconStyles","getIconScaleByCameraDistance","scaledIconWrapperSize","scaledIconSize","iconWrapperPadding","cameraDistance","onIconClick","overlayIcons","updateOverlayIcons","newIcons","oldIcons","receive","iconName","data-icon-name","SvgIcon","showList","links","listStyle","marginRight","listHtml","SList","linkedGlobalVariableName","SListItem","danger","flexShrink","newLinkedGlobalVariables","STopicWithPath","SExistingLinks","marginTop","GlobalVariableName","SForm","isOpen","leftPadding","maybeFullyDecodedMarker","positionBuffer","is_bigendian","isNil","getVertexCount","pointIndex","vertexValues","getVertexValues","minColorValue","maxColorValue","colorFieldValue","getVertexValue","colorFieldRange","pct","minColor","maxColor","parsedMinColor","toRgba","DEFAULT_MIN_COLOR","parsedMaxColor","DEFAULT_MAX_COLOR","lerp","getRainbowColor","flatColor","DEFAULT_FLAT_COLOR","allFields","row_step","point_step","getFieldOffsetsAndReaders","dataOffset","dataStart","rgba","h","f","PREFERRED_OBJECT_KEY_ORDER","SObjectDetails","shouldExpandNode","invertTheme","theme","tree","hideRoot","sortedDataObject","fromEntries","getItemString","itemType","itemString","labelRenderer","p1","p2","valueRenderer","usePanelContext","openRawMessages","topicPath","STopicLink","isSingleElemArray","isArrayView","toArray","dataWithoutWrappingArray","maybeDeepParse","diffMethod","diffTopicPath","diffEnabled","topicRosPath","rootStructureItem","expandAll","setExpandAll","expandedFields","setExpandedFields","consecutiveMsgs","prevTickMsg","prevTickObj","currTickObj","useLatestMessageDataItem","otherSourceTopic","inOtherSourceDiffMode","diffTopicObj","inTimetickDiffMode","baseItem","diffItem","onTopicPathChange","newTopicPath","onDiffTopicPathChange","newDiffTopicPath","onToggleDiff","onToggleExpandAll","currVal","onLabelClick","keypath","expandedFieldsCopy","keyPath","iconWrapper","isHovering","lastKeyPath","valueAction","getValueActionForValue","childStructureItem","getStructureItemForPath","enumMapping","basePath","itemLabel","smallNumberArrayStr","DATA_ARRAY_PREVIEW_LIMIT","HighlightedValue","log","iconBox","renderSingleTopicOrDiffOutput","hideWrappingArray","shouldDisplaySingleVal","singleVal","diffData","diffLabelTexts","CheckboxComponent","scroll","diffMessage","MaybeCollapsedValue","verticalAlign","raw","SDiffSpan","getItemStringForDiff","isCustomNode","postprocessValue","rawVal","maybeShallowParse","nestedNode","baseStyle","textDecoration","nestedObj","nestedObjKey","nestedNodeLabel","nestedNodeChildren","nodeType","active","topicInputs","newDiffMethod","noPortal","formatDuration","sqrt","getArrow","filterKeys","parts","pkg","ROS_COMMON_MSGS","atan2","counts","getChangeCounts","startingCounts","possibleLabelTexts","float","GREEN","buildSyntheticArrowMarker","getSyntheticArrowMarkerColor","POSE_MARKER_SCALE","getSceneErrorsByTopic","skipTransform","addError","topicsWithError","topicsMissingTransforms","rootTransformId","frameIds","sourceTopic","$TF","$TF_STATIC","missingTransformMessage","rootTransformID","topicsMissingFrameIds","_err","filterOutSupersededMessages","reversedMessages","MARKER_ARRAY_DATATYPES","earliestMessageToKeepIndex","findIndex","filteredMessages","hasSeenNonLifetimeMessage","parseStringTemplate","str","parameters","match","argument","resetMinZ","_minZ","MAX_SAFE_INTEGER","updateMinZ","topicsWithBadFrameIds","getSelectionState","getTopicsToRender","_hooks","prevSelectionState","selectionState","_markTopicToRender","_updateErrorsByTopic","_addError","_reportBadFrameId","badFrameError","topicMissingError","_consumeMarker","getOccupancyGridValues","mappedMessage","flattenedZHeightPose","originalInfo","originalPosition","collectors","addNonMarker","drawData","sourcePose","_settingsByKey","decayTimeInSec","lifetime","_clock","setClock","_consumeMarkerArray","_consumeOccupancyGrid","pathStamped","newMessage","closed","_consumeNonMarkerMessage","MARKER_MSG_TYPES","LINE_STRIP","polygonStamped","structuralDatatype","_structuralDatatypes","cloud","lastSeenMessages","consumeBobject","consumeMarkerArray","consumeNonMarkerMessage","consumeOccupancyGrid","frame","MessageCollector","flush","topicsByName","_consumeMessage","setStructuralDatatypes","collector","setPlayerId","playerId","_playerId","reportedErrorTopics","setSettingsByKey","setTopics","topicsToFlush","other","setFrame","topicsToRender","setFlattenMarkers","_flatten","setEnabledNamespaces","enabledNamespaces","setSelectedNamespacesByTopic","newNamespaces","previousNamespaces","setHighlightedMatchers","markerMatchers","markerMatchersByTopic","_addTopicsToRenderForMarkerMatchers","_highlightMarkerMatchersByTopic","setColorOverrideMatchers","_colorOverrideMarkerMatchersByTopic","previousMarkerMatchersByTopic","newMarkerMatchers","matchersBefore","hasErrors","setOnForceUpdate","_onForceUpdate","errorsByTopic","_consumeNamespace","allNamespaces","namespaceIsEnabled","setTopicError","deleteMarker","deleteAll","_transformMarkerPose","minZ","parsedPoints","getMarkerColor","iconTextTemplate","matchingMatcher","checks","matchingOverrideColor","OVERLAY_ICON","addMarker","getFlattenedPose","_consumeTopic","getScene","renderMarkers","topicMarkers","getMessages","markerMatches","_addMarkerToCollector","overrideCommand","arrow","cube","sphere","cylinder","LINED_CONVEX_HULL_RENDERING_SETTING","linedConvexHull","lineStrip","lineList","cubeList","triangleList","pointcloud","poseMarker","laserScan","radarPointCluster","filledPolygon","instancedLineList","overlayIcon","addMarkerToCollector","DISTORTION_STATE","binning_x","binning_y","roi","distortion_model","D","K","P","R","_distortionState","adjustBinning","adjustRoi","x_offset","y_offset","unrectifyPoint","rectX","rectY","fx","fy","cx","cy","X","Y","W","xp","yp","r2","r4","r6","a1","k1","k2","barrel_correction","ypp","declarations","lib_filename","filePath","sourceCode","lib_es6_dts","DEPRECATED__ros_lib_filename","DEPRECATED__ros_lib_dts","defaultLibFileName","rosLib","ros_lib_filename","ros_lib_dts","utilityFiles","userUtilities","utility","DEFAULT_WEBVIZ_NODE_PREFIX","DEFAULT_TIME","BaseRenderer","cleared","setSubscriptions","setConfigCameraState","staticTransformPath","calculatedTransforms","Transforms","useTransformedCameraState","onSetSubscriptions","subscriptions","callbackInputsRef","configFollowOrientation","configFollowTf","onFollowChange","getNewCameraStateOnFollowChange","onAlignXYAxis","saveCameraState","newCameraStateObj","saveCameraStateDebounced","debounce","newCurrentCameraState","oldConfig","useImperativeHandle","Renderer","forwardRef","FrameCompatibilityDEPRECATED","DrawingTools","defaultSelectedTab","onSetDrawingTabType","onSetPolygons","polygonBuilder","selectedPolygonEditFormat","setSelectedTab","accent","yaml","safeLoad","safeDump","noCompatMode","_rpc","_bobjectSender","BobjectRpcSender","_currentlySending","maybeOldQueuedSignal","_queuedSendSignal","newSendSignal","framesDiffer","_previousArgs","bobjects","nonFrameData","worldContextValue","contextToSend","renderFn","_bobjectReceiver","BobjectRpcReceiver","_nextArgs","searchTextMatches","frameIndex","frameIsEmpty","highlightedIndicesSet","startingIndex","lowerCaseSearchText","lowerCaseText","range","initialSearchText","onSearchTextChanged","initialSearchTextRef","searchTextOpen","setSearchTextOpen","setSearchText","setSearchTextMatches","selectedMatchIndex","setSelectedMatchIndex","searchInputRef","searchTextWithInlinedVariables","useStringWithInlinedGlobalVariables","updateSearchText","toggleSearchTextOpen","rootTf","currentMatch","hasCurrentMatchChanged","_previousMatch","subtract","iterateCurrentIndex","iterator","newIndex","flexDirection","autoFocus","IconTextTemplateEdit","targetStr","topicNameToShow","xsWidthElem","SName","textTruncateElem","endTextLength","STopicNameDisplay","SDisplayName","STable","STableRow","removeBorder","STableHeader","STableHeaderDropdown","SCell","addBorder","SPrimitiveCell","useRoboto","ROBOTO_MONO","SInnerArray","STableContainer","SNavigation","STableHeaderBorder","SHeaderDropdownItem","SFilterInput","columnId","TableContext","setHideColumn","setExpandColumn","setColumnFilter","setColumnWidth","updateConditionalFormats","ConfigContext","createSelectableContext","useColumnConfigValue","useContextSelector","columnConfigs","useColumnConfigFilterMap","property","columnConfig","hasOwnProperty","memoResolver","useColumnConfigFilterReduce","filterTruthy","DEFAULT_FILTER","comparator","TimeCell","isNestedArray","renderedValue","rosTimeToUrlTime","DEFAULT_ZERO_TIME","isWithinRange","isTimeInRangeInclusive","PrimitiveCell","enumValue","conditionalFormats","getFormattedColor","ComplexCell","disableExpansion","expandColumn","Table","accessorPath","updateConfig","msgDatatype","hiddenColumns","expandedColumns","initialFilters","initialSortBy","columnWidths","getColumnsFromDatatype","parentField","accessor","lastAccessor","getLastAccessor","isComplexType","isComplex","isExpanded","subColumns","columnOptions","Header","column","isResizing","isColumnExpanded","setFilterValueCallback","setFilterValueComparator","newComparator","renderedHeader","isSorted","isSortedDesc","filterValue","whiteSpace","COMPARATOR_LIST","getSortByToggleProps","ConditionaFormatsInput","stripLastAccessor","Cell","innerValue","filterColumn","bind","sortType","sortTimestamps","tableInstance","useTable","initialState","pageSize","filters","useFilters","useSortBy","useResizeColumns","useBlockLayout","usePagination","updateColumnConfig","updateColumnConfigWrapper","desc","primitiveList","getTableProps","getTableBodyProps","headerGroups","page","prepareRow","canPreviousPage","canNextPage","pageOptions","pageCount","gotoPage","nextPage","previousPage","setPageSize","toggleHideColumn","setFilter","allColumns","toggleHideAllColumns","rcToggleHideAllColumns","pageIndex","hidden","toggleAllColumns","ColumnDropdown","headerGroup","getHeaderGroupProps","headers","getHeaderProps","getResizerProps","getRowProps","cells","cell","getCellProps","TablePanel","msgs","cachedMessages","configRef","updater","flexGrow","_topic","splitPath","rowA","rowB","timeA","timeB","COMPARATOR_FUNCTIONS","evaluateCondition","fieldType","_columnIds","columnFilter","isNumberColumn","isBooleanColumn","formattedValue","conditionalFormat","layerIndex","models","arrowMarkers","modelType","shaftWidth","headWidth","pos","transformQuat","tipPoint","scaleAndAdd","tailPoint","Arrows","COLORS","BLACK","PINK","LIME","CYAN","WHITE","AQUA","MAGENTA","YELLOW","DARKGRAY","PURPLE","setRgba","rgba255","defaultMapPalette","tinycolor","toTypedArray","byteOffset","TextureCacheEntry","texture","mipmap","getTexture","store","entry","hitmapColors","offsetsAndReaders","createPositionBuffer","createColorBuffer","POSITIVE_INFINITY","NEGATIVE_INFINITY","hasMinValue","hasMaxValue","setupSendReportNotificationHandler","setupLogEventHandler","setNotificationHandler","details","severity","initializeLogEvent","logEventPerformance","logEventNavigation","logEventError","SAudioPlayer","AudioPlayerBase","TIMESTAMP_OPTIONS","CHANNEL_HOVER_BG","hexToRgbString","RED2","DEFAULT_WAVE_CONFIG","SPEED_SELECT_OPTIONS","SCanvasWrapper","SBarWrapper","STimestampWrapper","SDropdown","SCopyTimestamp","SChannelHover","selectedChannelAlt","globalSeek","globalStartTime","globalEndTime","globalCurrentTime","globalLastSeekTime","globalIsPlaying","lastSeekTime","AudioContext","webkitAudioContext","useCleanup","close","gainNode","createGain","sourceRef","currentPositionRef","startTimeRef","timestampDivRef","showReceiveTimestamp","setShowReceiveTimestamp","isPlayingRef","isPlayingState","setIsPlayingState","channelOptions","buffers","generateAudioBuffersFromSample","activeBuffer","totalSecs","getCurrentTimestamp","timestampIndex","currentMsgTimestamp","updateTimestampText","ratio","currentTimeStamp","timestampDiv","innerHTML","formatTimeRaw","updateCanvas","calculateWaveformData","drawWaveform","timestampOnChange","showReceive","pause","stop","tick","newPosition","gain","setValueAtTime","draggingStart","setDraggingStart","canvasHeight","canvasWidth","CANVAS_MARGIN","useEventListener","deltaPosition","hoveredRatio","globalSeekChanged","totalGlobalSecs","globalPlayedRatio","clickedWidthRatio","clickedHeightRatio","newSelectedChannel","clipboard","copy","chanelOptions","onPlaybackRateChange","newPlaybackRate","onSelectedChannelChange","onTogglePlay","createBufferSource","onended","connect","destination","onToggleShowAllChannels","onVolumeChange","newVolume","speedSelectOptions","downloadTooltip","onDownloadAudio","downloadFiles","bufferToFileBlob","SPlayButton","SSpeedWrapper","rootStyle","STransparentDropdownBtn","button","iconStyle","light60","SliderInput","attrs","SProgressWrapper","BlockLoadingProgressBase","LOADED_COLOR","UNLOADED_COLOR","rectWidth","rangeStartIdx","loadingState","beginPath","hasNewHardwareId","selectedHardwareId","hasNewName","selectedName","collapsedSections","splitFraction","topicToRenderMenu","newTopicToRender","selectedDisplayName","selectedItems","scrollX","onChangeSplitFraction","newSplitFraction","ResizeHandle","divider","KeyValueTable","allowedTags","sanitize","__html","allowedAttributes","td","th","HAS_ANY_HTML","getFormattedKeyValues","keyHtml","valueHtml","DiagnosticStatus","_resizeMouseMove","_resizeMouseUp","_tableRef","formattedKeyVals","inCollapsedSection","ellipsisShown","keyIsSection","valIsSection","sectionObj","section","_onClickSection","colSpan","collapsedSection","valuePath","openPlotPanelIconElem","stateTransitionsIcon","openSiblingStateTransitionsPanel","plotIcon","openSiblingPlotPanel","_renderKeyValueCell","keyCell","valueCell","newSectionsForCurrentName","_getSectionsCollapsedForCurrentName","_getSectionsThatCanBeCollapsed","otherSections","cls","html","dangerouslySetInnerHTML","statusClass","data-test-resizehandle","_resizeMouseDown","borderRight","borderLeft","_toggleSections","_renderKeyValueSections","Lexer","ParserRules","modifier","ParserStart","datasetsAndTooltips","yRanges","xRanges","isReferenceLinePlotPathType","yAxisRanges","xAxisRanges","datasetKey","hasMismatchedData","isCustomScale","rangeIndex","rangesOfTooltips","rangesOfPoints","rangeIdx","xRange","rangeTooltips","rangePoints","outerIdx","xItem","itemPoints","itemTooltips","itemHasMistmatchedData","getPointsAndTooltipsForMessagePathItem","newRangesOfTooltips","newRangesOfPoints","derivative","funcName","mathFunctions","applyToDataOrTooltips","borderColor","getDatasetAndTooltipsFromMessagePlotPath","getXForPoint","innerIdx","maybeBobject","isTime","fixedYAxisWidth","yItem","elapsedTime","queriedPath","valueNum","timeValue","getAnnotations","drawTime","scaleID","borderDash","getAnnotationFromReferenceLine","chartRenderPath","TimeBasedChartTooltip","formatTime","defaultShown","createShaderProgram","positionAttribLocation","getAttribLocation","projUniformLocation","getUniformLocation","paddingUniformLocation","vao","createVertexArray","bindVertexArray","enableVertexAttribArray","vertexAttribPointer","FLOAT","checkErrors","prevBounds","primitiveCount","xStep","yStep","bufferSubData","useProgram","uniformMatrix4fv","drawArrays","LINES","prevData","lineWidth","POINTS","Worker","FakeRpc","proxiedWorker","_transfer","handlers","checkboxStyle","TimeBasedChartLegend","pointSvg","PLOT_DOT_DASHED_STYLE","stroke","strokeWidth","strokeDasharray","PLOT_DASHED_STYLE","_toggleLine","newTooltips","secondsDifference","previousTooltip","dataOrTooltips","numericYValue","acos","asin","atan","cos","log1p","log2","log10","sign","sin","tan","negative","deg2rad","degrees","PI","rad2deg","radians","mps2kph","metersPerSecond","METERS_PER_SECOND_TO_KILOMETERS_PER_HOUR","kph2mps","kmPerHour","mps2mph","METERS_PER_SECOND_TO_MILES_PER_HOUR","mph2mps","milesPerHour","MILES_PER_HOUR_TO_METERS_PER_SECOND","mph2kph","MILES_PER_HOUR_TO_KILOMETERS_PER_HOUR","kph2mph","lastPath","toggleToHideLegend","toggleToShowLegend","legendToggle","itemIconContainer","zIndex","shortXAxisLabel","newXAxisVal","itemInput","itemInputDisabled","newXAxisPath","plotableRosTypes","isReferenceLinePlotPath","hasMismatchedDataLength","itemIcon","itemRemove","addLine","SFlexRow","SButton","isValidInput","xAxisCsvColumnName","custom","currentCustom","getCSVData","headLine","combinedLines","dataIndex","formatData","followWidthItem","isZero","csv","downloadCsvFile","isHeader","LevelClasses","ok","stale","NodeRow","onClickPin","isPinned","nodeRow","data-test-diagnostic-row","pinIcon","pinned","sortByLevel","hardwareFilter","Item","panel","SummaryPanelContents","togglePinned","showDetails","pinnedNodes","nodesByLevel","getDiagnosticsByLevel","sortedNodes","getSortedDiagnostics","AutoSizer","List","rowRenderer","rowProps","renderRow","rowCount","overscanRowCount","SGlobalVariablesPanel","makeFlashAnimation","initialCssProps","highlightCssProps","keyframes","SGlobalVariablesTable","sharedColors","BORDER_LIGHT","SLinkedTopicsSpan","FlashRowAnimation","HIGHLIGHT_MUTED","SAnimatedRow","tr","animate","skipAnimation","isActiveElementEditable","activeEl","isContentEditable","tagName","changeGlobalKey","newKey","oldKey","overwriteGlobalVariables","pick","LinkedGlobalVariableRow","linkedTopicPaths","unlink","varName","unlinkAndDelete","JSONInput","paddingTop","globalVariableNames","linkedGlobalVariablesKeyByName","linked","unlinked","timeoutId","clearTimeout","previousGlobalVariables","usePreviousValue","previousGlobalVariablesRef","changedVariables","setChangedVariables","newChangedVariables","union","timerId","ValidatedResizingInput","invalidInputs","minMaxValidatorFn","stepValidatorFn","SliderSettingsMenu","sliderProps","globalVariableName","updateSliderProps","partial","onChangeVariableName","newGlobalVariableName","onChangeMin","onChangeMax","onChangeStep","GlobalVariableSliderPanel","globalVariableValue","saveSliderProps","updatedConfig","additionalOutput","SliderWithTicks","SSliderContainer","draw","drawTicks","TICK_FONT","getNonOverlappingLabels","measuredLabels","stepLabels","sumBy","tickWidth","futureTime","sliderConfig","steps","fillText","GlobalVariableDropdownPanel","currentVal","onVariableNameChange","clonedGlobalVariables","cloneDeep","allDropdownOptions","RED1","DEFAULT_PANEL_HOOKS","TopicTimestampSpan","SEmptyStateWrapper","DARK","TopicTimestamp","styleObj","BottomBar","containsOpen","imageCanvasStyles","inScreenshotTests","ToggleComponent","dropDownStyles","AddTopic","onSelectTopic","s","NO_CUSTOM_OPTIONS","panelHooks","topicsKeyByTopicName","cameraTopicFullObject","imageTopics","topicsByNamespace","groupTopics","combinedImageMarkerDataTypes","WEBVIZ_ICON_MSGS$WEBVIZ_2D_ICON_ARRAY","defaultAvailableMarkerTopics","getMarkerOptions","availableAndEnabledMarkerTopics","onToggleMarkerName","markerTopic","onChangeCameraTopic","newCameraTopic","newAvailableMarkerTopics","newEnabledMarkerTopics","getRelatedMarkerTopics","onChangeScale","newScale","onToggleSynchronize","imageTopicDropdown","SubMenu","cameraInfoTopic","getCameraInfoTopic","addMessage","shouldSynchronize","imageAndMarkerTopics","imageScale","pendingSynchronizedMessages","getSynchronizingReducers","request","unsynchronizedMessages","oldState","newBobjects","newState","bobject","bobjectFrame","parsedFrame","iconMarkersToRender","nonIconMarkersToRender","combinedMarkers","iconMarkers","nonIconMarkers","renderedMarkerTimestamps","addTopicsMenu","markerDropdown","missingRequiredCameraInfo","closeOnChange","dropdownItem","topicOption","onIconTextChange","imageMessage","lastImageMessageRef","imageMessageToRender","onStartRenderImage","toolbar","controls","showEmptyState","markerTopics","renderEmptyState","image","ContainsOpen","canTransformMarkers","topicTimestamp","textBright","SErrorMessage","ImageCanvasWorker","ImageCanvas","openZoomChart","_canvasRenderer","_instantiateRpc","loadZoomFromConfig","transferableCanvas","_getRpcWorker","_canvasRef","panZoomCanvas","getTransform","updatedPercentage","checkOutOfBounds","bitmapDimensions","moveTo","_divRef","maxZoom","MAX_ZOOM_PERCENTAGE","minZoom","smoothScroll","filterKey","_e","_dx","_dy","_dz","minPercent","fitPercent","goToTargetPercentage","keepInBounds","imageViewportWidth","offsetWidth","imageViewportHeight","offsetHeight","getImageViewport","createPanZoom","applyPanZoom","renderCurrentImage","toBlob","ContextMenu","downloadImage","zoomAbs","moveToCenter","fillPercent","targetPercentage","onFinishImageRender","imageMessageDatatype","zoomChart","data-zoom-menu","menuItem","notInteractive","borderBottom","onZoomMinus","data-panel-minus-zoom","onZoomPlus","data-panel-add-zoom","onZoomFit","onZoomFill","useMainThreadRenderingForTesting","local","remote","createLinkedChannels","ImageCanvasRenderer","_onVisibilityChange","canvasRenderer","prevProps","innerA","innerB","innerKey","_getIconMarkerWrapperStyle","handleWidth","handleHeight","onResize","onCanvasRightClick","_setCanvasRef","onOutsideClick","renderZoomChart","magnify","clickMagnify","data-magnify-icon","clickedObject","setClickedObject","containerRef","unsetClickedObject","onClickObjectDetailsWrapper","SInnerWrapper","outline_color","SIconMarker","containerRect","getUpdatedGlobalVariablesBySelectedObject","colorToRgbaString","ICON_WRAPPER_HEIGHT","iconConfig","idx1","SObjectDetailsWrapper","wordBreak","SGlobalVariableName","_setIsOpen","setName","getInitialName","addLink","highlightIconStyle","onSubmit","primary","clickedObjects","clickedPosition","SInteractionContextMenu","SMenu","interactiveObject","InteractionContextMenuItem","STooltip","PURPLE1","SMenuItem","STopic","SId","YELLOW1","menuText","selectItemObject","Float32Reader","Uint16Reader","Int16Reader","Int32Reader","setUint8","getFloat32","getInt32","getUint16","getInt16","azimuth","azimuthReader","elevationReader","elevation","rangeReader","scaled_range","toRadians","centideg","COMPONENT_COUNT","onCopy","pointsToCsv","clickedPoint","extend","diffArrowStr","diffArrow","splitItemLabel","beforeText","afterText","lengthOverLimit","showingEntireLabel","setShowingEntireLabel","itemLabelToShow","expandText","rootValue","singleSlicePath","multiSlicePath","pivotPath","isObjectElement","isArrayElement","keyPathJoined","part","onClickCopy","dataToCopy","maybeParseValue","dataWithoutLargeArrays","cloneDeepWith","SMetadata","rel","getMessageDocumentationLink","CopyMessageButton","openPlotPanel","pathSuffix","openStateTransitionsPanel","onPivot","MessageWithLifetime","isExpired","expiresAt","isGreaterThan","clock","_addItem","existing","_idToCanvas","renderImage","clearCanvas","markerData","buildMarkerData","hasLoggedCameraModelError","rawData","encoding","ImageData","decodeYUV","decodeRGB8","decodeBGR8","decodeFloat1c","decodeBayerRGGB8","decodeBayerBGGR8","decodeBayerGBRG8","decodeBayerGRBG8","decodeMono8","decodeMono16","notSharedData","crossOriginIsolated","SharedArrayBuffer","createImageBitmap","decodeMessageToBitmap","resizeCanvas","drawImage","save","paintMarker","paintMarkers","paintBitmap","maybeUnrectifyPoint","arc","strokeStyle","lineTo","maybeUnrectifiedPoint","closePath","outline_colors","fill_color","textBaseline","filled","metrics","makeSpecializedDecodeBayer","tl","bl","br","Function","yuv","u","inIdx","outIdx","bgr","gray","mono8","ch","mono16","hide","Tooltip","getSubscriptionGroup","requester","getPublisherGroup","advertiser","publishers","groupedSubscriptions","subscriptionGroups","grouped","renderedSubscriptions","sub","originalTopic","inputTopics","inputTopic","renderedPublishers","groupedPublishers","recordGroup","setRecordGroup","recordingTopics","setRecordingTopics","recordedData","historyRecorder","isPrimary","recordSubs","downloadTextFile","lazy","skeletonBody","UnsavedDot","isSaved","NodePlaygroundSettings","autoFormatOnSave","vimMode","SWelcomeScreen","WelcomeScreen","addNewNode","updateExplorer","selectedNodeId","editorForStorybook","explorer","bottomBarSplitPercent","setBottomBarSplitPercent","bottomBarOpen","toggleBottomBarOpen","userNodes","userNodeDiagnostics","setUserNodes","payload","selectedNodeDiagnostics","diagnostics","selectedNode","scriptBackStack","setScriptBackStack","currentScript","isCurrentScriptSelectedNode","isNodeSaved","selectedNodeLogs","logs","inputTitle","readOnly","testItems","additionalBackStackItems","newNodeId","saveNode","script","setScriptOverride","maxDepth","goBack","setScriptCode","backStack","selectNode","nodeId","deleteNode","large","newNodeName","splitPercent","data-nativeundoredo","Suspense","fallback","resizeKey","minHeight","getDraggingCursor","SSide","SDraggableBorder","dragging","convertPercentToAbsolute","valueRaw","containerSize","valueAsStr","defaultSplitPercent","resizingCursor","positionPropName","sizePropName","minStyleName","maxStyleName","setDragging","setContainerRef","splitPercentInternal","setSplitPercent","splitPercentToUse","childrenStyles","isValidElement","setContainerRefCallback","getConstrainedMinMax","absoluteStyles","minVal","maxVal","stylesByChildType","constrainedMin","constrainedMax","constrainedSplit","dragStart","dragStop","drag","newSplit","SHeaderItem","HeaderItem","numItems","paddingBottom","bottomBarDisplay","setBottomBarDisplay","autoScroll","setAutoScroll","clearLogs","clearUserNodeLogs","scrollContainer","scrolledUp","overflowY","severityColors","Hint","YELLOWL1","Info","BLUEL1","Warning","ORANGEL1","REDL1","severityIcons","startColumn","startLineNumber","severityLabel","invert","DiagnosticSeverity","errorLoc","valueColorMap","number","base09","boolean","base08","renderTreeObj","_extends","prototype","call","_ref","_objectWithoutProperties","viewBox","xmlns","strokeLinecap","strokeLinejoin","MenuWrapper","ExplorerWrapper","GRAY2","ListItem","TemplateItem","SFlex","NodesList","collapse","SidebarTitle","getNodeProjectConfig","textTransform","otherMarkdownDocsForTest","nodesSelected","docsSelected","utilsSelected","templatesSelected","gotoUtils","monacoApi","monacoFilePath","Uri","requestedModel","getModel","uri","getValue","selection","explorers","docs","linkTarget","nodePlaygroundDocs","userUtilsReadMe","utils","templates","template","lib_es2015_symbol_dts","lodash","pointClouds","types","vectors","twoDimensionalPlot","markerArray","STextArea","onChangeText","noteText","panelRenderCount","messageHistoryRenderCount","messagePipelineRenderCount","useMessageReducerRenderCount","getNumberOfRendersCountsForTests","getRenderCountMessage","renderCount","HooksComponent","MessagePipelineRendersComponent","textAlign","PlaybackPerformanceItem","Sparkline","maximum","timeRange","decimalPlaces","UnconnectedPlaybackPerformance","playbackInfo","lastPlaybackInfo","perfPoints","framerate","bagTimeMs","megabitsPerSecond","renderTimeMs","totalBytesReceived","shift","now","nowStamp","STextAreaContainer","SErrorText","getTopicName","cachedProps","datatypeNames","parsedObject","_publisher","publish","parsedAny","parseInput","changed","sampleMessage","stringifiedSampleMessage","_renderMenuContent","advancedView","buttonText","buttonTooltip","buttonColor","canPublish","PlayerCapabilities","advertise","buttonRowStyle","_onChangeTopic","_onSelectTopic","_onSelectDatatype","_publish","buildSampleMessage","builtin","builtinSampleValues","Publisher","_getContext","_context","_setPublishers","setPublishers","MessagePipelineConsumer","Creatable","LOG_LEVEL_OPTIONS","KNOWN_LOG_LEVELS","stringsToOptions","strs","getShouldDisplayMsg","minLogLevel","searchTerms","logMessage","searchTermsInLowerCase","term","lowerCaseName","lowerCaseMsg","RosoutPanel","selectedOptions","seenNodeNames","nodeNameOptions","filtersBar","severityFilter","clearable","searchable","optionHeight","optionRenderer","styleProp","focusedOption","logStyle","VirtualizedSelectFocusedOption","_onLogLevelChange","valueComponent","nodeFilter","multi","closeOnSelect","_onNodeFilterChange","selectComponent","promptTextCreator","itemsCountField","_getFilteredMessages","_filterFn","_renderRow","$ROSOUT","_renderFiltersBar","PadStart","padStart","Stamp","altStr","file","strLevel","levelClassName","toLocaleLowerCase","listId","cache","CellMeasurerCache","fixedWidth","lastWidth","lastItems","lastRenderTime","clearAll","containerEl","getElementById","newAutoScroll","onResetView","deferredMeasurementCache","CellMeasurer","rowIndex","containerProps","scrollToIndex","SHeader","STitle","pausePlayback","numMessages","DateWrapper","TimestampWrapper","RosTimeWrapper","TimeWrapper","ROSText","textNormal","getValidTime","timeStr","isRosTime","validTime","parseRosTimeStr","parseTimeStr","clampTime","timezone","rosTimeStr","setRosTimeStr","currentTimeStr","setTimeStr","isEditingRosTime","setIsEditingRosTime","isEditingTime","setIsEditingTime","date","formatDate","rawTime","onSeekTime","onTimeChange","onTimeTextClick","copyText","SCopyTextWrapper","messagesSeen","seenBefore","SPanelCover","mosaicId","savePanelConfigsFn","activeTab","activeLayout","draggingTabState","setDraggingTabState","isOver","selectTab","setTabTitle","newTabs","removeTab","lastIdx","addTab","newTab","onChangeLayout","draggingTab","TabbedToolbar","UnconnectedPanelLayout","importHooks","setMosaicId","removeRootDropTarget","EmptyDropTarget","DEFAULT_TAB_PANEL_CONFIG","dropRef","useDrop","accept","TAB_DRAG_TYPE","collect","monitor","getItem","canDrop","drop","sourceItem","didDrop","moveTab","STabbedToolbar","showHiddenControlsOnHover","STabs","DraggableToolbarTab","tabCount","tabTitle","isDragging","dragRef","useDrag","_monitor","tabProps","innerRef","ToolbarTab","setTitle","editingTitle","setEditingTitle","onChangeTitleInput","onClickTab","inputEl","endTitleEditing","confirmNewTitle","resetTitle","STab","readonly","editable","clearBgStyle","boxShadow","VALID_TYPES","keysToPick","messagePathInputStyle","isValidMinMaxVal","HoverBar","mousePosition","wrapper","showBar","hideBar","TwoDimensionalTooltip","datapoints","xAxisLabel","datapoint","MenuContent","pointRadiusOverride","minXVal","maxXVal","minYVal","maxYVal","updateMousePosition","yAxisLabel","gridColor","l","lineTension","order","allXs","allYs","getBufferedMinMax","allVals","scaleLabel","labelString","pan","bottomPx","tooltipDatapoints","dataPoints","_datapoint","currentTooltip","emptyMessage","ChildComponent","baseTopics","FrameCompatibilityComponent","forwardedRef","childProps","componentSetSubscriptions","newTopics","lastClearTime","useFrame","flattenMarkers","showCrosshair","savedSearchText","getSaveConfig","setDebug","setPolygonBuilder","PolygonBuilder","measureInfo","setMeasureInfo","currentEditingTopic","editingNamespace","setAvailableNamespacesByTopic","setSceneErrorsByTopicKey","updateWorkerAvailableNamespacesByTopic","newAvailableNamespacesByTopic","oldAvailableNamespacesByTopic","updateWorkerErrorsByTopic","newErrorsByTopic","oldErrorsByTopic","searchTextProps","useSearchText","newSearchText","SearchCameraHandler","focusOnSearch","updateSearchTextMatches","newSearchMatches","oldSearchMatches","forcedUpdate","useReducer","measuringElRef","drawingTabType","setDrawingTabType","setSelectionState","DEFAULT_SELECTION_STATE","hoveredMarkerMatchers","setHoveredMarkerMatchersDebounced","useDebouncedCallback","isDrawing","POLYGON_TAB_TYPE","useStructuralDatatypes","supportedMarkerDatatypesSet","blacklistTopicsSet","startupPerPanelHooks","getDefaultTopicTree","getStaticallyAvailableNamespacesByTopic","getDefaultSettings","memoizedTopics","topicTreeData","highlightMarkerMatchers","colorOverrideMarkerMatchers","linkedGlobalVariablesByName","_activeColorOverrideMatchers","override","baseTopic","selectedTopics","topicsByTopicName","handleDrawPolygons","eventName","_colorOverrideBySourceIdxByVariable","handleEvent","currentDrawingTabType","currentHandleDrawPolygons","measuringHandler","updateGlobalVariablesFromSelection","newSelectedObject","updateInteractionsTabVisibility","OBJECT_TAB_TYPE","storyEvents","useStoryEventsContext","onControlsOverlayClick","onExitTopicTreeFocus","toggleCameraMode","toggleDebug","newClickedObjects","newClickedPosition","iconMarker","contains","currentCameraState","currentSaveConfig","newPerspective","reset","worldRef","shown","ctrlKey","cursorType","isHidden","DemoModeComponent","getDemoModeComponent","threeDimensionalVizContextValue","stillMounted","frameIndexRef","resumeFrames","workerDataSender","LayoutWorkerDataSender","setInitialized","setViewport","updateViewport","newViewport","oldViewport","renderFrame","setCanvasRef","ready","catch","mouseEventHandlers","sendMouseEvent","HTMLElement","clientTop","sendMouseUp","sendMouseDown","sendMouseMove","sendDoubleClick","cameraListener","VIDEO_RECORDING_STYLE","RenderToBodyPortal","onRequestClose","contentStyle","ColorPickerSettingsPanel","world","onToggleCameraMode","onToggleDebug","InteractionContextMenu","inVideoRecordingMode","debugStats","stats","bufferCount","elementsCount","textureCount","shaderCount","totalTextureSize","totalBufferSize","textureSize","bufferSize","setDebugStats","updateDebugStats","newStats","oldStats","polygonPoints","setPolygonPoints","polygonsToPoints","onChangePolygonPoints","newPolygonPoints","pointsToPolygons","clearPolygons","copyPolygons","getFormattedString","selectedFormat","polygonPointsValidator","getPolygonLineDistances","pointsPerPolygon","pointsToJson","pointsToYaml","polyPoints","additionalToolbarItemsElem","cartographer","tfToFollow","measuringTool","measureDistance","edit","setEdit","onEditToggle","camPos2DTrimmed","ZERO_VEC3","num","UncontrolledValidatedInput","cameraStateValidator","CameraStateInfo","textMuted","paddingLeft","newPos","newTargetOffset","point2DValidator","treeNodeToTfId","buildTfTree","roots","setDepth","getDescendants","padEnd","defaultFollowTfFrame","forceShowFrameList","setForceShowFrameList","hovering","setHovering","lastSelectedFrame","setLastSelectedFrame","tfTree","allNodes","nodesWithoutDefaultFollowTfFrame","newFollowTfFrame","getDefaultFollowTransformFrame","getFollowButtonTooltip","onClickFollowButton","onSelectFrame","autocompleteNode","openFrameList","onMouseLeaveDebounced","cancel","followingCustomFrame","showFrameList","selectedFrameId","cameraModeTip","toggleMeasureState","SYNC_OPTIONS","bag1ToBag2","bag2ToBag1","swapBag1AndBag2","bag2KeyToBag1Key","bag2Key","bag1KeyToBag2Key","bag1Key","partitionKeys","groupKeys","bag1","bag2","topicKeys","namespaceKeys","syncBags","syncOption","bag1CheckedKeys","bag2CheckedKeys","settingKeys","topicKeys1","namespaceKeys1","bag1SettingKeys","bag2SettingKeys","StoryEventsContext","DEFAULT_DELAY_AFTER_WAIT","waitFor3dPanelEvent","delayMs","worldEvents","decorators","StoryType","storyCompleted","screenshot","waitFor","use3dPanelEvent","STopicSettingsEditor","h3","SDatatype","SEditorWrapper","STabWrapper","MainEditor","defaultSettingsByColumn","settingsByColumn","defaultTopicSettingsByColumn","getDefaultTopicSettingsByColumn","newSettingsByColumn","getSettingsByColumnWithDefaults","topicSettingsKey","nonPrefixedTopic","useArbitraryTopicMessage","editorElem","activeKey","newEditingTopicName","TabPane","CommonPointSettings","CommonDecaySettings","SValueRangeInput","SegmentedControlWrapper","RainbowText","onColorModeChange","maybeBobjectFields","hasRGB","defaultColorField","selectedId","newColorMode","hexMinColor","hexMaxColor","drawGradient","gradient","createLinearGradient","addColorStop","SPickerWrapper","SLine","COLOR_PICKER_SIZE","GRADIENT_BAR_INSET","GRADIENT_BAR_HEIGHT","LIGHT2","renderRightIcon","rightIcon","SEmpty","renderOpen","mappedChildren","cloneElement","box","settingsByCarType","currentShaftWidth","currentHeadWidth","currentHeadLength","badModelTypeSetting","SDiffModeWrapper","isChecked","SDiffModeIcon","DiffModeIconEnabled","xlinkHref","SSwitch","rx","ry","topicNodeAvailable","ICON_SIZE","maxNodeNameLen","INNER_LEFT_MARGIN","commonRowProps","NamespaceNodeRow","prevIsOpen","colorPickerWrapperStyle","COLOR_PICKER_AND_ICON_WIDTH","DISABLED_STYLE","SItemContent","namespaceColor","SColorPickerWrapper","SColorTrigger","overrideColorChangedIconStyle","STextHighlight","autoEscape","highlightClassName","searchWords","textToHighlight","testShowTooltip","startTextLen","startText","endText","elem","STextMiddleTruncate","SStart","SEnd","linkedGlobalVariablesByVariableName","StyleExpressionNode","editingColorForSourceIdx","setEditingColorForSourceIdx","colorOverridesByColumnIdx","defaults","getDefaultColorOverrideBySourceIdx","activeRowActive","colorOverride","onToggleMenu","updateSettingsForGlobalVariable","sourceIdx","updatedSettings","tooltipContent","ColorPickerOverlay","onChangeColor","GlobalVariableStylesRow","overrides","linkedGlobalVariablesForRow","SColorPicker","defaultColorIndex","hexToColorObj","spin","_active","_color","STopicTreeSwitcher","SErrorsBadge","getDatatypesFromContext","getStructuralDatatypes","pointsField","pointDatatype","isRadarPointCloud","cloudField","isWrappedPointCloud","NO_HOOK_TRANSFORMS","getTransformElementBlock","tfMessages","framesToIgnore","transformsByFrameId","tfMessage","childFrameId","child_frame_id","findNearestTransformElementInBlocks","frameBlocks","timeSecs","makeTransformElement","candidateNearestTransforms","firstBlockAfterIndex","sortedLastIndexBy","blockBefore","firstMessageAfterIndex","minBy","findNearestTransformInBlocks","useDynamicTransformsNear","blockFrameIndex","topicBlock","processedBlock","getBlockFrameIndex","hookStaticTransforms","hookDynamicTransforms","dynamicTransforms","requestedTopics","nonPreloadedBlocks","translation","rotation","RemoveButton","SConditionalFormatInput","ColumnCheckbox","ConditionalFormatInput","removeConditionalFormat","setConditionalFormat","colorPickerRef","getCalendarContainer","addConditionalFormat","updatedConditionalFormat","conditionalFormatId","consumeMethods","MapComponent","renderAdditionalMarkers","LaserScanVert","getMapPalette","useWorldspacePointSize","allSupportedMarkers","PoseMarkers","GLTFScene","loadCarModel","carModelURL","samplers","LINEAR","postMessage","onmessage","setupWorker","setupLayoutRenderer","remoteRpc","ReactWorldInterface","onMouseEvent","handleOffscreenMouseEvent","isPropagationStopped","registerCallbacks","WorldRenderer","setAvailableNsAndErrors","sceneBuilder","transformsBuilder","SceneBuilder","TransformsBuilder","setTransforms","setCurrentTime","setSelectedTransforms","mapElement","memoizedScene","metadataTopicNamespaces","$METADATA","onMapTileError","scene","useMapElement","markerProviders","DrawPolygons","LayoutWorker","renderSignal","_renderSignals","queuedSignal","rendererCallbacks","hasChangedPlayerId","_hasOffscreenCanvas","clientWidth","resolveRenderSignal","inputArgs","normalizeMouseEventObject","availableTfs","iconDrawables","callbacks","_mouseEventHandler","LayoutWorkerDataReceiver","getTotalTextureSize","getTotalBufferSize","useDebugStats","newAvailableTfs","availableTfsRef","tfsNotYetAdded","mapKeys","sceneErrorsByKeyMemo","originPosition","originOrientation","defaultArrowMarker","defaultArrowScale","unitXVector","fromValues","originAxes","unitVector","tempOrientation","getAxesArrowMarkers","axis","axisId","rotationTo","getTransformedAxisArrowMarker","getAxisTextMarker","textPose","TEXT_VIEW_FACING","tempTranslation","throwawayQuat","getArrowToParentMarkers","childPose","parentPose","addMarkersForTransform","markersForTransform","RenderSignalResolver","getResolveRenderSignal","resolveLatestSignal","onDirty","WrappedWorldMarkers","withDiffMode","WorldMarkers","markersByType","glText","o","provider","getMarkers","processedMarkersByType","TextHighlighter","highlightText","OffscreenWorldview","hideDebug","preserveDrawingBuffer","LAYER_INDEX_DEFAULT_BASE","clearCachedMarkers","crosshairPoint","crosshair","extraThickness","defaultSphere","lineSize","defaultPose","endPoint","BASE_COLOR","SOURCE_1_COLOR","SOURCE_2_COLOR","BASE_COLOR_RGBA","SOURCE_1_COLOR_RGBA","SOURCE_2_COLOR_RGBA","getDiffBySource","elems","source1","source2","BaseWorldMarkers","markersByRenderPass","LAYER_INDEX_DIFF_MODE_BASE_PER_PASS","getHighlightedIndices","_throttledSetSearchTextMatches","numMatches","highlightedIndices","highlightColor","matches","WorldMarkersWithHighlights","hasHighlightedMarkers","highlightedMarkersByType","nonHighlightedMarkersByType","highlightedMarkers","nonHighlightedMarkers","LAYER_INDEX_HIGHLIGHT_OVERLAY","overwriteDepthBuffer","LAYER_INDEX_HIGHLIGHT_BASE","makeReglCommand","additionalMarkers","glTextAtlasInfo","setGlTextAtlasInfo","glTextAtlas","mounted","glTextAtlasPromise","groupedLines","groupLinesIntoInstancedLineLists","OccupancyGrids","LAYER_INDEX_OCCUPANCY_GRIDS","PointClouds","Points","Cubes","LaserScans","laserScanVert","GLText","LAYER_INDEX_TEXT","ALPHABET","scaleInvariantFontSize","FilledPolygons","LinedConvexHulls","RadarPointClusters","fromCodePoint","errorMessage","textureDataResponse","glTextAtlasUrl","expectedSize","resultMarkers","groups","INFINITE_POSITION","INFINITE_COLOR","CLEAR","INFINITE_POSE","INFINITE_METADATA","messageList","toPairs","baseMessage","isLineStrip","allPoints","messageIdx","fillExtend","lineListPoints","validateLineList","lineListColors","posesPerInstance","INSTANCED_LINE_LIST","arr1","arr2","getLaserScan","isCircle","angle_min","angle_increment","range_min","range_max","ranges","intensity","intensities","getOccupancyGrids","TextureCache","paletteTextures","palette","positionBufferCache","VertexBufferCache","colorBufferCache","getCachedBuffer","vertexBuffer","memoized","pointCloudCommand","minGradientColor","maxGradientColor","minColorFieldValue","maxColorFieldValue","onPreRender","onPostRender","makePointCloudCommand","markerCache","updateMarkerCache","decodedMarkers","decodeMarker","decoded","instancedGetChildrenForHitmap","_previous","_current","_deleteBuffer","cached","getTriangleChildrenForHitmap","onlyRenderInHitmap","faceIndices","trianglePoints","index1","index2","index3","convertedColor","propsWithColors","mapMarker","channel","minPoint","maxPoint","azimuths","elevations","azimuth_angle_0","elevation_angle","fraction","radarPointClusterCommand","mapped","assignNextIds","WorldContext","NO_CONTEXT","hostConfig","getRootHostContext","getChildHostContext","getPublicInstance","createInstance","appendInitialChild","finalizeInitialChildren","prepareUpdate","shouldSetTextContent","createTextInstance","scheduleTimeout","cancelTimeout","noTimeout","prepareForCommit","resetAfterCommit","isPrimaryRenderer","warnsIfNotActing","supportsMutation","supportsPersistence","commitMount","commitUpdate","commitTextUpdate","appendChildToContainer","insertBefore","insertInContainerBefore","removeChildFromContainer","clearContainer","hideInstance","hideTextInstance","unhideInstance","unhideTextInstance","resetTextContent","reconcilerInstance","parentObject","createContainer","updateContainer","dataItems","parseUrdf","urdf","joints","DOMParser","parseFromString","getElementsByTagName","joint","getAttribute","originNode","xyz","rpy","roll","pitch","quaternionFromRpy","arbitraryTopicMessage","quaternionFromEuler","c1","c2","c3","s1","s2","s3","experimentalFeatures","useAllExperimentalFeatures"],"mappings":"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","file":"hooks_bundle.js","sourcesContent":["/* eslint-disable header/header */\n\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport memoize from \"lodash/memoize\";\n\nimport { getGlobalHooks } from \"./loadWebviz\";\n\n/*\nWe've split this code out seperately from the rest of the hooks so that we can lazy load these components by\nlazily importing this file at runtime.\n*/\n\nexport function panelsByCategory() {\n  const Audio = require(\"webviz-core/src/panels/Audio\").default;\n  const DiagnosticStatusPanel = require(\"webviz-core/src/panels/diagnostics/DiagnosticStatusPanel\").default;\n  const DiagnosticSummary = require(\"webviz-core/src/panels/diagnostics/DiagnosticSummary\").default;\n  const GlobalVariables = require(\"webviz-core/src/panels/GlobalVariables\").default;\n  const GlobalVariableSlider = require(\"webviz-core/src/panels/GlobalVariableSlider\").default;\n  const GlobalVariableDropdown = require(\"webviz-core/src/panels/GlobalVariableDropdown\").default;\n  const ImageViewPanel = require(\"webviz-core/src/panels/ImageView\").default;\n  const Internals = require(\"webviz-core/src/panels/Internals\").default;\n  const NodePlayground = require(\"webviz-core/src/panels/NodePlayground\").default;\n  const Note = require(\"webviz-core/src/panels/Note\").default;\n  const NumberOfRenders = require(\"webviz-core/src/panels/NumberOfRenders\").default;\n  const PlaybackPerformance = require(\"webviz-core/src/panels/PlaybackPerformance\").default;\n  const Plot = require(\"webviz-core/src/panels/Plot\").default;\n  const Publish = require(\"webviz-core/src/panels/Publish\").default;\n  const RawMessages = require(\"webviz-core/src/panels/RawMessages\").default;\n  const Rosout = require(\"webviz-core/src/panels/Rosout\").default;\n  const SourceInfo = require(\"webviz-core/src/panels/SourceInfo\").default;\n  const StateTransitions = require(\"webviz-core/src/panels/StateTransitions\").default;\n  const SubscribeToList = require(\"webviz-core/src/panels/SubscribeToList\").default;\n  const Tab = require(\"webviz-core/src/panels/Tab\").default;\n  const TwoDimensionalPlot = require(\"webviz-core/src/panels/TwoDimensionalPlot\").default;\n  const ThreeDimensionalViz = require(\"webviz-core/src/panels/ThreeDimensionalViz\").default;\n  const { ndash } = require(\"webviz-core/src/util/entities\");\n  const Table = require(\"webviz-core/src/panels/Table\").default;\n\n  const ros = [\n    { title: \"2D Plot\", component: TwoDimensionalPlot },\n    { title: \"3D\", component: ThreeDimensionalViz },\n    { title: \"Audio\", component: Audio },\n    { title: `Diagnostics ${ndash} Summary`, component: DiagnosticSummary },\n    { title: `Diagnostics ${ndash} Detail`, component: DiagnosticStatusPanel },\n    { title: \"Image\", component: ImageViewPanel },\n    { title: \"Plot\", component: Plot },\n    { title: \"Publish\", component: Publish },\n    { title: \"Raw Messages\", component: RawMessages },\n    { title: \"rosout\", component: Rosout },\n    { title: \"State Transitions\", component: StateTransitions },\n    { title: \"Table\", component: Table },\n  ];\n\n  const utilities = [\n    { title: \"Global Variables\", component: GlobalVariables },\n    { title: \"Global Variable Slider\", component: GlobalVariableSlider },\n    { title: \"Global Variable Dropdown\", component: GlobalVariableDropdown },\n    { title: \"Node Playground\", component: NodePlayground },\n    { title: \"Notes\", component: Note },\n    { title: \"Tab\", component: Tab },\n    { title: \"Webviz Internals\", component: Internals },\n    { title: \"Data Source Info\", component: SourceInfo },\n  ];\n\n  const debugging = [\n    { title: \"Number of Renders\", component: NumberOfRenders },\n    { title: \"Playback Performance\", component: PlaybackPerformance },\n    { title: \"Subscribe to List\", component: SubscribeToList },\n  ];\n\n  return { ros, utilities, debugging };\n}\n\nexport function perPanelHooks() {\n  const BlurIcon = require(\"@mdi/svg/svg/blur.svg\").default;\n  const GridIcon = require(\"@mdi/svg/svg/grid.svg\").default;\n  const ChartIcon = require(\"@mdi/svg/svg/chart-line-variant.svg\").default;\n  const HexagonIcon = require(\"@mdi/svg/svg/hexagon.svg\").default;\n  const HexagonMultipleIcon = require(\"@mdi/svg/svg/hexagon-multiple.svg\").default;\n  const PentagonOutlineIcon = require(\"@mdi/svg/svg/pentagon-outline.svg\").default;\n  const RadarIcon = require(\"@mdi/svg/svg/radar.svg\").default;\n  const RobotIcon = require(\"@mdi/svg/svg/robot.svg\").default;\n  const {\n    GEOMETRY_MSGS$POLYGON_STAMPED,\n    NAV_MSGS$OCCUPANCY_GRID,\n    NAV_MSGS$PATH,\n    SENSOR_MSGS$POINT_CLOUD_2,\n    GEOMETRY_MSGS$POSE_STAMPED,\n    SENSOR_MSGS$LASER_SCAN,\n    TF2_MSGS$TF_MESSAGE,\n    VISUALIZATION_MSGS$MARKER,\n    VISUALIZATION_MSGS$MARKER_ARRAY,\n    VISUALIZATION_MSGS$WEBVIZ_MARKER,\n    VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY,\n    WEBVIZ_ICON_MSGS$WEBVIZ_3D_ICON_ARRAY,\n    $DIAGNOSTICS,\n    RADAR_POINT_CLOUD,\n    WRAPPED_POINT_CLOUD,\n  } = require(\"webviz-core/src/util/globalConstants\");\n\n  const sceneBuilderHooks = require(\"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/defaultHooks\").default;\n  const supportsOffscreenCanvas = require(\"webviz-core/src/util/supportsOffscreenCanvas\").default;\n  const initLayoutNonWorker = require(\"webviz-core/src/panels/ThreeDimensionalViz/Layout/LayoutWorker\").default;\n  const useStaticTransformsData = require(\"webviz-core/src/panels/ThreeDimensionalViz/Transforms/useStaticTransformsData\")\n    .default;\n\n  const SUPPORTED_MARKER_DATATYPES = {\n    // generally supported datatypes\n    VISUALIZATION_MSGS$MARKER,\n    VISUALIZATION_MSGS$MARKER_ARRAY,\n    VISUALIZATION_MSGS$WEBVIZ_MARKER,\n    VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY,\n    WEBVIZ_ICON_MSGS$WEBVIZ_3D_ICON_ARRAY,\n    GEOMETRY_MSGS$POSE_STAMPED,\n    SENSOR_MSGS$POINT_CLOUD_2,\n    SENSOR_MSGS$LASER_SCAN,\n    NAV_MSGS$PATH,\n    NAV_MSGS$OCCUPANCY_GRID,\n    GEOMETRY_MSGS$POLYGON_STAMPED,\n    TF2_MSGS$TF_MESSAGE,\n  };\n\n  return {\n    Audio: { defaultTopic: null },\n    DiagnosticSummary: {\n      defaultConfig: {\n        pinnedIds: [],\n        hardwareIdFilter: \"\",\n        topicToRender: $DIAGNOSTICS,\n      },\n    },\n    ImageView: {\n      defaultConfig: {\n        cameraTopic: \"\",\n        enabledMarkerTopics: [],\n        customMarkerTopicOptions: [],\n        scale: 0.2,\n        transformMarkers: false,\n        synchronize: false,\n        mode: \"fit\",\n        zoomPercentage: 100,\n        offset: [0, 0],\n      },\n      imageMarkerDatatypes: [\"visualization_msgs/ImageMarker\", \"webviz_msgs/ImageMarkerArray\"],\n      canTransformMarkersByTopic: (topic) => !topic.includes(\"rect\"),\n    },\n    GlobalVariableSlider: {\n      getVariableSpecificOutput: () => null,\n    },\n    StateTransitions: { defaultConfig: { paths: [] }, customStateTransitionColors: {} },\n    ThreeDimensionalViz: {\n      defaultConfig: {\n        checkedKeys: [\"name:Topics\"],\n        expandedKeys: [\"name:Topics\"],\n        followTf: null,\n        cameraState: {},\n        modifiedNamespaceTopics: [],\n        pinTopics: false,\n        settingsByKey: {},\n        autoSyncCameraState: false,\n        autoTextBackgroundColor: true,\n      },\n      topicSettingsEditors: {},\n      SUPPORTED_MARKER_DATATYPES,\n      BLACKLIST_TOPICS: [],\n      additionalSubscriptions: [],\n      iconsByDatatype: {\n        // Named datatypes\n        [VISUALIZATION_MSGS$MARKER]: HexagonIcon,\n        [VISUALIZATION_MSGS$MARKER_ARRAY]: HexagonMultipleIcon,\n        [NAV_MSGS$OCCUPANCY_GRID]: GridIcon,\n        [NAV_MSGS$PATH]: ChartIcon,\n        [SENSOR_MSGS$LASER_SCAN]: RadarIcon,\n        [GEOMETRY_MSGS$POLYGON_STAMPED]: PentagonOutlineIcon,\n        [SENSOR_MSGS$POINT_CLOUD_2]: BlurIcon,\n        [GEOMETRY_MSGS$POSE_STAMPED]: RobotIcon,\n        [VISUALIZATION_MSGS$WEBVIZ_MARKER]: HexagonIcon,\n        [VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY]: HexagonMultipleIcon,\n        // Structural datatypes\n        [RADAR_POINT_CLOUD]: BlurIcon,\n        [WRAPPED_POINT_CLOUD]: BlurIcon,\n      },\n      // TODO(Audrey): remove icons config after topic group release\n      icons: {},\n      AdditionalToolbarItems: () => null,\n      // TODO(useWorkerIn3DPanel): Remove sceneBuilderHooks when flag is deleted.\n      sceneBuilderHooks,\n      useWorldContextValue: require(\"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/useWorldContextValue\")\n        .default,\n      getLayoutWorker: () => {\n        if (supportsOffscreenCanvas()) {\n          const WorkerType = require(\"webviz-core/src/panels/ThreeDimensionalViz/Layout/Layout.worker\");\n          return new WorkerType();\n        }\n        return initLayoutNonWorker(sceneBuilderHooks);\n      },\n      // Duplicated in sceneBuilderHooks\n      skipTransformFrame: null,\n      useDynamicTransformsData: () => null,\n      useStaticTransformsData,\n\n      ungroupedNodesCategory: \"Topics\",\n      rootTransformFrame: \"map\",\n      defaultFollowTransformFrame: null,\n    },\n    RawMessages: { docLinkFunction: (filename) => `https://www.google.com/search?q=${filename}` },\n  };\n}\n\n// Helper function to bypass lazy fetch when running tests\nexport function testSetup() {\n  const hooks = getGlobalHooks();\n  hooks.panelsByCategory = memoize(() => {\n    return panelsByCategory();\n  });\n  hooks.perPanelHooks = memoize(() => {\n    return perPanelHooks();\n  });\n  hooks.areHooksImported = () => true;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nclass BoundingBox {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n  width: number;\n  height: number;\n\n  constructor(left: number, top: number) {\n    this.left = left;\n    this.top = top;\n    this.right = -left;\n    this.bottom = -top;\n    this.width = Math.abs(left) * 2;\n    this.height = Math.abs(top) * 2;\n  }\n}\n\nexport default function getOrthographicBounds(zDistance: number, width: number, height: number): BoundingBox {\n  const aspect = width / height;\n  // never go below ground level\n  const distanceToGround = Math.abs(zDistance);\n  const left = (-distanceToGround / 2) * aspect;\n  const top = distanceToGround / 2;\n  return new BoundingBox(left, top);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// Copied from Jam3/camera-project\n// in order to replace gl-vec4 dependency with gl-matrix\n\nimport { vec4 } from \"gl-matrix\";\n\nimport type { Vec3, Vec4, Mat4 } from \"../types\";\n\nconst NEAR_RANGE = 0;\nconst FAR_RANGE = 1;\nconst tmp4 = [0, 0, 0, 0];\n\nexport default function cameraProject(out: any, vec: Vec3, viewport: Vec4, combinedProjView: Mat4): Vec4 {\n  const vX = viewport[0],\n    vY = viewport[1],\n    vWidth = viewport[2],\n    vHeight = viewport[3],\n    n = NEAR_RANGE,\n    f = FAR_RANGE;\n\n  // convert: clip space -> NDC -> window coords\n  // implicit 1.0 for w component\n  vec4.set(tmp4, vec[0], vec[1], vec[2], 1.0);\n\n  // transform into clip space\n  vec4.transformMat4(tmp4, tmp4, combinedProjView);\n\n  // now transform into NDC\n  const w = tmp4[3];\n  if (w !== 0) {\n    // how to handle infinity here?\n    tmp4[0] = tmp4[0] / w;\n    tmp4[1] = tmp4[1] / w;\n    tmp4[2] = tmp4[2] / w;\n  }\n\n  // and finally into window coordinates\n  // the foruth component is (1/clip.w)\n  // which is the same as gl_FragCoord.w\n  out[0] = vX + (vWidth / 2) * tmp4[0] + (0 + vWidth / 2);\n  out[1] = vY + (vHeight / 2) * tmp4[1] + (0 + vHeight / 2);\n  out[2] = ((f - n) / 2) * tmp4[2] + (f + n) / 2;\n  out[3] = w === 0 ? 0 : 1 / w;\n  return out;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Color, Point, Orientation, ReglCommand, Vec4, Vec3 } from \"../types\";\n\nconst rotateGLSL = `\n  uniform vec3 _position;\n  uniform vec4 _rotation;\n\n  // rotate a 3d point v by a rotation quaternion q\n  vec3 rotate(vec3 v, vec4 q) {\n    vec3 temp = cross(q.xyz, v) + q.w * v;\n    return v + (2.0 * cross(q.xyz, temp));\n  }\n\n  vec3 applyPose(vec3 point) {\n    // rotate the point and then add the position of the pose\n    return rotate(point, _rotation) + _position;\n  }\n`;\n\nconst DEFAULT_TEXT_COLOR = { r: 1, g: 1, b: 1, a: 1 };\n\nexport const pointToVec3 = ({ x, y, z }: Point): Vec3 => {\n  return [x, y, z];\n};\nexport const orientationToVec4 = ({ x, y, z, w }: Orientation): Vec4 => {\n  return [x, y, z, w];\n};\n\nexport const vec3ToPoint = ([x, y, z]: Vec3): Point => ({ x, y, z });\n\nexport const vec4ToOrientation = ([x, y, z, w]: Vec4): Orientation => ({ x, y, z, w });\n\nexport const pointToVec3Array = (points: Point[]) => {\n  const result = new Float32Array(points.length * 3);\n  let i = 0;\n  for (const { x, y, z } of points) {\n    result[i++] = x;\n    result[i++] = y;\n    result[i++] = z;\n  }\n  return result;\n};\n\nexport const toRGBA = (val: Color) => {\n  return [val.r, val.g, val.b, val.a];\n};\n\nexport const vec4ToRGBA = (color: Vec4): Color => ({ r: color[0], g: color[1], b: color[2], a: color[3] });\n\nexport const toColor = (val: Color | Vec4): Color => (Array.isArray(val) ? vec4ToRGBA(val) : val);\n\nexport function getCSSColor(color: Color = DEFAULT_TEXT_COLOR) {\n  const { r, g, b, a } = color;\n  return `rgba(${(r * 255).toFixed()}, ${(g * 255).toFixed()}, ${(b * 255).toFixed()}, ${a.toFixed(3)})`;\n}\n\nconst toRGBAArray = (colors: $ReadOnlyArray<Color>): Float32Array => {\n  const result = new Float32Array(colors.length * 4);\n  let i = 0;\n  for (const { r, g, b, a } of colors) {\n    result[i++] = r;\n    result[i++] = g;\n    result[i++] = b;\n    result[i++] = a;\n  }\n  return result;\n};\n\nconst constantRGBAArray = (count: number, { r, g, b, a }: Color): Float32Array => {\n  const result = new Float32Array(count * 4);\n  for (let i = 0; i < count; i++) {\n    result[4 * i + 0] = r;\n    result[4 * i + 1] = g;\n    result[4 * i + 2] = b;\n    result[4 * i + 3] = a;\n  }\n  return result;\n};\n\n// default blend func params to be mixed into regl commands\nexport const defaultReglBlend = {\n  enable: true,\n  // this is the same gl.BlendFunc used by three.js by default\n  func: {\n    src: \"src alpha\",\n    dst: \"one minus src alpha\",\n    srcAlpha: 1,\n    dstAlpha: \"one minus src alpha\",\n  },\n  equation: {\n    rgb: \"add\",\n    alpha: \"add\",\n  },\n};\n\nexport const defaultReglDepth = {\n  enable: true,\n  mask: true,\n};\n\nexport const defaultDepth = {\n  enable: (context: any, props: any) => (props.depth && props.depth.enable) || defaultReglDepth.enable,\n  mask: (context: any, props: any) => (props.depth && props.depth.mask) || defaultReglDepth.mask,\n};\n\nexport const defaultBlend = {\n  ...defaultReglBlend,\n  enable: (context: any, props: any) => (props.blend && props.blend.enable) || defaultReglBlend.enable,\n  func: (context: any, props: any) => (props.blend && props.blend.func) || defaultReglBlend.func,\n};\n\n// TODO: deprecating, remove before 1.x release\nexport const blend = defaultBlend;\n\n// takes a regl command definition object and injects\n// position and rotation from the object pose and also\n// inserts some glsl helpers to apply the pose to points in a fragment shader\nexport function withPose(command: ReglCommand): ReglCommand {\n  const { vert, uniforms } = command;\n  const newVert = vert.replace(\"#WITH_POSE\", rotateGLSL);\n  const newUniforms = {\n    ...uniforms,\n    _position: (context, props) => {\n      const { position } = props.pose;\n      return Array.isArray(position) ? position : pointToVec3(position);\n    },\n    _rotation: (context, props) => {\n      const { orientation: r } = props.pose;\n      return Array.isArray(r) ? r : [r.x, r.y, r.z, r.w];\n    },\n  };\n  return {\n    ...command,\n    vert: newVert,\n    uniforms: newUniforms,\n  };\n}\n\nexport function getVertexColors({\n  colors,\n  color,\n  points,\n}: {\n  colors?: $ReadOnlyArray<Color> | $ReadOnlyArray<Vec4>,\n  color: Color,\n  points: $ReadOnlyArray<Point>,\n}): Float32Array | $ReadOnlyArray<Vec4> {\n  if ((!colors || !colors.length) && color) {\n    return constantRGBAArray(points.length, color);\n  }\n  if (colors) {\n    // $FlowFixMe this will go away once we consolidate getVertexColors and colorBuffer\n    return shouldConvert(colors) ? toRGBAArray(colors) : colors;\n  }\n  return [];\n}\n\nfunction hasNestedArrays(arr: any[]) {\n  return arr.length && Array.isArray(arr[0]);\n}\n\n// Returns a function which accepts a single color, an array of colors, and the number of instances,\n// and returns a color attribute buffer for use in regl.\n// If there are multiple colors in the colors array, one color will be assigned to each instance.\n// In the case of a single color, the same color will be used for all instances.\nexport function colorBuffer(regl: any) {\n  const buffer = regl.buffer({\n    usage: \"dynamic\",\n    data: [],\n  });\n\n  return function(color: any, colors: any, length: number) {\n    let data, divisor;\n    if (!colors || !colors.length) {\n      data = shouldConvert(color) ? toRGBA(color) : color;\n      divisor = length;\n    } else {\n      data = shouldConvert(colors) ? toRGBAArray(colors) : colors;\n      divisor = 1;\n    }\n    return {\n      buffer: buffer({\n        usage: \"dynamic\",\n        data,\n      }),\n      divisor,\n    };\n  };\n}\n\n// used to determine if the input/array of inputs is an object like {r: 0, g: 0, b: 0} or [0,0,0]\nexport function shouldConvert(props: any) {\n  if (!props || hasNestedArrays(props) || !isNaN(props[0])) {\n    return false;\n  }\n  return true;\n}\n\nexport function intToRGB(i: number = 0): Vec4 {\n  const r = ((i >> 16) & 255) / 255;\n  const g = ((i >> 8) & 255) / 255;\n  const b = (i & 255) / 255;\n  return [r, g, b, 1];\n}\n\nexport function getIdFromColor(rgb: Vec4): number {\n  const r = rgb[0] * 255;\n  const g = rgb[1] * 255;\n  const b = rgb[2] * 255;\n  return b | (g << 8) | (r << 16);\n}\n\nexport function getIdFromPixel(rgb: Uint8Array): number {\n  const r = rgb[0];\n  const g = rgb[1];\n  const b = rgb[2];\n  return b | (g << 8) | (r << 16);\n}\n\n// gl-matrix clone of three.js Vector3.setFromSpherical\n// phi: polar angle (between poles, 0 - pi)\n// theta: azimuthal angle (around equator, 0 - 2pi)\nexport function fromSpherical(out: number[], r: number, theta: number, phi: number): Vec3 {\n  const rSinPhi = r * Math.sin(phi);\n  out[0] = rSinPhi * Math.sin(theta);\n  out[1] = r * Math.cos(phi);\n  out[2] = rSinPhi * Math.cos(theta);\n  return (out: any);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat, mat4 } from \"gl-matrix\";\nimport { createSelector } from \"reselect\";\n\nimport type { CameraState, Vec4, Vec3, Mat4 } from \"../types\";\nimport { fromSpherical } from \"../utils/commandUtils\";\n\nconst UNIT_X_VECTOR = Object.freeze([1, 0, 0]);\n\n// reusable arrays for intermediate calculations\nconst TEMP_VEC3 = [0, 0, 0];\nconst TEMP_MAT = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\nconst TEMP_QUAT = [0, 0, 0, 0];\n\nconst stateSelector = (state: CameraState) => state;\n\nconst perspectiveSelector = createSelector(\n  stateSelector,\n  ({ perspective }) => perspective\n);\nconst distanceSelector = createSelector(\n  stateSelector,\n  ({ distance }) => distance\n);\nconst phiSelector = createSelector(\n  stateSelector,\n  ({ phi }) => phi\n);\nconst thetaOffsetSelector = createSelector(\n  stateSelector,\n  ({ thetaOffset }) => thetaOffset\n);\nconst targetOrientationSelector = createSelector(\n  stateSelector,\n  ({ targetOrientation }) => targetOrientation\n);\n\n// the heading direction of the target\nconst targetHeadingSelector: (CameraState) => number = createSelector(\n  targetOrientationSelector,\n  (targetOrientation) => {\n    const out = vec3.transformQuat(TEMP_VEC3, UNIT_X_VECTOR, targetOrientation);\n    const heading = -Math.atan2(out[1], out[0]);\n    return heading;\n  }\n);\n\n// orientation of the camera\nconst orientationSelector: (CameraState) => Vec4 = createSelector(\n  perspectiveSelector,\n  phiSelector,\n  thetaOffsetSelector,\n  (perspective, phi, thetaOffset) => {\n    const result = quat.identity([0, 0, 0, 0]);\n    quat.rotateZ(result, result, -thetaOffset);\n\n    // phi is ignored in 2D mode\n    if (perspective) {\n      quat.rotateX(result, result, phi);\n    }\n    return result;\n  }\n);\n\n// position of the camera\nconst positionSelector: (CameraState) => Vec3 = createSelector(\n  thetaOffsetSelector,\n  phiSelector,\n  distanceSelector,\n  (thetaOffset, phi, distance) => {\n    const position = fromSpherical([], distance, thetaOffset, phi);\n\n    // poles are on the y-axis in spherical coordinates; rearrange so they are on the z axis\n    const [x, y, z] = position;\n    position[0] = -x;\n    position[1] = -z;\n    position[2] = y;\n\n    return position;\n  }\n);\n\n/*\nGet the view matrix, which transforms points from world coordinates to camera coordinates.\n\nAn equivalent and easier way to think about this transformation is that it takes the camera from\nits actual position/orientation in the world, and moves it to have position=0,0,0 and orientation=0,0,0,1.\n\nWe build up this transformation in 5 steps as demonstrated below:\n   T = target\n   < = direction of target\n   * = target with offset (position that the camera is looking at)\n   C = camera (always points toward *)\n\nStarting point: actual positions in world coordinates\n\n  |      *\n  |  <T   C\n  |\n  +--------\n\nStep 1: translate target to the origin\n\n  |\n  |  *\n <T---C----\n\nStep 2: rotate around the origin so the target points forward\n(Here we use the target's heading only, ignoring other components of its rotation)\n\n  |\n  ^\n  T--------\n  |\n  | *\n  C\n\nStep 3: translate the target-with-offset point to be at the origin\n\n ^\n T|\n  |\n  *--------\n C|\n  |\n\n\nStep 4: translate the camera to be at the origin\n(Steps 3 and 4 are both translations, but they're kept separate because it's easier\nto conceptualize: 3 uses the targetOffset and 4 uses the distance+thetaOffset+phi.)\n\n ^\n T\n |\n |*\n C--------\n |\n\nStep 5: rotate the camera to point forward\n\n \\\n  T  |\n     *\n     C--------\n     |\n\n*/\nconst viewSelector: (CameraState) => Mat4 = createSelector(\n  stateSelector,\n  orientationSelector,\n  positionSelector,\n  targetHeadingSelector,\n  ({ target, targetOffset, perspective }, orientation, position, targetHeading) => {\n    const m = mat4.identity([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n\n    // apply the steps described above in reverse because we use right-multiplication\n\n    // 5. rotate camera to point forward\n    mat4.multiply(m, m, mat4.fromQuat(TEMP_MAT, quat.invert(TEMP_QUAT, orientation)));\n\n    // 4. move camera to the origin\n    if (perspective) {\n      mat4.translate(m, m, vec3.negate(TEMP_VEC3, position));\n    }\n\n    // 3. move center to the origin\n    mat4.translate(m, m, vec3.negate(TEMP_VEC3, targetOffset));\n\n    // 2. rotate target to point forward\n    mat4.rotateZ(m, m, targetHeading);\n\n    // 1. move target to the origin\n    vec3.negate(TEMP_VEC3, target);\n    if (!perspective) {\n      // if using orthographic camera ensure the distance from \"ground\"\n      // stays large so no reasonably tall item goes past the camera\n      TEMP_VEC3[2] = -2500;\n    }\n    mat4.translate(m, m, TEMP_VEC3);\n\n    return m;\n  }\n);\n\nconst billboardRotation: (CameraState) => Mat4 = createSelector(\n  orientationSelector,\n  targetHeadingSelector,\n  (orientation, targetHeading) => {\n    const m = mat4.identity(mat4.create());\n    mat4.rotateZ(m, m, -targetHeading);\n    mat4.multiply(m, m, mat4.fromQuat(TEMP_MAT, orientation));\n    return m;\n  }\n);\n\nexport default {\n  orientation: orientationSelector,\n  position: positionSelector,\n  targetHeading: targetHeadingSelector,\n  view: viewSelector,\n  billboardRotation,\n};\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat } from \"gl-matrix\";\n\nimport type { Vec2, Vec3, Vec4 } from \"../types\";\nimport selectors from \"./cameraStateSelectors\";\n\nexport type CameraState = {|\n  distance: number,\n  perspective: boolean,\n  phi: number,\n  target: Vec3,\n  targetOffset: Vec3,\n  targetOrientation: Vec4,\n  thetaOffset: number,\n  fovy: number,\n  near: number,\n  far: number,\n|};\n\n//  we use up on the +z axis\nconst UNIT_Z_VECTOR = Object.freeze([0, 0, 1]);\n// reusable array for intermediate calculations\nconst TEMP_QUAT = [0, 0, 0, 0];\n\nexport const DEFAULT_CAMERA_STATE: CameraState = {\n  distance: 75,\n  perspective: true,\n  phi: Math.PI / 4,\n  target: [0, 0, 0],\n  targetOffset: [0, 0, 0],\n  targetOrientation: [0, 0, 0, 1],\n  thetaOffset: 0,\n  fovy: Math.PI / 4,\n  near: 0.01,\n  far: 5000,\n};\n\nfunction distanceAfterZoom(startingDistance: number, zoomPercent: number): number {\n  // keep distance above 0 so that percentage-based zoom always works\n  return Math.max(0.001, startingDistance * (1 - zoomPercent / 100));\n}\n\nexport default class CameraStore {\n  state: CameraState;\n\n  _onChange: (CameraState) => void;\n\n  constructor(\n    handler: (CameraState) => void = () => {},\n    initialCameraState: $Shape<CameraState> = DEFAULT_CAMERA_STATE\n  ) {\n    this._onChange = handler;\n    this.setCameraState(initialCameraState);\n  }\n\n  setCameraState = (state: $Shape<CameraState>) => {\n    // Fill in missing properties from DEFAULT_CAMERA_STATE.\n    // Mutate the `state` parameter instead of copying -- this\n    // matches the previous behavior of this method, which didn't\n    // fill in missing properties but also didn't copy `state`.\n    for (const [key, value] of Object.entries(DEFAULT_CAMERA_STATE)) {\n      if (state[key] == null) {\n        state[key] = value;\n      }\n    }\n    // `state` must be a valid CameraState now, because we filled in\n    // missing properties from DEFAULT_CAMERA_STATE.\n    this.state = (state: any);\n  };\n\n  cameraRotate = ([x, y]: Vec2) => {\n    // This can happen in 2D mode, when both e.movementX and e.movementY are evaluated as negative and mouseX move is 0\n    if (x === 0 && y === 0) {\n      return;\n    }\n    const { thetaOffset, phi } = this.state;\n    this.setCameraState({\n      ...this.state,\n      thetaOffset: thetaOffset - x,\n      phi: Math.max(0, Math.min(phi + y, Math.PI)),\n    });\n    this._onChange(this.state);\n  };\n\n  // move the camera along x, y axis; do not move up/down\n  cameraMove = ([x, y]: Vec2) => {\n    // moveX and moveY both be 0 sometimes\n    if (x === 0 && y === 0) {\n      return;\n    }\n\n    const { targetOffset, thetaOffset } = this.state;\n\n    // rotate around z axis so the offset is in the target's reference frame\n    const result = [x, y, 0];\n    const offset = vec3.transformQuat(result, result, quat.setAxisAngle(TEMP_QUAT, UNIT_Z_VECTOR, -thetaOffset));\n\n    this.setCameraState({\n      ...this.state,\n      targetOffset: vec3.add(offset, targetOffset, offset),\n    });\n    this._onChange(this.state);\n  };\n\n  cameraZoom = (zoomPercent: number) => {\n    const { distance } = this.state;\n    const newDistance: number = distanceAfterZoom(distance, zoomPercent);\n    if (distance === newDistance) {\n      return;\n    }\n\n    this.setCameraState({\n      ...this.state,\n      distance: newDistance,\n    });\n    this._onChange(this.state);\n  };\n}\n\nexport { selectors };\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4 } from \"gl-matrix\";\n\nimport type { Vec3, Mat4, CameraCommand, Viewport } from \"../types\";\nimport getOrthographicBounds from \"../utils/getOrthographicBounds\";\nimport project from \"./cameraProject\";\nimport { selectors, DEFAULT_CAMERA_STATE, type CameraState } from \"./CameraStore\";\n\nconst TEMP_MAT = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\n// This is the regl command which encapsulates the camera projection and view matrices.\n// It adds the matrices to the regl context so they can be used by other commands.\nexport default (regl: any) => {\n  if (!regl) {\n    throw new Error(\"Invalid regl instance\");\n  }\n\n  return class Camera implements CameraCommand {\n    viewportWidth: number = 0;\n    viewportHeight: number = 0;\n    cameraState: CameraState = DEFAULT_CAMERA_STATE;\n\n    getProjection(): Mat4 {\n      const { near, far, distance, fovy } = this.cameraState;\n      if (!this.cameraState.perspective) {\n        const bounds = getOrthographicBounds(distance, this.viewportWidth, this.viewportHeight);\n        const { left, right, bottom, top } = bounds;\n        return mat4.ortho([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], left, right, bottom, top, near, far);\n      }\n      const aspect = this.viewportWidth / this.viewportHeight;\n      return mat4.perspective([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], fovy, aspect, near, far);\n    }\n\n    getView(): Mat4 {\n      return selectors.view(this.cameraState);\n    }\n\n    // convert a point in 3D space to a point on the screen\n    toScreenCoord(viewport: Viewport, point: Vec3) {\n      const projection = this.getProjection();\n      const view = selectors.view(this.cameraState);\n      const combinedProjView = mat4.multiply(TEMP_MAT, projection, view);\n      const [x, y, z, w] = project([], point, viewport, combinedProjView);\n      if (z < 0 || z > 1 || w < 0) {\n        // resulting point is outside the window depth range\n        return undefined;\n      }\n      const diffY = viewport[3] + viewport[1];\n      const diffX = viewport[0];\n      // move the x value over based on the left of the viewport\n      // and move the y value over based on the bottom of the viewport\n      return [x - diffX, diffY - y, z];\n    }\n\n    draw = regl({\n      // adds context variables to the regl context so they are accessible from commands\n      context: {\n        // use functions, not lambdas here to make sure we can access\n        // the regl supplied this scope: http://regl.party/api#this\n        projection(context, props) {\n          const { viewportWidth, viewportHeight } = context;\n          // save these variables on the camera instance\n          // because we need them for raycasting\n          this.viewportWidth = viewportWidth;\n          this.viewportHeight = viewportHeight;\n          this.cameraState = props;\n          return this.getProjection();\n        },\n\n        view(context, props) {\n          return this.getView();\n        },\n\n        // inverse of the view rotation, used for making objects always face the camera\n        billboardRotation(context, props) {\n          return selectors.billboardRotation(this.cameraState);\n        },\n\n        isPerspective(context, props) {\n          return this.cameraState.perspective;\n        },\n\n        fovy(context, props) {\n          return this.cameraState.fovy;\n        },\n      },\n\n      // adds view and projection as uniforms to every command\n      // and makes them available in the shaders\n      uniforms: {\n        view: regl.context(\"view\"),\n        billboardRotation: regl.context(\"billboardRotation\"),\n        projection: regl.context(\"projection\"),\n      },\n    });\n  };\n};\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport normalizeWheel from \"normalize-wheel\";\nimport * as React from \"react\";\n\nimport type { CameraKeyMap, CameraAction, Vec2 } from \"../types\";\nimport getOrthographicBounds from \"../utils/getOrthographicBounds\";\nimport CameraStore from \"./CameraStore\";\n\nconst PAN_SPEED = 4;\nconst MOUSE_ZOOM_SPEED = 0.3;\nconst KEYBOARD_MOVE_SPEED = 0.3;\nconst KEYBOARD_ZOOM_SPEED = 150;\nconst KEYBOARD_SPIN_SPEED = 1.5;\n\nconst DEFAULT_KEYMAP: CameraKeyMap = {\n  KeyA: \"moveLeft\",\n  KeyD: \"moveRight\",\n  KeyE: \"rotateRight\",\n  KeyF: \"tiltUp\",\n  KeyQ: \"rotateLeft\",\n  KeyR: \"tiltDown\",\n  KeyS: \"moveDown\",\n  KeyW: \"moveUp\",\n  KeyX: \"zoomOut\",\n  KeyZ: \"zoomIn\",\n};\n\ntype KeyMotion = { x?: number, y?: number, zoom?: number, yaw?: number, tilt?: number };\n\ntype Props = {|\n  cameraStore: CameraStore,\n  keyMap?: CameraKeyMap,\n  shiftKeys: boolean,\n  children?: React.ChildrenArray<React.Element<any> | null>,\n|};\n\n// attaches mouse and keyboard listeners to allow for moving the camera on user input\nexport default class CameraListener extends React.Component<Props> {\n  _keyTimer: ?AnimationFrameID;\n  _keys: Set<string> = new Set();\n  _buttons: Set<number> = new Set();\n  _listeners = [];\n  _shiftKey = false;\n  _metaKey = false;\n  _ctrlKey = false;\n\n  _el: ?HTMLDivElement;\n  _rect: ClientRect | DOMRect;\n  _initialMouse: Vec2;\n\n  componentDidMount() {\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n\n    this._rect = _el.getBoundingClientRect();\n    const listen = (target: any, name: string, fn) => {\n      target.addEventListener(name, fn);\n      this._listeners.push({ target, name, fn });\n    };\n    listen(document, \"blur\", this._onBlur);\n    listen(window, \"mouseup\", this._onWindowMouseUp);\n    _el.addEventListener(\"wheel\", this._onWheel, { passive: false });\n  }\n\n  componentWillUnmount() {\n    this._listeners.forEach((listener) => {\n      listener.target.removeEventListener(listener.name, listener.fn);\n    });\n    this._endDragging();\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n    _el.removeEventListener(\"wheel\", this._onWheel, { passive: false });\n  }\n\n  focus() {\n    if (this._el) {\n      this._el.focus();\n    }\n  }\n\n  _getMouseOnScreen = (mouse: MouseEvent) => {\n    const { clientX, clientY } = mouse;\n    const { top, left, width, height } = this._rect;\n    const x = (clientX - left) / width;\n    const y = (clientY - top) / height;\n    return [x, y];\n  };\n\n  _onMouseDown = (e: MouseEvent) => {\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n\n    e.preventDefault();\n    this._buttons.add(e.button);\n    _el.focus();\n    this._rect = _el.getBoundingClientRect();\n    this._initialMouse = this._getMouseOnScreen(e);\n    this.startDragging(e);\n  };\n\n  _isLeftMouseDown() {\n    return this._buttons.has(0);\n  }\n\n  _isRightMouseDown() {\n    return this._buttons.has(2);\n  }\n\n  _getMagnitude(base: number = 1) {\n    return this._shiftKey ? base / 10 : base;\n  }\n\n  _getMoveMagnitude() {\n    // avoid interference with drawing tools\n    if (this._ctrlKey) {\n      return { x: 0, y: 0 };\n    }\n\n    const {\n      cameraStore: {\n        state: { distance, perspective },\n      },\n    } = this.props;\n    if (perspective) {\n      // in perspective mode its more like flying, so move by the magnitude\n      // we use the camera distance as a heuristic\n      return { x: distance, y: distance };\n    }\n    // in orthographic mode we know the exact viewable area\n    // which is a square so we can move exactly percentage within it\n    const { width, height } = this._rect;\n    const bounds = getOrthographicBounds(distance, width, height);\n    return { x: bounds.width, y: bounds.height };\n  }\n\n  _onWindowMouseMove = (e: MouseEvent) => {\n    if (!this._buttons.size) {\n      return;\n    }\n    this._shiftKey = e.shiftKey;\n    const {\n      cameraStore: {\n        cameraMove,\n        cameraRotate,\n        state: { perspective },\n      },\n    } = this.props;\n\n    // compute the amount the mouse has moved\n    let moveX, moveY;\n    const mouse = this._getMouseOnScreen(e);\n    // when pointer lock is enabled, we get movementX and movementY (with direction reversed)\n    // instead of the screenX/screenY changing... except, when using synergy, they come through\n    // like regular mousemove events.\n    if ((document: any).pointerLockElement && (e.movementX || e.movementY)) {\n      moveX = -e.movementX / this._rect.width;\n      moveY = -e.movementY / this._rect.height;\n    } else {\n      moveX = this._initialMouse[0] - mouse[0];\n      moveY = this._initialMouse[1] - mouse[1];\n    }\n    this._initialMouse = mouse;\n\n    if (this._isRightMouseDown()) {\n      const magnitude = this._getMagnitude(PAN_SPEED);\n      // in orthographic mode, flip the direction of rotation so \"left\" means \"counterclockwise\"\n      const x = (perspective ? moveX : -moveX) * magnitude;\n      // do not rotate vertically in orthograhpic mode\n      const y = perspective ? moveY * magnitude : 0;\n      cameraRotate([x, y]);\n    }\n\n    if (this._isLeftMouseDown()) {\n      const { x, y } = this._getMoveMagnitude();\n      cameraMove([this._getMagnitude(moveX * x), this._getMagnitude(-moveY * y)]);\n    }\n  };\n\n  _onMouseUp = (e: MouseEvent) => {\n    this._buttons.delete(e.button);\n    this._endDragging();\n  };\n\n  _onWindowMouseUp = (e: MouseEvent) => {\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n\n    // do nothing if this container had a mouseup, because we catch it in the onMouseUp handler\n    if (_el.contains((e.target: any)) || e.target === _el) {\n      return;\n    }\n    // If mouseup triggers on the window outside this container, clear any active interactions.\n    // This will allow a mouseup outside the browser window to be handled; otherwise the mouse\n    // \"sticks\" in a down position until another click on this element is received.\n    this._buttons.clear();\n    this._endDragging();\n  };\n\n  startDragging(e: MouseEvent) {\n    if (e.button !== 0 && this._el && typeof this._el.requestPointerLock === \"function\") {\n      this._el.requestPointerLock();\n    }\n    window.addEventListener(\"mousemove\", this._onWindowMouseMove);\n  }\n\n  _endDragging() {\n    window.removeEventListener(\"mousemove\", this._onWindowMouseMove);\n    if (typeof (document: any).exitPointerLock === \"function\") {\n      (document: any).exitPointerLock();\n    }\n  }\n\n  _getKeyMotion = (code: string): ?KeyMotion => {\n    const moveSpeed = this._getMagnitude(KEYBOARD_MOVE_SPEED);\n    const zoomSpeed = this._getMagnitude(KEYBOARD_ZOOM_SPEED);\n    const spinSpeed = this._getMagnitude(KEYBOARD_SPIN_SPEED);\n    const { keyMap, shiftKeys } = this.props;\n    const action: CameraAction | false = (keyMap && keyMap[code]) || DEFAULT_KEYMAP[code] || false;\n\n    if (this._shiftKey && !shiftKeys) {\n      return null;\n    }\n\n    switch (action) {\n      case \"moveRight\":\n        return { x: moveSpeed };\n      case \"moveLeft\":\n        return { x: -moveSpeed };\n      case \"moveUp\":\n        return { y: moveSpeed };\n      case \"moveDown\":\n        return { y: -moveSpeed };\n      case \"zoomIn\":\n        return { zoom: zoomSpeed };\n      case \"zoomOut\":\n        return { zoom: -zoomSpeed };\n      case \"rotateLeft\":\n        return { yaw: -spinSpeed };\n      case \"rotateRight\":\n        return { yaw: spinSpeed };\n      case \"tiltUp\":\n        return { tilt: -spinSpeed };\n      case \"tiltDown\":\n        return { tilt: spinSpeed };\n      case false:\n        return null;\n      default:\n        (action: empty);\n        console.warn(\"Unrecognized key action:\", action);\n        return null;\n    }\n  };\n\n  _moveKeyboard(dt: number) {\n    const motion = { x: 0, y: 0, zoom: 0, yaw: 0, tilt: 0 };\n    this._keys.forEach((code) => {\n      const { x = 0, y = 0, zoom = 0, yaw = 0, tilt = 0 } = this._getKeyMotion(code) || {};\n      motion.x += x;\n      motion.y += y;\n      motion.zoom += zoom;\n      motion.yaw += yaw;\n      motion.tilt += tilt;\n    });\n\n    const {\n      cameraStore: {\n        cameraMove,\n        cameraRotate,\n        cameraZoom,\n        state: { perspective },\n      },\n    } = this.props;\n\n    if (motion.x || motion.y) {\n      const { x, y } = this._getMoveMagnitude();\n      cameraMove([motion.x * x * dt, motion.y * y * dt]);\n    }\n    if (motion.yaw || (perspective && motion.tilt)) {\n      cameraRotate([motion.yaw * dt, perspective ? motion.tilt * dt : 0]);\n    }\n    if (motion.zoom) {\n      cameraZoom(motion.zoom * dt);\n    }\n  }\n\n  _startKeyTimer(lastStamp: ?number) {\n    if (this._keyTimer) {\n      return;\n    }\n    this._keyTimer = requestAnimationFrame((stamp) => {\n      this._moveKeyboard((lastStamp ? stamp - lastStamp : 0) / 1000);\n      this._keyTimer = undefined;\n\n      // Only start the timer if keys are still pressed.\n      // We do this rather than stopping the timer in onKeyUp, because keys held\n      // sometimes actually trigger repeated keyup/keydown, rather than just repeated keydown.\n      // By checking currently-down keys in the requestAnimationFrame callback, we give the browser enough time to\n      // handle both the keyup and keydown before checking whether we should restart the timer.\n      if (this._keys.size) {\n        this._startKeyTimer(stamp);\n      }\n    });\n  }\n\n  _stopKeyTimer() {\n    if (this._keyTimer) {\n      cancelAnimationFrame(this._keyTimer);\n    }\n    this._keyTimer = undefined;\n  }\n\n  _onKeyDown = (e: SyntheticKeyboardEvent<HTMLDivElement>) => {\n    const { keyMap } = this.props;\n    this._shiftKey = e.shiftKey;\n    this._metaKey = e.metaKey;\n    this._ctrlKey = e.ctrlKey;\n    const code = ((e.nativeEvent: any): KeyboardEvent).code;\n\n    // ignore repeated keydown events\n    if (e.repeat || this._keys.has(code)) {\n      e.stopPropagation();\n      e.preventDefault();\n      return;\n    }\n\n    if (e.altKey || e.ctrlKey || e.metaKey) {\n      // we don't currently handle these modifiers\n      return;\n    }\n\n    // allow null, false, or empty keymappings which explicitly cancel Worldview from processing that key\n    if (keyMap && code in keyMap && !keyMap[code]) {\n      return false;\n    }\n\n    // if we respond to this key, start the update timer\n    if (this._getKeyMotion(code)) {\n      this._keys.add(code);\n      this._startKeyTimer();\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  };\n\n  _onKeyUp = (e: SyntheticKeyboardEvent<HTMLDivElement>) => {\n    this._shiftKey = e.shiftKey;\n    this._metaKey = e.metaKey;\n    this._ctrlKey = e.ctrlKey;\n\n    this._keys.delete(((e.nativeEvent: any): KeyboardEvent).code);\n  };\n\n  _onWheel = (e: WheelEvent) => {\n    // stop the wheel event here, as wheel propagation through the entire dom\n    // can cause the browser to slow down & thrash\n    e.preventDefault();\n    e.stopPropagation();\n    this._shiftKey = e.shiftKey;\n\n    // with osx trackpad scrolling, slow to medium pixelY is around +/- 1 to 10\n    // external mouse wheels generally come in higher values around +/- 30 to 50\n    const { pixelX, pixelY } = normalizeWheel(e);\n\n    // shift+scroll on an external mouse may scroll in the X direction instead of Y\n    const wheelAmount = pixelY || pixelX;\n\n    // we use positive value to indicate zooming in\n    // and negative value to zoom out, so reverse the direction of the wheel\n    const dir = Math.sign(wheelAmount) * -1;\n    const amount = Math.abs(wheelAmount);\n    // restrict zoom percentage per tick to between 1 & 50 percent\n    const percentage = Math.max(1, Math.min(amount, 50));\n\n    // support shift+wheel magnitude adjustment\n    const zoomPercentage = this._getMagnitude(percentage * dir * MOUSE_ZOOM_SPEED);\n    this.props.cameraStore.cameraZoom(zoomPercentage);\n  };\n\n  // make sure all movements stop if the document loses focus by resetting modifier keys\n  // to their 'off' position\n  // (e.g. ctrl+tab leaving the page should not leave the ctrl key in the 'on' position)\n  _onBlur = (e: MouseEvent) => {\n    this._keys = new Set();\n    this._ctrlKey = false;\n    this._shiftKey = false;\n    this._metaKey = false;\n    this._stopKeyTimer();\n  };\n\n  _onContextMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  render() {\n    const { children } = this.props;\n    return (\n      <div\n        tabIndex={0}\n        style={{ outline: \"none\" }}\n        draggable\n        ref={(el) => (this._el = el)}\n        onMouseDown={this._onMouseDown}\n        onMouseUp={this._onMouseUp}\n        onBlur={this._onBlur}\n        onContextMenu={this._onContextMenu}\n        onKeyDown={this._onKeyDown}\n        onKeyUp={this._onKeyUp}>\n        {children}\n      </div>\n    );\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport function getNodeEnv() {\n  return process && process.env && process.env.NODE_ENV;\n}\n\n/* eslint-disable no-undef */\nexport const inWebWorker = () =>\n  global.postMessage && typeof WorkerGlobalScope !== \"undefined\" && self instanceof WorkerGlobalScope;\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, mat4 } from \"gl-matrix\";\n\nimport type { CameraCommand, Vec3 } from \"../types\";\n\ntype ClickInfo = { clientX: number, clientY: number, width: number, height: number };\n\nconst tempVec = [0, 0, 0];\nconst tempMat = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\nexport class Ray {\n  origin: Vec3;\n  dir: Vec3;\n  point: Vec3;\n\n  constructor(origin: Vec3, dir: Vec3, point: Vec3) {\n    this.origin = origin;\n    this.dir = dir;\n    this.point = point;\n  }\n\n  distanceToPoint(point: Vec3) {\n    return vec3.distance(this.origin, point);\n  }\n\n  // https://commons.apache.org/proper/commons-math/javadocs/api-3.6/src-html/org/apache/commons/math3/geometry/euclidean/threed/Plane.html#line.394\n  planeIntersection(planeCoordinate: Vec3, planeNormal: Vec3): ?Vec3 {\n    const d = vec3.dot(planeNormal, planeCoordinate);\n    const cosine = vec3.dot(planeNormal, this.dir);\n\n    if (cosine === 0) {\n      return null;\n    }\n\n    const x = (d - vec3.dot(planeNormal, this.origin)) / cosine;\n    const contact = vec3.add([0, 0, 0], this.origin, vec3.scale(tempVec, this.dir, x));\n    return contact;\n  }\n}\n\n// adapted from https://github.com/regl-project/regl/blob/master/example/raycast.js\nexport function getRayFromClick(camera: CameraCommand, { clientX, clientY, width, height }: ClickInfo) {\n  const projectionMatrix = camera.getProjection();\n  const viewMatrix = camera.getView();\n\n  const vp = mat4.multiply(tempMat, projectionMatrix, viewMatrix);\n  const invVp = mat4.invert(tempMat, vp);\n\n  const mouseX = (2.0 * clientX) / width - 1.0;\n  const mouseY = (-2.0 * clientY) / height + 1.0;\n  // get a single point on the camera ray.\n  const rayPoint = vec3.transformMat4([0, 0, 0], [mouseX, mouseY, 0.0], invVp);\n\n  // get the position of the camera.\n  const rayOrigin = vec3.transformMat4([0, 0, 0], [0, 0, 0], mat4.invert(tempMat, viewMatrix));\n  const rayDir = vec3.normalize([0, 0, 0], vec3.subtract(tempVec, rayPoint, rayOrigin));\n\n  return new Ray(rayOrigin, rayDir, rayPoint);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport { type WorldviewContextType } from \"./WorldviewContext\";\n\n// $FlowFixMe\nexport default React.createContext((undefined: WorldviewContextType | void));\n","// @flow\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type {\n  ComponentMouseHandler,\n  GetChildrenForHitmap,\n  MouseEventEnum,\n  RawCommand,\n  Color,\n  Point,\n  MouseEventObject,\n} from \"../types\";\nimport { getNodeEnv } from \"../utils/common\";\nimport { Ray } from \"../utils/Raycast\";\nimport { type WorldviewContextType } from \"../WorldviewContext\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\n\nexport const SUPPORTED_MOUSE_EVENTS = [\"onClick\", \"onMouseUp\", \"onMouseMove\", \"onMouseDown\", \"onDoubleClick\"];\n\nexport type MarkerDefault = {\n  id?: number,\n  points?: Point[],\n  color?: Color,\n};\n\nexport type CommonCommandProps = {\n  [MouseEventEnum]: ComponentMouseHandler,\n  layerIndex?: number,\n  getChildrenForHitmap?: GetChildrenForHitmap,\n};\n\ntype Props<T> = {\n  ...CommonCommandProps,\n  children?: T[] | T,\n  // Deprecated, but here for backwards compatibility\n  drawProps?: T[],\n  reglCommand: RawCommand<T>,\n};\n\nexport type CommandProps<T> = Props<T>;\n\n// Component to dispatch children (for drawing) and hitmap props and a reglCommand to the render loop to render with regl.\nexport default class Command<T> extends React.Component<Props<T>> {\n  context: ?WorldviewContextType;\n  static displayName = \"Command\";\n\n  constructor(props: Props<T>) {\n    super(props);\n    // In development put a check in to make sure the reglCommand prop is not mutated.\n    // Similar to how react checks for unsupported or deprecated calls in a development build.\n    if (getNodeEnv() !== \"production\") {\n      // $FlowFixMe\n      this.shouldComponentUpdate = (nextProps: Props) => {\n        if (nextProps.reglCommand !== this.props.reglCommand) {\n          console.error(\"Changing the regl command prop on a <Command /> is not supported.\");\n        }\n        return true;\n      };\n    }\n  }\n\n  componentDidMount() {\n    const context = this.context;\n    if (!context) {\n      return;\n    }\n    context.onMount(this, this.props.reglCommand);\n    this._updateContext();\n  }\n\n  componentDidUpdate() {\n    this._updateContext();\n  }\n\n  componentWillUnmount() {\n    const context = this.context;\n    if (!context) {\n      return;\n    }\n    context.onUnmount(this);\n  }\n\n  _updateContext() {\n    const context = this.context;\n    if (!context) {\n      return;\n    }\n\n    const { reglCommand, layerIndex, getChildrenForHitmap } = this.props;\n    const children = this.props.children || this.props.drawProps;\n    if (children == null) {\n      return;\n    }\n    context.registerDrawCall({\n      instance: this,\n      reglCommand,\n      children,\n      layerIndex,\n      getChildrenForHitmap,\n    });\n  }\n\n  handleMouseEvent(\n    objects: MouseEventObject[],\n    ray: Ray,\n    e: SyntheticMouseEvent<HTMLCanvasElement>,\n    mouseEventName: MouseEventEnum\n  ) {\n    const mouseHandler = this.props[mouseEventName];\n    if (!mouseHandler || !objects.length) {\n      return;\n    }\n    mouseHandler(e, { ray, objects });\n  }\n\n  render() {\n    return (\n      <WorldviewReactContext.Consumer>\n        {(ctx: ?WorldviewContextType) => {\n          if (ctx) {\n            this.context = ctx;\n          }\n          return null;\n        }}\n      </WorldviewReactContext.Consumer>\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useEffect, useState, useCallback, type Node } from \"react\";\n\nimport { inWebWorker } from \"./common\";\n\ntype DimensionsParams = {| height: number, width: number, left: number, top: number |};\ntype Props = {|\n  children: (DimensionsParams) => Node,\n|};\n\n// Jest does not include ResizeObserver.\nclass ResizeObserverMock {\n  _callback: (ResizeObserverEntry[]) => void;\n  constructor(callback) {\n    this._callback = callback;\n  }\n\n  observe() {\n    const entry: any = { contentRect: { width: 150, height: 150 } };\n    this._callback([entry]);\n  }\n  unobserve() {}\n}\nconst ResizeObserverImpl =\n  process.env.NODE_ENV === \"test\" || inWebWorker() ? (ResizeObserverMock: any) : ResizeObserver;\n\n// Calculates the dimensions of the parent element, and passes those dimensions to the child function.\n// Uses resizeObserver, which is very performant.\n// Works by rendering an empty div, getting the parent element, and then once we know the dimensions of the parent\n// element, rendering the children. After the initial render it just observes the parent element.\n// We expect the parent element to never change.\nexport default function Dimensions({ children }: Props) {\n  const [parentElement, setParentElement] = useState(undefined);\n  const [dimensions, setDimensions] = useState<?DimensionsParams>();\n  // This resizeObserver should never change.\n  const [resizeObserver] = useState<ResizeObserver>(\n    () =>\n      new ResizeObserverImpl((entries) => {\n        if (!entries || !entries.length) {\n          return;\n        }\n\n        // We only observe a single element, so just use the first entry.\n        // We have to round because these could be sub-pixel values.\n        const newWidth = Math.round(entries[0].contentRect.width);\n        const newHeight = Math.round(entries[0].contentRect.height);\n        const newLeft = Math.round(entries[0].contentRect.left);\n        const newTop = Math.round(entries[0].contentRect.top);\n        setDimensions({ width: newWidth, height: newHeight, top: newTop, left: newLeft });\n      })\n  );\n\n  // This should only fire once, because `dimensions` should only be undefined at the beginning.\n  const setParentElementRef = useCallback((element) => {\n    if (element) {\n      setParentElement(element.parentElement);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!parentElement) {\n      return;\n    }\n    resizeObserver.observe(parentElement);\n    // Make sure to unobserve when we unmount the component.\n    return () => resizeObserver.unobserve(parentElement);\n  }, [parentElement, resizeObserver]);\n\n  // This only happens during the first render - we use it to grab the parentElement of this div.\n  if (dimensions == null) {\n    return <div ref={setParentElementRef} />;\n  }\n  return children(dimensions);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport last from \"lodash/last\";\n\nimport Command from \"../commands/Command\";\nimport type { ObjectHitmapId, Vec4, MouseEventObject } from \"../types\";\nimport { intToRGB } from \"./commandUtils\";\n\nfunction fillArray(start: number, length: number): number[] {\n  return new Array(length).fill(0).map((_, index) => start + index);\n}\n\ntype CommandType = Command<any>;\n\n/*\n * This object manages the mapping between objects that are rendered into the scene and their IDs.\n * It supplies an API for generating IDs for a rendered object and then accessing those objects based on their ID.\n */\nexport default class HitmapObjectIdManager {\n  _objectsByObjectHitmapIdMap: { [ObjectHitmapId]: Object } = {};\n  _commandsByObjectMap: Map<Object, CommandType> = new Map();\n  _nextObjectHitmapId = 1;\n  _instanceIndexByObjectHitmapIdMap: { [ObjectHitmapId]: number } = {};\n\n  assignNextColors = (command: CommandType, object: Object, count: number): Vec4[] => {\n    if (count < 1) {\n      throw new Error(\"Must get at least 1 id\");\n    }\n\n    const ids: ObjectHitmapId[] = fillArray(this._nextObjectHitmapId, count);\n    this._nextObjectHitmapId = last(ids) + 1;\n\n    // Instanced rendering - add to the instanced ID map.\n    if (count > 1) {\n      ids.forEach((id, index) => {\n        this._instanceIndexByObjectHitmapIdMap[id] = index;\n      });\n    }\n\n    // Store the mapping of ID to original marker object\n    for (const id of ids) {\n      this._objectsByObjectHitmapIdMap[id] = object;\n    }\n    this._commandsByObjectMap.set(object, command);\n\n    // Return colors from the IDs.\n    const colors = ids.map((id) => intToRGB(id));\n    return colors;\n  };\n\n  getObjectByObjectHitmapId = (objectHitmapId: ObjectHitmapId): MouseEventObject => {\n    return {\n      object: this._objectsByObjectHitmapIdMap[objectHitmapId],\n      instanceIndex: this._instanceIndexByObjectHitmapIdMap[objectHitmapId],\n    };\n  };\n\n  getCommandForObject = (object: Object): ?CommandType => {\n    return this._commandsByObjectMap.get(object);\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { signal, type Signal } from \"./signal\";\n\ntype QueuedFn = ((...args: any[]) => Promise<any>) & { currentPromise: ?Promise<any> };\n\n// Wait for the previous promise to resolve before starting the next call to the function.\nexport default function queuePromise(fn: (...args: any[]) => Promise<any>): QueuedFn {\n  // Whether we are currently waiting for a promise returned by `fn` to resolve.\n  let calling = false;\n  // The list of calls made to the function was made while a call was in progress.\n  const nextCalls: {| args: any[], promise: Signal<any> |}[] = [];\n\n  function queuedFn(...args) {\n    if (calling) {\n      const returnPromise = signal();\n      nextCalls.push({ args, promise: returnPromise });\n      return returnPromise;\n    }\n    return start(...args);\n  }\n\n  function start(...args) {\n    calling = true;\n\n    const promise = fn(...args).finally(() => {\n      calling = false;\n      queuedFn.currentPromise = undefined;\n      if (nextCalls.length) {\n        const { promise: nextPromise, args: nextArgs } = nextCalls.shift();\n        start(...nextArgs)\n          .then((result) => nextPromise.resolve(result))\n          .catch((error) => nextPromise.reject(error));\n      }\n    });\n    queuedFn.currentPromise = promise;\n\n    return promise;\n  }\n\n  return queuedFn;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport type Signal<T> = Promise<T> & {\n  resolve: (T) => void,\n  reject: (Error) => void,\n};\n\nexport function signal<T>(): Signal<T> {\n  let resolve;\n  let reject;\n  const promise: any = new Promise((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  promise.resolve = resolve;\n  promise.reject = reject;\n  return promise;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport createREGL from \"regl\";\nimport shallowequal from \"shallowequal\";\n\nimport { camera, CameraStore } from \"./camera/index\";\nimport Command from \"./commands/Command\";\nimport type {\n  Dimensions,\n  RawCommand,\n  CompiledReglCommand,\n  CameraCommand,\n  Vec4,\n  CameraState,\n  MouseEventObject,\n  GetChildrenForHitmap,\n  AssignNextColorsFn,\n} from \"./types\";\nimport { getIdFromPixel, intToRGB } from \"./utils/commandUtils\";\nimport { getNodeEnv } from \"./utils/common\";\nimport HitmapObjectIdManager from \"./utils/HitmapObjectIdManager\";\nimport queuePromise from \"./utils/queuePromise\";\nimport { getRayFromClick } from \"./utils/Raycast\";\n\ntype Props = any;\n\ntype ConstructorArgs = {\n  dimension: Dimensions,\n  canvasBackgroundColor: Vec4,\n  cameraState: CameraState,\n  defaultCameraState?: CameraState,\n  onCameraStateChange: ?(CameraState) => void,\n  contextAttributes?: ?{ [string]: any },\n};\n\ntype InitializedData = {\n  _fbo: any,\n  regl: any,\n  camera: CameraCommand,\n};\n\nexport type DrawInput = {\n  instance: Command<any>,\n  reglCommand: RawCommand<any>,\n  children: Props,\n  layerIndex: ?number,\n  getChildrenForHitmap: ?GetChildrenForHitmap,\n};\n\nexport type PaintFn = () => void;\n\nexport type WorldviewContextType = {\n  onMount(instance: Command<any>, command: RawCommand<any>): void,\n  registerDrawCall(drawInput: DrawInput): void,\n  registerPaintCallback(PaintFn): void,\n  unregisterPaintCallback(PaintFn): void,\n  onUnmount(instance: Command<any>): void,\n  onDirty(): void,\n  +dimension: Dimensions,\n  +initializedData: ?InitializedData,\n};\n\n// Compile instructions with an initialized regl context into a regl command.\n// If the instructions are a function, pass the context to the instructions and compile the result\n// of the function; otherwise, compile the instructions directly\nfunction compile<T>(regl: any, cmd: RawCommand<T>): CompiledReglCommand<T> {\n  const src = cmd(regl);\n  return typeof src === \"function\" ? src : regl(src);\n}\n\n// This is made available to every Command component as `this.context`.\n// It contains all the regl interaction code and is responsible for collecting and executing\n// draw calls, hitmap calls, and raycasting.\n\nexport class WorldviewContext {\n  _commands: Set<RawCommand<any>> = new Set();\n  _compiled: Map<Function, CompiledReglCommand<any>> = new Map();\n  _drawCalls: Map<React.Component<any>, DrawInput> = new Map();\n  _frame: ?AnimationFrameID;\n  _needsPaint = false;\n  _paintCalls: Map<PaintFn, PaintFn> = new Map();\n  _hitmapObjectIdManager: HitmapObjectIdManager = new HitmapObjectIdManager();\n  _cachedReadHitmapCall: ?{\n    arguments: any[],\n    result: Array<[MouseEventObject, Command<any>]>,\n  } = undefined;\n  // store every compiled command object compiled for debugging purposes\n  reglCommandObjects: { stats: { count: number } }[] = [];\n  counters: { paint?: number, render?: number } = {};\n  dimension: Dimensions;\n  onDirty: () => void;\n  cameraStore: CameraStore;\n  canvasBackgroundColor: Vec4 = [0, 0, 0, 1];\n  // group all initialized data together so it can be checked for existence to verify initialization is complete\n  initializedData: ?InitializedData;\n  contextAttributes: ?{ [string]: any };\n\n  constructor({\n    dimension,\n    canvasBackgroundColor,\n    cameraState,\n    onCameraStateChange,\n    contextAttributes,\n  }: ConstructorArgs) {\n    // used for children to call paint() directly\n    this.dimension = dimension;\n    this.canvasBackgroundColor = canvasBackgroundColor;\n    this.contextAttributes = contextAttributes;\n    this.cameraStore = new CameraStore((cameraState: CameraState) => {\n      if (onCameraStateChange) {\n        onCameraStateChange(cameraState);\n      } else {\n        // this must be called for Worldview with defaultCameraState prop\n        this.paint();\n      }\n    }, cameraState);\n  }\n\n  initialize(canvas: HTMLCanvasElement) {\n    if (this.initializedData) {\n      throw new Error(\"can not initialize regl twice\");\n    }\n\n    const regl = this._instrumentCommands(\n      createREGL({\n        canvas,\n        attributes: this.contextAttributes || {},\n        extensions: [\n          \"angle_instanced_arrays\",\n          \"oes_texture_float\",\n          \"oes_element_index_uint\",\n          \"oes_standard_derivatives\",\n        ],\n        profile: getNodeEnv() !== \"production\",\n      })\n    );\n\n    if (!regl) {\n      throw new Error(\"Cannot initialize regl\");\n    }\n\n    // compile any components which mounted before regl is initialized\n    this._commands.forEach((uncompiledCommand) => {\n      const compiledCommand = compile(regl, uncompiledCommand);\n      this._compiled.set(uncompiledCommand, compiledCommand);\n    });\n\n    const Camera = compile(regl, camera);\n    const compiledCameraCommand = new Camera();\n    // framebuffer object from regl context\n    const fbo = regl.framebuffer({\n      width: Math.round(this.dimension.width),\n      height: Math.round(this.dimension.height),\n    });\n\n    this.initializedData = {\n      _fbo: fbo,\n      camera: compiledCameraCommand,\n      regl,\n    };\n  }\n\n  destroy() {\n    if (this.initializedData) {\n      this.initializedData.regl.destroy();\n    }\n    if (this._frame) {\n      cancelAnimationFrame(this._frame);\n    }\n  }\n\n  // compile a command when it is first mounted, and try to register in _commands and _compiled maps\n  onMount(instance: React.Component<any>, command: RawCommand<any>) {\n    const { initializedData } = this;\n    // do nothing if regl hasn't been initialized yet\n    if (!initializedData || this._commands.has(command)) {\n      return;\n    }\n    this._commands.add(command);\n\n    // for components that mount after regl is initialized\n    this._compiled.set(command, compile(initializedData.regl, command));\n  }\n\n  // unregister children hitmap and draw calls\n  onUnmount(instance: React.Component<any>) {\n    this._drawCalls.delete(instance);\n  }\n\n  unregisterPaintCallback(paintFn: PaintFn) {\n    this._paintCalls.delete(paintFn);\n  }\n\n  registerDrawCall(drawInput: DrawInput) {\n    this._drawCalls.set(drawInput.instance, drawInput);\n  }\n\n  registerPaintCallback(paintFn: PaintFn) {\n    this._paintCalls.set(paintFn, paintFn);\n  }\n\n  setDimension(dimension: Dimensions) {\n    this.dimension = dimension;\n  }\n\n  raycast = (canvasX: number, canvasY: number) => {\n    if (!this.initializedData) {\n      return undefined;\n    }\n\n    const { width, height } = this.dimension;\n    return getRayFromClick(this.initializedData.camera, {\n      clientX: canvasX,\n      clientY: canvasY,\n      width,\n      height,\n    });\n  };\n\n  paint() {\n    try {\n      this._paint();\n    } catch (error) {\n      // Regl automatically tries to reconnect when losing the canvas 3d context.\n      // We should log this error, but it's not important to throw it.\n      if (error.message === \"(regl) context lost\") {\n        console.warn(error);\n      } else {\n        throw error;\n      }\n    }\n  }\n\n  _paint() {\n    this._needsPaint = false;\n    const start = Date.now();\n    this.reglCommandObjects.forEach((cmd) => (cmd.stats.count = 0));\n    if (!this.initializedData) {\n      return;\n    }\n    this._cachedReadHitmapCall = null; // clear the cache every time we paint\n    const { regl, camera } = this.initializedData;\n    this._clearCanvas(regl);\n    camera.draw(this.cameraStore.state, () => {\n      const x = Date.now();\n      this._drawInput();\n      this.counters.paint = Date.now() - x;\n    });\n\n    this._paintCalls.forEach((paintCall) => {\n      paintCall();\n    });\n    this.counters.render = Date.now() - start;\n    // More React state updates may have happened while we were painting, since paint happens\n    // outside the normal React render flow. If this is the case, we need to paint again.\n    if (this._needsPaint) {\n      this._frame = requestAnimationFrame(() => this.paint());\n    } else {\n      this._frame = undefined;\n    }\n  }\n\n  onDirty = () => {\n    if (undefined === this._frame) {\n      this._frame = requestAnimationFrame(() => this.paint());\n    } else {\n      this._needsPaint = true;\n    }\n  };\n\n  readHitmap = queuePromise(\n    (\n      canvasX: number,\n      canvasY: number,\n      enableStackedObjectEvents: boolean,\n      maxStackedObjectCount: number\n    ): Promise<Array<[MouseEventObject, Command<any>]>> => {\n      if (!this.initializedData) {\n        return Promise.reject(new Error(\"regl data not initialized yet\"));\n      }\n      const args = [canvasX, canvasY, enableStackedObjectEvents, maxStackedObjectCount];\n\n      const cachedReadHitmapCall = this._cachedReadHitmapCall;\n      if (cachedReadHitmapCall) {\n        if (shallowequal(cachedReadHitmapCall.arguments, args)) {\n          // Make sure that we aren't returning the exact object identity of the mouseEventObject - we don't know what\n          // callers have done with it.\n          const result = cachedReadHitmapCall.result.map(([mouseEventObject, command]) => [\n            { ...mouseEventObject },\n            command,\n          ]);\n          return Promise.resolve(result);\n        }\n        this._cachedReadHitmapCall = undefined;\n      }\n\n      const { regl, camera, _fbo } = this.initializedData;\n      const { width, height } = this.dimension;\n\n      const x = canvasX;\n      // 0,0 corresponds to the bottom left in the webgl context, but the top left in window coordinates\n      const y = height - canvasY;\n\n      // regl will only resize the framebuffer if the size changed\n      // it uses floored whole pixel values\n      _fbo.resize(Math.floor(width), Math.floor(height));\n\n      return new Promise((resolve) => {\n        // tell regl to use a framebuffer for this render\n        regl({ framebuffer: _fbo })(() => {\n          // clear the framebuffer\n          regl.clear({ color: intToRGB(0), depth: 1 });\n          let currentObjectId = 0;\n          const excludedObjects = [];\n          const mouseEventsWithCommands = [];\n          let counter = 0;\n\n          camera.draw(this.cameraStore.state, () => {\n            // Every iteration in this loop clears the framebuffer, draws the hitmap objects that have NOT already been\n            // seen to the framebuffer, and then reads the pixel under the cursor to find the object on top.\n            // If `enableStackedObjectEvents` is false, we only do this iteration once - we only resolve with 0 or 1\n            // objects.\n            do {\n              if (counter >= maxStackedObjectCount) {\n                // Provide a max number of layers so this while loop doesn't crash the page.\n                console.error(\n                  `Hit ${maxStackedObjectCount} iterations. There is either a bug or that number of rendered hitmap layers under the mouse cursor.`\n                );\n                break;\n              }\n              counter++;\n              regl.clear({ color: intToRGB(0), depth: 1 });\n              this._drawInput(true, excludedObjects);\n\n              // it's possible to get x/y values outside the framebuffer size\n              // if the mouse quickly leaves the draw area during a read operation\n              // reading outside the bounds of the framebuffer causes errors\n              // and puts regl into a bad internal state.\n              // https://github.com/regl-project/regl/blob/28fbf71c871498c608d9ec741d47e34d44af0eb5/lib/read.js#L57\n              if (x < Math.floor(width) && y < Math.floor(height) && x >= 0 && y >= 0) {\n                const pixel = new Uint8Array(4);\n\n                // read pixel value from the frame buffer\n                regl.read({\n                  x,\n                  y,\n                  width: 1,\n                  height: 1,\n                  data: pixel,\n                });\n\n                currentObjectId = getIdFromPixel(pixel);\n                const mouseEventObject = this._hitmapObjectIdManager.getObjectByObjectHitmapId(currentObjectId);\n\n                // Check an error case: if we see an ID/color that we don't know about, it means that some command is\n                // drawing a color into the hitmap that it shouldn't be.\n                if (currentObjectId > 0 && !mouseEventObject) {\n                  console.error(\n                    `Clicked on an unknown object with id ${currentObjectId}. This likely means that a command is painting an incorrect color into the hitmap.`\n                  );\n                }\n                // Check an error case: if we've already seen this object, then the getHitmapFromChildren function\n                // is not respecting the excludedObjects correctly and we should notify the user of a bug.\n                if (\n                  excludedObjects.some(\n                    ({ object, instanceIndex }) =>\n                      object === mouseEventObject.object && instanceIndex === mouseEventObject.instanceIndex\n                  )\n                ) {\n                  console.error(\n                    `Saw object twice when reading from hitmap. There is likely an error in getHitmapFromChildren`,\n                    mouseEventObject\n                  );\n                  break;\n                }\n\n                if (currentObjectId > 0 && mouseEventObject.object) {\n                  const command = this._hitmapObjectIdManager.getCommandForObject(mouseEventObject.object);\n                  excludedObjects.push(mouseEventObject);\n                  if (command) {\n                    mouseEventsWithCommands.push([mouseEventObject, command]);\n                  }\n                }\n              }\n              // If we haven't enabled stacked object events, break out of the loop immediately.\n              // eslint-disable-next-line no-unmodified-loop-condition\n            } while (currentObjectId !== 0 && enableStackedObjectEvents);\n\n            this._cachedReadHitmapCall = {\n              arguments: args,\n              result: mouseEventsWithCommands,\n            };\n            resolve(mouseEventsWithCommands);\n          });\n        });\n      });\n    }\n  );\n\n  _drawInput = (isHitmap?: boolean, excludedObjects?: MouseEventObject[]) => {\n    if (isHitmap) {\n      this._hitmapObjectIdManager = new HitmapObjectIdManager();\n    }\n\n    const drawCalls = Array.from(this._drawCalls.values()).sort((a, b) => (a.layerIndex || 0) - (b.layerIndex || 0));\n    drawCalls.forEach((drawInput: DrawInput) => {\n      const { reglCommand, children, instance, getChildrenForHitmap } = drawInput;\n      if (!children) {\n        return console.debug(`${isHitmap ? \"hitmap\" : \"\"} draw skipped, props was falsy`, drawInput);\n      }\n      const cmd = this._compiled.get(reglCommand);\n      if (!cmd) {\n        return console.warn(\"could not find draw command for\", instance ? instance.constructor.displayName : \"Unknown\");\n      }\n      // draw hitmap\n      if (isHitmap && getChildrenForHitmap) {\n        const assignNextColorsFn: AssignNextColorsFn = (...rest) => {\n          return this._hitmapObjectIdManager.assignNextColors(instance, ...rest);\n        };\n        const hitmapProps = getChildrenForHitmap(children, assignNextColorsFn, excludedObjects || []);\n        if (hitmapProps) {\n          cmd(hitmapProps, true);\n        }\n      } else if (!isHitmap) {\n        cmd(children, false);\n      }\n    });\n  };\n\n  _clearCanvas = (regl: any) => {\n    // Since we aren't using regl.frame and only rendering when we need to,\n    // we need to tell regl to update its internal state.\n    regl.poll();\n    regl.clear({\n      color: this.canvasBackgroundColor,\n      depth: 1,\n    });\n  };\n\n  _instrumentCommands(regl: any) {\n    if (getNodeEnv() === \"production\") {\n      return regl;\n    }\n    return new Proxy(regl, {\n      apply: (target, thisArg, args) => {\n        const command = target(...args);\n        if (typeof command.stats === \"object\") {\n          this.reglCommandObjects.push(command);\n        }\n        return command;\n      },\n    });\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport mapValues from \"lodash/mapValues\";\nimport pickBy from \"lodash/pickBy\";\nimport * as React from \"react\";\n\nimport { CameraListener, DEFAULT_CAMERA_STATE } from \"./camera/index\";\nimport Command from \"./commands/Command\";\nimport type {\n  MouseHandler,\n  Dimensions,\n  Vec4,\n  CameraState,\n  CameraKeyMap,\n  MouseEventEnum,\n  MouseEventObject,\n} from \"./types\";\nimport aggregate from \"./utils/aggregate\";\nimport { getNodeEnv } from \"./utils/common\";\nimport ContainerDimensions from \"./utils/Dimensions\";\nimport { Ray } from \"./utils/Raycast\";\nimport { WorldviewContext } from \"./WorldviewContext\";\nimport WorldviewReactContext from \"./WorldviewReactContext\";\n\nconst DEFAULT_BACKGROUND_COLOR = [0, 0, 0, 1];\nexport const DEFAULT_MOUSE_CLICK_RADIUS = 3;\nconst DEFAULT_MAX_NUMBER_OF_HITMAP_LAYERS = 100;\n\nexport type BaseProps = {|\n  keyMap?: CameraKeyMap,\n  shiftKeys: boolean,\n  backgroundColor?: Vec4,\n  // (Deprecated) rendering the hitmap on mouse move is expensive, so disable it by default\n  hitmapOnMouseMove?: boolean,\n  // Disable hitmap generation for specific mouse events\n  // For example, if you want to disable hitmap generating on drag, use: [\"onMouseDown\", \"onMouseMove\", \"onMouseUp\"]\n  disableHitmapForEvents?: MouseEventEnum[],\n  // getting events for objects stacked on top of each other is expensive, so disable it by default\n  enableStackedObjectEvents?: boolean,\n  // allow users to specify the max stacked object count\n  maxStackedObjectCount: number,\n  showDebug?: boolean,\n  children?: React.Node,\n  style: { [styleAttribute: string]: number | string },\n\n  cameraState?: $Shape<CameraState>,\n  onCameraStateChange?: (CameraState) => void,\n  defaultCameraState?: $Shape<CameraState>,\n  // interactions\n  onDoubleClick?: MouseHandler,\n  onMouseDown?: MouseHandler,\n  onMouseUp?: MouseHandler,\n  onMouseMove?: MouseHandler,\n  onClick?: MouseHandler,\n\n  // Used to scale the canvas resolution and provide a higher image quality\n  resolutionScale?: number,\n  ...Dimensions,\n\n  // Context attributes passed into canvas.getContext.\n  contextAttributes?: ?{ [string]: any },\n  canvas?: HTMLCanvasElement,\n|};\n\ntype State = {|\n  worldviewContext: WorldviewContext,\n|};\n\nfunction handleWorldviewMouseInteraction(\n  objects: MouseEventObject[],\n  ray: Ray,\n  e: SyntheticMouseEvent<HTMLCanvasElement>,\n  handler: MouseHandler\n) {\n  const args = { ray, objects };\n\n  try {\n    handler(e, args);\n  } catch (err) {\n    console.error(\"Error during mouse handler\", err);\n  }\n}\n\n// responsible for camera and scene state management\n// takes in children that declaritively define what should be rendered\nexport class WorldviewBase extends React.Component<BaseProps, State> {\n  _canvas: { current: HTMLCanvasElement | null } = React.createRef();\n  _cameraListener: { current: CameraListener | null } = React.createRef();\n  _tick: AnimationFrameID | void;\n  _dragStartPos: ?{ x: number, y: number } = null;\n\n  static defaultProps = {\n    maxStackedObjectCount: DEFAULT_MAX_NUMBER_OF_HITMAP_LAYERS,\n    backgroundColor: DEFAULT_BACKGROUND_COLOR,\n    shiftKeys: true,\n    style: {},\n    resolutionScale: 1,\n  };\n\n  constructor(props: BaseProps) {\n    super(props);\n    const {\n      width,\n      height,\n      top,\n      left,\n      backgroundColor,\n      onCameraStateChange,\n      cameraState,\n      defaultCameraState,\n      hitmapOnMouseMove,\n      disableHitmapForEvents,\n      canvas,\n    } = props;\n    if (canvas) {\n      this._canvas.current = canvas;\n    }\n    if (onCameraStateChange) {\n      if (!cameraState) {\n        console.warn(\n          \"You provided `onCameraStateChange` without `cameraState`. Use Worldview as a controlled component with `cameraState` and `onCameraStateChange`, or uncontrolled with `defaultCameraState`.\"\n        );\n      }\n      if (cameraState && defaultCameraState) {\n        console.warn(\"You provided both `cameraState` and `defaultCameraState`. `defaultCameraState` will be ignored.\");\n      }\n    } else {\n      if (cameraState) {\n        console.warn(\n          \"You provided `cameraState` without an `onCameraStateChange` handler. This will prevent moving the camera. If the camera should be movable, use `defaultCameraState`, otherwise set `onCameraStateChange`.\"\n        );\n      }\n    }\n\n    if (hitmapOnMouseMove) {\n      if (disableHitmapForEvents) {\n        throw new Error(\n          \"Property 'hitmapOnMouseMove' is deprectated and will be ignored when used along with 'disableHitmapForEvents'.\"\n        );\n      } else {\n        console.warn(\n          \"Property 'hitmapOnMouseMove' is deprectated. Please use 'disableHitmapForEvents' property instead.\"\n        );\n      }\n    }\n\n    this.state = {\n      worldviewContext: new WorldviewContext({\n        dimension: { width, height, top, left },\n        canvasBackgroundColor: backgroundColor || DEFAULT_BACKGROUND_COLOR,\n        // DEFAULT_CAMERA_STATE is applied if both `cameraState` and `defaultCameraState` are not present\n        cameraState: props.cameraState || props.defaultCameraState || DEFAULT_CAMERA_STATE,\n        onCameraStateChange: props.onCameraStateChange || undefined,\n        contextAttributes: props.contextAttributes || {},\n      }),\n    };\n  }\n\n  static getDerivedStateFromProps({ width, height, top, left }: BaseProps, { worldviewContext }: State) {\n    worldviewContext.setDimension({ width, height, top, left });\n    return null;\n  }\n\n  componentDidMount() {\n    if (!this._canvas.current) {\n      return console.warn(\"missing canvas element\");\n    }\n    const { worldviewContext } = this.state;\n    worldviewContext.initialize(this._canvas.current);\n    // trigger rendering in children that require camera to be present, e.g. Text component\n    this.setState({}); //eslint-disable-line\n    // call paint to set the correct viewportWidth and viewportHeight for camera so non-regl components\n    // such as Text can get the correct screen coordinates for the first render\n    worldviewContext.paint();\n  }\n\n  componentWillUnmount() {\n    if (this._tick) {\n      cancelAnimationFrame(this._tick);\n    }\n    this.state.worldviewContext.destroy();\n  }\n\n  componentDidUpdate() {\n    const { worldviewContext } = this.state;\n    // update internal cameraState\n    if (this.props.cameraState) {\n      worldviewContext.cameraStore.setCameraState(this.props.cameraState);\n    }\n    worldviewContext.onDirty();\n  }\n\n  focus() {\n    if (this._cameraListener.current) {\n      this._cameraListener.current.focus();\n    }\n  }\n\n  handleOffscreenMouseEvent = (e: SyntheticMouseEvent<HTMLCanvasElement>, mouseEventName: MouseEventEnum) => {\n    if (mouseEventName === \"onDoubleClick\") {\n      this._onDoubleClick(e, true);\n    } else if (mouseEventName === \"onMouseDown\") {\n      this._onMouseDown(e, true);\n    } else if (mouseEventName === \"onMouseMove\") {\n      this._onMouseMove(e, true);\n    } else if (mouseEventName === \"onMouseUp\") {\n      this._onMouseUp(e, true);\n    }\n  };\n\n  _onDoubleClick = (e: SyntheticMouseEvent<HTMLCanvasElement>, fromOffscreenTarget: boolean) => {\n    this._onMouseInteraction(e, \"onDoubleClick\", fromOffscreenTarget);\n  };\n\n  _onMouseDown = (e: SyntheticMouseEvent<HTMLCanvasElement>, fromOffscreenTarget: boolean) => {\n    this._dragStartPos = { x: e.clientX, y: e.clientY };\n    this._onMouseInteraction(e, \"onMouseDown\", fromOffscreenTarget);\n  };\n\n  _onMouseMove = (e: SyntheticMouseEvent<HTMLCanvasElement>, fromOffscreenTarget: boolean) => {\n    this._onMouseInteraction(e, \"onMouseMove\", fromOffscreenTarget);\n  };\n\n  _onMouseUp = (e: SyntheticMouseEvent<HTMLCanvasElement>, fromOffscreenTarget: boolean) => {\n    this._onMouseInteraction(e, \"onMouseUp\", fromOffscreenTarget);\n    const { _dragStartPos } = this;\n    if (_dragStartPos) {\n      const deltaX = e.clientX - _dragStartPos.x;\n      const deltaY = e.clientY - _dragStartPos.y;\n      const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n      if (distance < DEFAULT_MOUSE_CLICK_RADIUS) {\n        this._onMouseInteraction(e, \"onClick\", fromOffscreenTarget);\n      }\n      this._dragStartPos = null;\n    }\n  };\n\n  _onMouseInteraction = (\n    e: SyntheticMouseEvent<HTMLCanvasElement>,\n    mouseEventName: MouseEventEnum,\n    fromOffscreenTarget: boolean\n  ) => {\n    const { worldviewContext } = this.state;\n    const worldviewHandler = this.props[mouseEventName];\n\n    // When working with offscreen canvases, window is not defined and the target\n    // might not be a valid HTMLElement. If so, we can asume any event coming\n    // from an offscreen canvas already has a relevant target.\n    if (!fromOffscreenTarget && (!(e.target instanceof window.HTMLElement) || e.button !== 0)) {\n      return;\n    }\n\n    // $FlowFixMe: Because of `fromOffscreenTarget`, target might not be an actual HTMLElement instance but still needs to implement `getBoundingClientRect`\n    const { top: clientTop, left: clientLeft } = e.target.getBoundingClientRect();\n    const { clientX, clientY } = e;\n\n    const canvasX = clientX - clientLeft;\n    const canvasY = clientY - clientTop;\n    const ray = worldviewContext.raycast(canvasX, canvasY);\n    if (!ray) {\n      return;\n    }\n\n    // Rendering the hitmap is expensive, so we should disable it for some events.\n    // If 'disableHitmapForEvents' is provided, we ignore any events contained in that property.\n    // Otherwise, we ignore 'onMouseMove' events by default unless 'hitmapOnMouseMove' is 'true'\n    const { hitmapOnMouseMove, disableHitmapForEvents = hitmapOnMouseMove ? [] : [\"onMouseMove\"] } = this.props;\n    if (disableHitmapForEvents.includes(mouseEventName)) {\n      if (worldviewHandler) {\n        return handleWorldviewMouseInteraction([], ray, e, worldviewHandler);\n      }\n      return;\n    }\n\n    // reading hitmap is async so we need to persist the event to use later in the event handler\n    (e: any).persist();\n    worldviewContext\n      .readHitmap(canvasX, canvasY, !!this.props.enableStackedObjectEvents, this.props.maxStackedObjectCount)\n      .then((mouseEventsWithCommands) => {\n        const mouseEventsByCommand: Map<Command<any>, Array<MouseEventObject>> = aggregate(mouseEventsWithCommands);\n        for (const [command, mouseEvents] of mouseEventsByCommand.entries()) {\n          command.handleMouseEvent(mouseEvents, ray, e, mouseEventName);\n          if (e.isPropagationStopped()) {\n            break;\n          }\n        }\n        if (worldviewHandler && !e.isPropagationStopped()) {\n          const mouseEvents = mouseEventsWithCommands.map(([mouseEventObject]) => mouseEventObject);\n          handleWorldviewMouseInteraction(mouseEvents, ray, e, worldviewHandler);\n        }\n      })\n      .catch((e) => {\n        console.error(e);\n      });\n  };\n\n  _renderDebug() {\n    const { worldviewContext } = this.state;\n    const initializedData = worldviewContext.initializedData;\n\n    if (getNodeEnv() === \"production\" || !initializedData) {\n      return null;\n    }\n    const { regl } = initializedData;\n    const mem = window.performance.memory;\n    const style = {\n      bottom: 5,\n      right: 10,\n      width: 200,\n      position: \"absolute\",\n      backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n      color: \"white\",\n      fontFamily: \"monospace\",\n      fontSize: 10,\n    };\n    const { counters, reglCommandObjects } = worldviewContext;\n    const data = mapValues(counters, (val) => `${val} ms`);\n    data[\"draw calls\"] = reglCommandObjects.reduce((total, cmd) => total + cmd.stats.count, 0);\n    if (mem) {\n      data[\"heap used\"] = `${((mem.usedJSHeapSize / mem.jsHeapSizeLimit) * 100).toFixed(3)}%`;\n    }\n\n    Object.assign(data, pickBy(regl.stats, (val) => typeof val === \"number\" && val !== 0));\n    if (regl.stats.bufferCount > 1000) {\n      throw new Error(\"Memory leak: Buffer count > 1000.\");\n    }\n\n    const rows = Object.keys(data).map((key) => {\n      return (\n        <tr key={key} style={{ backgroundColor: \"transparent\", border: \"none\" }}>\n          <td style={{ paddingRight: 10, border: \"none\" }}>{key}</td>\n          <td style={{ width: \"100%\", border: \"none\" }}>{data[key]}</td>\n        </tr>\n      );\n    });\n    return (\n      <table style={style}>\n        <tbody>{rows}</tbody>\n      </table>\n    );\n  }\n\n  render() {\n    const {\n      width,\n      height,\n      showDebug,\n      keyMap,\n      shiftKeys,\n      style,\n      cameraState,\n      onCameraStateChange,\n      resolutionScale,\n      canvas,\n    } = this.props;\n    const { worldviewContext } = this.state;\n    // If we are supplied controlled camera state and no onCameraStateChange callback\n    // then there is a 'fixed' camera from outside of worldview itself.\n    const isFixedCamera = cameraState && !onCameraStateChange;\n    const canvasScale = resolutionScale || 1;\n    const canvasHtml = canvas ? null : (\n      <React.Fragment>\n        <canvas\n          style={{ width, height, maxWidth: \"100%\", maxHeight: \"100%\" }}\n          width={width * canvasScale}\n          height={height * canvasScale}\n          ref={this._canvas}\n          onMouseUp={this._onMouseUp}\n          onMouseDown={this._onMouseDown}\n          onDoubleClick={this._onDoubleClick}\n          onMouseMove={this._onMouseMove}\n        />\n        {showDebug && this._renderDebug()}\n      </React.Fragment>\n    );\n\n    return (\n      <div style={{ position: \"relative\", overflow: \"hidden\", ...style }}>\n        {/* skip rendering CameraListener if Worldview has a fixed camera */}\n        {isFixedCamera ? (\n          canvasHtml\n        ) : (\n          <CameraListener\n            cameraStore={worldviewContext.cameraStore}\n            keyMap={keyMap}\n            shiftKeys={shiftKeys}\n            ref={(el) => (this._cameraListener.current = el)}>\n            {canvasHtml}\n          </CameraListener>\n        )}\n        {worldviewContext.initializedData && (\n          <WorldviewReactContext.Provider value={worldviewContext}>\n            {this.props.children}\n          </WorldviewReactContext.Provider>\n        )}\n      </div>\n    );\n  }\n}\n\nexport type Props = $Diff<React.ElementConfig<typeof WorldviewBase>, Dimensions>;\n\nconst Worldview = React.forwardRef<Props, _>((props: Props, ref) => (\n  <ContainerDimensions>\n    {({ width, height, left, top }) => (\n      <WorldviewBase width={width} height={height} left={left} top={top} ref={ref} {...props} />\n    )}\n  </ContainerDimensions>\n));\n\nWorldview.displayName = \"Worldview\";\n\nexport default Worldview;\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// Takes an array of [value, key] and aggregates across the keys. Results in a Map of [key, values[]], in order of the\n// keys as seen in the array.\nexport default function aggregate<T, K>(array: Array<[T, K]>): Map<K, T[]> {\n  const aggregationMap = new Map<K, T[]>();\n  array.forEach(([item, key]) => {\n    const existingItems = aggregationMap.get(key) || [];\n    existingItems.push(item);\n    if (!aggregationMap.has(key)) {\n      aggregationMap.set(key, existingItems);\n    }\n  });\n  return aggregationMap;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Point } from \"../types\";\n\n// a single min/max value\nclass Bound {\n  min: number;\n  max: number;\n\n  constructor() {\n    this.min = Number.MAX_SAFE_INTEGER;\n    this.max = Number.MIN_SAFE_INTEGER;\n  }\n  // update the bound based on a value\n  update(value: number) {\n    this.min = Math.min(this.min, value);\n    this.max = Math.max(this.max, value);\n  }\n}\n\n// represents x, y, and z min & max bounds for a 3d scene\nexport default class Bounds {\n  x: Bound;\n  y: Bound;\n  z: Bound;\n\n  constructor() {\n    this.x = new Bound();\n    this.y = new Bound();\n    this.z = new Bound();\n  }\n\n  // update the bounds based on a point\n  update(point: Point) {\n    this.x.update(point.x);\n    this.y.update(point.y);\n    this.z.update(point.z);\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat3 } from \"gl-matrix\";\n\nimport type { Vec3, Vec4 } from \"../types\";\n\nconst scratch = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n\n// gl-matrix clone of three.js Euler.setFromQuaternion\n// assumes default XYZ order\nexport default function eulerFromQuaternion(out: number[], q: Vec4): Vec3 {\n  const m = mat3.fromQuat(scratch, q);\n  const m11 = m[0], m12 = m[3], m13 = m[6]; // prettier-ignore\n  const             m22 = m[4], m23 = m[7]; // prettier-ignore\n  const             m32 = m[5], m33 = m[8]; // prettier-ignore\n\n  out[1] = Math.asin(m13 < -1 ? -1 : m13 > 1 ? 1 : m13);\n  if (Math.abs(m13) < 0.99999) {\n    out[0] = Math.atan2(-m23, m33);\n    out[2] = Math.atan2(-m12, m11);\n  } else {\n    out[0] = Math.atan2(m32, m22);\n    out[2] = 0;\n  }\n  return (out: any);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { ReglCommand, Vec3 } from \"../types\";\nimport { withPose, pointToVec3, defaultBlend, defaultDepth, shouldConvert, colorBuffer } from \"./commandUtils\";\n\n// Creates a regl command factory which will render any geometry described by point positions\n// and elements (indexes into the array of positions), and apply the object's pose, scale, and color to it.\nexport default (positions: Vec3[], elements: Vec3[]) => (regl: any): ReglCommand => {\n  const vertexArray = Float32Array.from([].concat(...positions));\n\n  if (elements.some((face) => face.some((i) => i < 0 || i >= 1 << 16))) {\n    throw new Error(\"Element index out of bounds for Uint16\");\n  }\n  const elementsArray = Uint16Array.from([].concat(...elements));\n\n  const buff = regl.buffer({\n    // tell the gpu this buffer's contents will change frequently\n    usage: \"dynamic\",\n    data: [],\n  });\n  const colorBuff = colorBuffer(regl);\n\n  return withPose({\n    vert: `\n    precision mediump float;\n    attribute vec3 point;\n    attribute vec3 offset;\n    attribute vec4 color;\n    uniform mat4 projection, view;\n    uniform vec3 scale;\n    varying vec4 vColor;\n\n    #WITH_POSE\n\n    void main () {\n      vec3 p = applyPose(scale * point + offset);\n      vColor = color;\n      gl_Position = projection * view * vec4(p, 1);\n    }\n    `,\n    frag: `\n    precision mediump float;\n    varying vec4 vColor;\n    void main () {\n      gl_FragColor = vColor;\n    }`,\n\n    attributes: {\n      point: vertexArray,\n      color: (context, props) => {\n        return colorBuff(props.color, props.colors, props.points ? props.points.length : 1);\n      },\n\n      offset: (context, props) => {\n        const points = shouldConvert(props.points) ? props.points.map(pointToVec3) : props.points || [0, 0, 0];\n        return {\n          buffer: buff({\n            usage: \"dynamic\",\n            data: points,\n          }),\n          divisor: 1,\n        };\n      },\n    },\n\n    elements: elementsArray,\n\n    depth: defaultDepth,\n    blend: defaultBlend,\n\n    uniforms: {\n      scale: (context, props) => (shouldConvert(props.scale) ? pointToVec3(props.scale) : props.scale),\n    },\n\n    count: elementsArray.length,\n\n    instances: (context, props) => (props.points ? props.points.length : 1),\n  });\n};\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport draco3d from \"draco3d\";\n\nconst decodeGeometry = (draco, decoder, json, binary, dracoCompression) => {\n  const { bufferView: bufferViewIndex } = dracoCompression;\n  const bufferView = json.bufferViews[bufferViewIndex];\n  const buffer = new draco.DecoderBuffer();\n  const data = new Int8Array(binary.buffer, binary.byteOffset + (bufferView.byteOffset || 0), bufferView.byteLength);\n  buffer.Init(data, bufferView.byteLength);\n  const geometryType = decoder.GetEncodedGeometryType(buffer);\n\n  let dracoGeometry;\n  let status;\n  if (geometryType === draco.TRIANGULAR_MESH) {\n    dracoGeometry = new draco.Mesh();\n    status = decoder.DecodeBufferToMesh(buffer, dracoGeometry);\n  } else if (geometryType === draco.POINT_CLOUD) {\n    dracoGeometry = new draco.PointCloud();\n    status = decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\n  } else {\n    const errorMsg = \"Error: Unknown geometry type.\";\n    console.error(errorMsg);\n  }\n\n  if (!status || !dracoGeometry || !status.ok() || dracoGeometry?.ptr === 0) {\n    throw new Error(`Decoding failed: ${status ? status.error_msg() : \"unknown error\"}`);\n  }\n\n  draco.destroy(buffer);\n\n  return dracoGeometry;\n};\n\nconst decodeAttributes = (draco, decoder, dracoGeometry, attributes) => {\n  const accessors = [];\n  for (const attributeName in attributes) {\n    const attributeId = attributes[attributeName];\n    const attribute = decoder.GetAttributeByUniqueId(dracoGeometry, attributeId);\n\n    const numComponents = attribute.num_components();\n    const numPoints = dracoGeometry.num_points();\n    const numValues = numPoints * numComponents;\n    const attributeType = Float32Array;\n    const byteLength = numValues * attributeType.BYTES_PER_ELEMENT;\n    const dataType = draco.DT_FLOAT32;\n\n    // eslint-disable-next-line no-underscore-dangle\n    const ptr = draco._malloc(byteLength);\n\n    decoder.GetAttributeDataArrayForAllPoints(dracoGeometry, attribute, dataType, byteLength, ptr);\n    const array = new attributeType(draco.HEAPF32.buffer, ptr, numValues).slice();\n\n    // eslint-disable-next-line no-underscore-dangle\n    draco._free(ptr);\n\n    accessors.push(array);\n  }\n  return accessors;\n};\n\nconst decodeIndices = (draco, decoder, dracoGeometry) => {\n  const numFaces = dracoGeometry.num_faces();\n  const numIndices = numFaces * 3;\n  const byteLength = numIndices * 4;\n\n  // eslint-disable-next-line no-underscore-dangle\n  const ptr = draco._malloc(byteLength);\n\n  decoder.GetTrianglesUInt32Array(dracoGeometry, byteLength, ptr);\n  const indices = new Uint32Array(draco.HEAPF32.buffer, ptr, numIndices).slice();\n\n  // eslint-disable-next-line no-underscore-dangle\n  draco._free(ptr);\n\n  return indices;\n};\n\nconst decodePrimitive = (draco, decoder, json, binary, primitive) => {\n  const { extensions = {} } = primitive;\n  const dracoCompression = extensions.KHR_draco_mesh_compression;\n  if (!dracoCompression) {\n    return;\n  }\n\n  const dracoGeometry = decodeGeometry(draco, decoder, json, binary, dracoCompression);\n\n  dracoCompression.accessors = [];\n\n  const { attributes } = dracoCompression;\n  dracoCompression.accessors.push(...decodeAttributes(draco, decoder, dracoGeometry, attributes));\n\n  dracoCompression.accessors.push(decodeIndices(draco, decoder, dracoGeometry));\n\n  draco.destroy(dracoGeometry);\n};\n\nasync function createDracoModule(): any {\n  // npm does not work correctly when we try to use `import` to fetch the wasm module,\n  // so we need to use `require` here instead. In any case, `draco3dWasm` does not\n  // hold the actual wasm module, but the path to it, which we use in the `locateFile`\n  // function below.\n  const draco3dWasm = require(\"draco3d/draco_decoder.wasm\");\n  return draco3d.createDecoderModule({\n    locateFile: () => {\n      return draco3dWasm;\n    },\n  });\n}\n\nexport default async function decodeCompressedGLB(json: any, binary: DataView) {\n  const { extensionsRequired = [] } = json;\n  if (!extensionsRequired.includes(\"KHR_draco_mesh_compression\")) {\n    // this model does not uses Draco compression\n    return;\n  }\n\n  const draco = await createDracoModule();\n  const decoder = new draco.Decoder();\n\n  json.meshes.forEach((mesh) => {\n    mesh.primitives.forEach((primitive) => {\n      decodePrimitive(draco, decoder, json, binary, primitive);\n    });\n  });\n\n  draco.destroy(decoder);\n}\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport decodeCompressedGLB from \"./draco\";\n\ntype TypedArray = Int8Array | Uint8Array | Int16Array | Uint16Array | Uint32Array | Float32Array;\n\nexport type GLBModel = {\n  json: Object,\n  accessors?: TypedArray[],\n  images?: ImageBitmap[],\n};\n\n// Parse a GLB file: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0\n//\n// Returns an object containing the raw json data as well as parsed images (Image) and\n// accessors (TypedArray).\nexport default async function parseGLB(arrayBuffer: ArrayBuffer): Promise<GLBModel> {\n  const data = new DataView(arrayBuffer);\n  let offset = 0;\n\n  function readUint32() {\n    const value = data.getUint32(offset, true);\n    offset += 4;\n    return value;\n  }\n\n  // magic header\n  const magic = readUint32();\n  if (magic !== 0x46546c67) {\n    throw new Error(`incorrect magic value 0x${magic.toString(16)}`);\n  }\n\n  // Binary glTF version\n  const version = readUint32();\n  if (version !== 2) {\n    throw new Error(`incorrect version ${version}`);\n  }\n\n  // total file length\n  const totalLength = readUint32();\n  if (totalLength !== data.byteLength) {\n    throw new Error(`length ${totalLength} doesn't match response length ${data.byteLength}`);\n  }\n\n  function findNextChunkOfType(type) {\n    do {\n      const chunkLength = readUint32();\n      const chunkType = readUint32();\n      if (chunkType === type) {\n        const chunkData = new DataView(data.buffer, offset, chunkLength);\n        offset += chunkLength;\n        return chunkData;\n      }\n      offset += chunkLength;\n    } while (offset < totalLength);\n  }\n\n  const jsonData = findNextChunkOfType(/* JSON */ 0x4e4f534a);\n  if (!jsonData) {\n    throw new Error(\"no JSON chunk found\");\n  }\n\n  const json = JSON.parse(new TextDecoder().decode(jsonData));\n\n  const binary = findNextChunkOfType(/* BIN */ 0x004e4942);\n  if (!binary) {\n    return { json };\n  }\n\n  if (json.buffers[0].uri !== undefined) {\n    throw new Error(\"expected GLB-stored buffer\");\n  }\n\n  // create a TypedArray for each accessor\n  const accessors = json.accessors.map((accessorInfo) => {\n    if (accessorInfo.bufferView == null) {\n      // This accessor has no associated bufferView, which happens when the mesh\n      // contains compressed data. This is not an error, though. So, we return\n      // null and let the mesh handles data access later.\n      return null;\n    }\n\n    let arrayType;\n    // prettier-ignore\n    switch (accessorInfo.componentType) {\n      case WebGLRenderingContext.BYTE: arrayType = Int8Array; break;\n      case WebGLRenderingContext.UNSIGNED_BYTE: arrayType = Uint8Array; break;\n      case WebGLRenderingContext.SHORT: arrayType = Int16Array; break;\n      case WebGLRenderingContext.UNSIGNED_SHORT: arrayType = Uint16Array; break;\n      case WebGLRenderingContext.UNSIGNED_INT: arrayType = Uint32Array; break;\n      case WebGLRenderingContext.FLOAT: arrayType = Float32Array; break;\n      default:\n        throw new Error(`unrecognized componentType ${accessorInfo.componentType}`);\n    }\n    let numComponents;\n    // prettier-ignore\n    switch (accessorInfo.type) {\n      case \"SCALAR\": numComponents = 1; break;\n      case \"VEC2\": numComponents = 2; break;\n      case \"VEC3\": numComponents = 3; break;\n      case \"VEC4\": numComponents = 4; break;\n      case \"MAT2\": numComponents = 4; break;\n      case \"MAT3\": numComponents = 9; break;\n      case \"MAT4\": numComponents = 16; break;\n      default:\n        throw new Error(`unrecognized type ${accessorInfo.type}`);\n    }\n    const bufferView = json.bufferViews[accessorInfo.bufferView];\n    if (bufferView.buffer !== 0) {\n      throw new Error(\"only GLB-stored buffers are supported\");\n    }\n    if (bufferView.byteLength % arrayType.BYTES_PER_ELEMENT !== 0) {\n      throw new Error(\"bufferView.byteLength mismatch\");\n    }\n    return new arrayType(\n      binary.buffer,\n      binary.byteOffset + (bufferView.byteOffset || 0) + (accessorInfo.byteOffset || 0),\n      accessorInfo.count * numComponents\n    );\n  });\n\n  await decodeCompressedGLB(json, binary);\n\n  // load embedded images\n  const images =\n    json.images &&\n    (await Promise.all(\n      json.images.map((imgInfo) => {\n        const bufferView = json.bufferViews[imgInfo.bufferView];\n        const data = new DataView(binary.buffer, binary.byteOffset + bufferView.byteOffset, bufferView.byteLength);\n        return self.createImageBitmap(new Blob([data], { type: imgInfo.mimeType }));\n      })\n    ));\n\n  return { json, accessors, images };\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { AssignNextColorsFn, MouseEventObject } from \"../types\";\n\nfunction nonInstancedGetChildrenForHitmapFromSingleProp<T: any>(\n  prop: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[],\n  useOriginalMarkerProp: boolean = false\n): ?T {\n  // The marker that we send to event callbacks.\n  const eventCallbackMarker = useOriginalMarkerProp ? prop.originalMarker : prop;\n  if (excludedObjects.some(({ object }) => object === eventCallbackMarker)) {\n    return null;\n  }\n  const hitmapProp = { ...prop };\n  const [hitmapColor] = assignNextColors(eventCallbackMarker, 1);\n  hitmapProp.color = hitmapColor;\n  if (hitmapProp.colors && hitmapProp.points && hitmapProp.points.length) {\n    hitmapProp.colors = new Array(hitmapProp.points.length).fill(hitmapColor);\n  }\n  return hitmapProp;\n}\n\nexport const nonInstancedGetChildrenForHitmap = <T: any>(\n  props: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[]\n): ?T => {\n  if (Array.isArray(props)) {\n    return props\n      .map((prop) => nonInstancedGetChildrenForHitmapFromSingleProp(prop, assignNextColors, excludedObjects))\n      .filter(Boolean);\n  }\n  return nonInstancedGetChildrenForHitmapFromSingleProp(props, assignNextColors, excludedObjects);\n};\n\n// Almost identical to nonInstancedGetChildrenForHitmap, but instead the object passed to event callbacks is the object\n// at `prop.originalMarker`, not just `prop`.\nexport const getChildrenForHitmapWithOriginalMarker = <T: any>(\n  props: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[]\n) => {\n  if (Array.isArray(props)) {\n    return props\n      .map((prop) => nonInstancedGetChildrenForHitmapFromSingleProp(prop, assignNextColors, excludedObjects, true))\n      .filter(Boolean);\n  }\n  return nonInstancedGetChildrenForHitmapFromSingleProp(props, assignNextColors, excludedObjects, true);\n};\n\nfunction instancedGetChildrenForHitmapFromSingleProp<T: any>(\n  prop: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[],\n  pointCountPerInstance\n): ?T {\n  const matchedExcludedObjects = excludedObjects.filter(({ object, instanceIndex }) => object === prop);\n  const filteredIndices = matchedExcludedObjects\n    .map(({ object, instanceIndex }) => instanceIndex)\n    .filter((instanceIndex) => typeof instanceIndex === \"number\");\n  const hitmapProp = { ...prop };\n  const instanceCount = (hitmapProp.points && Math.ceil(hitmapProp.points.length / pointCountPerInstance)) || 1;\n  // This returns 1 color per instance.\n  const idColors = assignNextColors(prop, instanceCount);\n  const startColor = idColors[0];\n  // We have to map these instance colors to `pointCountPerInstance` number of points\n  if (hitmapProp.points && hitmapProp.points.length) {\n    const allColors = new Array(hitmapProp.points.length).fill().map(() => startColor);\n    for (let i = 0; i < instanceCount; i++) {\n      for (let j = 0; j < pointCountPerInstance; j++) {\n        const idx = i * pointCountPerInstance + j;\n        if (idx < allColors.length) {\n          allColors[idx] = idColors[i];\n        }\n      }\n    }\n    hitmapProp.colors = allColors;\n    if (filteredIndices.length) {\n      hitmapProp.points = hitmapProp.points.filter(\n        (_, index) => !filteredIndices.includes(Math.floor(index / pointCountPerInstance))\n      );\n      hitmapProp.colors = hitmapProp.colors.filter(\n        (_, index) => !filteredIndices.includes(Math.floor(index / pointCountPerInstance))\n      );\n    } else if (matchedExcludedObjects.length) {\n      // if we don't have instance indices, just filter out the whole object.\n      return null;\n    }\n  } else {\n    hitmapProp.color = startColor;\n    if (matchedExcludedObjects.length) {\n      return null;\n    }\n  }\n  return hitmapProp;\n}\n\nexport const createInstancedGetChildrenForHitmap = (pointCountPerInstance: number) => <T: any>(\n  props: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[]\n): ?T => {\n  if (Array.isArray(props)) {\n    return props\n      .map((prop) =>\n        instancedGetChildrenForHitmapFromSingleProp(prop, assignNextColors, excludedObjects, pointCountPerInstance)\n      )\n      .filter(Boolean);\n  }\n  return instancedGetChildrenForHitmapFromSingleProp(props, assignNextColors, excludedObjects, pointCountPerInstance);\n};\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport memoize from \"lodash/memoize\";\n\nimport type { DepthState, BlendState } from \"../types\";\nimport { defaultReglDepth, defaultReglBlend } from \"./commandUtils\";\n\nconst withRenderStateOverrides = (command: any) => (regl: any) => {\n  // Generate the render command once\n  const reglCommand = command(regl);\n\n  // Use memoization to avoid generating multiple render commands for the same render states\n  // for the same render states\n  const memoizedRender = memoize(\n    (props: { depth: DepthState, blend: BlendState }) => {\n      const { depth, blend } = props;\n      return regl({ ...reglCommand, depth, blend });\n    },\n    (...args) => JSON.stringify(args)\n  );\n\n  const renderElement = (props) => {\n    // Get curstom render states from the given marker. Some commands, like <Arrows />\n    // will use the originalMarker property instead. If no custom render states\n    // are present, use either the ones provided in the command or the default ones. We do\n    // need to provide valid objects in order to make sure the hitmap works correctly.\n    const depth = props.depth || props.originalMarker?.depth || reglCommand.depth || defaultReglDepth;\n    const blend = props.blend || props.originalMarker?.blend || reglCommand.blend || defaultReglBlend;\n    memoizedRender({ depth, blend })(props);\n  };\n\n  return (props: any) => {\n    if (Array.isArray(props)) {\n      props.forEach(renderElement);\n    } else {\n      renderElement(props);\n    }\n  };\n};\n\nexport default withRenderStateOverrides;\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Cylinder } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport withRenderStateOverrides from \"../utils/withRenderStateOverrides\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nexport function createCylinderGeometry(numSegments: number, cone: boolean) {\n  // \"poles\" are the centers of top/bottom faces\n  const northPole = [0, 0, 0.5];\n  const southPole = [0, 0, -0.5];\n\n  const points = [northPole, southPole];\n\n  // Keep side faces separate from top/bottom to improve appearance for semi-transparent colors.\n  // We don't have a good approach to transparency right now but this is a small improvement over mixing the faces.\n  const sideFaces = [];\n  const endCapFaces = [];\n\n  for (let i = 0; i < numSegments; i++) {\n    const theta = (2 * Math.PI * i) / numSegments;\n    const x = 0.5 * Math.cos(theta);\n    const y = 0.5 * Math.sin(theta);\n    points.push([x, y, 0.5], [x, y, -0.5]);\n\n    const bottomLeftPt = points.length - 1;\n    const topRightPt = cone ? 0 : i + 1 === numSegments ? 2 : points.length;\n    const bottomRightPt = i + 1 === numSegments ? 3 : points.length + 1;\n    sideFaces.push([bottomLeftPt, topRightPt, bottomRightPt]);\n    endCapFaces.push([bottomLeftPt, bottomRightPt, 1]);\n    if (!cone) {\n      const topLeftPt = points.length - 2;\n      sideFaces.push([topLeftPt, bottomLeftPt, topRightPt]);\n      endCapFaces.push([topLeftPt, topRightPt, 0]);\n    }\n  }\n  return { points, sideFaces, endCapFaces };\n}\n\nconst { points, sideFaces, endCapFaces } = createCylinderGeometry(30, false);\n\nexport const cylinders = withRenderStateOverrides(fromGeometry(points, sideFaces.concat(endCapFaces)));\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Cylinders(props: { ...CommonCommandProps, children: Cylinder[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={cylinders} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Cone } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport withRenderStateOverrides from \"../utils/withRenderStateOverrides\";\nimport Command, { type CommonCommandProps } from \"./Command\";\nimport { createCylinderGeometry } from \"./Cylinders\";\n\nconst { points, sideFaces, endCapFaces } = createCylinderGeometry(30, true);\n\nexport const cones = withRenderStateOverrides(fromGeometry(points, sideFaces.concat(endCapFaces)));\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Cones(props: { ...CommonCommandProps, children: Cone[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={cones} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat } from \"gl-matrix\";\nimport omit from \"lodash/omit\";\nimport React, { memo, Fragment } from \"react\";\n\nimport type { Arrow } from \"../types\";\nimport { pointToVec3, vec3ToPoint, orientationToVec4, vec4ToOrientation } from \"../utils/commandUtils\";\nimport { getChildrenForHitmapWithOriginalMarker } from \"../utils/getChildrenForHitmapDefaults\";\nimport type { CommonCommandProps } from \"./Command\";\nimport Cones, { cones } from \"./Cones\";\nimport Cylinders, { cylinders } from \"./Cylinders\";\n\nconst UNIT_X_VECTOR = Object.freeze([0, 0, 1]);\n\ntype Props = {\n  ...CommonCommandProps,\n  children: Arrow[],\n};\n\nconst generateArrowPrimitives = (markers: Arrow[]) => {\n  const cylinders = [];\n  const cones = [];\n\n  for (const marker of markers) {\n    let shaftWidthX;\n    let shaftWidthY;\n    let shaftLength;\n    let headWidthX;\n    let headWidthY;\n    let headLength;\n\n    let basePosition;\n    let orientation;\n    let dir;\n    if (marker.points && marker.points.length === 2) {\n      const [start, end] = marker.points;\n      basePosition = [start.x, start.y, start.z];\n      const tipPosition = [end.x, end.y, end.z];\n      const length = vec3.distance(basePosition, tipPosition);\n\n      dir = vec3.subtract([0, 0, 0], tipPosition, basePosition);\n      vec3.normalize(dir, dir);\n      orientation = quat.rotationTo([0, 0, 0, 0], UNIT_X_VECTOR, dir);\n\n      headWidthX = headWidthY = marker.scale.y;\n      headLength = marker.scale.z || length * 0.3;\n      shaftWidthX = shaftWidthY = marker.scale.x;\n      shaftLength = length - headLength;\n    } else {\n      basePosition = pointToVec3(marker.pose.position);\n      orientation = orientationToVec4(marker.pose.orientation);\n      quat.rotateY(orientation, orientation, Math.PI / 2);\n      dir = vec3.transformQuat([0, 0, 0], UNIT_X_VECTOR, orientation);\n\n      shaftWidthX = marker.scale.y || 1;\n      shaftWidthY = marker.scale.z || 1;\n      headWidthX = 2 * shaftWidthX;\n      headWidthY = 2 * shaftWidthY;\n\n      // these magic numbers taken from\n      // https://github.com/ros-visualization/rviz/blob/57325fa075893de70f234f4676cdd08b411858ff/src/rviz/default_plugin/markers/arrow_marker.cpp#L113\n      headLength = 0.23 * (marker.scale.x || 1);\n      shaftLength = 0.77 * (marker.scale.x || 1);\n    }\n\n    const shaftPosition = vec3.scaleAndAdd([0, 0, 0], basePosition, dir, shaftLength / 2);\n    const headPosition = vec3.scaleAndAdd([0, 0, 0], basePosition, dir, shaftLength + headLength / 2);\n\n    cylinders.push({\n      // Set the original marker so we can use it in mouse events\n      originalMarker: marker,\n      scale: { x: shaftWidthX, y: shaftWidthY, z: shaftLength },\n      color: marker.color,\n      pose: {\n        position: vec3ToPoint(shaftPosition),\n        orientation: vec4ToOrientation(orientation),\n      },\n    });\n    cones.push({\n      // Set the original marker so we can use it in mouse events\n      originalMarker: marker,\n      scale: { x: headWidthX, y: headWidthY, z: headLength },\n      color: marker.color,\n      pose: {\n        position: vec3ToPoint(headPosition),\n        orientation: vec4ToOrientation(orientation),\n      },\n    });\n  }\n\n  return {\n    cones,\n    cylinders,\n  };\n};\n\nexport const makeArrowsCommand = () => (regl: any) => {\n  const cylindersCommand = cylinders(regl);\n  const conesCommand = cones(regl);\n  return (props: any) => {\n    const { cylinders: cylinderPrimitives, cones: conePrimitives } = generateArrowPrimitives(props);\n    cylindersCommand(cylinderPrimitives);\n    conesCommand(conePrimitives);\n  };\n};\n\nfunction Arrows(props: Props) {\n  const passedProps = omit(props, \"children\");\n  const { cylinders, cones } = generateArrowPrimitives(props.children);\n  return (\n    <Fragment>\n      <Cylinders getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker} {...passedProps}>\n        {cylinders}\n      </Cylinders>\n      <Cones getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker} {...passedProps}>\n        {cones}\n      </Cones>\n    </Fragment>\n  );\n}\n\nexport default memo<Props>(Arrows);\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport flatten from \"lodash/flatten\";\nimport memoize from \"lodash/memoize\";\nimport * as React from \"react\";\n\nimport type { Line, Vec4, Color, Pose, DepthState, BlendState } from \"../types\";\nimport {\n  defaultBlend,\n  withPose,\n  toRGBA,\n  shouldConvert,\n  pointToVec3,\n  defaultReglDepth,\n  defaultReglBlend,\n} from \"../utils/commandUtils\";\nimport { nonInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\n/*\nTriangle-based line drawing.\n\n4 points (a strip of 2 triangles) are drawn for each segment of the line using instanced arrays.\nEach of the 4 points has a distinct \"point type\" which informs how the input point is offset to\nyield the vertices of the triangle.\n\nPassing the input point as an attribute with {divisor: 1} tells GL to use each point for 1 instance,\nthen move on to the next point -- something like `points.map((p) => draw2Triangles(p))`.\n\n4 attributes are used so the vertex shader can see 4 input points at once (reading from the same\nbuffer with different offsets). This is because the positions of the TL/BL endpoints depend on the\nangle ABC, and the positions of TR/BR depend on the angle BCD.\n\nRoughly the segment looks like:\n\n     TL   -   -   -  .TR\n      |          ,.-' |\nA - - B - - -,.-' - - C - - D\n      |  ,.-'         |\n     BL-' -   -   -   BR\n\nWhen two adjacent segments form an obtuse angle, we draw a miter join:\n\n                      TR/TL.\n                 , '   _/|   ' .\n             , '     _/  |       ' .\n         , '       _/    C           ' .\n     , '         _/      |               ' .\n   TL          _/        |        ______,----'TR\n    \\        _/       ,BR/BL.----'            /\n     B     _/    , '          ' .            D\n      \\  _/ , '                   ' .       /\n       BL'                            ' . BR\n\nBut when the angle gets too sharp, we switch to a \"fold\" join, where the two segments overlap at\nthe corner:\n\n        ,TR/BL---C--BR/TL\n       ,    |.\\__  ,     .\n      ,     | .  \\,_      .\n     ,      |  . ,  \\_     .\n    ,       |   ,     \\__   .\n   ,        |  , .       \\__ .\n  TL._      | ,   .        _.TR\n      'B._  |,     .   _.C'\n          'BL       BR'\n\n(A regular bevel join without any overlaps is harder to achieve without artifacts in the sharp-angle\nedge cases.)\n\n*/\n\nconst FLOAT_BYTES = Float32Array.BYTES_PER_ELEMENT;\nconst POINT_BYTES = 3 * FLOAT_BYTES;\nconst DEFAULT_MONOCHROME_COLOR = [1, 1, 1, 0.2];\n\n// The four points forming the triangles' vertices.\n// Values do not matter, they just need to be distinct.\nconst POINT_TYPES = { BL: 0, TR: 1, BR: 2, TL: 3 };\nconst VERTICES_PER_INSTANCE = Object.keys(POINT_TYPES).length;\n\nconst vert = `\nprecision mediump float;\n\nattribute float pointType;\n\n// per-instance attributes\nattribute vec4 colorB;\nattribute vec4 colorC;\nattribute vec3 positionA;\nattribute vec3 positionB;\nattribute vec3 positionC;\nattribute vec3 positionD;\n// per-instance pose attributes\nattribute vec3 posePosition;\nattribute vec4 poseRotation;\n\nuniform mat4 projection, view;\nuniform float viewportWidth;\nuniform float viewportHeight;\nuniform float alpha;\nuniform float thickness;\nuniform bool joined;\nuniform bool scaleInvariant;\n\nvarying vec4 vColor;\n\n${Object.keys(POINT_TYPES)\n  .map((k) => `const float POINT_${k} = ${POINT_TYPES[k]}.0;`)\n  .join(\"\\n\")}\n\n#WITH_POSE\n\nvec3 applyPoseInstance(vec3 point, vec4 rotation, vec3 position) {\n  // rotate the point and then add the position of the pose\n  // this function is defined in WITH_POSE\n  return rotate(point, rotation) + position;\n}\n\nvec2 rotateCCW(vec2 v) {\n  return vec2(-v.y, v.x);\n}\n\nvec2 normalizeOrZero(vec2 v) {\n  return length(v) < 0.00001 ? vec2(0, 0) : normalize(v);\n}\n\nvoid setPosition(vec4 proj, vec2 offset) {\n  gl_Position = proj;\n\n  offset *= thickness / 2.;\n\n  if (scaleInvariant) {\n    // The given thickness is a number of pixels on screen. Divide x by width/2 and\n    // y by height/2 so that they correspond to pixel distances when scaled from clip space to NDC.\n    offset.x /= viewportWidth / 2.0;\n    offset.y /= viewportHeight / 2.0;\n    // Compensate for automatic division by w\n    offset *= proj.w;\n  } else {\n    // The line thickness should be scaled the same way the camera scales other distances.\n    // projection[0].xyz is the result of projecting a unit x-vector, so its length represents\n    // how much distances are scaled by the camera projection.\n    offset *= length(projection[0].xyz);\n    offset.y *= viewportWidth / viewportHeight;\n  }\n\n  gl_Position.xy += offset;\n}\n\nvoid main () {\n  bool isStart = positionA == positionB;\n  bool isEnd = positionC == positionD;\n  bool isLeft = (pointType == POINT_TL || pointType == POINT_BL);\n  bool isTop = (pointType == POINT_TL || pointType == POINT_TR);\n  bool isEndpoint = isLeft ? isStart : isEnd;\n\n  float scale = isTop ? 1. : -1.;\n\n  mat4 projView = projection * view;\n  vec4 projA = projView * vec4(applyPose(applyPoseInstance(positionA, poseRotation, posePosition)), 1);\n  vec4 projB = projView * vec4(applyPose(applyPoseInstance(positionB, poseRotation, posePosition)), 1);\n  vec4 projC = projView * vec4(applyPose(applyPoseInstance(positionC, poseRotation, posePosition)), 1);\n  vec4 projD = projView * vec4(applyPose(applyPoseInstance(positionD, poseRotation, posePosition)), 1);\n\n  vec2 aspectVec = vec2(viewportWidth / viewportHeight, 1.0);\n  vec2 screenA = projA.xy / projA.w * aspectVec;\n  vec2 screenB = projB.xy / projB.w * aspectVec;\n  vec2 screenC = projC.xy / projC.w * aspectVec;\n  vec2 screenD = projD.xy / projD.w * aspectVec;\n\n  vec2 dirAB = normalizeOrZero(screenB - screenA);\n  vec2 dirBC = normalizeOrZero(screenC - screenB);\n  vec2 dirCD = normalizeOrZero(screenD - screenC);\n\n  vec2 perpAB = rotateCCW(dirAB); // vector perpendicular to AB\n  vec2 perpBC = rotateCCW(dirBC); // vector perpendicular to BC\n\n  vColor = isLeft ? colorB : colorC;\n  vColor.a *= alpha;\n\n  vec4 proj = isLeft ? projB : projC;\n\n  // simple case: non-joined line list\n  if (!joined || isEndpoint) {\n    setPosition(proj, scale * perpBC);\n    return;\n  }\n\n  // clamp to prevent rounding errors from breaking the sqrt()s below\n  float cosB = clamp(-dot(dirAB, dirBC), -1., 1.);\n  float cosC = clamp(-dot(dirBC, dirCD), -1., 1.);\n\n  bool tooSharpB = cosB > 0.01;\n  bool tooSharpC = cosC > 0.01;\n  bool tooSharp = isLeft ? tooSharpB : tooSharpC;\n\n  bool turningRightB = dot(dirAB, rotateCCW(dirBC)) > 0.;\n  bool turningRightC = dot(dirBC, rotateCCW(dirCD)) > 0.;\n  bool turningRight = isLeft ? turningRightB : turningRightC;\n\n  if (tooSharp) {\n    // \"fold join\"\n    vec2 perp = isLeft ? perpAB : perpBC;\n    vec2 dir = isLeft ? dirAB : dirBC;\n    float scalePerp = isLeft ? -1. : 1.;\n    float scaleDir = (turningRight == isLeft) ? 1. : -1.;\n    float tanHalfB = sqrt((1. - cosB) / (1. + cosB));\n    float tanHalfC = sqrt((1. - cosC) / (1. + cosC));\n    float tanHalf = isLeft ? tanHalfB : tanHalfC;\n    setPosition(proj, scale * (scalePerp * perp + scaleDir * dir * tanHalf));\n  } else {\n    // miter join\n    vec2 bisectorB = rotateCCW(normalize(dirAB + dirBC)); // angle bisector of ABC\n    vec2 bisectorC = rotateCCW(normalize(dirBC + dirCD)); // angle bisector of BCD\n    vec2 bisector = isLeft ? bisectorB : bisectorC;\n    float sinHalfB = sqrt((1. - cosB) / 2.);\n    float sinHalfC = sqrt((1. - cosC) / 2.);\n    float sinHalf = isLeft ? sinHalfB : sinHalfC;\n    setPosition(proj, scale * bisector / sinHalf);\n  }\n}\n`;\n\nconst frag = `\nprecision mediump float;\nvarying vec4 vColor;\nvoid main () {\n  gl_FragColor = vColor;\n}\n`;\n\nfunction pointsEqual(a, b) {\n  const [ax, ay, az] = shouldConvert(a) ? pointToVec3(a) : a;\n  const [bx, by, bz] = shouldConvert(b) ? pointToVec3(b) : b;\n  return ax === bx && ay === by && az === bz;\n}\n\nexport const lines = (regl: any) => {\n  if (!regl) {\n    throw new Error(\"Invalid regl instance\");\n  }\n\n  // The point type attribute, reused for each instance\n  const pointTypeBuffer = regl.buffer({\n    type: \"uint16\",\n    usage: \"static\",\n    data: [POINT_TYPES.TL, POINT_TYPES.BL, POINT_TYPES.TR, POINT_TYPES.BR],\n  });\n  const debugColorBuffer = regl.buffer({\n    type: \"float\",\n    usage: \"static\",\n    data: [\n      [0, 1, 1, 1], // cyan\n      [1, 0, 0, 1], // red\n      [0, 1, 0, 1], // green\n      [1, 0, 1, 1], // magenta\n    ],\n  });\n  // The pose position and rotation buffers contain the identity position/rotation, for use when we don't have instanced\n  // poses.\n  const defaultPosePositionBuffer = regl.buffer({\n    type: \"float\",\n    usage: \"static\",\n    data: flatten(new Array(VERTICES_PER_INSTANCE).fill([0, 0, 0])),\n  });\n  const defaultPoseRotationBuffer = regl.buffer({\n    type: \"float\",\n    usage: \"static\",\n    // Rotation array identity is [x: 0, y: 0, z: 0, w: 1]\n    data: flatten(new Array(VERTICES_PER_INSTANCE).fill([0, 0, 0, 1])),\n  });\n\n  // The buffers used for input position & color data\n  const colorBuffer = regl.buffer({ type: \"float\" });\n\n  // All invocations of the vertex shader share data from the positions buffer, but with different\n  // offsets. However, when offset and stride are combined, 3 or 4 attributes reading from the same\n  // buffer produces incorrect results on certain Lenovo hardware running Ubuntu. As a workaround,\n  // we upload the same data into two buffers and have only two attributes reading from each buffer.\n  const positionBuffer1 = regl.buffer({ type: \"float\" });\n  const positionBuffer2 = regl.buffer({ type: \"float\" });\n\n  const posePositionBuffer = regl.buffer({ type: \"float\" });\n  const poseRotationBuffer = regl.buffer({ type: \"float\" });\n\n  const command = regl(\n    withPose({\n      vert,\n      frag,\n      blend: defaultBlend,\n      uniforms: {\n        thickness: regl.prop(\"scale.x\"),\n        viewportWidth: regl.context(\"viewportWidth\"),\n        viewportHeight: regl.context(\"viewportHeight\"),\n        alpha: regl.prop(\"alpha\"),\n        joined: regl.prop(\"joined\"),\n        scaleInvariant: regl.prop(\"scaleInvariant\"),\n      },\n      attributes: {\n        pointType: pointTypeBuffer,\n        colorB: (context, { joined, monochrome, debug }) => ({\n          buffer: debug ? debugColorBuffer : colorBuffer,\n          offset: 0,\n          stride: (joined || monochrome || debug ? 1 : 2) * 4 * FLOAT_BYTES,\n          divisor: monochrome || debug ? 0 : 1,\n        }),\n        colorC: (context, { joined, monochrome, debug }) => ({\n          buffer: debug ? debugColorBuffer : colorBuffer,\n          offset: monochrome || debug ? 0 : 4 * FLOAT_BYTES,\n          stride: (joined || monochrome || debug ? 1 : 2) * 4 * FLOAT_BYTES,\n          divisor: monochrome || debug ? 0 : 1,\n        }),\n        positionA: (context, { joined }) => ({\n          buffer: positionBuffer1,\n          offset: 0,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        positionB: (context, { joined }) => ({\n          buffer: positionBuffer1,\n          offset: POINT_BYTES,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        positionC: (context, { joined }) => ({\n          buffer: positionBuffer2,\n          offset: 2 * POINT_BYTES,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        positionD: (context, { joined }) => ({\n          buffer: positionBuffer2,\n          offset: 3 * POINT_BYTES,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        posePosition: (context, { hasInstancedPoses }) => ({\n          buffer: hasInstancedPoses ? posePositionBuffer : defaultPosePositionBuffer,\n          divisor: hasInstancedPoses ? 1 : 0,\n        }),\n        poseRotation: (context, { hasInstancedPoses }) => ({\n          buffer: hasInstancedPoses ? poseRotationBuffer : defaultPoseRotationBuffer,\n          divisor: hasInstancedPoses ? 1 : 0,\n        }),\n      },\n      count: VERTICES_PER_INSTANCE,\n      instances: regl.prop(\"instances\"),\n      primitive: regl.prop(\"primitive\"),\n    })\n  );\n\n  let colorArray = new Float32Array(VERTICES_PER_INSTANCE * 4);\n  let pointArray = new Float32Array(0);\n  let allocatedPoints = 0;\n  let positionArray = new Float32Array(0);\n  let rotationArray = new Float32Array(0);\n\n  function fillPointArray(points: any[], alreadyClosed: boolean, shouldClose: boolean): Float32Array {\n    const numTotalPoints = points.length + (shouldClose ? 3 : 2);\n    if (allocatedPoints < numTotalPoints) {\n      pointArray = new Float32Array(numTotalPoints * 3);\n      allocatedPoints = numTotalPoints;\n    }\n    points.forEach((point, i) => {\n      const [x, y, z] = shouldConvert(point) ? pointToVec3(point) : point;\n      const off = 3 + i * 3;\n      pointArray[off + 0] = x;\n      pointArray[off + 1] = y;\n      pointArray[off + 2] = z;\n    });\n\n    // The \"prior\" point (A) and \"next\" point (D) need to be set when rendering the first & last\n    // segments, so we copy data from the last point(s) to the beginning of the array, and from the\n    // first point(s) to the end of the array.\n    const n = numTotalPoints * 3;\n    if (alreadyClosed) {\n      // First and last points already match; \"prior\" should be the second-to-last\n      // and \"next\" should be the second.\n      pointArray.copyWithin(0, n - 9, n - 6);\n      pointArray.copyWithin(n - 3, 6, 9);\n    } else if (shouldClose) {\n      // First point is being reused after last point; first *two* points need to be copied at the end\n      pointArray.copyWithin(0, n - 9, n - 6);\n      pointArray.copyWithin(n - 6, 3, 9);\n    } else {\n      // Endpoints are separate; just duplicate first & last points, resulting in square-looking endcaps\n      pointArray.copyWithin(0, 3, 6);\n      pointArray.copyWithin(n - 3, n - 6, n - 3);\n    }\n    return pointArray.subarray(0, n);\n  }\n\n  function fillPoseArrays(\n    instances: number,\n    poses: Pose[]\n  ): { positionData: Float32Array, rotationData: Float32Array } {\n    if (positionArray.length < instances * 3) {\n      positionArray = new Float32Array(instances * 3);\n      rotationArray = new Float32Array(instances * 4);\n    }\n    for (let index = 0; index < poses.length; index++) {\n      const positionOffset = index * 3;\n      const rotationOffset = index * 4;\n      const { position, orientation: r } = poses[index];\n      const convertedPosition = Array.isArray(position) ? position : pointToVec3(position);\n      positionArray[positionOffset + 0] = convertedPosition[0];\n      positionArray[positionOffset + 1] = convertedPosition[1];\n      positionArray[positionOffset + 2] = convertedPosition[2];\n\n      const convertedRotation = Array.isArray(r) ? r : [r.x, r.y, r.z, r.w];\n      rotationArray[rotationOffset + 0] = convertedRotation[0];\n      rotationArray[rotationOffset + 1] = convertedRotation[1];\n      rotationArray[rotationOffset + 2] = convertedRotation[2];\n      rotationArray[rotationOffset + 3] = convertedRotation[3];\n    }\n    return {\n      positionData: positionArray.subarray(0, instances * 3),\n      rotationData: rotationArray.subarray(0, instances * 4),\n    };\n  }\n\n  function convertColors(colors: any): Vec4[] {\n    return shouldConvert(colors) ? colors.map(toRGBA) : colors;\n  }\n\n  function fillColorArray(\n    color: ?Color | ?Vec4,\n    colors: ?((Color | Vec4)[]),\n    monochrome: boolean,\n    shouldClose: boolean\n  ): Float32Array {\n    if (monochrome) {\n      if (colorArray.length < VERTICES_PER_INSTANCE * 4) {\n        colorArray = new Float32Array(VERTICES_PER_INSTANCE * 4);\n      }\n      const monochromeColor = color || DEFAULT_MONOCHROME_COLOR;\n      const [convertedMonochromeColor] = convertColors([monochromeColor]);\n      const [r, g, b, a] = convertedMonochromeColor;\n      for (let index = 0; index < VERTICES_PER_INSTANCE; index++) {\n        const offset = index * 4;\n        colorArray[offset + 0] = r;\n        colorArray[offset + 1] = g;\n        colorArray[offset + 2] = b;\n        colorArray[offset + 3] = a;\n      }\n      return colorArray.subarray(0, VERTICES_PER_INSTANCE * 4);\n    } else if (colors) {\n      const length = shouldClose ? colors.length + 1 : colors.length;\n      if (colorArray.length < length * 4) {\n        colorArray = new Float32Array(length * 4);\n      }\n      const convertedColors = convertColors(colors);\n      for (let index = 0; index < convertedColors.length; index++) {\n        const offset = index * 4;\n        const [r, g, b, a] = convertedColors[index];\n        colorArray[offset + 0] = r;\n        colorArray[offset + 1] = g;\n        colorArray[offset + 2] = b;\n        colorArray[offset + 3] = a;\n      }\n\n      if (shouldClose) {\n        const [r, g, b, a] = convertedColors[0];\n        const lastIndex = length - 1;\n        colorArray[lastIndex * 4 + 0] = r;\n        colorArray[lastIndex * 4 + 1] = g;\n        colorArray[lastIndex * 4 + 2] = b;\n        colorArray[lastIndex * 4 + 3] = a;\n      }\n      return colorArray.subarray(0, length * 4);\n    }\n    throw new Error(\"Impossible: !monochrome implies !!colors.\");\n  }\n\n  // Create a new render function based on rendering settings\n  // Memoization is required in order to prevent creating too many functions\n  // that use the same arguments, potentially leading to memory leaks.\n  const memoizedRender = memoize(\n    (props: { depth?: DepthState, blend?: BlendState }) => {\n      const { depth = defaultReglDepth, blend = defaultReglBlend } = props;\n      return regl({ depth, blend });\n    },\n    (...args) => JSON.stringify(args)\n  );\n\n  // Disable depth for debug rendering (so lines stay visible)\n  const render = (props: { debug?: boolean, depth?: DepthState, blend?: BlendState }, commands: any) => {\n    const { debug } = props;\n    if (debug) {\n      memoizedRender({ depth: { enable: false } })(commands);\n    } else {\n      memoizedRender(props)(commands);\n    }\n  };\n\n  // Render one line list/strip\n  function renderLine(props) {\n    const { debug, primitive = \"lines\", scaleInvariant = false, depth, blend } = props;\n    const numInputPoints = props.points.length;\n\n    if (numInputPoints < 2) {\n      return;\n    }\n\n    const alreadyClosed = numInputPoints > 2 && pointsEqual(props.points[0], props.points[numInputPoints - 1]);\n    // whether the first point needs to be duplicated after the last point\n    const shouldClose = !alreadyClosed && props.closed;\n\n    const pointData = fillPointArray(props.points, alreadyClosed, shouldClose);\n    positionBuffer1({ data: pointData, usage: \"dynamic\" });\n    positionBuffer2({ data: pointData, usage: \"dynamic\" });\n\n    const monochrome = !(props.colors && props.colors.length);\n    const colorData = fillColorArray(props.color, props.colors, monochrome, shouldClose);\n    colorBuffer({ data: colorData, usage: \"dynamic\" });\n\n    const joined = primitive === \"line strip\";\n    const effectiveNumPoints = numInputPoints + (shouldClose ? 1 : 0);\n    const instances = joined ? effectiveNumPoints - 1 : Math.floor(effectiveNumPoints / 2);\n\n    // fill instanced pose buffers\n    const { poses } = props;\n    const hasInstancedPoses = !!poses && poses.length > 0;\n    if (hasInstancedPoses && poses) {\n      if (instances !== poses.length) {\n        console.error(`Expected ${instances} poses but given ${poses.length} poses: will result in webgl error.`);\n        return;\n      }\n      const { positionData, rotationData } = fillPoseArrays(instances, poses);\n      posePositionBuffer({ data: positionData, usage: \"dynamic\" });\n      poseRotationBuffer({ data: rotationData, usage: \"dynamic\" });\n    }\n\n    render({ debug, depth, blend }, () => {\n      // Use Object.assign because it's actually faster than babel's object spread polyfill.\n      command(\n        Object.assign({}, props, {\n          joined,\n          primitive: \"triangle strip\",\n          alpha: debug ? 0.2 : 1,\n          monochrome,\n          instances,\n          scaleInvariant,\n          hasInstancedPoses,\n        })\n      );\n      if (debug) {\n        command(\n          Object.assign({}, props, {\n            joined,\n            primitive: \"line strip\",\n            alpha: 1,\n            monochrome,\n            instances,\n            scaleInvariant,\n            hasInstancedPoses,\n          })\n        );\n      }\n    });\n  }\n\n  return (inProps: any) => {\n    if (Array.isArray(inProps)) {\n      inProps.forEach(renderLine);\n    } else {\n      renderLine(inProps);\n    }\n  };\n};\n\nexport default function Lines(props: { ...CommonCommandProps, children: Line[] }) {\n  return <Command getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...props} reglCommand={lines} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport type { Point, Vec3, Line } from \"../types\";\nimport Lines from \"./Lines\";\n\nconst pointToVec3 = (p: Vec3): Point => ({\n  x: p[0],\n  y: p[1],\n  z: p[2],\n});\n\nconst scale = 100;\nconst x = 1 * scale;\nconst xAxisPoints = [[-x, 0, 0], [x, 0, 0]].map(pointToVec3);\nconst yAxisPoints = [[0, -100, 0], [0, 100, 0]].map(pointToVec3);\nconst zAxisPoints = [[0, 0, -100], [0, 0, 100]].map(pointToVec3);\nconst pose = {\n  orientation: { x: 0, y: 0, z: 0, w: 0 },\n  position: { x: 0, y: 0, z: 0 },\n};\nconst xAxis = {\n  pose,\n  points: xAxisPoints,\n  scale: { x: 0.5, y: 0.5, z: 0.5 },\n  color: { r: 0.95, g: 0.26, b: 0.4, a: 1 },\n};\nconst yAxis = {\n  pose,\n  points: yAxisPoints,\n  scale: { x: 0.5, y: 0.5, z: 0.5 },\n  color: { r: 0.02, g: 0.82, b: 0.49, a: 1 },\n};\nconst zAxis = {\n  pose,\n  points: zAxisPoints,\n  scale: { x: 0.5, y: 0.5, z: 0.5 },\n  color: { r: 0.11, g: 0.51, b: 0.92, a: 1 },\n};\n\ntype Axis = Line;\n\ntype Props = {\n  children: Axis[],\n};\n\n// Renders lines along the x, y, and z axes; useful for debugging.\nexport default class Axes extends React.Component<Props> {\n  static defaultProps: Props = {\n    children: [xAxis, yAxis, zAxis],\n  };\n\n  render() {\n    return <Lines>{this.props.children}</Lines>;\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Cube } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport withRenderStateOverrides from \"../utils/withRenderStateOverrides\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nexport const cubes = withRenderStateOverrides(\n  fromGeometry(\n    [\n      // bottom face corners\n      [-0.5, -0.5, -0.5],\n      [-0.5, 0.5, -0.5],\n      [0.5, -0.5, -0.5],\n      [0.5, 0.5, -0.5],\n      // top face corners\n      [-0.5, -0.5, 0.5],\n      [-0.5, 0.5, 0.5],\n      [0.5, -0.5, 0.5],\n      [0.5, 0.5, 0.5],\n    ],\n    [\n      // bottom\n      [0, 1, 2],\n      [1, 2, 3],\n      // top\n      [4, 5, 6],\n      [5, 6, 7],\n      // left\n      [0, 2, 4],\n      [2, 4, 6],\n      // right\n      [1, 3, 5],\n      [3, 5, 7],\n      //front\n      [2, 3, 6],\n      [3, 6, 7],\n      //back\n      [0, 1, 4],\n      [1, 4, 5],\n    ]\n  )\n);\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Cubes(props: { ...CommonCommandProps, children: Cube[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={cubes} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { SphereList } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport withRenderStateOverrides from \"../utils/withRenderStateOverrides\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nconst NUM_PARALLELS = 15;\nconst NUM_MERIDIANS = 15;\nconst RADIUS = 0.5;\n\nconst northPole = [0, 0, RADIUS];\nconst southPole = [0, 0, -RADIUS];\nconst points = [northPole, southPole];\nconst faces = [];\n\nfor (let i = 0; i < NUM_PARALLELS; i++) {\n  for (let j = 0; j < NUM_MERIDIANS; j++) {\n    const phi = ((i + 1) / (NUM_PARALLELS + 1)) * Math.PI;\n    const z = RADIUS * Math.cos(phi);\n    const width = RADIUS * Math.sin(phi);\n    const theta = (j * 2 * Math.PI) / NUM_MERIDIANS;\n    const x = width * Math.cos(theta);\n    const y = width * Math.sin(theta);\n    points.push([x, y, z]);\n    if (j > 0) {\n      // connect to previous parallel (or north pole)\n      const prevMeridianPt = i === 0 ? 0 : points.length - 1 - NUM_MERIDIANS;\n      faces.push([points.length - 2, points.length - 1, prevMeridianPt]);\n      if (i > 0) {\n        faces.push([points.length - 2, prevMeridianPt - 1, prevMeridianPt]);\n      }\n    }\n  }\n  // connect to previous parallel (or north pole)\n  const prevMeridianPt = i === 0 ? 0 : points.length - 2 * NUM_MERIDIANS;\n  faces.push([points.length - 1, points.length - NUM_MERIDIANS, prevMeridianPt]);\n  if (i > 0) {\n    faces.push([points.length - 1, points.length - NUM_MERIDIANS - 1, prevMeridianPt]);\n  }\n}\n// connect last parallel to south pole\nfor (let j = 0; j < NUM_MERIDIANS; j++) {\n  const pt = points.length - NUM_MERIDIANS + j;\n  const prevPt = j === 0 ? points.length - 1 : pt - 1;\n  faces.push([pt, prevPt, 1]);\n}\n\nexport const spheres = withRenderStateOverrides(fromGeometry(points, faces));\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Spheres(props: { ...CommonCommandProps, children: SphereList[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={spheres} />;\n}\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport type { Line, Point, Vec3, Scale, GetChildrenForHitmap, SphereList } from \"../../types\";\nimport { vec4ToRGBA, vec3ToPoint } from \"../../utils/commandUtils\";\nimport Lines from \"../Lines\";\nimport Spheres from \"../Spheres\";\n\nexport function multiplyScale(scale: Scale, factor: number): Scale {\n  return { x: scale.x * factor, y: scale.y * factor, z: scale.z * factor };\n}\n\nexport const DEFAULT_COLOR = [1, 1, 1, 1];\nexport const ACTIVE_POLYGON_COLOR = [0.8, 0, 0.8, 1];\nexport const ACTIVE_POINT_COLOR = [1, 0.2, 1, 1];\nexport const LINE_STRIP = \"line strip\";\nconst POINT_SIZE_FACTOR = 1.3;\nexport const DRAW_SCALE = { x: 0.1, y: 0.1, z: 0.1 };\nexport const DRAW_POINT_SCALE = multiplyScale(DRAW_SCALE, POINT_SIZE_FACTOR);\nexport const HITMAP_SCALE = { x: 0.5, y: 0.5, z: 0.5 };\nexport const HITMAP_POINT_SCALE = multiplyScale(HITMAP_SCALE, POINT_SIZE_FACTOR);\nexport const POSE = {\n  position: { x: 0, y: 0, z: 0 },\n  orientation: { x: 0, y: 0, z: 0, w: 0 },\n};\n\nlet count = 1;\n\nexport class PolygonPoint {\n  id: number;\n  point: Vec3;\n  active: boolean = false;\n\n  constructor(points: Vec3) {\n    this.id = count++;\n    this.point = points;\n  }\n}\n\nexport class Polygon {\n  id: number;\n  name: string;\n  points: PolygonPoint[] = [];\n  active: boolean = false;\n\n  constructor(name: string = \"\") {\n    this.name = name;\n    this.id = count++;\n  }\n}\n\nexport type DrawPolygonType = Polygon;\n\ntype Props = {\n  children: DrawPolygonType[],\n};\n\nconst polygonLinesGetChildrenForHitmap: GetChildrenForHitmap = <T: any>(\n  props: T,\n  assignNextColors,\n  excludedObjects\n) => {\n  // This is almost identical to the default nonInstancedGetChildrenForHitmap, with changes marked.\n  return props\n    .map((prop) => {\n      if (excludedObjects.some(({ object }) => object === prop)) {\n        return null;\n      }\n      const hitmapProp = { ...prop };\n      // Change from original: pass the original marker as a callback object instead of this marker.\n      const [hitmapColor] = assignNextColors(prop.originalMarker, 1);\n      // Change from original: increase scale for hitmap\n      hitmapProp.scale = HITMAP_SCALE;\n\n      hitmapProp.color = hitmapColor;\n      if (hitmapProp.colors && hitmapProp.points && hitmapProp.points.length) {\n        hitmapProp.colors = new Array(hitmapProp.points.length).fill(hitmapColor);\n      }\n      return hitmapProp;\n    })\n    .filter(Boolean);\n};\n\n/**\n * Draw the polygon lines\n */\nclass PolygonLines extends React.Component<Props> {\n  render() {\n    const polygons = this.props.children;\n    const lines: Line[] = [];\n    for (const poly of polygons) {\n      const color = poly.active ? ACTIVE_POLYGON_COLOR : DEFAULT_COLOR;\n      const points: (Point | Vec3)[] = poly.points.map(({ point }) => vec3ToPoint(point));\n\n      lines.push({\n        primitive: LINE_STRIP,\n        pose: POSE,\n        points,\n        scale: DRAW_SCALE,\n        color: vec4ToRGBA(color),\n        originalMarker: poly,\n      });\n    }\n\n    return <Lines getChildrenForHitmap={polygonLinesGetChildrenForHitmap}>{lines}</Lines>;\n  }\n}\n\nconst polygonPointsGetChildrenForHitmap: GetChildrenForHitmap = <T: any>(\n  props: T,\n  assignNextColors,\n  excludedObjects\n) => {\n  // This is similar to the default nonInstancedGetChildrenForHitmap, with changes marked.\n  return props\n    .map((prop) => {\n      if (excludedObjects.some(({ object }) => object === prop)) {\n        return null;\n      }\n      const hitmapProp = { ...prop };\n      // Change from original: assign a non-instanced color to each point color, even though this marker uses\n      // instancing.\n      // This is so that we can have a unique callback object for each point.\n      hitmapProp.colors = hitmapProp.colors.map((color, index) => {\n        return assignNextColors(prop.originalMarkers[index], 1);\n      });\n      // Change from original: increase scale for hitmap\n      hitmapProp.scale = HITMAP_POINT_SCALE;\n      return hitmapProp;\n    })\n    .filter(Boolean);\n};\n\n/**\n * Draw the polygon points at the end of each lines\n */\nclass PolygonPoints extends React.Component<Props> {\n  render() {\n    const polygons = this.props.children;\n    const points = [];\n    const colors = [];\n    const originalMarkers = [];\n\n    for (const poly of polygons) {\n      const color = poly.active ? ACTIVE_POLYGON_COLOR : DEFAULT_COLOR;\n      for (const point of poly.points) {\n        const convertedPoint = vec3ToPoint(point.point);\n        points.push(convertedPoint);\n        colors.push(point.active ? ACTIVE_POINT_COLOR : color);\n        originalMarkers.push(point);\n      }\n    }\n\n    const sphereList: SphereList = {\n      points,\n      colors,\n      pose: POSE,\n      scale: DRAW_POINT_SCALE,\n      originalMarkers,\n    };\n\n    return <Spheres getChildrenForHitmap={polygonPointsGetChildrenForHitmap}>{[sphereList]}</Spheres>;\n  }\n}\n\nexport default function DrawPolygons({ children: polygons = [] }: Props) {\n  if (polygons.length === 0) {\n    return null;\n  }\n\n  return (\n    <React.Fragment>\n      <PolygonLines>{polygons}</PolygonLines>\n      <PolygonPoints>{polygons}</PolygonPoints>\n    </React.Fragment>\n  );\n}\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport distance from \"distance-to-line-segment\";\n\nimport type { Vec3, MouseHandler } from \"../../types\";\nimport { PolygonPoint, Polygon } from \"./index\";\n\ntype OptionalZPoint = {\n  x: number,\n  y: number,\n  z?: number,\n};\n\ntype PolygonAddCommand = {\n  points: OptionalZPoint[],\n  name?: string,\n};\n\nfunction areEqual(point1: PolygonPoint, point2: PolygonPoint) {\n  const [x1, y1, z1] = point1.point;\n  const [x2, y2, z2] = point2.point;\n  return x1 === x2 && y1 === y2 && z1 === z2;\n}\n\nfunction isClosed(polygon: Polygon): boolean {\n  const { points } = polygon;\n  for (let i = 0; i < points.length - 1; i++) {\n    if (areEqual(points[i], points[i + 1])) {\n      return true;\n    }\n  }\n  const firstPoint = points[0];\n  const lastPoint = points[points.length - 1];\n  return areEqual(firstPoint, lastPoint);\n}\n\n// Has listeners you can pass to Worldview for mouse interactions\n// internally builds a list of polygons and modifies the polygons\n// based on mouse & keyboard interactions. For now we use mututation internally\n// instead of immutability to keep the number of allocations lower and make\n// the implementation a bit more straightforward\n\nexport default class PolygonBuilder {\n  mouseDown: boolean = false;\n  polygons: Polygon[];\n  onChange: () => void = () => {};\n  activePolygon: ?Polygon;\n  activePoint: ?PolygonPoint;\n  mouseDownPoint: Vec3;\n\n  constructor(polygons: Polygon[] = []) {\n    this.polygons = polygons;\n  }\n\n  isActivePolygonClosed(): boolean {\n    return !!this.activePolygon && isClosed(this.activePolygon);\n  }\n\n  // adds a polygon to the builder, transforming it into the internal representation\n  addPolygon(cmd: PolygonAddCommand): void {\n    const { points, name } = cmd;\n    if (points.length < 3) {\n      return;\n    }\n    // clear any selections\n    this.selectObject();\n\n    const polygon = new Polygon(name);\n    polygon.points = points.map((p) => new PolygonPoint([p.x, p.y, p.z || 0]));\n    if (!isClosed(polygon)) {\n      polygon.points.push(polygon.points[0]);\n    }\n    this.polygons.push(polygon);\n  }\n\n  // push a new point - either adds to the active polygon\n  // or creates a new polygon at this point\n  pushPoint(point: Vec3): void {\n    const { activePolygon } = this;\n    if (activePolygon) {\n      // do not push a point on a closed polygon\n      if (!isClosed(activePolygon)) {\n        const newPoint = new PolygonPoint(point);\n        activePolygon.points.push(newPoint);\n        this.selectObject(newPoint);\n        return;\n      }\n    }\n\n    const polygon = new Polygon();\n    polygon.points.push(new PolygonPoint(point));\n    const floatingPoint = new PolygonPoint(point);\n    polygon.points.push(floatingPoint);\n    this.polygons.push(polygon);\n    this.selectObject(floatingPoint);\n    this.onChange();\n  }\n\n  // updates the active point to the new position\n  updateActivePoint(point: Vec3): void {\n    if (this.activePoint) {\n      this.activePoint.point = point;\n      this.onChange();\n    }\n  }\n\n  // closes the active polygon by either deleting it if\n  // is only 2 points (no \"single sided\" polygons...)\n  // or inserts an 'overlap' point by making the first point\n  // and last point a reference to the same point in the list\n  // this structure of overlap is similar to the structure used by geoJSON\n  // though \"left to right\" ordering is not enforced\n  closeActivePolygon(): void {\n    const polygon = this.activePolygon;\n    if (!polygon) {\n      return;\n    }\n\n    // remove single lines\n    if (polygon.points.length === 2) {\n      this.deletePolygon(polygon);\n    } else {\n      polygon.points.push(polygon.points[0]);\n    }\n    this.onChange();\n  }\n\n  // mouse move handler - should be added to Worldview as a prop\n  onMouseMove: MouseHandler = (e, args) => {\n    // prevent the camera from responding to move if we\n    // have an active object being edited\n    if (this.activePolygon) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    //const cursor = e.ctrlKey ? 'crosshair' : '';\n    //document.body.style.cursor = cursor;\n\n    if (!this.mouseDown) {\n      return;\n    }\n    if (!args) {\n      return;\n    }\n\n    // early return to only raycast when mouse moves during interaction\n    if (!this.activePoint && !this.activePolygon) {\n      return;\n    }\n\n    const { ray } = args;\n    const point = ray.planeIntersection([0, 0, 0], [0, 0, 1]);\n    // satisfy flow\n    if (!point) {\n      return;\n    }\n\n    // satisfy flow\n    const { activePolygon } = this;\n\n    if (this.activePoint) {\n      this.updateActivePoint(point);\n    } else if (activePolygon && this.mouseDownPoint) {\n      // move polygon\n      const [pointX, pointY] = point;\n      const [mouseX, mouseY] = this.mouseDownPoint;\n      // figure out how far the mouse has moved\n      const dX = pointX - mouseX;\n      const dY = pointY - mouseY;\n\n      // save the new mouse position as for the next computation\n      this.mouseDownPoint = point;\n\n      // only update the 'overlap' point once\n      const uniquePoints = activePolygon.points.reduce((acc, point) => {\n        if (!acc.includes(point)) {\n          acc.push(point);\n        }\n        return acc;\n      }, []);\n\n      // adjust each point's location\n      for (const polygonPoint of uniquePoints) {\n        const { point } = polygonPoint;\n        point[0] = point[0] + dX;\n        point[1] = point[1] + dY;\n      }\n\n      this.onChange();\n    }\n  };\n\n  // deletes a polygon\n  deletePolygon(polygon: Polygon): void {\n    this.polygons = this.polygons.filter((poly) => poly !== polygon);\n    this.activePolygon = null;\n  }\n\n  // deletes a point in the active polygon\n  // if the point is the 'overlap point' create a new one\n  // also deletes the entire polygon if the polygon becomes a 1-sided polygon\n  deletePoint(point: PolygonPoint): void {\n    const { activePolygon } = this;\n    if (!activePolygon) {\n      return;\n    }\n    const newPoints = activePolygon.points.filter((p) => p.id !== point.id);\n    // if the 'overlap' point is deleted, create a new start/end overlap point\n    if (newPoints.length === activePolygon.points.length - 2) {\n      newPoints.push(newPoints[0]);\n    }\n    activePolygon.points = newPoints;\n    this.activePoint = null;\n    if (activePolygon.points.length < 4) {\n      this.deletePolygon(activePolygon);\n    }\n    this.onChange();\n  }\n\n  // key down handler - to be passed to Worldview as a prop\n  onKeyDown = (e: KeyboardEvent): void => {\n    // only respond to key events if we have a selected polygon\n    const { activePolygon } = this;\n    if (!activePolygon) {\n      return;\n    }\n\n    switch (e.key) {\n      case \"Delete\":\n      case \"Backspace\":\n        if (this.activePoint) {\n          this.deletePoint(this.activePoint);\n        } else {\n          this.deletePolygon(activePolygon);\n        }\n        this.onChange();\n        break;\n      default:\n        break;\n    }\n  };\n\n  // select either a point or polygon by id\n  selectObject(object?: Polygon | PolygonPoint) {\n    // clear out any previously active objects\n    this.activePolygon = null;\n    if (this.activePoint) {\n      this.activePoint.active = false;\n    }\n    this.activePoint = null;\n\n    for (const polygon of this.polygons) {\n      let isActive = polygon === object;\n      polygon.active = isActive;\n      if (isActive) {\n        this.activePolygon = polygon;\n      }\n      for (const point of polygon.points) {\n        if (point === object) {\n          // if a point is selected, activate both it\n          // and the polygon it belongs to\n          this.activePoint = point;\n          point.active = true;\n          polygon.active = true;\n          this.activePolygon = polygon;\n          isActive = true;\n        }\n      }\n    }\n\n    this.onChange();\n  }\n\n  // mouse up handler - to be passed to Worldview as a prop\n  onMouseUp: MouseHandler = (e, args) => {\n    if (!e.ctrlKey) {\n      this.mouseDown = false;\n    }\n  };\n\n  // double click handler - to be passed to Worldview as a prop\n  onDoubleClick: MouseHandler = (e, args) => {\n    // satisfy flow\n    if (!args) {\n      return;\n    }\n    if (!args.objects.length) {\n      return;\n    }\n\n    this.selectObject(args.objects[0].object);\n\n    // if a point was double-clicked, delete it\n    if (this.activePoint) {\n      this.deletePoint(this.activePoint);\n      return;\n    }\n\n    // otherwise insert a new point into the nearest line of the active polygon\n    const { activePolygon } = this;\n\n    // if no polygon is active, don't do anything w/ the double-click\n    if (!activePolygon) {\n      return;\n    }\n\n    let shortestDistance = Number.MAX_SAFE_INTEGER;\n    let shortestIndex = -1;\n    const { ray } = args;\n    const point = ray.planeIntersection([0, 0, 0], [0, 0, 1]);\n    if (!point) {\n      return;\n    }\n    const [px, py] = point;\n\n    // find the closest line segment of the active polygon\n    const { points } = activePolygon;\n    for (let i = 0; i < points.length - 1; i++) {\n      const point1 = points[i];\n      const point2 = points[i + 1];\n      const [x1, y1] = point1.point;\n      const [x2, y2] = point2.point;\n\n      // distance.squared is faster since we don't care about the\n      // actual distance, just which line produces the shortest distance\n      const dist = distance.squared(x1, y1, x2, y2, px, py);\n      if (dist < shortestDistance) {\n        shortestDistance = dist;\n        shortestIndex = i;\n      }\n    }\n\n    // insert a new point in the nearest line\n    if (shortestIndex > -1) {\n      const newPoint = new PolygonPoint(point);\n      activePolygon.points.splice(shortestIndex + 1, 0, newPoint);\n      this.activePoint = newPoint;\n    }\n    this.onChange();\n  };\n\n  // mouse down handler - to be passed to Worldview as a prop\n  onMouseDown: MouseHandler = (e, args) => {\n    if (!args) {\n      return;\n    }\n    const { ray } = args;\n\n    const point = ray.planeIntersection([0, 0, 0], [0, 0, 1]);\n\n    // satisfy flow but raycasting should always work\n    if (!point) {\n      return;\n    }\n\n    const isFirstClick = !this.mouseDown;\n    this.mouseDown = true;\n    this.mouseDownPoint = point;\n    const isCtrlClick = e.ctrlKey;\n\n    // single click or click+drag is for selection & moving\n    if (isFirstClick && !isCtrlClick) {\n      const clickObject = args.objects[0];\n      this.selectObject(clickObject && clickObject.object);\n      return this.onChange();\n    }\n\n    // ctrl+click always inserts a point\n    if (isCtrlClick) {\n      this.pushPoint(point);\n      return this.onChange();\n    }\n\n    // if mouse was down & we have a non-control click, close the active polygon\n    this.closeActivePolygon();\n    return this.onChange();\n  };\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Regl, TriangleList } from \"../types\";\nimport {\n  defaultBlend,\n  getVertexColors,\n  pointToVec3Array,\n  shouldConvert,\n  toRGBA,\n  withPose,\n} from \"../utils/commandUtils\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport withRenderStateOverrides from \"../utils/withRenderStateOverrides\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\n// TODO(Audrey): default to the actual regl defaults before 1.x release\nconst defaultSingleColorDepth = { enable: true, mask: false };\nconst defaultVetexColorDepth = {\n  enable: true,\n  mask: true,\n  func: \"<=\",\n};\n\nconst singleColor = (regl) =>\n  withPose({\n    primitive: \"triangles\",\n    vert: `\n  precision mediump float;\n\n  attribute vec3 point;\n\n  uniform mat4 projection, view;\n\n  #WITH_POSE\n\n  void main () {\n    vec3 pos = applyPose(point);\n    gl_Position = projection * view * vec4(pos, 1);\n  }\n  `,\n    frag: `\n  precision mediump float;\n  uniform vec4 color;\n  void main () {\n    gl_FragColor = color;\n  }\n  `,\n    attributes: {\n      point: (context, props) => {\n        if (shouldConvert(props.points)) {\n          return pointToVec3Array(props.points);\n        }\n        return props.points;\n      },\n    },\n    uniforms: {\n      color: (context, props) => {\n        if (shouldConvert(props.color)) {\n          return toRGBA(props.color);\n        }\n        return props.color;\n      },\n    },\n    // can pass in { enable: true, depth: false } to turn off depth to prevent flicker\n    // because multiple items are rendered to the same z plane\n    depth: {\n      enable: (context, props) => {\n        return (props.depth && props.depth.enable) || defaultSingleColorDepth.enable;\n      },\n      mask: (context, props) => {\n        return (props.depth && props.depth.mask) || defaultSingleColorDepth.mask;\n      },\n    },\n    blend: defaultBlend,\n\n    count: (context, props) => props.points.length,\n  });\n\nconst vertexColors = (regl) =>\n  withPose({\n    primitive: \"triangles\",\n    vert: `\n  precision mediump float;\n\n  attribute vec3 point;\n  attribute vec4 color;\n\n  uniform mat4 projection, view;\n\n  varying vec4 vColor;\n\n  #WITH_POSE\n\n  void main () {\n    vec3 pos = applyPose(point);\n    vColor = color;\n    gl_Position = projection * view * vec4(pos, 1);\n  }\n  `,\n    frag: `\n  precision mediump float;\n  varying vec4 vColor;\n  void main () {\n    gl_FragColor = vColor;\n  }\n  `,\n    attributes: {\n      point: (context, props) => {\n        if (shouldConvert(props.points)) {\n          return pointToVec3Array(props.points);\n        }\n        return props.points;\n      },\n      color: (context, props) => {\n        if (!props.colors || !props.colors.length) {\n          throw new Error(`Invalid empty or null prop \"colors\" when rendering triangles using vertex colors`);\n        }\n        if (shouldConvert(props.colors)) {\n          return getVertexColors(props);\n        }\n        return props.colors;\n      },\n    },\n\n    depth: {\n      enable: (context, props) => {\n        return (props.depth && props.depth.enable) || defaultVetexColorDepth.enable;\n      },\n      mask: (context, props) => {\n        return (props.depth && props.depth.mask) || defaultVetexColorDepth.mask;\n      },\n    },\n    blend: defaultBlend,\n\n    count: (context, props) => props.points.length,\n  });\n\n// command to render triangle lists optionally supporting vertex colors for each triangle\nconst triangles = (regl: Regl) => {\n  const single = withRenderStateOverrides(singleColor)(regl);\n  const vertex = withRenderStateOverrides(vertexColors)(regl);\n  return (props: any, isHitmap: boolean) => {\n    const items: TriangleList[] = Array.isArray(props) ? props : [props];\n    const singleColorItems = [];\n    const vertexColorItems = [];\n    items.forEach((item) => {\n      // If the item has onlyRenderInHitmap set, only render it in the hitmap.\n      if (isHitmap || !item.onlyRenderInHitmap) {\n        if (item.colors && item.colors.length) {\n          vertexColorItems.push(item);\n        } else {\n          singleColorItems.push(item);\n        }\n      }\n    });\n\n    single(singleColorItems);\n    vertex(vertexColorItems);\n  };\n};\n\nexport const makeTrianglesCommand = () => {\n  return triangles;\n};\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(3);\nexport default function Triangles(props: { ...CommonCommandProps, children: TriangleList[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={triangles} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport earcut from \"earcut\";\nimport React from \"react\";\n\nimport type { Vec3, Point, PolygonType } from \"../types\";\nimport { shouldConvert, pointToVec3 } from \"../utils/commandUtils\";\nimport { getChildrenForHitmapWithOriginalMarker } from \"../utils/getChildrenForHitmapDefaults\";\nimport Triangles, { makeTrianglesCommand } from \"./Triangles\";\n\nconst NO_POSE = {\n  position: { x: 0, y: 0, z: 0 },\n  orientation: { x: 0, y: 0, z: 0, w: 0 },\n};\n\nconst DEFAULT_SCALE = { x: 1, y: 1, z: 1 };\n\nfunction flatten3D(points: Vec3[]): Float32Array {\n  const array = new Float32Array(points.length * 3);\n  for (let i = 0; i < points.length; i++) {\n    const [x, y, z] = points[i];\n    array[i * 3] = x;\n    array[i * 3 + 1] = y;\n    array[i * 3 + 2] = z;\n  }\n  return array;\n}\n\nfunction getEarcutPoints(points: Vec3[]): (Vec3 | Point)[] {\n  const flattenedPoints = flatten3D(points);\n  const indices = earcut(flattenedPoints, null, 3);\n  const newPoints = [];\n  for (let i = 0; i < indices.length; i++) {\n    const originalIndex = indices[i];\n    newPoints.push(points[originalIndex]);\n  }\n  return newPoints;\n}\n\ntype Props = {\n  children: PolygonType[],\n};\n\nconst generateTriangles = (polygons: PolygonType[]) => {\n  return polygons.map((poly) => {\n    // $FlowFixMe flow doesn't know how shouldConvert works\n    const points: Vec3[] = shouldConvert(poly.points) ? poly.points.map(pointToVec3) : poly.points;\n    const pose = poly.pose ? poly.pose : NO_POSE;\n    const earcutPoints = getEarcutPoints(points);\n    return {\n      ...poly,\n      points: earcutPoints,\n      pose,\n      scale: DEFAULT_SCALE,\n      originalMarker: poly,\n    };\n  });\n};\n\nexport const makeFilledPolygonsCommand = () => (regl: any) => {\n  const trianglesCommand = makeTrianglesCommand()(regl);\n  return (props: any) => {\n    trianglesCommand(generateTriangles(props), false);\n  };\n};\n\n// command to draw a filled polygon\nfunction FilledPolygons({ children: polygons = [], ...rest }: Props) {\n  const triangles = generateTriangles(polygons);\n\n  // Overwrite the triangle's default getChildrenForHitmap because we want to event as if each triangle is a single\n  // polygon.\n  return (\n    <Triangles getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker} {...rest}>\n      {triangles}\n    </Triangles>\n  );\n}\n\nexport default FilledPolygons;\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport type { Point, CameraCommand, Dimensions, Color, Pose, Scale, Vec4 } from \"../types\";\nimport { getCSSColor, toColor } from \"../utils/commandUtils\";\nimport { type WorldviewContextType } from \"../WorldviewContext\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\n\nconst BG_COLOR_LIGHT = \"#ffffff\";\nconst BG_COLOR_DARK = \"rgba(0,0,0,0.8)\";\nconst BRIGHTNESS_THRESHOLD = 128;\nconst DEFAULT_TEXT_COLOR = { r: 1, g: 1, b: 1, a: 1 };\nconst DEFAULT_BG_COLOR = { r: 0, g: 0, b: 0, a: 0.8 };\n\nexport type TextMarker = {\n  name?: string,\n  pose: Pose,\n  scale: Scale,\n  color?: Color | Vec4,\n  colors?: (Color | Vec4)[],\n  text: string,\n};\n\nlet cssHasBeenInserted = false;\nfunction insertGlobalCss() {\n  if (cssHasBeenInserted) {\n    return;\n  }\n  const style = document.createElement(\"style\");\n  style.innerHTML = `\n    .regl-worldview-text-wrapper {\n      position: absolute;\n      white-space: nowrap;\n      z-index: 100;\n      pointer-events: none;\n      top: 0;\n      left: 0;\n      will-change: transform;\n    }\n    .regl-worldview-text-inner {\n      position: relative;\n      left: -50%;\n      top: -0.5em;\n      white-space: pre-line;\n    }\n  `;\n  if (document.body) {\n    document.body.appendChild(style);\n  }\n  cssHasBeenInserted = true;\n}\n\nexport function isColorDark({ r, g, b }: Color): boolean {\n  // ITU-R BT.709 https://en.wikipedia.org/wiki/Rec._709\n  // 0.2126 * 255 * r + 0.7152 * 255 * g + 0.0722 * 255 * b\n  const luma = 54.213 * r + 182.376 * g + 18.411 * b;\n  return luma < BRIGHTNESS_THRESHOLD;\n}\n\nfunction isColorEqual(a: Color, b: Color): boolean {\n  return a.r === b.r && a.g === b.g && a.b === b.b && a.a === b.a;\n}\n\nclass TextElement {\n  wrapper = document.createElement(\"span\");\n  _inner = document.createElement(\"span\");\n  _text = document.createTextNode(\"\");\n  // store prev colors to improve perf\n  _prevTextColor: Color = DEFAULT_TEXT_COLOR;\n  _prevBgColor: ?Color = DEFAULT_BG_COLOR;\n  _prevAutoBackgroundColor: ?boolean = null;\n\n  constructor() {\n    insertGlobalCss();\n    this.wrapper.className = \"regl-worldview-text-wrapper\";\n    this._inner.className = \"regl-worldview-text-inner\";\n    this.wrapper.appendChild(this._inner);\n    this._inner.appendChild(this._text);\n    this.wrapper.style.color = getCSSColor(DEFAULT_TEXT_COLOR);\n  }\n\n  update(marker: TextMarker, left: number, top: number, autoBackgroundColor?: boolean) {\n    this.wrapper.style.transform = `translate(${left.toFixed()}px,${top.toFixed()}px)`;\n    const { color, colors = [] } = marker;\n    const hasBgColor = colors.length >= 2;\n    const textColor = toColor(hasBgColor ? colors[0] : color || [0, 0, 0, 1]);\n\n    if (textColor) {\n      const backgroundColor = toColor(colors[1]);\n      if (!isColorEqual(this._prevTextColor, textColor)) {\n        this._prevTextColor = textColor;\n        this.wrapper.style.color = getCSSColor(textColor);\n      }\n\n      if (!autoBackgroundColor && autoBackgroundColor !== this._prevAutoBackgroundColor) {\n        // remove background color if autoBackgroundColor has changed\n        this._inner.style.background = \"transparent\";\n        this._prevBgColor = null;\n      } else {\n        if (\n          autoBackgroundColor &&\n          (!this._prevBgColor || (this._prevBgColor && !isColorEqual(textColor, this._prevBgColor)))\n        ) {\n          // update background color with automatic dark/light color\n          this._prevBgColor = textColor;\n          const isTextColorDark = isColorDark(textColor);\n          const hexBgColor = isTextColorDark ? BG_COLOR_LIGHT : BG_COLOR_DARK;\n          this._inner.style.background = hexBgColor;\n        } else if (hasBgColor && this._prevBgColor && !isColorEqual(backgroundColor, this._prevBgColor)) {\n          // update background color with colors[1] data\n          this._prevBgColor = backgroundColor;\n          this._inner.style.background = getCSSColor(backgroundColor);\n        }\n      }\n    }\n    this._prevAutoBackgroundColor = autoBackgroundColor;\n\n    if (this._text.textContent !== marker.text) {\n      this._text.textContent = marker.text || \"\";\n    }\n  }\n}\n\ntype Props = {\n  children: TextMarker[],\n  autoBackgroundColor?: boolean,\n};\n\n// Render text on a scene using DOM nodes, similar to the Overlay command.\n// Implementation uses manual DOM manipulation to avoid the performance hit from React tree reconciliation.\nexport default class Text extends React.Component<Props> {\n  _context: ?WorldviewContextType;\n  _textComponents: Map<string | TextMarker, TextElement> = new Map();\n  _textContainerRef: { current: HTMLDivElement | null } = React.createRef();\n\n  static defaultProps = {\n    children: [],\n  };\n\n  componentDidMount() {\n    if (this._context) {\n      this._context.registerPaintCallback(this.paint);\n    }\n  }\n\n  componentWillUnmount = () => {\n    if (this._context) {\n      this._context.unregisterPaintCallback(this.paint);\n    }\n  };\n\n  paint = () => {\n    const context = this._context;\n    const textComponents = this._textComponents;\n    const { children: markers, autoBackgroundColor } = this.props;\n    const { current: textContainer } = this._textContainerRef;\n    const initializedData = context && context.initializedData;\n\n    if (!textContainer || !context || !initializedData) {\n      return;\n    }\n    const {\n      dimension,\n      dimension: { width, height },\n    } = context;\n    const { camera } = initializedData;\n\n    const componentsToRemove = new Set(textComponents.keys());\n\n    for (const marker of markers) {\n      const { pose, name } = marker;\n      const { position } = pose;\n      const coord = this.project(position, camera, dimension);\n      if (!coord) {\n        continue;\n      }\n\n      const [left, top] = coord;\n      if (left < -10 || top < -10 || left > width + 10 || top > height + 10) {\n        continue;\n      }\n\n      let el = textComponents.get(name || marker);\n      if (el) {\n        componentsToRemove.delete(name || marker);\n      } else {\n        el = new TextElement();\n        textComponents.set(name || marker, el);\n        textContainer.appendChild(el.wrapper);\n      }\n\n      el.update(marker, left, top, autoBackgroundColor);\n    }\n\n    for (const key of componentsToRemove) {\n      const el = textComponents.get(key);\n      if (!el) {\n        continue;\n      }\n      el.wrapper.remove();\n      textComponents.delete(key);\n    }\n  };\n\n  project = (point: Point, camera: CameraCommand, dimension: Dimensions) => {\n    const vec = [point.x, point.y, point.z];\n    const { left, top, width, height } = dimension;\n    const viewport = [left, top, width, height];\n    return camera.toScreenCoord(viewport, vec);\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        <div ref={this._textContainerRef} />\n        <WorldviewReactContext.Consumer>\n          {(ctx: ?WorldviewContextType) => {\n            if (ctx) {\n              this._context = ctx;\n            }\n            return null;\n          }}\n        </WorldviewReactContext.Consumer>\n      </React.Fragment>\n    );\n  }\n}\n","// @flow\n\nimport TinySDF from \"@mapbox/tiny-sdf\";\nimport difference from \"lodash/difference\";\nimport memoizeOne from \"memoize-one\";\nimport React, { useState } from \"react\";\n\nimport type { Color } from \"../types\";\nimport { defaultBlend, defaultDepth, toColor } from \"../utils/commandUtils\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\nimport { isColorDark, type TextMarker } from \"./Text\";\n\n// HACK: TinySDF doesn't agree with workers. Until support is added, hack this to make it work.\n// TODO(steel): Upstream the fix in memoizedCreateCanvas.\nif (!self.document) {\n  // $FlowFixMe: Flow doesn't know about OffscreenCanvas.\n  self.document = { createElement: () => new OffscreenCanvas(0, 0) };\n}\n\n// The GLText command renders text from a Signed Distance Field texture.\n// There are many external resources about SDFs and text rendering in WebGL, including:\n// https://steamcdn-a.akamaihd.net/apps/valve/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n// https://blog.mapbox.com/drawing-text-with-signed-distance-fields-in-mapbox-gl-b0933af6f817\n// http://hack.chrons.me/opengl-text-rendering/\n// https://stackoverflow.com/questions/25956272/better-quality-text-in-webgl\n//\n// Approach\n// ========\n// Characters from the font are measured using a <canvas> and the SDFs are drawn into a texture up front\n// (and whenever new characters are being rendered). Then one instanced draw call is made with an instance\n// per character which reads from the corresponding place in the texture atlas.\n//\n// Possible future improvements\n// ============================\n// - Allow customization of font style, maybe highlight ranges.\n// - Consider a solid rectangular background instead of an outline. This is challenging because the\n//   instances currently overlap, so there will be z-fighting, but might be possible using the stencil buffer and multiple draw calls.\n// - Somehow support kerning and more advanced font metrics. However, the web font APIs may not\n//   provide support for this. Some font info could be generated/stored offline, possibly including the atlas.\n// - Explore multi-channel SDFs.\n\ntype CharacterLocations = {\n  [char: string]: {|\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    yOffset: number,\n  |},\n};\n\nexport type GeneratedAtlas = {|\n  charInfo: CharacterLocations,\n  textureWidth: number,\n  textureHeight: number,\n  textureData: Uint8Array,\n|};\n\nexport type AtlasConfig = {|\n  fontSize: number,\n  fontFamily: string,\n  charSet: Set<string>,\n|};\n\ntype TextMarkerProps = TextMarker & {\n  billboard?: ?boolean,\n  highlightedIndices?: Array<number>,\n  highlightColor?: ?Color,\n};\n\ntype GLTextProps = {|\n  autoBackgroundColor?: boolean,\n  scaleInvariantFontSize?: number,\n  resolution?: number,\n  alphabet?: string[],\n  textAtlas?: GeneratedAtlas,\n  borderRadius?: number,\n  paddingScale?: [number, number],\n|};\n\ntype Props = {\n  // $FlowFixMe: flow does not know how to handle the indexed property in CommonCommandProps\n  ...CommonCommandProps,\n  ...GLTextProps,\n  children: $ReadOnlyArray<TextMarkerProps>,\n};\n\n// Font size used in rendering the atlas. This is independent of the `scale` of the rendered text.\nconst MIN_RESOLUTION = 40;\nconst DEFAULT_RESOLUTION = 160;\nconst SDF_RADIUS = 8;\nconst CUTOFF = 0.25;\nconst BUFFER = 10;\n\nconst BG_COLOR_LIGHT = Object.freeze({ r: 1, g: 1, b: 1, a: 1 });\nconst BG_COLOR_DARK = Object.freeze({ r: 0, g: 0, b: 0, a: 1 });\nconst BG_COLOR_TRANSPARENT = Object.freeze({ r: 0, b: 0, g: 0, a: 0 });\n\nconst hashMarkerPosition = (marker: TextMarker): string => {\n  const { x, y, z } = marker.pose.position;\n  // The hash is a simple string with all three components\n  return `x${x}y${y}z${z}`;\n};\n\nconst getMarkerYOffset = (offsets: Map<string, number>, marker: TextMarker) => {\n  return offsets.get(hashMarkerPosition(marker)) || 0;\n};\n\nconst setMarkerYOffset = (offsets: Map<string, number>, marker: TextMarker, yOffset: number) => {\n  offsets.set(hashMarkerPosition(marker), yOffset);\n};\n\n// Build a single font atlas: a texture containing all characters from all atlasConfigs\nexport const generateAtlas = (atlasConfigs: AtlasConfig[], maxAtlasWidth: number): GeneratedAtlas => {\n  // Render and measure each character using tinySDF\n  const sdfDataByChar = {};\n  atlasConfigs.forEach((atlasConfig) => {\n    const { charSet, fontSize, fontFamily } = atlasConfig;\n    const tinySDF = new TinySDF({\n      fontSize, // Font size in pixels\n      fontFamily: fontFamily || \"sans-serif\", // CSS font-family\n      fontWeight: \"normal\", // CSS font-weight\n      fontStyle: \"normal\", // CSS font-style\n      buffer: BUFFER, // Whitespace buffer around a glyph in pixels\n      radius: SDF_RADIUS, // How many pixels around the glyph shape to use for encoding distance\n      cutoff: CUTOFF, // How much of the radius (relative) is used for the inside part of the glyph\n    });\n    charSet.forEach((char) => (sdfDataByChar[char] = tinySDF.draw(char)));\n  });\n\n  // Compute positions for every character in the atlas\n  const charInfo = {};\n\n  let x = 0;\n  let y = 0;\n  let maxHeight = 0;\n  let textureWidth = 0;\n  atlasConfigs.forEach(({ charSet, fontSize }) => {\n    for (const char of charSet) {\n      const { height, width, glyphAdvance, glyphTop, glyphHeight } = sdfDataByChar[char];\n      const lineHeight = height;\n\n      const dx = Math.ceil(width);\n      if (x + dx + glyphAdvance > maxAtlasWidth) {\n        x = 0;\n        y += Math.max(maxHeight, fontSize);\n        maxHeight = lineHeight;\n      }\n      charInfo[char] = { x, y, height: glyphHeight, width: glyphAdvance, yOffset: fontSize - glyphTop };\n      x += dx;\n      textureWidth = Math.max(textureWidth, x);\n      maxHeight = Math.max(maxHeight, lineHeight);\n    }\n  });\n\n  // Copy each character's SDF image into a single texture\n  const textureHeight = y + Math.max(maxHeight);\n  const textureData = new Uint8Array(textureWidth * textureHeight);\n\n  atlasConfigs.forEach(({ charSet }) => {\n    for (const char of charSet) {\n      const { x, y } = charInfo[char];\n      const { data, width, height } = sdfDataByChar[char];\n\n      for (let i = 0; i < height; i++) {\n        for (let j = 0; j < width; j++) {\n          // if this character is near the right edge, we don't actually copy the whole square of data\n          if (x + j < textureWidth) {\n            textureData[textureWidth * (y + i) + x + j] = data[i * width + j];\n          }\n        }\n      }\n    }\n  });\n\n  return {\n    charInfo,\n    textureWidth,\n    textureHeight,\n    textureData,\n  };\n};\n\nconst createMemoizedGenerateAtlasConfigs = () =>\n  memoizeOne((charSet, charSetSize, fontSize, fontFamily) => [\n    {\n      charSet,\n      fontSize,\n      fontFamily,\n    },\n  ]);\n\n// Build a single font atlas: a texture containing all characters and position/size data for each character.\n// We update charSet mutably but monotonically. Pass in the size to invalidate the cache.\nconst createMemoizedGenerateAtlas = () => memoizeOne(generateAtlas);\n\nconst createMemoizedDrawAtlasTexture = () =>\n  memoizeOne((textAtlas: GeneratedAtlas, atlasTexture: any) => {\n    atlasTexture({\n      data: textAtlas.textureData,\n      width: textAtlas.textureWidth,\n      height: textAtlas.textureHeight,\n      format: \"alpha\",\n      wrap: \"clamp\",\n      mag: \"linear\",\n      min: \"linear\",\n    });\n  });\n\nconst vert = `\n  precision mediump float;\n\n  uniform mat4 projection, view, billboardRotation;\n  uniform float fontSize;\n  uniform vec2 atlasSize;\n  uniform bool scaleInvariant;\n  uniform float scaleInvariantSize;\n  uniform float viewportHeight;\n  uniform float viewportWidth;\n  uniform bool isPerspective;\n  uniform float cameraFovY;\n  uniform float cutoff;\n\n  // per-vertex attributes\n  attribute vec2 texCoord;\n  attribute vec2 position;\n\n  // per-instance (character) attributes\n  attribute vec2 srcOffset;\n  attribute vec2 charOffset;\n  attribute vec2 srcSize;\n  attribute vec2 roundedBackgroundSize;\n  attribute vec2 backgroundDestSize;\n  attribute vec2 destOffset;\n\n  // per-marker attributes\n  attribute float billboard;\n  attribute vec2 alignmentOffset;\n  attribute vec3 posePosition;\n  attribute vec3 scale;\n  attribute vec4 textColor;\n  attribute vec4 poseOrientation;\n  attribute vec4 backgroundColor;\n\n  varying vec2 vLineSize;\n\n  varying vec2 vCharBackgroundCoord;\n  varying vec2 vTextAtlasCoord;\n  varying vec4 vTextColor;\n  varying float vBillboard;\n  varying vec2 vCharOffset;\n  varying float vLineBackgroundRadiusRatio;\n  varying vec2 vCharToBackgroundSizeRatio;\n  varying vec2 vLineBackgroundCoord;\n  varying vec4 vBackgroundColor;\n\n  // rotate a 3d point v by a rotation quaternion q\n  // like applyPose(), but we need to use a custom per-instance pose\n  vec3 rotate(vec3 v, vec4 q) {\n    vec3 temp = cross(q.xyz, v) + q.w * v;\n    return v + (2.0 * cross(q.xyz, temp));\n  }\n\n  vec4 computeVertexPosition(vec3 markerPos) {\n    vec3 pos;\n    if (billboard == 1.0) {\n      pos = (billboardRotation * vec4(markerPos, 1.0)).xyz + posePosition;\n    } else {\n      pos = rotate(markerPos, poseOrientation) + posePosition;\n    }\n    return projection * view * vec4(pos, 1.0);\n  }\n\n  void main () {\n    // Scale invariance only works for billboards\n    bool scaleInvariantEnabled = scaleInvariant && billboard == 1.0;\n    vec3 markerSpacePos = vec3((position * backgroundDestSize + destOffset + alignmentOffset) / fontSize, 0);\n\n    if (!scaleInvariantEnabled) {\n      // Apply marker scale only when scale invariance is disabled\n      markerSpacePos *= scale;\n    } else {\n      // If scale invariance is enabled, the text will be rendered at a constant\n      // scale regardless of the zoom level.\n      // The given scaleInvariantSize is in pixels. We need to scale it based on\n      // the current canvas resolution to get the proper dimensions later in NDC\n      float scaleInvariantFactor = scaleInvariantSize / viewportHeight;\n      if (isPerspective) {\n        // When using a perspective projection, the effect is achieved by using\n        // the w-component for scaling, which is obtained by first projecting\n        // the marker position into clip space.\n        gl_Position = computeVertexPosition(markerSpacePos);\n        scaleInvariantFactor *= gl_Position.w;\n        // We also need to take into account the camera's half vertical FOV\n        scaleInvariantFactor *= cameraFovY;\n      } else {\n        // Compute inverse aspect ratio\n        float invAspect = viewportHeight / viewportWidth;\n        // When using orthographic projection, the scaling factor is obtained from\n        // the camera projection itself.\n        // We also need applied the inverse aspect ratio\n        scaleInvariantFactor *= 2.0 * invAspect / length(projection[0].xyz);\n      }\n      // Apply scale invariant factor\n      markerSpacePos *= scaleInvariantFactor;\n    }\n\n    // Compute final vertex position\n    gl_Position = computeVertexPosition(markerSpacePos);\n\n    // Compute additions offsets for the char within the background char within the atlas\n    vec2 charOffsetCoord = vec2(0.5) - ((backgroundDestSize - srcSize) / 2. + charOffset) / backgroundDestSize;\n    vec2 textAtlasCoord = (charOffset + srcOffset + texCoord * backgroundDestSize) / atlasSize;\n\n    // Compute the coords for the full line\n    vec2 lineCoord = (texCoord * backgroundDestSize + destOffset) / roundedBackgroundSize;\n    vLineBackgroundCoord = vec2(lineCoord.x, texCoord.y) * 2. - 1.; // Transform from [0,1] to [-1,1]\n\n    vCharToBackgroundSizeRatio = (srcSize + ${(BUFFER / 2).toFixed(1)}) / backgroundDestSize;\n    vLineBackgroundRadiusRatio = roundedBackgroundSize.y / roundedBackgroundSize.x;\n    \n    vBackgroundColor = backgroundColor;\n    vBillboard = billboard;\n    vCharOffset = charOffsetCoord;\n    vCharBackgroundCoord = texCoord;\n    vTextColor = textColor;\n    vTextAtlasCoord = textAtlasCoord;\n  }\n`;\n\nconst frag = `\n  #extension GL_OES_standard_derivatives : enable\n  precision mediump float;\n\n  uniform bool isHitmap;\n  uniform bool scaleInvariant;\n  uniform float borderRadiusSize;\n  uniform float cutoff;\n  uniform float scaleInvariantSize;\n  uniform sampler2D atlas;\n  uniform float viewportHeight;\n  uniform float viewportWidth;\n  \n  varying float vBillboard;\n  varying float vLineBackgroundRadiusRatio;\n  varying vec2 vCharBackgroundCoord;\n  varying vec2 vCharOffset;\n  varying vec2 vCharToBackgroundSizeRatio;\n  varying vec2 vLineBackgroundCoord;\n  varying vec2 vLineSize;\n  varying vec2 vTextAtlasCoord;\n  varying vec4 vBackgroundColor;\n  varying vec4 vTextColor;\n\n  // fwidth(dist) is used to provide some anti-aliasing. However it's currently only used\n  // when the solid background is enabled, because the alpha blending and\n  // depth test don't work together nicely for partially-transparent pixels.\n  float getAntialisedStep(float dist, float cutoff) {\n    return smoothstep(1. - cutoff - fwidth(dist), 1. - cutoff, dist);\n  }\n\n  float rectangleMask(vec2 uv, vec2 position, vec2 size) {\n    float t = 0.;\n    if ((uv.x > position.x - size.x / 2.) && (uv.x < position.x + size.x / 2.)\n      && (uv.y > position.y - size.y / 2.) && (uv.y < position.y + size.y / 2.)) {\n      t = 1.;\n    }\n    return t;\n  }\n\n  float roundedRectangleMask(vec2 position, vec2 size, float radius) {\n    vec2 q = abs(position) - size + radius;\n    float borderRadius = min(max(q.x,q.y), 0.) + length(max(q, 0.)) - radius;\n    return getAntialisedStep(1. - borderRadius, 0.);\n  }\n\n  void main() {\n    float dist = texture2D(atlas, vTextAtlasCoord).a;\n    float charEdgeStep = getAntialisedStep(dist, cutoff); \n\n    bool skipInterpolate = scaleInvariant && vBillboard == 1. && scaleInvariantSize <= 20.;\n    if (skipInterpolate) {\n      // If scale invariant is enabled and scaleInvariantSize is \"too small\", do not interpolate\n      // the raw distance value since at such small scale, the SDF approach causes some\n      // visual artifacts.\n      // The value used for checking if scaleInvariantSize is \"too small\" is arbitrary and\n      // was defined after some experimentation.\n      charEdgeStep = dist;\n    }\n\n    // Since the background can be bigger than the character from the atlas,\n    // mask out parts of the atlas that fall outside of the character bounds\n    float charMask = rectangleMask(vCharBackgroundCoord, vCharOffset, vCharToBackgroundSizeRatio);\n    vec4 finalColor = mix(vBackgroundColor, vTextColor, charEdgeStep * charMask);\n\n    // Apply rounded corners\n    // Shrink the size of the background by a pixel on each end to help avoid hard edges\n    vec2 pixelEdgeScale = 1. - 2. * vec2(1./viewportWidth, 1./viewportHeight);\n    vec2 backgroundSize = vec2(1., vLineBackgroundRadiusRatio) * pixelEdgeScale;\n    vec2 backgroundPosition = vec2(vLineBackgroundCoord.x, vLineBackgroundCoord.y * vLineBackgroundRadiusRatio);\n    float roundedCornerMask = roundedRectangleMask(backgroundPosition, backgroundSize, borderRadiusSize * vLineBackgroundRadiusRatio);\n    \n    if (!isHitmap) {\n      gl_FragColor = vec4(finalColor.rgb, finalColor.a * roundedCornerMask);\n    } else {\n      gl_FragColor = vTextColor;\n    }\n\n    if (gl_FragColor.a == 0.) {\n      discard;\n    }\n  }\n`;\n\nfunction makeTextCommand(alphabet?: string[]) {\n  // Keep the set of rendered characters around so we don't have to rebuild the font atlas too often.\n  const charSet = new Set(alphabet || []);\n  const memoizedGetAtlasConfig = createMemoizedGenerateAtlasConfigs();\n  const memoizedGenerateAtlas = createMemoizedGenerateAtlas();\n  const memoizedDrawAtlasTexture = createMemoizedDrawAtlasTexture();\n\n  const command = (regl: any) => {\n    if (!regl) {\n      throw new Error(\"Invalid regl instance\");\n    }\n\n    const atlasTexture = regl.texture();\n\n    const drawText = regl({\n      // When using scale invariance, we want the text to be drawn on top\n      // of other elements. This is achieved by disabling depth testing\n      // In addition, make sure the <GLText /> command is the last one\n      // being rendered.\n      depth: {\n        enable: (ctx, props) => (props.scaleInvariant ? false : defaultDepth.enable(ctx, props)),\n        mask: (ctx, props) => (props.scaleInvariant ? false : defaultDepth.mask(ctx, props)),\n      },\n      blend: defaultBlend,\n      primitive: \"triangle strip\",\n      vert,\n      frag,\n      uniforms: {\n        atlas: atlasTexture,\n        atlasSize: () => [atlasTexture.width, atlasTexture.height],\n        fontSize: regl.prop(\"resolution\"),\n        cutoff: CUTOFF,\n        scaleInvariant: regl.prop(\"scaleInvariant\"),\n        scaleInvariantSize: regl.prop(\"scaleInvariantSize\"),\n        borderRadiusSize: regl.prop(\"borderRadiusSize\"),\n        isHitmap: regl.prop(\"isHitmap\"),\n        viewportHeight: regl.context(\"viewportHeight\"),\n        viewportWidth: regl.context(\"viewportWidth\"),\n        isPerspective: regl.context(\"isPerspective\"),\n        cameraFovY: regl.context(\"fovy\"),\n      },\n      instances: regl.prop(\"instances\"),\n      count: 4,\n      attributes: {\n        position: [[0, 0], [0, -1], [1, 0], [1, -1]],\n        texCoord: [[0, 0], [0, 1], [1, 0], [1, 1]], // flipped\n        srcOffset: (ctx, props) => ({ buffer: props.srcOffsets, divisor: 1 }),\n        charOffset: (ctx, props) => ({ buffer: props.charOffsets, divisor: 1 }),\n        destOffset: (ctx, props) => ({ buffer: props.destOffsets, divisor: 1 }),\n        srcSize: (ctx, props) => ({ buffer: props.srcSizes, divisor: 1 }),\n        roundedBackgroundSize: (ctx, props) => ({ buffer: props.lineSizes, divisor: 1 }),\n        backgroundDestSize: (ctx, props) => ({ buffer: props.backgroundDestSizes, divisor: 1 }),\n        scale: (ctx, props) => ({ buffer: props.scale, divisor: 1 }),\n        alignmentOffset: (ctx, props) => ({ buffer: props.alignmentOffset, divisor: 1 }),\n        billboard: (ctx, props) => ({ buffer: props.billboard, divisor: 1 }),\n        textColor: (ctx, props) => ({ buffer: props.textColor, divisor: 1 }),\n        backgroundColor: (ctx, props) => ({ buffer: props.backgroundColor, divisor: 1 }),\n        posePosition: (ctx, props) => ({ buffer: props.posePosition, divisor: 1 }),\n        poseOrientation: (ctx, props) => ({ buffer: props.poseOrientation, divisor: 1 }),\n      },\n    });\n\n    return (props: $ReadOnlyArray<TextMarkerProps>, isHitmap: boolean) => {\n      // Split the text into lines\n      let estimatedInstances = 0;\n      const markersWithSplitText = props.map((marker) => {\n        const { text } = marker;\n        if (typeof text !== \"string\") {\n          throw new Error(`Expected typeof 'text' to be a string. But got type '${typeof text}' instead.`);\n        }\n\n        const charsByLine = text.split(\"\\n\").map((line) => Array.from(line));\n        charsByLine.forEach((line) => {\n          for (const char of text) {\n            ++estimatedInstances;\n            charSet.add(char);\n          }\n        });\n        return { marker, charsByLine };\n      });\n\n      let maybeGeneratedAtlas: ?GeneratedAtlas = command.textAtlas;\n      const generatedAtlasChars = maybeGeneratedAtlas ? Object.keys(maybeGeneratedAtlas.charInfo) : [];\n      const textChars = Array.from(charSet);\n      const generatedAtlasHasAllChars = difference(textChars, generatedAtlasChars).length === 0;\n      if (!maybeGeneratedAtlas || !generatedAtlasHasAllChars) {\n        // See http://webglstats.com/webgl/parameter/MAX_TEXTURE_SIZE - everyone has at least min 2048 texture size, and\n        // almost everyone has at least 4096. With a 2048 width we have ~900 height with a full character set.\n        const maxAtlasWidth: number = regl.limits.maxTextureSize || 2048;\n        const atlasConfigs = memoizedGetAtlasConfig(charSet, charSet.size, command.resolution, \"sans-serif\");\n        maybeGeneratedAtlas = memoizedGenerateAtlas(atlasConfigs, maxAtlasWidth);\n      }\n      if (!maybeGeneratedAtlas) {\n        return; // Make flow happy\n      }\n      const generatedAtlas: GeneratedAtlas = maybeGeneratedAtlas;\n      memoizedDrawAtlasTexture(generatedAtlas, atlasTexture);\n\n      const destOffsets = new Float32Array(estimatedInstances * 2);\n      const backgroundDestSizes = new Float32Array(estimatedInstances * 2);\n      const srcSizes = new Float32Array(estimatedInstances * 2);\n      const srcOffsets = new Float32Array(estimatedInstances * 2);\n      const charOffsets = new Float32Array(estimatedInstances * 2);\n      const lineSizes = new Float32Array(estimatedInstances * 2);\n\n      // These don't vary across characters within a marker, but the divisor can't be dynamic so we have to duplicate the data for each character.\n      const alignmentOffset = new Float32Array(estimatedInstances * 2);\n      const scale = new Float32Array(estimatedInstances * 3);\n      const textColor = new Float32Array(estimatedInstances * 4);\n      const backgroundColor = new Float32Array(estimatedInstances * 4);\n      const billboard = new Float32Array(estimatedInstances);\n      const posePosition = new Float32Array(estimatedInstances * 3);\n      const poseOrientation = new Float32Array(estimatedInstances * 4);\n\n      let totalInstances = 0;\n\n      // Markers sharing the same position will be rendered in multiple lines.\n      // We keep track of offsets for the y-coordinate.\n      // We cannot use same value comparison here, so the\n      // key of the map is a hash based on the marker's position\n      // (see hashMarkerPosition() above).\n      const yOffsets = new Map<string, number>();\n\n      for (const { marker, charsByLine } of markersWithSplitText) {\n        let totalWidth = 0;\n        let x = 0;\n        let y = getMarkerYOffset(yOffsets, marker);\n        let markerInstances = 0;\n\n        // If we need to render text for hitmap framebuffer, we only render the polygons using\n        // the foreground color (which needs to be converted to RGBA since it's a vec4).\n        // See comment on fragment shader above\n        const fgColor = toColor(\n          isHitmap ? marker.color || [0, 0, 0, 1] : marker.colors?.[0] || marker.color || BG_COLOR_LIGHT\n        );\n        const bgColor = toColor(\n          marker.colors?.[1] ||\n            (command.autoBackgroundColor && (isColorDark(fgColor) ? BG_COLOR_LIGHT : BG_COLOR_DARK)) ||\n            BG_COLOR_TRANSPARENT\n        );\n        const hlColor = marker?.highlightColor || { r: 1, b: 0, g: 1, a: 1 };\n        const hlColorText = isColorDark(hlColor) ? BG_COLOR_LIGHT : BG_COLOR_DARK;\n\n        const paddingScaleX = command.paddingScale?.[0] ?? 1;\n        const paddingScaleY = command.paddingScale?.[1] ?? paddingScaleX;\n\n        const paddingX = ((paddingScaleX - 1) * command.resolution) / 2;\n        const paddingY = ((paddingScaleY - 1) * command.resolution) / 2;\n\n        const lineHeight = command.resolution + paddingY * 2;\n\n        // In order to make sure there's enough room for glyphs' descenders (i.e. 'g'),\n        // we need to apply an extra offset based on the font resolution.\n        // The value used to compute the offset is a result of experimentation.\n        const charDescenderLineShift = -0.25 * command.resolution;\n\n        let runningGlyphCount = 0;\n        for (let lineIndex = 0; lineIndex < charsByLine.length; lineIndex++) {\n          const chars = charsByLine[lineIndex];\n\n          // Calculate the entire line's width ahead of time in order to calculate the rounded corners properly\n          const totalLineWidth = chars.reduce((total, char) => {\n            const info = generatedAtlas.charInfo[char];\n            return total + info.width;\n          }, paddingX * 2);\n\n          for (let i = 0; i < chars.length; i++) {\n            const char = chars[i];\n            const info = generatedAtlas.charInfo[char];\n            const index = totalInstances + markerInstances;\n\n            const firstCharOnLine = i === 0;\n            const lastCharOnLine = i === chars.length - 1;\n\n            const charIndex = runningGlyphCount + lineIndex + i;\n            const charHighlighted =\n              !isHitmap && marker.highlightedIndices && marker.highlightedIndices.includes(charIndex);\n            const charTextColor = charHighlighted ? hlColorText : fgColor;\n            const charBackgroundColor = charHighlighted ? hlColor : bgColor;\n\n            // Calculate per-character attributes\n            destOffsets[2 * index + 0] = x;\n            destOffsets[2 * index + 1] = -y;\n\n            // The offset from the top-left of the atlas to the top-left corner of each character\n            srcOffsets[2 * index + 0] = info.x + BUFFER;\n            srcOffsets[2 * index + 1] = info.y + BUFFER;\n\n            // Size of each character in the atlas in pixels\n            srcSizes[2 * index + 0] = info.width;\n            srcSizes[2 * index + 1] = info.height;\n\n            // The size of the background rectangle in pixels\n            backgroundDestSizes[2 * index + 0] =\n              info.width + (firstCharOnLine ? paddingX : 0) + (lastCharOnLine ? paddingX : 0);\n            backgroundDestSizes[2 * index + 1] = lineHeight;\n\n            // The size of all characters in the line in pixels. Used for rounded corners\n            lineSizes[2 * index + 0] = totalLineWidth;\n            lineSizes[2 * index + 1] = lineHeight;\n\n            // Additional offset for each character within the background rectangle in pixels\n            charOffsets[2 * index + 0] = firstCharOnLine ? -paddingX : 0;\n            charOffsets[2 * index + 1] = -(info.yOffset ?? 0) - charDescenderLineShift - paddingY;\n\n            x += backgroundDestSizes[2 * index + 0];\n            totalWidth = Math.max(totalWidth, x);\n\n            // Copy per-marker attributes. These are duplicated per character so that we can draw\n            // all characters from all markers in a single draw call.\n\n            billboard[index] = Number(marker.billboard ?? true);\n\n            scale[3 * index + 0] = marker.scale.x;\n            scale[3 * index + 1] = marker.scale.y;\n            scale[3 * index + 2] = marker.scale.z;\n\n            posePosition[3 * index + 0] = marker.pose.position.x;\n            posePosition[3 * index + 1] = marker.pose.position.y;\n            posePosition[3 * index + 2] = marker.pose.position.z;\n\n            poseOrientation[4 * index + 0] = marker.pose.orientation.x;\n            poseOrientation[4 * index + 1] = marker.pose.orientation.y;\n            poseOrientation[4 * index + 2] = marker.pose.orientation.z;\n            poseOrientation[4 * index + 3] = marker.pose.orientation.w;\n\n            textColor[4 * index + 0] = charTextColor.r;\n            textColor[4 * index + 1] = charTextColor.g;\n            textColor[4 * index + 2] = charTextColor.b;\n            textColor[4 * index + 3] = charTextColor.a;\n\n            backgroundColor[4 * index + 0] = charBackgroundColor.r;\n            backgroundColor[4 * index + 1] = charBackgroundColor.g;\n            backgroundColor[4 * index + 2] = charBackgroundColor.b;\n            backgroundColor[4 * index + 3] = charBackgroundColor.a;\n\n            ++markerInstances;\n          }\n\n          // Reset values for the next line\n          x = 0;\n          y += lineHeight;\n          runningGlyphCount += chars.length;\n        }\n        y -= lineHeight;\n\n        const totalHeight = y + command.resolution;\n        for (let i = 0; i < markerInstances; i++) {\n          alignmentOffset[2 * (totalInstances + i) + 0] = -totalWidth / 2;\n          alignmentOffset[2 * (totalInstances + i) + 1] = totalHeight / 2;\n        }\n\n        // Compute the y-coordinate's offset for the next overlapped marker, if any.\n        // Basically, we add as many offsets as numbers of lines in the marker's text.\n        // Since the y-coordinate is inverted when computing destOffset[] a few lines above\n        // we need an additional command.resolution offset (precomputed in totalHeight).\n        setMarkerYOffset(yOffsets, marker, totalHeight + charsByLine.length * command.resolution);\n\n        totalInstances += markerInstances;\n      }\n\n      drawText({\n        instances: totalInstances,\n\n        isHitmap: !!isHitmap,\n        resolution: command.resolution,\n        borderRadiusSize: command.borderRadius || 0,\n        scaleInvariant: command.scaleInvariant,\n        scaleInvariantSize: command.scaleInvariantSize,\n\n        // per-character\n        srcOffsets,\n        charOffsets,\n        destOffsets,\n        srcSizes,\n        lineSizes,\n        backgroundDestSizes,\n        textColor,\n        backgroundColor,\n\n        // per-marker\n        alignmentOffset,\n        billboard,\n        poseOrientation,\n        posePosition,\n        scale,\n      });\n    };\n  };\n  command.autoBackgroundColor = false;\n  return command;\n}\n\nexport const makeGLTextCommand = (props: GLTextProps) => {\n  const command = makeTextCommand(props.alphabet);\n  // HACK: Worldview doesn't provide an easy way to pass a command-level prop into the regl commands,\n  // so just attach it to the command object for now.\n  command.autoBackgroundColor = props.autoBackgroundColor;\n  command.resolution = Math.max(MIN_RESOLUTION, props.resolution || DEFAULT_RESOLUTION);\n  command.scaleInvariant = props.scaleInvariantFontSize != null;\n  command.scaleInvariantSize = props.scaleInvariantFontSize ?? 0;\n  command.textAtlas = props.textAtlas;\n  command.borderRadius = props.borderRadius;\n  command.paddingScale = props.paddingScale;\n\n  return command;\n};\n\nexport default function GLText(props: Props) {\n  const [command] = useState(() => makeGLTextCommand(props));\n  const getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\n\n  return <Command getChildrenForHitmap={getChildrenForHitmap} reglCommand={command} {...props} />;\n}\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4 } from \"gl-matrix\";\nimport memoizeWeak from \"memoize-weak\";\nimport React, { useContext, useState, useEffect, useCallback, useDebugValue } from \"react\";\n\nimport type { Pose, Scale, MouseHandler } from \"../types\";\nimport { defaultBlend, pointToVec3, orientationToVec4 } from \"../utils/commandUtils\";\nimport { getChildrenForHitmapWithOriginalMarker } from \"../utils/getChildrenForHitmapDefaults\";\nimport parseGLB, { type GLBModel } from \"../utils/parseGLB\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\nimport Command from \"./Command\";\n\nfunction glConstantToRegl(value: ?number): ?string {\n  if (value === undefined) {\n    return undefined;\n  }\n  // prettier-ignore\n  switch (value) {\n    // min/mag filters\n    case WebGLRenderingContext.NEAREST: return \"nearest\";\n    case WebGLRenderingContext.LINEAR: return \"linear\";\n    case WebGLRenderingContext.NEAREST_MIPMAP_NEAREST: return \"nearest mipmap nearest\";\n    case WebGLRenderingContext.NEAREST_MIPMAP_LINEAR: return \"nearest mipmap linear\";\n    case WebGLRenderingContext.LINEAR_MIPMAP_NEAREST: return \"linear mipmap nearest\";\n    case WebGLRenderingContext.LINEAR_MIPMAP_LINEAR: return \"linear mipmap linear\";\n    // texture wrapping modes\n    case WebGLRenderingContext.REPEAT: return \"repeat\";\n    case WebGLRenderingContext.CLAMP_TO_EDGE: return \"clamp\";\n    case WebGLRenderingContext.MIRRORED_REPEAT: return \"mirror\";\n  }\n  throw new Error(`unhandled constant value ${JSON.stringify(value)}`);\n}\n\n// Default sampler set based on GLTF recommendations:\n// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#texture\nconst getDefaultSampler = () => ({\n  minFilter: WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,\n  magFilter: WebGLRenderingContext.LINEAR,\n  wrapS: WebGLRenderingContext.REPEAT,\n  wrapT: WebGLRenderingContext.REPEAT,\n});\n\nconst getSceneToDraw = ({ json }) => {\n  if (json.scene != null) {\n    return json.scene;\n  }\n  // Draw the first scene if the scene key is missing.\n  const keys = Object.keys(json.scenes ?? {});\n  if (keys.length === 0) {\n    throw new Error(\"No scenes to render\");\n  }\n  return keys[0];\n};\n\nconst drawModel = (regl) => {\n  if (!regl) {\n    throw new Error(\"Invalid regl instance\");\n  }\n\n  const command = regl({\n    primitive: \"triangles\",\n    blend: defaultBlend,\n    uniforms: {\n      globalAlpha: regl.context(\"globalAlpha\"),\n      poseMatrix: regl.context(\"poseMatrix\"),\n\n      baseColorTexture: regl.prop(\"baseColorTexture\"),\n      baseColorFactor: regl.prop(\"baseColorFactor\"),\n      nodeMatrix: regl.prop(\"nodeMatrix\"),\n      \"light.direction\": [0, 0, -1],\n      \"light.ambientIntensity\": 0.5,\n      \"light.diffuseIntensity\": 0.5,\n      hitmapColor: regl.context(\"hitmapColor\"),\n      isHitmap: regl.context(\"isHitmap\"),\n    },\n    attributes: {\n      position: regl.prop(\"positions\"),\n      normal: regl.prop(\"normals\"),\n      texCoord: regl.prop(\"texCoords\"),\n    },\n    elements: regl.prop(\"indices\"),\n    vert: `\n  uniform mat4 projection, view;\n  uniform mat4 nodeMatrix;\n  uniform mat4 poseMatrix;\n  attribute vec3 position, normal;\n  varying vec3 vNormal;\n  attribute vec2 texCoord;\n  varying vec2 vTexCoord;\n\n  void main() {\n    // using the projection matrix for normals breaks lighting for orthographic mode\n    mat4 mv = view * poseMatrix * nodeMatrix;\n    vNormal = normalize((mv * vec4(normal, 0)).xyz);\n    vTexCoord = texCoord;\n    gl_Position = projection * mv * vec4(position, 1);\n  }\n  `,\n    frag: `\n  precision mediump float;\n  uniform bool isHitmap;\n  uniform vec4 hitmapColor;\n  uniform float globalAlpha;\n  uniform sampler2D baseColorTexture;\n  uniform vec4 baseColorFactor;\n  varying mediump vec2 vTexCoord;\n  varying mediump vec3 vNormal;\n\n  // Basic directional lighting from:\n  // http://ogldev.atspace.co.uk/www/tutorial18/tutorial18.html\n  struct DirectionalLight {\n    mediump vec3 direction;\n    lowp float ambientIntensity;\n    lowp float diffuseIntensity;\n  };\n  uniform DirectionalLight light;\n\n  void main() {\n    vec4 baseColor = texture2D(baseColorTexture, vTexCoord) * baseColorFactor;\n    float diffuse = light.diffuseIntensity * max(0.0, dot(vNormal, -light.direction));\n    gl_FragColor = isHitmap ? hitmapColor : vec4((light.ambientIntensity + diffuse) * baseColor.rgb, baseColor.a * globalAlpha);\n  }\n  `,\n  });\n\n  // default values for when baseColorTexture is not specified\n  const singleTexCoord = regl.buffer([0, 0]);\n  const whiteTexture = regl.texture({\n    data: [255, 255, 255, 255],\n    width: 1,\n    height: 1,\n  });\n\n  // build the draw calls needed to draw the model. This will happen whenever the model changes.\n  const getDrawCalls = memoizeWeak((model: GLBModel) => {\n    // upload textures to the GPU\n    const { accessors } = model;\n    const textures =\n      model.json.textures &&\n      model.json.textures.map((textureInfo) => {\n        const sampler = textureInfo.sampler ? model.json.samplers[textureInfo.sampler] : getDefaultSampler();\n        const bitmap = model.images && model.images[textureInfo.source];\n        const texture = regl.texture({\n          data: bitmap,\n          min: glConstantToRegl(sampler.minFilter),\n          mag: glConstantToRegl(sampler.magFilter),\n          wrapS: glConstantToRegl(sampler.wrapS),\n          wrapT: glConstantToRegl(sampler.wrapT),\n        });\n        return texture;\n      });\n    if (model.images) {\n      model.images.forEach((bitmap: ImageBitmap) => bitmap.close());\n    }\n\n    const drawCalls = [];\n    // helper to draw the primitives comprising a mesh\n    function drawMesh(mesh, nodeMatrix) {\n      for (const primitive of mesh.primitives) {\n        const material = model.json.materials[primitive.material];\n        const texInfo = material.pbrMetallicRoughness.baseColorTexture;\n\n        let primitiveAccessors = accessors;\n        const { extensions = {} } = primitive;\n        const dracoCompressionEXT = extensions.KHR_draco_mesh_compression;\n        if (dracoCompressionEXT) {\n          // If mesh contains compressed data, accessors will be available inside\n          // the draco extension. See `parseGLB.js` and `draco.js` files.\n          primitiveAccessors = dracoCompressionEXT.accessors;\n        }\n        if (!primitiveAccessors) {\n          throw new Error(\"Error decoding GLB model: Missing `accessors` in JSON data\");\n        }\n\n        drawCalls.push({\n          indices: primitiveAccessors[primitive.indices],\n          positions: primitiveAccessors[primitive.attributes.POSITION],\n          normals: primitiveAccessors[primitive.attributes.NORMAL],\n          texCoords: texInfo\n            ? primitiveAccessors[primitive.attributes[`TEXCOORD_${texInfo.texCoord || 0}`]]\n            : { divisor: 1, buffer: singleTexCoord },\n          baseColorTexture: texInfo ? textures[texInfo.index] : whiteTexture,\n          baseColorFactor: material.pbrMetallicRoughness.baseColorFactor || [1, 1, 1, 1],\n          nodeMatrix,\n        });\n      }\n    }\n\n    // helper to draw all the meshes contained in a node and its child nodes\n    function drawNode(node, parentMatrix) {\n      const nodeMatrix = node.matrix\n        ? mat4.clone(node.matrix)\n        : mat4.fromRotationTranslationScale(\n            mat4.create(),\n            node.rotation || [0, 0, 0, 1],\n            node.translation || [0, 0, 0],\n            node.scale || [1, 1, 1]\n          );\n      mat4.mul(nodeMatrix, parentMatrix, nodeMatrix);\n      if (node.mesh != null) {\n        drawMesh(model.json.meshes[node.mesh], nodeMatrix);\n      }\n      if (node.children) {\n        for (const childIdx of node.children) {\n          drawNode(model.json.nodes[childIdx], nodeMatrix);\n        }\n      }\n    }\n\n    // finally, draw each of the main scene's nodes. Use the first scene if one isn't specified\n    // explicitly.\n    for (const nodeIdx of model.json.scenes[getSceneToDraw(model)].nodes) {\n      const rootTransform = mat4.create();\n      mat4.rotateX(rootTransform, rootTransform, Math.PI / 2);\n      mat4.rotateY(rootTransform, rootTransform, Math.PI / 2);\n      drawNode(model.json.nodes[nodeIdx], rootTransform);\n    }\n    return drawCalls;\n  });\n\n  // create a regl command to set the context for each draw call\n  const withContext = regl({\n    context: {\n      poseMatrix: (context, props) =>\n        mat4.fromRotationTranslationScale(\n          mat4.create(),\n          orientationToVec4(props.pose.orientation),\n          pointToVec3(props.pose.position),\n          props.scale ? pointToVec3(props.scale) : [1, 1, 1]\n        ),\n      globalAlpha: (context, props) => (props.alpha == null ? 1 : props.alpha),\n      hitmapColor: (context, props) => props.color || [0, 0, 0, 1],\n      isHitmap: (context, props) => !!props.isHitmap,\n    },\n  });\n\n  return (props, isHitmap) => {\n    const drawCalls = getDrawCalls(props.model);\n    withContext(isHitmap ? { ...props, isHitmap } : props, () => {\n      command(drawCalls);\n    });\n  };\n};\n\ntype Props = {|\n  model: string | (() => Promise<GLBModel>),\n  onClick?: MouseHandler,\n  onDoubleClick?: MouseHandler,\n  onMouseDown?: MouseHandler,\n  onMouseMove?: MouseHandler,\n  onMouseUp?: MouseHandler,\n  children: {\n    pose: Pose,\n    scale: Scale,\n    alpha?: ?number,\n  },\n|};\n\nfunction useAsyncValue<T>(fn: () => Promise<T>, deps: ?(any[])): ?T {\n  const [value, setValue] = useState<?T>();\n  useEffect(\n    useCallback(() => {\n      let unloaded = false;\n      fn().then((result) => {\n        if (!unloaded) {\n          setValue(result);\n        }\n      });\n      return () => {\n        unloaded = true;\n        setValue(undefined);\n      };\n    }, deps || [fn]),\n    deps || [fn]\n  );\n  return value;\n}\n\nfunction useModel(model: string | (() => Promise<GLBModel>)): ?GLBModel {\n  useDebugValue(model);\n  return useAsyncValue(async () => {\n    if (typeof model === \"function\") {\n      return model();\n    }\n    if (typeof model === \"string\") {\n      const response = await fetch(model);\n      if (!response.ok) {\n        throw new Error(`failed to fetch GLTF model: ${response.status}`);\n      }\n      return parseGLB(await response.arrayBuffer());\n    }\n\n    /*:: (model: empty) */\n    throw new Error(`unsupported model prop: ${typeof model}`);\n  }, [model]);\n}\n\nexport default function GLTFScene(props: Props) {\n  const { children, model, ...rest } = props;\n\n  const context = useContext(WorldviewReactContext);\n  const loadedModel = useModel(model);\n  useEffect(() => {\n    if (context) {\n      context.onDirty();\n    }\n  }, [context, loadedModel]);\n\n  if (!loadedModel) {\n    return null;\n  }\n\n  return (\n    <Command {...rest} reglCommand={drawModel} getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker}>\n      {{ ...children, model: loadedModel, originalMarker: children }}\n    </Command>\n  );\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport { withPose } from \"../utils/commandUtils\";\nimport { nonInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nconst DEFAULT_GRID_COLOR = [0.3, 0.3, 0.3, 1];\n\nexport function grid() {\n  return withPose({\n    vert: `\n    precision mediump float;\n    uniform mat4 projection, view;\n\n    attribute vec3 point;\n    attribute vec4 color;\n    varying vec4 fragColor;\n\n    void main () {\n      fragColor = color;\n      vec3 p = point;\n      gl_Position = projection * view * vec4(p, 1);\n    }\n    `,\n    frag: `\n      precision mediump float;\n      varying vec4 fragColor;\n      void main () {\n        gl_FragColor = fragColor;\n      }\n    `,\n    primitive: \"lines\",\n    attributes: {\n      point: (context, props) => {\n        const points = [];\n        const bound = props.count;\n        for (let i = -props.count; i < props.count; i++) {\n          points.push([-bound, i, 0]);\n          points.push([bound, i, 0]);\n          points.push([i, -bound, 0]);\n          points.push([i, bound, 0]);\n        }\n        return points;\n      },\n      color: (context, props) => {\n        const color = props.color || DEFAULT_GRID_COLOR;\n        return new Array(props.count * 4 * 2).fill(color);\n      },\n    },\n    count: (context, props) => {\n      // 8 points per count\n      const count = props.count * 4 * 2;\n      return count;\n    },\n  });\n}\n\ntype Props = {\n  ...CommonCommandProps,\n  count: number,\n};\n\n// useful for rendering a grid for debugging in stories\n\nexport default function Grid({ count, ...rest }: Props) {\n  const children = { count };\n  return (\n    <Command getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...rest} reglCommand={grid}>\n      {children}\n    </Command>\n  );\n}\n\nGrid.defaultProps = { count: 6 };\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Point, Vec3, Dimensions, Pose } from \"../types\";\nimport { type WorldviewContextType } from \"../WorldviewContext\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\n\ntype PoseObj = { pose: Pose };\ntype RenderItemInput<T: PoseObj> = {\n  item: T,\n  coordinates: ?Vec3,\n  index: number,\n  dimension: Dimensions,\n};\n\ntype Props<T: PoseObj> = {\n  children: T[],\n  renderItem: (RenderItemInput<T>) => React.Node,\n};\n\ntype State = {\n  items: React.Node[],\n};\n\n// A command that renders arbitrary DOM nodes on top of the Worldview 3D scene.\n// It supplies coordinates to the `renderItem` prop for positioning DOM nodes relative to the canvas.\nexport default class Overlay<T: PoseObj> extends React.Component<Props<T>, State> {\n  _context: ?WorldviewContextType;\n  state = { items: [] };\n\n  componentDidMount() {\n    if (this._context) {\n      this._context.registerPaintCallback(this.paint);\n    }\n  }\n\n  componentWillUnmount = () => {\n    if (this._context) {\n      this._context.unregisterPaintCallback(this.paint);\n    }\n  };\n\n  paint = () => {\n    const context = this._context;\n    const dimension = context && context.dimension;\n    const { renderItem, children } = this.props;\n    if (!context || !dimension) {\n      return;\n    }\n    const items = children.map((item, index) => {\n      const coordinates = this.project(item.pose.position, context);\n      return renderItem({ item, index, coordinates, dimension });\n    });\n    this.setState({ items });\n  };\n\n  project = (point: Point, context: ?WorldviewContextType): ?Vec3 => {\n    if (!context || !context.initializedData) {\n      return;\n    }\n    const { dimension } = context;\n    const { camera } = context.initializedData;\n\n    const vec = [point.x, point.y, point.z];\n    const { left, top, width, height } = dimension;\n    const viewport = [left, top, width, height];\n    return camera.toScreenCoord(viewport, vec);\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        <WorldviewReactContext.Consumer>\n          {(ctx: ?WorldviewContextType) => {\n            if (ctx) {\n              this._context = ctx;\n            }\n            return this.state.items;\n          }}\n        </WorldviewReactContext.Consumer>\n      </React.Fragment>\n    );\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useState } from \"react\";\n\nimport type { PointType, Regl } from \"../types\";\nimport { getVertexColors, pointToVec3, withPose } from \"../utils/commandUtils\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\ntype PointsProps = {|\n  useWorldSpaceSize?: boolean,\n|};\n\ntype Props = {\n  // $FlowFixMe: flow does not know how to handle the indexed property in CommonCommandProps\n  ...CommonCommandProps,\n  ...PointsProps,\n  children: $ReadOnlyArray<PointType>,\n};\n\nexport const makePointsCommand = ({ useWorldSpaceSize }: PointsProps) => {\n  return (regl: Regl) => {\n    if (!regl) {\n      throw new Error(\"Invalid regl instance\");\n    }\n\n    const [minLimitPointSize, maxLimitPointSize] = regl.limits.pointSizeDims;\n    return withPose({\n      primitive: \"points\",\n      vert: `\n    precision mediump float;\n\n    #WITH_POSE\n\n    uniform mat4 projection, view;\n    uniform float pointSize;\n    uniform bool useWorldSpaceSize;\n    uniform float viewportWidth;\n    uniform float viewportHeight;\n    uniform float minPointSize;\n    uniform float maxPointSize;\n\n    attribute vec3 point;\n    attribute vec4 color;\n    varying vec4 fragColor;\n    void main () {\n      vec3 pos = applyPose(point);\n      gl_Position = projection * view * vec4(pos, 1);\n      fragColor = color;\n\n      if (useWorldSpaceSize) {\n        // Calculate the point size based on world dimensions:\n        // First, we need to compute a new point that is one unit away from\n        // the center of the current point being rendered. We do it in view space\n        // in order to make sure the new point is always one unit up and it's not\n        // affected by view rotation.\n        vec4 up = projection * (view * vec4(pos, 1.0) + vec4(0.0, 1.0, 0.0, 0.0));\n\n        // Then, we compute the distance between both points in clip space, dividing\n        // by the w-component to account for distance in perspective projection.\n        float d = length(up.xyz / up.w - gl_Position.xyz / gl_Position.w);\n\n        // Finally, the point size is calculated using the size of the render target\n        // and it's aspect ratio. We multiply it by 0.5 since distance in clip space\n        // is in range [0, 2] (because clip space's range is [-1, 1]) and\n        // we need it to be [0, 1].\n        float invAspect = viewportHeight / viewportWidth;\n        gl_PointSize = pointSize * 0.5 * d * viewportWidth * invAspect;\n      } else {\n        gl_PointSize = pointSize;\n      }\n\n      // Finally, ensure the calculated point size is within the limits.\n      gl_PointSize = min(maxPointSize, max(minPointSize, gl_PointSize));\n    }\n    `,\n      frag: `\n    precision mediump float;\n    varying vec4 fragColor;\n    void main () {\n      gl_FragColor = vec4(fragColor.x, fragColor.y, fragColor.z, 1);\n    }\n    `,\n      attributes: {\n        point: (context, props) => {\n          return props.points.map((point) => (Array.isArray(point) ? point : pointToVec3(point)));\n        },\n        color: (context, props) => {\n          const colors = getVertexColors(props);\n          return colors;\n        },\n      },\n\n      uniforms: {\n        pointSize: (context, props) => {\n          return props.scale.x || 1;\n        },\n        useWorldSpaceSize: !!useWorldSpaceSize,\n        viewportWidth: regl.context(\"viewportWidth\"),\n        viewportHeight: regl.context(\"viewportHeight\"),\n        minPointSize: minLimitPointSize,\n        maxPointSize: maxLimitPointSize,\n      },\n\n      count: regl.prop(\"points.length\"),\n    });\n  };\n};\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Points(props: Props) {\n  const [command] = useState(() => makePointsCommand(props));\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={command} />;\n}\n","//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useLayoutEffect } from \"react\";\n\nimport { generateAtlas } from \"../commands/GLText\";\n\nconst MAX_ATLAS_WIDTH = 2048;\n\nconst SDFGenerator = ({ atlasConfigs }) => {\n  const canvasRef = React.useRef();\n  const atlasData = React.useRef({ textureWidth: MAX_ATLAS_WIDTH, textureHeight: MAX_ATLAS_WIDTH });\n\n  const regenerateAtlas = React.useCallback(async () => {\n    const canEl = canvasRef.current;\n    if (canEl) {\n      const { charInfo, textureWidth, textureHeight, textureData } = generateAtlas(atlasConfigs, MAX_ATLAS_WIDTH);\n      atlasData.current = { charInfo, textureData, textureWidth, textureHeight };\n\n      const ctx = canEl.getContext(\"2d\");\n      canEl.width = textureWidth;\n      canEl.height = textureHeight;\n      ctx.clearRect(0, 0, canEl.width, canEl.height);\n      ctx.putImageData(makeRGBAImageData(ctx, textureData, textureWidth, textureHeight), 0, 0);\n    }\n  }, [atlasConfigs]);\n\n  const downloadAtlasFiles = React.useCallback(() => {\n    const canEl = canvasRef.current;\n    if (canEl) {\n      const { charInfo, textureWidth, textureHeight, textureData } = atlasData.current;\n      const textAtlasJson = {\n        charInfo,\n        textureWidth,\n        textureHeight,\n      };\n      const textAtlasJsonStr = JSON.stringify(textAtlasJson, null, 2);\n      const dataStr = `data:text/json;charset=utf-8,${encodeURIComponent(textAtlasJsonStr)}`;\n      downloadURL(dataStr, \"textAtlas.json\");\n\n      const blob = new Blob([textureData], { type: \"application/octet-stream\" });\n      const url = window.URL.createObjectURL(blob);\n      downloadURL(url, \"textureAtlasData.bin\");\n      setTimeout(() => window.URL.revokeObjectURL(url));\n    }\n  }, []);\n\n  // Regenerate the atlas once all fonts have loaded\n  useLayoutEffect(() => {\n    // $FlowFixMe - Flow doesn't understand document.fonts\n    document.fonts.ready.then(() => {\n      regenerateAtlas();\n    });\n  }, []);\n\n  return (\n    <div style={{ margin: 16 }}>\n      <button style={{ margin: 16 }} onClick={regenerateAtlas}>\n        Regenerate atlas\n      </button>\n      <button style={{ margin: 16 }} onClick={downloadAtlasFiles}>\n        Download atlas files\n      </button>\n      <canvas\n        ref={canvasRef}\n        width={atlasData.current.textureWidth}\n        height={atlasData.current.textureHeight}\n        style={{ backgroundColor: \"white\" }}\n      />\n    </div>\n  );\n};\n\n// Convert alpha-only to RGBA so we can use `putImageData` for building the composite bitmap\nfunction makeRGBAImageData(ctx, alphaChannel, width, height) {\n  const imageData = ctx.createImageData(width, height);\n  for (let i = 0; i < alphaChannel.length; i++) {\n    imageData.data[4 * i + 0] = alphaChannel[i];\n    imageData.data[4 * i + 1] = alphaChannel[i];\n    imageData.data[4 * i + 2] = alphaChannel[i];\n    imageData.data[4 * i + 3] = 255;\n  }\n  return imageData;\n}\n\nfunction downloadURL(data, fileName) {\n  const a = Object.assign(document.createElement(\"a\"), {\n    href: data,\n    download: fileName,\n  });\n  if (document.body) {\n    document.body.appendChild(a);\n  }\n  a.style.display = \"none\";\n  a.click();\n  a.remove();\n}\n\nexport default SDFGenerator;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport BorderAllIcon from \"@mdi/svg/svg/border-all.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport ExpandAllOutlineIcon from \"@mdi/svg/svg/expand-all-outline.svg\";\nimport FullscreenIcon from \"@mdi/svg/svg/fullscreen.svg\";\nimport GridLargeIcon from \"@mdi/svg/svg/grid-large.svg\";\nimport TrashCanOutlineIcon from \"@mdi/svg/svg/trash-can-outline.svg\";\nimport cx from \"classnames\";\nimport { last, without, xor } from \"lodash\";\nimport React, { useState, useCallback, useContext, useMemo, useRef, type ComponentType } from \"react\";\nimport DocumentEvents from \"react-document-events\";\nimport {\n  MosaicContext,\n  type MosaicRootActions,\n  type MosaicWindowActions,\n  MosaicWindowContext,\n  getNodeAtPath,\n  getOtherBranch,\n  getPathFromNode,\n  isParent,\n  updateTree,\n} from \"react-mosaic-component\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\n\nimport styles from \"./Panel.module.scss\";\nimport { addSelectedPanelId, removeSelectedPanelId, setSelectedPanelIds } from \"webviz-core/src/actions/mosaic\";\nimport {\n  savePanelConfigs,\n  saveFullPanelConfig,\n  changePanelLayout,\n  createTabPanel,\n  setFullScreenPanel,\n  clearFullScreenPanel,\n} from \"webviz-core/src/actions/panels\";\nimport Button from \"webviz-core/src/components/Button\";\nimport ErrorBoundary from \"webviz-core/src/components/ErrorBoundary\";\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport MosaicDragHandle from \"webviz-core/src/components/PanelToolbar/MosaicDragHandle\";\nimport { type ShortcutConfig } from \"webviz-core/src/components/ShortcutsModal\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport PanelList, { getPanelsByType } from \"webviz-core/src/panels/PanelList\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport { type TabPanelConfig } from \"webviz-core/src/types/layouts\";\nimport type {\n  CreateTabPanelPayload,\n  EditHistoryOptions,\n  SaveConfigsPayload,\n  SaveFullConfigPayload,\n  PanelConfig,\n  SaveConfig,\n} from \"webviz-core/src/types/panels\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { TAB_PANEL_TYPE } from \"webviz-core/src/util/globalConstants\";\nimport {\n  getAllPanelIds,\n  getPanelIdForType,\n  getPanelTypeFromId,\n  getParentTabPanelByPanelId,\n  isTabPanel,\n  updateTabPanelLayout,\n} from \"webviz-core/src/util/layout\";\nimport { getEventTags, getEventInfos, logEventAction } from \"webviz-core/src/util/logEvent\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\ntype Props<Config> = { childId?: string, config?: Config, saveConfig?: (Config) => void, tabId?: string };\ntype ActionProps = {|\n  savePanelConfigs: (SaveConfigsPayload) => void,\n  saveFullPanelConfig: (SaveFullConfigPayload) => PanelConfig,\n  changePanelLayout: (panels: any) => void,\n  addSelectedPanelId: (panelId: string) => void,\n  removeSelectedPanelId: (panelId: string) => void,\n  setSelectedPanelIds: (panelIds: string[]) => void,\n  createTabPanel: (CreateTabPanelPayload) => void,\n  setFullScreenPanel: (panelId: string, locked: boolean) => void,\n  clearFullScreenPanel: (panelId: string) => void,\n|};\n\ninterface PanelStatics<Config> {\n  panelType: string;\n  defaultConfig: Config;\n  shortcuts?: ShortcutConfig[];\n}\nexport type PanelComponentType<T> = ComponentType<Props<T>> & PanelStatics<T>;\n\nconst EMPTY_CONFIG = Object.freeze({});\n\n// HOC that wraps panel in an error boundary and flex box.\n// Gives panel a `config` and `saveConfig`.\n//   export default Panel(MyPanelComponent)\n//\n// `config` comes from Redux, but in stories / tests you can pass in your own:\n//   `<MyPanel config={} />`\nexport default function Panel<Config: PanelConfig>(\n  PanelComponent: (\n    | ComponentType<{}>\n    | ComponentType<\n        $Shape<{\n          config: Config,\n          saveConfig: SaveConfig<Config>,\n          openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n          topics: Topic[],\n          capabilities: string[],\n          datatypes: RosDatatypes,\n          isHovered: boolean,\n        }>\n      >\n  ) &\n    PanelStatics<Config>\n  // TODO(JP): Add `& PanelStatics<Config>` to the return type when we have figured out\n  // https://stackoverflow.com/questions/52508434/adding-static-variable-to-union-of-class-types\n): ComponentType<Props<Config>> & PanelStatics<Config> {\n  function ConnectedPanel(props: Props<Config>) {\n    const { childId, config: originalConfig, saveConfig, tabId } = props;\n    const { mosaicActions }: { mosaicActions: MosaicRootActions } = useContext(MosaicContext);\n    const { mosaicWindowActions }: { mosaicWindowActions: MosaicWindowActions } = useContext(MosaicWindowContext);\n\n    const layout = useSelector((state) => state.persistedState.panels.layout);\n    const savedProps = useSelector((state) => state.persistedState.panels.savedProps);\n    const stableSavedProps = useRef(savedProps);\n    stableSavedProps.current = savedProps;\n    const selectedPanelIds = useSelector((state) => state.mosaic.selectedPanelIds);\n    const isSelected = selectedPanelIds.includes(childId);\n    const isFocused = selectedPanelIds.length === 1 && selectedPanelIds[0] === childId; // the current panel is the only selected panel\n\n    const isOnlyPanel = useMemo(() => (tabId ? false : !isParent(layout)), [layout, tabId]);\n    const config = savedProps[childId] || originalConfig || EMPTY_CONFIG;\n\n    const { topics, datatypes, capabilities } = PanelAPI.useDataSourceInfo();\n    const dispatch = useDispatch();\n    const actions: ActionProps = useMemo(\n      () =>\n        bindActionCreators(\n          {\n            savePanelConfigs,\n            saveFullPanelConfig,\n            changePanelLayout,\n            addSelectedPanelId,\n            removeSelectedPanelId,\n            setSelectedPanelIds,\n            createTabPanel,\n            setFullScreenPanel,\n            clearFullScreenPanel,\n          },\n          dispatch\n        ),\n      [dispatch]\n    );\n\n    const [quickActionsKeyPressed, setQuickActionsKeyPressed] = useState(false);\n    const [shiftKeyPressed, setShiftKeyPressed] = useState(false);\n    const fullScreen =\n      useSelector((state) => state.persistedState.panels.fullScreenPanel?.panelId) === childId && childId != null;\n    const fullScreenLocked = useSelector((state) => state.persistedState.panels.fullScreenPanel?.locked) && fullScreen;\n    const [isHovered, setIsHovered] = useState(false);\n\n    const panelsByType = useMemo(() => getPanelsByType(), []);\n    const type = PanelComponent.panelType;\n    const title = useMemo(() => panelsByType[type]?.title, [panelsByType, type]);\n    const panelComponentConfig = useMemo(() => ({ ...PanelComponent.defaultConfig, ...config }), [config]);\n\n    // Mix partial config with current config or `defaultConfig`\n    const saveCompleteConfig = useCallback((\n      configToSave: $Shape<Config>,\n      options: ?{ historyOptions?: EditHistoryOptions }\n    ) => {\n      if (saveConfig) {\n        saveConfig(configToSave);\n      }\n      if (childId) {\n        actions.savePanelConfigs({\n          configs: [{ id: childId, config: configToSave, defaultConfig: PanelComponent.defaultConfig }],\n          historyOptions: options?.historyOptions,\n        });\n      }\n    }, [actions, childId, saveConfig]);\n\n    const updatePanelConfig = useCallback((\n      panelType: string,\n      perPanelFunc: (PanelConfig) => PanelConfig,\n      historyOptions?: EditHistoryOptions\n    ) => {\n      actions.saveFullPanelConfig({ panelType, perPanelFunc, historyOptions });\n    }, [actions]);\n\n    // Open a panel next to the current panel, of the specified `panelType`.\n    // If such a panel already exists, we update it with the new props.\n    const openSiblingPanel = useCallback((panelType: string, siblingConfigCreator: (PanelConfig) => PanelConfig) => {\n      const siblingComponent = PanelList.getComponentForType(panelType);\n      if (!siblingComponent) {\n        return;\n      }\n      const siblingDefaultConfig = siblingComponent.defaultConfig;\n      const ownPath = mosaicWindowActions.getPath();\n\n      // Try to find a sibling summary panel and update it with the `siblingConfig`\n      const siblingPathEnd = last(ownPath) ? getOtherBranch(last(ownPath)) : \"second\";\n      const siblingPath = ownPath.slice(0, -1).concat(siblingPathEnd);\n      const siblingId = getNodeAtPath(mosaicActions.getRoot(), siblingPath);\n      if (typeof siblingId === \"string\" && getPanelTypeFromId(siblingId) === panelType) {\n        const siblingConfig: PanelConfig = { ...siblingDefaultConfig, ...stableSavedProps.current[siblingId] };\n        actions.savePanelConfigs({\n          configs: [\n            { id: siblingId, config: siblingConfigCreator(siblingConfig), defaultConfig: siblingDefaultConfig },\n          ],\n        });\n        return;\n      }\n\n      // Otherwise, open new panel\n      const newPanelPath = ownPath.concat(\"second\");\n      mosaicWindowActions.split({ type: panelType }).then(() => {\n        const newPanelId = getNodeAtPath(mosaicActions.getRoot(), newPanelPath);\n        actions.savePanelConfigs({\n          configs: [\n            {\n              id: newPanelId,\n              config: siblingConfigCreator(siblingDefaultConfig),\n              defaultConfig: siblingDefaultConfig,\n            },\n          ],\n        });\n      });\n    }, [actions, mosaicActions, mosaicWindowActions]);\n\n    const selectPanel = useCallback((panelId: string, toggleSelection: boolean) => {\n      const panelIdsToDeselect = [];\n\n      // If we selected a Tab panel, deselect its children\n      const savedConfig = savedProps[panelId];\n      if (isTabPanel(panelId) && savedConfig) {\n        const { activeTabIdx, tabs } = (savedConfig: TabPanelConfig);\n        const activeTabLayout = tabs[activeTabIdx]?.layout;\n        if (activeTabLayout) {\n          const childrenPanelIds = getAllPanelIds(activeTabLayout, savedProps);\n          panelIdsToDeselect.push(...childrenPanelIds);\n        }\n      }\n\n      // If we selected a child, deselect all parent Tab panels\n      const parentTabPanelByPanelId = getParentTabPanelByPanelId(savedProps);\n      let nextParentId = tabId;\n      const parentTabPanelIds = [];\n      while (nextParentId) {\n        parentTabPanelIds.push(nextParentId);\n        nextParentId = parentTabPanelByPanelId[nextParentId];\n      }\n      panelIdsToDeselect.push(...parentTabPanelIds);\n\n      const nextSelectedPanelIds = toggleSelection ? xor(selectedPanelIds, [panelId]) : [panelId];\n      const nextValidSelectedPanelIds = without(nextSelectedPanelIds, ...panelIdsToDeselect);\n      actions.setSelectedPanelIds(nextValidSelectedPanelIds);\n\n      // Deselect any text that was selected due to holding the shift key while clicking\n      if (nextValidSelectedPanelIds.length >= 2) {\n        window.getSelection().removeAllRanges();\n      }\n    }, [actions, savedProps, selectedPanelIds, tabId]);\n\n    const onOverlayClick = useCallback((e) => {\n      if (!fullScreen && quickActionsKeyPressed && childId != null) {\n        actions.setFullScreenPanel(childId, shiftKeyPressed);\n        return;\n      }\n\n      if (childId) {\n        e.stopPropagation();\n        const toggleSelection = e.metaKey || shiftKeyPressed;\n        selectPanel(childId, toggleSelection);\n      }\n    }, [actions, childId, fullScreen, quickActionsKeyPressed, selectPanel, shiftKeyPressed]);\n\n    const groupPanels = useCallback(() => {\n      actions.createTabPanel({\n        idToReplace: childId,\n        layout,\n        idsToRemove: selectedPanelIds,\n        singleTab: true,\n      });\n    }, [actions, childId, layout, selectedPanelIds]);\n\n    const createTabs = useCallback(() => {\n      actions.createTabPanel({\n        idToReplace: childId,\n        layout,\n        idsToRemove: selectedPanelIds,\n        singleTab: false,\n      });\n    }, [actions, childId, layout, selectedPanelIds]);\n\n    const { closePanel, splitPanel } = useMemo(\n      () => ({\n        closePanel: () => {\n          logEventAction(getEventInfos().PANEL_REMOVE, { [getEventTags().PANEL_TYPE]: type });\n          mosaicActions.remove(mosaicWindowActions.getPath());\n        },\n        splitPanel: () => {\n          if (tabId) {\n            const newId = getPanelIdForType(PanelComponent.panelType);\n            const activeTabLayout = savedProps[tabId].tabs[savedProps[tabId].activeTabIdx].layout;\n            const pathToPanelInTab = getPathFromNode(childId, activeTabLayout);\n            const newTabLayout = updateTree(activeTabLayout, [\n              { path: pathToPanelInTab, spec: { $set: { first: childId, second: newId, direction: \"row\" } } },\n            ]);\n            const newTabConfig = updateTabPanelLayout(newTabLayout, savedProps[tabId]);\n            actions.savePanelConfigs({ configs: [{ id: tabId, config: newTabConfig }, { id: newId, config }] });\n          } else {\n            mosaicWindowActions.split({ type: PanelComponent.panelType });\n          }\n          logEventAction(getEventInfos().PANEL_SPLIT, { [getEventTags().PANEL_TYPE]: type });\n        },\n      }),\n      [actions, childId, config, mosaicActions, mosaicWindowActions, savedProps, tabId, type]\n    );\n\n    const { onMouseEnter, onMouseLeave, enterFullScreen, exitFullScreen } = useMemo(\n      () => ({\n        onMouseEnter: () => setIsHovered(true),\n        onMouseLeave: () => setIsHovered(false),\n        enterFullScreen: () => {\n          if (childId != null) {\n            actions.setFullScreenPanel(childId, true);\n          }\n        },\n        exitFullScreen: () => {\n          if (childId != null) {\n            actions.clearFullScreenPanel(childId);\n          }\n        },\n      }),\n      [actions, childId]\n    );\n\n    const onReleaseQuickActionsKey = useCallback(() => {\n      setQuickActionsKeyPressed(false);\n      if (fullScreen && !fullScreenLocked) {\n        exitFullScreen();\n      }\n    }, [exitFullScreen, fullScreen, fullScreenLocked]);\n\n    const { keyUpHandlers, keyDownHandlers } = useMemo(\n      () => ({\n        keyUpHandlers: {\n          \"`\": () => onReleaseQuickActionsKey(),\n          \"~\": () => onReleaseQuickActionsKey(),\n          Shift: () => setShiftKeyPressed(false),\n        },\n        keyDownHandlers: {\n          \"`\": () => setQuickActionsKeyPressed(true),\n          \"~\": () => setQuickActionsKeyPressed(true),\n          Shift: () => setShiftKeyPressed(true),\n          Escape: () => exitFullScreen(),\n        },\n      }),\n      [exitFullScreen, onReleaseQuickActionsKey]\n    );\n\n    const onBlurDocument = useCallback(() => {\n      setShiftKeyPressed(false);\n      onReleaseQuickActionsKey();\n    }, [onReleaseQuickActionsKey]);\n\n    const child = useMemo(\n      () => (\n        <PanelComponent\n          config={panelComponentConfig}\n          saveConfig={saveCompleteConfig}\n          openSiblingPanel={openSiblingPanel}\n          topics={[...topics]}\n          datatypes={datatypes}\n          capabilities={capabilities}\n          isHovered={isHovered}\n        />\n      ),\n      [panelComponentConfig, saveCompleteConfig, openSiblingPanel, topics, datatypes, capabilities, isHovered]\n    );\n\n    const isDemoMode = useExperimentalFeature(\"demoMode\");\n    return (\n      // $FlowFixMe - bug prevents requiring panelType on PanelComponent: https://stackoverflow.com/q/52508434/23649\n      <PanelContext.Provider\n        value={{\n          type,\n          id: childId,\n          title,\n          config,\n          saveConfig: saveCompleteConfig,\n          updatePanelConfig,\n          openSiblingPanel,\n          enterFullScreen,\n          isHovered,\n          isFocused,\n          tabId,\n        }}>\n        {/* Ensure user exits full-screen mode when leaving window, even if key is still pressed down */}\n        <DocumentEvents target={window} enabled onBlur={onBlurDocument} />\n        <KeyListener global keyUpHandlers={keyUpHandlers} keyDownHandlers={keyDownHandlers} />\n        <Flex\n          onClick={onOverlayClick}\n          onMouseEnter={onMouseEnter}\n          onMouseLeave={onMouseLeave}\n          className={cx({\n            [styles.root]: true,\n            [styles.rootFullScreen]: fullScreen,\n            [styles.selected]: isSelected && !isDemoMode,\n          })}\n          col\n          dataAttrs={{ \"data-panel-id\": `${childId || \"\"}` }}\n          dataTest={\"panel-mouseenter-container\"}\n          clip>\n          {fullScreen ? <div className={styles.notClickable} /> : null}\n          {isSelected && !fullScreen && selectedPanelIds.length > 1 && (\n            <div data-tab-options className={styles.tabActionsOverlay}>\n              <Button style={{ backgroundColor: colors.BLUE }} onClick={groupPanels}>\n                <Icon small style={{ marginBottom: 5 }}>\n                  <BorderAllIcon />\n                </Icon>\n                Group in tab\n              </Button>\n              <Button style={{ backgroundColor: colors.BLUE }} onClick={createTabs}>\n                <Icon small style={{ marginBottom: 5 }}>\n                  <ExpandAllOutlineIcon />\n                </Icon>\n                Create {selectedPanelIds.length} tabs\n              </Button>\n            </div>\n          )}\n          {type !== TAB_PANEL_TYPE && quickActionsKeyPressed && !fullScreen && (\n            <div className={styles.quickActionsOverlay} data-panel-overlay>\n              <MosaicDragHandle tabId={tabId}>\n                <>\n                  <div>\n                    <FullscreenIcon />\n                    {shiftKeyPressed ? \"Lock fullscreen\" : \"Fullscreen (Shift+click to lock)\"}\n                  </div>\n                  <div>\n                    <Button onClick={closePanel} disabled={isOnlyPanel}>\n                      <TrashCanOutlineIcon />\n                      Remove\n                    </Button>\n                    <Button onClick={splitPanel}>\n                      <GridLargeIcon />\n                      Split\n                    </Button>\n                  </div>\n                  {!isOnlyPanel && <p>Drag to move</p>}\n                </>\n              </MosaicDragHandle>\n            </div>\n          )}\n          {fullScreen ? (\n            <button className={styles.exitFullScreen} onClick={exitFullScreen} data-panel-overlay-exit>\n              <CloseIcon /> <span>Exit fullscreen</span>\n            </button>\n          ) : null}\n          <ErrorBoundary>{child}</ErrorBoundary>\n        </Flex>\n      </PanelContext.Provider>\n    );\n  }\n  ConnectedPanel.displayName = `Panel(${PanelComponent.displayName || PanelComponent.name || \"\"})`;\n\n  // $FlowFixMe - doesn't know underlying memoized PanelComponent's interface\n  return Object.assign(React.memo(ConnectedPanel), {\n    defaultConfig: PanelComponent.defaultConfig,\n    shortcuts: PanelComponent.shortcuts,\n    panelType: PanelComponent.panelType,\n  });\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ColorPicker, { Panel as ColorPickerPanel } from \"rc-color-picker\";\nimport React from \"react\";\nimport { type Color } from \"regl-worldview\";\nimport styled from \"styled-components\";\nimport tinyColor from \"tinycolor2\";\n\nexport const PICKER_SIZE = {\n  NORMAL: { name: \"NORMAL\", size: 24 },\n  SMALL: { name: \"SMALL\", size: 16 },\n};\n\nexport type Size = $Keys<typeof PICKER_SIZE>;\ntype Placement = \"topLeft\" | \"topRight\" | \"bottomLeft\" | \"bottomRight\";\n\nconst SWrapper = styled.span`\n  .rc-color-picker-trigger {\n    border: none;\n    box-shadow: none;\n    display: inline-block;\n    width: ${({ isSmallSize }) => (isSmallSize ? PICKER_SIZE.SMALL.size : PICKER_SIZE.NORMAL.size)}px;\n    height: ${({ isSmallSize }) => (isSmallSize ? PICKER_SIZE.SMALL.size : PICKER_SIZE.NORMAL.size)}px;\n    border-radius: ${({ isSmallSize }) => (isSmallSize ? PICKER_SIZE.SMALL.size / 2 : PICKER_SIZE.NORMAL.size / 2)}px;\n  }\n`;\n\nconst DEFAULT_OVERRIDE_COLOR = \"rgba(255,255,255,1)\";\n\nexport function getHexFromColorSettingWithDefault(color: ?Color): string {\n  return color ? tinyColor.fromRatio(color).toRgbString() : DEFAULT_OVERRIDE_COLOR;\n}\n\ntype Props = {|\n  color: ?Color,\n  onChange: (newColor: Color) => void,\n  placement?: Placement,\n  size?: ?Size,\n  useModal?: boolean,\n|};\ntype ColorPickerSettingsPanelProps = {|\n  color: ?Color,\n  onChange: (newColor: Color) => void,\n|};\n\nexport function getRGBAFromColor(color: { color: string, alpha: number }): Color {\n  const rgbaColor = tinyColor(color.color)\n    .setAlpha(color.alpha / 100)\n    .toRgb();\n  return {\n    r: rgbaColor.r / 255,\n    g: rgbaColor.g / 255,\n    b: rgbaColor.b / 255,\n    a: rgbaColor.a,\n  };\n}\n// A tiny wrapper to set up the default handling of color and onChange for ColorPickerPanel.\nexport function ColorPickerSettingsPanel({ color, onChange }: ColorPickerSettingsPanelProps) {\n  const hexColor = getHexFromColorSettingWithDefault(color);\n  return (\n    <ColorPickerPanel\n      enableAlpha\n      color={hexColor}\n      onChange={(newColor: { color: string, alpha: number }) => onChange(getRGBAFromColor(newColor))}\n      mode=\"RGB\"\n    />\n  );\n}\n\nexport default function ColorPickerForTopicSettings({ color, placement, onChange, size }: Props) {\n  const isSmallSize = !!(size && size === PICKER_SIZE.SMALL.name);\n  const hexColor = getHexFromColorSettingWithDefault(color);\n\n  return (\n    <SWrapper isSmallSize={isSmallSize}>\n      <ColorPicker\n        animation=\"slide-up\"\n        color={hexColor}\n        placement={placement}\n        onChange={(newColor: { color: string, alpha: number }) => onChange(getRGBAFromColor(newColor))}\n      />\n    </SWrapper>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\n\nimport { setLinkedGlobalVariables } from \"webviz-core/src/actions/panels\";\n\nexport type LinkedGlobalVariable = {\n  topic: string,\n  markerKeyPath: string[],\n  name: string,\n};\n\nexport type LinkedGlobalVariables = LinkedGlobalVariable[];\n\nexport default function useLinkedGlobalVariables(): {|\n  linkedGlobalVariables: LinkedGlobalVariables,\n  setLinkedGlobalVariables: (LinkedGlobalVariables) => void,\n|} {\n  const linkedGlobalVariables = useSelector((state) => state.persistedState.panels.linkedGlobalVariables);\n  const dispatch = useDispatch();\n  return {\n    linkedGlobalVariables,\n    ...bindActionCreators({ setLinkedGlobalVariables }, dispatch),\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\ntype Props = {|\n  children: React.Node,\n  alignLeft?: boolean,\n|};\n\nconst Container = styled.div`\n  flex: 1 1 auto;\n  display: flex;\n  align-items: center;\n  justify-content: ${(props) => (props.alignLeft ? \"left\" : \"center\")};\n  margin: 20px;\n  line-height: 1.4;\n  color: ${colors.GRAY};\n\n  code {\n    color: ${colors.DARK9};\n    background: transparent;\n    padding: 0;\n  }\n`;\n\nexport default class EmptyState extends React.Component<Props> {\n  render() {\n    return (\n      <Container alignLeft={this.props.alignLeft}>\n        <div>{this.props.children}</div>\n      </Container>\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { memoize, uniq } from \"lodash\";\nimport { Parser, Grammar } from \"nearley\";\n\nimport type { RosPath } from \"./constants\";\nimport grammar from \"./grammar.ne\";\nimport filterMap from \"webviz-core/src/filterMap\";\n\nconst grammarObj = Grammar.fromCompiled(grammar);\n\nconst parseRosPath: (path: string) => ?RosPath = memoize(\n  (path: string): ?RosPath => {\n    // Need to create a new Parser object for every new string to parse (should be cheap).\n    const parser = new Parser(grammarObj);\n    try {\n      return parser.feed(path).results[0];\n    } catch (_) {\n      return undefined;\n    }\n  }\n);\nexport default parseRosPath;\n\nexport function getTopicsFromPaths(paths: string[]): string[] {\n  return uniq(\n    filterMap(paths, (path) => {\n      const rosPath = parseRosPath(path);\n      return rosPath ? rosPath.topicName : undefined;\n    })\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport GlobalVariableName from \"../GlobalVariableName\";\nimport { getLinkedGlobalVariable } from \"../interactionUtils\";\nimport useLinkedGlobalVariables, { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport LinkToGlobalVariable from \"./LinkToGlobalVariable\";\nimport UnlinkGlobalVariable from \"./UnlinkGlobalVariable\";\nimport UnlinkGlobalVariables from \"./UnlinkGlobalVariables\";\nimport UnlinkWrapper from \"./UnlinkWrapper\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SWrapper = styled.span`\n  display: inline-flex;\n  align-items: center;\n`;\nexport const SPath = styled.span`\n  opacity: 0.8;\n`;\nexport const SP = styled.p`\n  line-height: 1.4;\n  margin-bottom: 12px;\n`;\nexport const SGlobalVariableLink = styled.span`\n  height: 15px;\n  flex-direction: row;\n  display: inline-flex;\n  align-items: center;\n  word-break: normal;\n  .icon {\n    color: ${colors.BLUE};\n  }\n  .link-icon {\n    opacity: 0.2;\n    display: inline;\n  }\n  .highlight {\n    opacity: 1;\n  }\n  &:hover {\n    .link-icon {\n      opacity: 1;\n    }\n  }\n`;\n\nexport const SGlobalVariableForm = styled.form`\n  background-color: ${colors.DARK3};\n  margin-left: -16px;\n  padding: 12px;\n  width: 240px;\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\n  pointer-events: auto;\n  flex: 0 0 auto;\n  border-radius: 8px;\n  overflow-wrap: break-word;\n`;\n\nconst SValue = styled.span`\n  padding: 0;\n`;\n\ntype Props = {\n  addLinkTooltip?: React.Node,\n  hasNestedValue?: boolean,\n  highlight?: boolean,\n  label?: string,\n  linkedGlobalVariable?: ?LinkedGlobalVariable,\n  markerKeyPath?: string[],\n  nestedValueStyle?: any,\n  onlyRenderAddLink?: boolean,\n  style?: any,\n  topic?: string,\n  unlinkTooltip?: React.Node,\n  variableValue?: any,\n};\n\nexport default function GlobalVariableLink({\n  addLinkTooltip,\n  hasNestedValue,\n  highlight,\n  label,\n  linkedGlobalVariable,\n  markerKeyPath,\n  nestedValueStyle = { marginLeft: 8 },\n  onlyRenderAddLink,\n  style = { marginLeft: 4 },\n  topic,\n  unlinkTooltip,\n  variableValue = null,\n}: Props) {\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  let linkedGlobalVariableLocal: ?LinkedGlobalVariable = linkedGlobalVariable;\n  if (!linkedGlobalVariableLocal && topic && markerKeyPath) {\n    linkedGlobalVariableLocal = getLinkedGlobalVariable({\n      topic,\n      markerKeyPath,\n      linkedGlobalVariables,\n    });\n  }\n\n  const isArrayBuffer = ArrayBuffer.isView(variableValue);\n  const renderUnlink = !!linkedGlobalVariableLocal;\n  const addToLinkedGlobalVariable = topic && markerKeyPath ? { topic, markerKeyPath, variableValue } : null;\n  const renderAddLink = !renderUnlink && !isArrayBuffer && addToLinkedGlobalVariable;\n  if (!(renderUnlink || renderAddLink)) {\n    return null;\n  }\n\n  const arrayBufferStyle = isArrayBuffer ? style : { cursor: \"pointer\" };\n  let wrapperStyle = hasNestedValue ? nestedValueStyle : style;\n  wrapperStyle = { ...arrayBufferStyle, ...wrapperStyle };\n\n  return (\n    <SWrapper>\n      {label && <SValue>{label}</SValue>}\n      <SGlobalVariableLink style={wrapperStyle}>\n        {linkedGlobalVariableLocal && !onlyRenderAddLink && (\n          <UnlinkWrapper\n            linkedGlobalVariable={linkedGlobalVariableLocal}\n            name={linkedGlobalVariableLocal.name}\n            tooltip={unlinkTooltip}>\n            {({ setIsOpen, linkedGlobalVariable: linkedVar }) => (\n              <UnlinkGlobalVariable linkedGlobalVariable={linkedVar} setIsOpen={setIsOpen} />\n            )}\n          </UnlinkWrapper>\n        )}\n        {renderAddLink && addToLinkedGlobalVariable && (\n          <LinkToGlobalVariable\n            highlight={highlight}\n            tooltip={addLinkTooltip}\n            addToLinkedGlobalVariable={addToLinkedGlobalVariable}\n          />\n        )}\n      </SGlobalVariableLink>\n    </SWrapper>\n  );\n}\n\nexport { GlobalVariableName, UnlinkGlobalVariables };\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4, vec3, quat } from \"gl-matrix\";\nimport type { Mat4 } from \"gl-matrix\";\n\nimport type { MutablePose, Pose, Point, Orientation } from \"webviz-core/src/types/Messages\";\nimport { objectValues } from \"webviz-core/src/util\";\n\n// allocate some temporary variables\n// so we can copy/in out of them during tf application\n// this reduces GC as this code gets called lot\nconst tempMat = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\nconst tempPos = [0, 0, 0];\nconst tempScale = [0, 0, 0];\nconst tempOrient = [0, 0, 0, 0];\n\nfunction stripLeadingSlash(name: string) {\n  return name.startsWith(\"/\") ? name.slice(1) : name;\n}\n\n// A simplification of the ROS data format. We usually don't need everything.\nexport type TransformElement = $ReadOnly<{|\n  childFrame: string,\n  parentFrame: string,\n  pose: Pose,\n|}>;\n\nexport class Transform {\n  id: string;\n  matrix: Mat4 = mat4.create();\n  parent: ?Transform;\n  _hasValidMatrix: boolean = false;\n\n  constructor(id: string) {\n    this.id = stripLeadingSlash(id);\n  }\n\n  set(position: Point, orientation: Orientation) {\n    mat4.fromRotationTranslation(\n      this.matrix,\n      quat.set(tempOrient, orientation.x, orientation.y, orientation.z, orientation.w),\n      vec3.set(tempPos, position.x, position.y, position.z)\n    );\n    this._hasValidMatrix = true;\n  }\n\n  isValid(rootId: string) {\n    return this._hasValidMatrix || this.id === rootId;\n  }\n\n  isChildOfTransform(rootId: string): boolean {\n    rootId = stripLeadingSlash(rootId);\n    if (!this.parent) {\n      return this.id === rootId;\n    }\n    return this.parent.isChildOfTransform(rootId);\n  }\n\n  rootTransform(): Transform {\n    if (!this.parent) {\n      return this;\n    }\n    return this.parent.rootTransform();\n  }\n\n  apply(output: MutablePose, input: Pose, rootId: string): ?MutablePose {\n    rootId = stripLeadingSlash(rootId);\n    if (!this.isValid(rootId)) {\n      return null;\n    }\n\n    if (this.id === rootId) {\n      output.position.x = input.position.x;\n      output.position.y = input.position.y;\n      output.position.z = input.position.z;\n      output.orientation.x = input.orientation.x;\n      output.orientation.y = input.orientation.y;\n      output.orientation.z = input.orientation.z;\n      output.orientation.w = input.orientation.w;\n      return output;\n    }\n\n    // Can't apply if this transform doesn't map to the root transform.\n    if (!this.isChildOfTransform(rootId)) {\n      return null;\n    }\n\n    const { position, orientation } = input;\n    // set a transform matrix from the input pose\n    mat4.fromRotationTranslation(\n      tempMat,\n      quat.set(tempOrient, orientation.x, orientation.y, orientation.z, orientation.w),\n      vec3.set(tempPos, position.x, position.y, position.z)\n    );\n\n    // set transform matrix to (our matrix * pose transform matrix)\n    mat4.multiply(tempMat, this.matrix, tempMat);\n\n    // copy the transform matrix components out into temp variables\n    mat4.getTranslation(tempPos, tempMat);\n\n    // Normalize the values in the matrix by the scale. This ensures that we get the correct rotation\n    // out even if the scale isn't 1 in each axis. The logic from this comes from the threejs\n    // implementation and an SO answer:\n    // - https://github.com/mrdoob/three.js/blob/master/src/math/Matrix4.js#L790-L815\n    // - https://math.stackexchange.com/a/1463487\n    mat4.getScaling(tempScale, tempMat);\n    if (mat4.determinant(tempMat) < 0) {\n      tempScale[0] *= -1;\n    }\n    vec3.inverse(tempScale, tempScale);\n    mat4.scale(tempMat, tempMat, tempScale);\n\n    mat4.getRotation(tempOrient, tempMat);\n\n    // mutate the output w/ the temp values\n    output.position.x = tempPos[0];\n    output.position.y = tempPos[1];\n    output.position.z = tempPos[2];\n    output.orientation.x = tempOrient[0];\n    output.orientation.y = tempOrient[1];\n    output.orientation.z = tempOrient[2];\n    output.orientation.w = tempOrient[3];\n\n    if (!this.parent) {\n      return output;\n    }\n    return this.parent.apply(output, output, rootId);\n  }\n}\n\nclass TfStore {\n  storage = {};\n  get(key: string): Transform {\n    key = stripLeadingSlash(key);\n    let result = this.storage[key];\n    if (result) {\n      return result;\n    }\n    result = new Transform(key);\n    this.storage[key] = result;\n    return result;\n  }\n\n  values = (): Array<Transform> => objectValues(this.storage);\n}\n\nexport default class Transforms {\n  storage = new TfStore();\n  empty = true;\n  rawTransforms: $ReadOnlyArray<TransformElement>;\n  constructor(transformElements: $ReadOnlyArray<TransformElement>) {\n    this.empty = transformElements.length === 0;\n    this.rawTransforms = transformElements;\n    transformElements.forEach(({ childFrame, parentFrame, pose: { position, orientation } }) => {\n      const tf = this.storage.get(childFrame);\n      tf.set(position, orientation);\n      tf.parent = this.storage.get(parentFrame);\n    });\n  }\n\n  // Apply the tf hierarchy to the original pose and update the pose supplied in the output parameter.\n  // This follows the same calling conventions in the gl-mat4 lib, which takes an 'out' parameter as their first argument.\n  // This allows the caller to decide if they want to update the pose by reference\n  // (by reference by supplying it as both the first and second arguments)\n  // or return a new one by calling with apply({ position: { }, orientation: {} }, original).\n  // Returns the output pose, or the input pose if no transform was needed, or null if the transform\n  // is not available -- the return value must not be ignored.\n  apply(output: MutablePose, original: Pose, frameId: string, rootId: string): ?MutablePose {\n    const tf = this.storage.get(frameId);\n    return tf.apply(output, original, rootId);\n  }\n\n  rootOfTransform(transformID: string): Transform {\n    return this.get(transformID).rootTransform();\n  }\n\n  get = (key: string) => this.storage.get(key);\n  values = (): Array<Transform> => this.storage.values();\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Layout.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Layout.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Layout.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport styled from \"styled-components\";\n\nexport const SLabel = styled.label`\n  display: block;\n  font-size: 14px;\n  margin: 6px 2px;\n  text-decoration: ${(props) => (props.strikethrough ? \"line-through\" : null)};\n`;\nexport const SDescription = styled.label`\n  display: block;\n  margin: 6px 2px;\n  opacity: 0.8;\n  line-height: 1.2;\n`;\n\nexport const SInput = styled.input`\n  flex: 1 1 auto;\n  margin-bottom: 8px;\n`;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport AlertCircleIcon from \"@mdi/svg/svg/alert-circle.svg\";\nimport LeadPencilIcon from \"@mdi/svg/svg/lead-pencil.svg\";\nimport React, { type Node, useCallback, useContext, useMemo } from \"react\";\nimport styled from \"styled-components\";\n\nimport NodeName from \"./NodeName\";\nimport { TREE_SPACING } from \"./TopicTree\";\nimport TreeNodeMenu, { DOT_MENU_WIDTH } from \"./TreeNodeMenu\";\nimport type { DerivedCustomSettings, SetCurrentEditingTopic, TreeNode } from \"./types\";\nimport VisibilityToggle, { TOGGLE_WRAPPER_SIZE, TOPIC_ROW_PADDING } from \"./VisibilityToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { ThreeDimensionalVizContext } from \"webviz-core/src/panels/ThreeDimensionalViz/ThreeDimensionalVizContext\";\nimport { canEditDatatype } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor\";\nimport { TopicTreeContext } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useTopicTree\";\nimport type { StructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\nimport { useGuaranteedContext } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport { joinTopics } from \"webviz-core/src/util/topicUtils\";\n\nexport const ICON_SIZE = 22;\nexport const ROW_HEIGHT = 24;\nconst MAX_GROUP_ERROR_WIDTH = 64;\nconst VISIBLE_COUNT_WIDTH = 18;\nconst VISIBLE_COUNT_MARGIN = 4;\n\nexport const STreeNodeRow = styled.div`\n  color: ${(props: { visibleInScene: boolean }) => (props.visibleInScene ? \"unset\" : colors.TEXT_MUTED)};\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nexport const SLeft = styled.div`\n  display: flex;\n  align-items: center;\n  flex: 1 1 auto;\n  min-height: ${TOGGLE_WRAPPER_SIZE}px;\n  padding: ${TOPIC_ROW_PADDING}px 0px;\n`;\n\nconst SErrorCount = styled.small`\n  color: ${colors.RED};\n  width: ${MAX_GROUP_ERROR_WIDTH}px;\n`;\n\nconst SIconWrapper = styled.div`\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: ${ICON_SIZE}px;\n  height: ${ICON_SIZE}px;\n`;\n\nconst SErrorList = styled.ul`\n  max-width: 240px;\n  word-wrap: break-word;\n  padding-left: 16px;\n`;\n\nconst SErrorItem = styled.li`\n  list-style: outside;\n`;\n\nexport const SRightActions = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n`;\n\nexport const SToggles = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nexport const SDotMenuPlaceholder = styled.span`\n  width: ${DOT_MENU_WIDTH}px;\n  height: ${ROW_HEIGHT}px;\n`;\n\nconst SVisibleCount = styled.span`\n  width: ${VISIBLE_COUNT_WIDTH}px;\n  height: ${ROW_HEIGHT - 6}px;\n  padding-top: 2px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 10px;\n  margin: 0 ${VISIBLE_COUNT_MARGIN}px;\n`;\n\ntype Props = {|\n  checkedKeysSet: Set<string>,\n  hasChildren: boolean,\n  hasFeatureColumn: boolean,\n  isXSWidth: boolean,\n  node: TreeNode,\n  nodeVisibleInScene: boolean,\n  visibleByColumn: (?boolean)[],\n  sceneErrors: ?(string[]),\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  structuralDatatypes: StructuralDatatypes,\n  derivedCustomSettings: ?DerivedCustomSettings,\n  width: number,\n  filterText: string,\n  tooltips?: Node[],\n  visibleTopicsCount: number,\n  diffModeEnabled: boolean,\n|};\n\nexport default function TreeNodeRow({\n  checkedKeysSet,\n  derivedCustomSettings,\n  filterText,\n  hasChildren,\n  hasFeatureColumn,\n  isXSWidth,\n  node,\n  node: { availableByColumn, providerAvailable, name, key, featureKey },\n  nodeVisibleInScene,\n  sceneErrors,\n  setCurrentEditingTopic,\n  structuralDatatypes,\n  tooltips,\n  visibleByColumn,\n  visibleTopicsCount,\n  width,\n  diffModeEnabled,\n}: Props) {\n  const topicName = node.type === \"topic\" ? node.topicName : \"\";\n  const datatype = node.type === \"topic\" ? node.datatype : undefined;\n\n  const isDefaultSettings = derivedCustomSettings?.isDefaultSettings || !derivedCustomSettings;\n  const showTopicSettings = topicName && datatype && canEditDatatype(datatype, structuralDatatypes);\n  const showTopicSettingsChanged = showTopicSettings && !isDefaultSettings;\n\n  const showTopicError = node.type === \"topic\" && sceneErrors && sceneErrors.length > 0;\n  const showGroupError = node.type === \"group\" && sceneErrors && sceneErrors.length > 0;\n\n  const rowWidth = width - (isXSWidth ? 0 : TREE_SPACING * 2);\n\n  const togglesWidth = hasFeatureColumn ? TOGGLE_WRAPPER_SIZE * 2 : TOGGLE_WRAPPER_SIZE;\n  const rightActionWidth = providerAvailable ? togglesWidth + DOT_MENU_WIDTH : DOT_MENU_WIDTH;\n  // -8px to add some spacing between the name and right action area.\n  let maxNodeNameWidth = rowWidth - rightActionWidth - 8;\n\n  if (showTopicSettingsChanged) {\n    maxNodeNameWidth -= ICON_SIZE;\n  }\n  if (showGroupError) {\n    maxNodeNameWidth -= MAX_GROUP_ERROR_WIDTH;\n  }\n  if (showTopicError) {\n    maxNodeNameWidth -= ICON_SIZE;\n  }\n\n  const errorTooltip = sceneErrors && (\n    <SErrorList>\n      {sceneErrors.map((errStr) => (\n        <SErrorItem key={errStr}>{errStr}</SErrorItem>\n      ))}\n    </SErrorList>\n  );\n\n  const showVisibleTopicsCount = providerAvailable && node.type === \"group\" && node.children && visibleTopicsCount > 0;\n\n  maxNodeNameWidth -= showVisibleTopicsCount ? VISIBLE_COUNT_WIDTH + VISIBLE_COUNT_MARGIN * 2 : 0;\n\n  const { setHoveredMarkerMatchers } = useContext(ThreeDimensionalVizContext);\n  const updateHoveredMarkerMatchers = useCallback((columnIndex, visible) => {\n    if (visible) {\n      const topic = [topicName, joinTopics($WEBVIZ_SOURCE_2, topicName)][columnIndex];\n      setHoveredMarkerMatchers([{ topic }]);\n    }\n  }, [setHoveredMarkerMatchers, topicName]);\n\n  const onMouseLeave = useCallback(() => setHoveredMarkerMatchers([]), [setHoveredMarkerMatchers]);\n  const mouseEventHandlersByColumnIdx = useMemo(() => {\n    return new Array(2).fill().map((_, columnIndex) => ({\n      onMouseEnter: () => updateHoveredMarkerMatchers(columnIndex, true),\n      onMouseLeave,\n    }));\n  }, [onMouseLeave, updateHoveredMarkerMatchers]);\n  const {\n    toggleCheckAllAncestors,\n    toggleNodeChecked,\n    toggleNodeExpanded,\n    toggleCheckAllDescendants,\n  } = useGuaranteedContext(TopicTreeContext, \"TopicTreeContext\");\n\n  return (\n    <STreeNodeRow visibleInScene={nodeVisibleInScene} style={{ width: rowWidth }}>\n      <SLeft\n        style={{ cursor: hasChildren && !filterText ? \"pointer\" : \"default\" }}\n        data-test={`name~${key}`}\n        onClick={hasChildren ? () => toggleNodeExpanded(key) : undefined}>\n        <NodeName\n          isXSWidth={isXSWidth}\n          maxWidth={maxNodeNameWidth}\n          displayName={name || topicName}\n          tooltips={tooltips}\n          topicName={topicName}\n          searchText={filterText}\n          {...(showVisibleTopicsCount\n            ? {\n                additionalElem: (\n                  <Tooltip\n                    placement=\"top\"\n                    contents={`${visibleTopicsCount} visible ${\n                      visibleTopicsCount === 1 ? \"topic\" : \"topics\"\n                    } in this group`}>\n                    <SVisibleCount>{visibleTopicsCount}</SVisibleCount>\n                  </Tooltip>\n                ),\n              }\n            : undefined)}\n        />\n        {showTopicSettingsChanged && datatype && (\n          <Icon\n            style={{ padding: \"0 4px\", color: colors.HIGHLIGHT, lineHeight: 1 }}\n            fade\n            tooltip=\"Topic settings edited\"\n            onClick={() => setCurrentEditingTopic({ name: topicName, datatype })}>\n            <LeadPencilIcon />\n          </Icon>\n        )}\n        {showGroupError && errorTooltip && sceneErrors && (\n          <Tooltip contents={errorTooltip} placement=\"top\">\n            <SErrorCount>{`${sceneErrors.length} ${sceneErrors.length === 1 ? \"error\" : \"errors\"}`}</SErrorCount>\n          </Tooltip>\n        )}\n        {showTopicError && errorTooltip && (\n          <SIconWrapper>\n            <Icon\n              style={{ color: colors.RED, fontSize: 14, display: \"inline-flex\", alignItems: \"center\" }}\n              small\n              tooltipProps={{ placement: \"top\" }}\n              tooltip={errorTooltip}\n              onClick={(e) => e.stopPropagation()}>\n              <AlertCircleIcon />\n            </Icon>\n          </SIconWrapper>\n        )}\n      </SLeft>\n\n      <SRightActions>\n        {providerAvailable && (\n          <SToggles>\n            {availableByColumn.map((available, columnIdx) => {\n              const checked = checkedKeysSet.has(columnIdx === 1 ? featureKey : key);\n              return (\n                <VisibilityToggle\n                  available={available}\n                  dataTest={`visibility-toggle~${key}~column${columnIdx}`}\n                  key={columnIdx}\n                  size={node.type === \"topic\" ? \"SMALL\" : \"NORMAL\"}\n                  overrideColor={(derivedCustomSettings?.overrideColorByColumn || [])[columnIdx]}\n                  checked={checked}\n                  onToggle={() => {\n                    toggleNodeChecked(key, columnIdx);\n                    updateHoveredMarkerMatchers(columnIdx, !checked);\n                  }}\n                  onShiftToggle={() => {\n                    toggleCheckAllDescendants(key, columnIdx);\n                    updateHoveredMarkerMatchers(columnIdx, !checked);\n                  }}\n                  onAltToggle={() => {\n                    toggleCheckAllAncestors(key, columnIdx);\n                    updateHoveredMarkerMatchers(columnIdx, !checked);\n                  }}\n                  unavailableTooltip={\n                    node.type === \"group\" ? \"None of the topics in this group are currently available\" : \"Unavailable\"\n                  }\n                  visibleInScene={!!visibleByColumn[columnIdx]}\n                  {...mouseEventHandlersByColumnIdx[columnIdx]}\n                  diffModeEnabled={diffModeEnabled}\n                  columnIndex={columnIdx}\n                />\n              );\n            })}\n          </SToggles>\n        )}\n        <TreeNodeMenu\n          datatype={showTopicSettings ? datatype : undefined}\n          disableBaseColumn={diffModeEnabled || !availableByColumn[0]}\n          disableFeatureColumn={diffModeEnabled || !availableByColumn[1]}\n          hasFeatureColumn={hasFeatureColumn && availableByColumn[1]}\n          nodeKey={key}\n          providerAvailable={providerAvailable}\n          setCurrentEditingTopic={setCurrentEditingTopic}\n          topicName={topicName}\n        />\n      </SRightActions>\n    </STreeNodeRow>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport { useCallback, useMemo, useRef } from \"react\";\n\nimport { type MessagePathFilter } from \"./constants\";\nimport { messagePathStructures } from \"./messagePathsForDatatype\";\nimport type { MessagePathStructureItem, RosPath } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport parseRosPath from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport useGlobalVariables, { type GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { ReflectiveMessage, Topic } from \"webviz-core/src/players/types\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { fieldNames, getField, getIndex } from \"webviz-core/src/util/binaryObjects\";\nimport { useChangeDetector, useDeepMemo, useShallowMemo } from \"webviz-core/src/util/hooks\";\nimport { enumValuesByDatatypeAndField } from \"webviz-core/src/util/selectors\";\n\nexport type MessagePathDataItem = {|\n  value: mixed, // The actual value.\n  // TODO(JP): Maybe this should just be a simple path without nice ids, and then have a separate function\n  // to generate \"nice ids\". Because they might not always be reliable and we might want to use different\n  // kinds of \"nice ids\" for different purposes, e.g. `[10]{id==5}{other_id=123}` for tooltips (more information)\n  // but `[:]{other_id==123}` for line graphs (more likely to match values).\n  path: string, // The path to get to this value. Tries to use \"nice ids\" like `[:]{some_id==123}` wherever possible.\n  constantName?: ?string, // The name of the constant that the value matches up with, if any.\n|};\n\n// Given a set of message paths, this returns a function that you can call to resolve a single path\n// and message to an array of `MessagePathDataItem` objects. The array+objects will be the same by\n// reference, as long as topics/datatypes/global variables haven't changed in the meantime.\nexport function useCachedGetMessagePathDataItems(\n  paths: string[]\n): (path: string, message: ReflectiveMessage, bigInt: ?true) => ?(MessagePathDataItem[]) {\n  const { topics: providerTopics, datatypes } = PanelAPI.useDataSourceInfo();\n  const { globalVariables } = useGlobalVariables();\n  const memoizedPaths: string[] = useShallowMemo<string[]>(paths);\n\n  // We first fill in global variables in the paths, so we can later see which paths have really\n  // changed when the global variables have changed.\n  const unmemoizedFilledInPaths: { [string]: RosPath } = useMemo(() => {\n    const filledInPaths = {};\n    for (const path of memoizedPaths) {\n      const rosPath = parseRosPath(path);\n      if (rosPath) {\n        filledInPaths[path] = fillInGlobalVariablesInPath(rosPath, globalVariables);\n      }\n    }\n    return filledInPaths;\n  }, [globalVariables, memoizedPaths]);\n  const memoizedFilledInPaths = useDeepMemo<{ [string]: RosPath }>(unmemoizedFilledInPaths);\n\n  // Cache MessagePathDataItem arrays by Message. We need to clear out this cache whenever\n  // the topics or datatypes change, since that's what getMessagePathDataItems\n  // depends on, outside of the message+path.\n  const cachesByPath = useRef<{\n    [string]: {| filledInPath: RosPath, weakMap: WeakMap<ReflectiveMessage, ?(MessagePathDataItem[])> |},\n  }>({});\n  if (useChangeDetector([providerTopics, datatypes], true)) {\n    cachesByPath.current = {};\n  }\n  // When the filled in paths changed, then that means that either the path string changed, or a\n  // relevant global variable changed. Delete the caches for where the `filledInPath` doesn't match\n  // any more.\n  if (useChangeDetector([memoizedFilledInPaths], false)) {\n    for (const path of Object.keys(cachesByPath.current)) {\n      const filledInPath = memoizedFilledInPaths[path];\n      if (!filledInPath || !isEqual(cachesByPath.current[path].filledInPath, filledInPath)) {\n        delete cachesByPath.current[path];\n      }\n    }\n  }\n\n  return useCallback((path: string, message: ReflectiveMessage, bigInt: ?true): ?(MessagePathDataItem[]) => {\n    if (!memoizedPaths.includes(path)) {\n      throw new Error(`path (${path}) was not in the list of cached paths`);\n    }\n    const filledInPath = memoizedFilledInPaths[path];\n    if (!filledInPath) {\n      return;\n    }\n    if (!cachesByPath.current[path]) {\n      cachesByPath.current[path] = { filledInPath, weakMap: new WeakMap() };\n    }\n    const { weakMap } = cachesByPath.current[path];\n    if (!weakMap.has(message)) {\n      const messagePathDataItems = getMessagePathDataItems(message, filledInPath, providerTopics, datatypes, bigInt);\n      weakMap.set(message, messagePathDataItems);\n      return messagePathDataItems;\n    }\n    const messagePathDataItems = weakMap.get(message);\n    return messagePathDataItems;\n  }, [datatypes, memoizedFilledInPaths, memoizedPaths, providerTopics]);\n}\n\nfunction filterMatches(filter: MessagePathFilter, value: any) {\n  if (typeof filter.value === \"object\") {\n    throw new Error(\"filterMatches only works on paths where global variables have been filled in\");\n  }\n\n  let currentValue = value;\n  for (const name of filter.path) {\n    currentValue = getField(currentValue, name);\n    if (currentValue == null) {\n      return false;\n    }\n  }\n\n  // Test equality using `==` so we can be forgiving for comparing booleans with integers,\n  // comparing numbers with strings, and so on.\n  // eslint-disable-next-line eqeqeq\n  return currentValue == filter.value;\n}\n\nexport function fillInGlobalVariablesInPath(rosPath: RosPath, globalVariables: GlobalVariables): RosPath {\n  return {\n    ...rosPath,\n    messagePath: rosPath.messagePath.map((messagePathPart) => {\n      if (messagePathPart.type === \"slice\") {\n        const start =\n          typeof messagePathPart.start === \"object\"\n            ? Number(globalVariables[messagePathPart.start.variableName])\n            : messagePathPart.start;\n        const end =\n          typeof messagePathPart.end === \"object\"\n            ? Number(globalVariables[messagePathPart.end.variableName])\n            : messagePathPart.end;\n\n        return {\n          ...messagePathPart,\n          start: isNaN(start) ? 0 : start,\n          end: isNaN(end) ? Infinity : end,\n        };\n      } else if (messagePathPart.type === \"filter\" && typeof messagePathPart.value === \"object\") {\n        let value;\n        const variable = globalVariables[messagePathPart.value.variableName];\n        if (typeof variable === \"number\" || typeof variable === \"string\") {\n          value = variable;\n        }\n        return { ...messagePathPart, value };\n      }\n\n      (messagePathPart.type: \"name\" | \"filter\");\n      return messagePathPart;\n    }),\n  };\n}\n\nconst TIME_NEXT_BY_NAME = Object.freeze({\n  sec: { structureType: \"primitive\", primitiveType: \"int32\", datatype: \"time\" },\n  nsec: { structureType: \"primitive\", primitiveType: \"int32\", datatype: \"time\" },\n});\n\n// Get a new item that has `queriedData` set to the values and paths as queried by `rosPath`.\n// Exported just for tests.\nexport function getMessagePathDataItems(\n  message: ReflectiveMessage,\n  filledInPath: RosPath,\n  providerTopics: $ReadOnlyArray<Topic>,\n  datatypes: RosDatatypes,\n  bigInt: ?true\n): ?(MessagePathDataItem[]) {\n  const structures = messagePathStructures(datatypes);\n  const topic = providerTopics.find(({ name }) => name === filledInPath.topicName);\n\n  // We don't care about messages that don't match the topic we're looking for.\n  if (!topic || message.topic !== filledInPath.topicName) {\n    return;\n  }\n\n  // Apply top-level filters first. If a message matches all top-level filters, then this function\n  // will *always* return a history item, so this is our only chance to return nothing.\n  for (const item of filledInPath.messagePath) {\n    if (item.type === \"filter\") {\n      if (!filterMatches(item, message.message)) {\n        return [];\n      }\n    } else {\n      break;\n    }\n  }\n\n  const queriedData = [];\n  // Traverse the message (via `value`) and the `messagePath` at the same time. Also keep track\n  // of a `path` string that we should show in the tooltip of the point.\n  function traverse(value: any, pathIndex: number, path: string, structureItem: MessagePathStructureItem) {\n    if (value === undefined || structureItem === undefined) {\n      return;\n    }\n    const pathItem = filledInPath.messagePath[pathIndex];\n    const nextPathItem = filledInPath.messagePath[pathIndex + 1];\n    const structureIsJson = structureItem.structureType === \"primitive\" && structureItem.primitiveType === \"json\";\n    if (!pathItem) {\n      // If we're at the end of the `messagePath`, we're done! Just store the point.\n      let constantName: ?string;\n      const prevPathItem = filledInPath.messagePath[pathIndex - 1];\n      if (prevPathItem && prevPathItem.type === \"name\") {\n        const fieldName = prevPathItem.name;\n        const enumMap = enumValuesByDatatypeAndField(datatypes)[structureItem.datatype];\n        if (enumMap && enumMap[fieldName]) {\n          constantName = enumMap[fieldName][value];\n        }\n      }\n      queriedData.push({ value, path, constantName });\n    } else if (pathItem.type === \"name\" && structureItem.structureType === \"message\") {\n      // If the `pathItem` is a name, we're traversing down using that name.\n      const next = structureItem.nextByName[pathItem.name];\n      // Datatype names can have ambiguous definitions, most commonly when there are multiple input\n      // bags. If a field exists but doesn't appear in the datatype structure, treat it and its\n      // children as free-form JSON.\n      const nextStructIsJson = next == null || (next.structureType === \"primitive\" && next?.primitiveType === \"json\");\n      traverse(\n        getField(value, pathItem.name, bigInt),\n        pathIndex + 1,\n        `${path}.${pathItem.name}`,\n        !nextStructIsJson ? next : { structureType: \"primitive\", primitiveType: \"json\", datatype: \"\" }\n      );\n    } else if (\n      pathItem.type === \"name\" &&\n      (structureItem.primitiveType === \"time\" || structureItem.primitiveType === \"duration\")\n    ) {\n      traverse(\n        getField(value, pathItem.name),\n        pathIndex + 1,\n        `${path}.${pathItem.name}`,\n        TIME_NEXT_BY_NAME[pathItem.name]\n      );\n    } else if (pathItem.type === \"slice\" && (structureItem.structureType === \"array\" || structureIsJson)) {\n      const { start, end } = pathItem;\n      if (typeof start === \"object\" || typeof end === \"object\") {\n        throw new Error(\"getMessagePathDataItems  only works on paths where global variables have been filled in\");\n      }\n      const startIdx: number = start;\n      const endIdx: number = end;\n      if (typeof startIdx !== \"number\" || typeof endIdx !== \"number\") {\n        return;\n      }\n\n      // If the `pathItem` is a slice, iterate over all the relevant elements in the array.\n      const arrayLength = getField(value, \"length\");\n      for (let i = startIdx; i <= Math.min(endIdx, arrayLength - 1); i++) {\n        const index = i >= 0 ? i : arrayLength + i;\n        const arrayElement = getIndex(value, index, bigInt);\n        if (arrayElement == null) {\n          continue;\n        }\n        // Ideally show something like `/topic.object[:]{some_id=123}` for the path, but fall\n        // back to `/topic.object[10]` if necessary. In any case, make sure that the user can\n        // actually identify where the value came from.\n        let newPath;\n        if (nextPathItem && nextPathItem.type === \"filter\") {\n          // If we have a filter set after this, it will update the path appropriately.\n          newPath = `${path}[:]`;\n        } else {\n          // See if `arrayElement` has a property that we typically filter on. If so, show that.\n          const name = fieldNames(arrayElement).find((key) => isTypicalFilterName(key));\n          if (name) {\n            newPath = `${path}[:]{${name}==${getField(arrayElement, name, bigInt)}}`;\n          } else {\n            // Use `i` here instead of `index`, since it's only different when `i` is negative,\n            // and in that case it's probably more useful to show to the user how many elements\n            // from the end of the array this data is, since they clearly are thinking in that way\n            // (otherwise they wouldn't have chosen a negative slice).\n            newPath = `${path}[${i}]`;\n          }\n        }\n        traverse(\n          arrayElement,\n          pathIndex + 1,\n          newPath,\n          !structureIsJson && structureItem.structureType === \"array\" ? structureItem.next : structureItem // Structure is already JSON.\n        );\n      }\n    } else if (pathItem.type === \"filter\") {\n      if (filterMatches(pathItem, value)) {\n        traverse(value, pathIndex + 1, `${path}{${pathItem.repr}}`, structureItem);\n      }\n    } else if (structureIsJson && pathItem.name) {\n      // Use getField just in case.\n      traverse(getField(value, pathItem.name), pathIndex + 1, `${path}.${pathItem.name}`, {\n        structureType: \"primitive\",\n        primitiveType: \"json\",\n        datatype: \"\",\n      });\n    } else {\n      console.warn(`Unknown pathItem.type ${pathItem.type} for structureType: ${structureItem.structureType}`);\n    }\n  }\n  traverse(message.message, 0, filledInPath.topicName, structures[topic.datatype]);\n  return queriedData;\n}\n\nexport const useDecodeMessagePathsForMessagesByTopic = (paths: string[]) => {\n  const memoizedPaths = useShallowMemo<string[]>(paths);\n  const cachedGetMessagePathDataItems = useCachedGetMessagePathDataItems(memoizedPaths);\n  // Note: Let callers define their own memoization scheme for messagesByTopic. For regular playback\n  // useMemo might be appropriate, but weakMemo will likely better for blocks.\n  return useCallback((messagesByTopic: $ReadOnly<{ [topicName: string]: $ReadOnlyArray<ReflectiveMessage> }>) => {\n    const obj = {};\n    for (const path of memoizedPaths) {\n      // Create an array for invalid paths, and valid paths with entries in messagesByTopic\n      const rosPath = parseRosPath(path);\n      if (!rosPath) {\n        obj[path] = [];\n        continue;\n      }\n      if (!messagesByTopic[rosPath.topicName]) {\n        // For the playback pipeline messagesByTopic will always include an entry for every topic.\n        // For the blocks, missing entries are semantically interesting, and should result in\n        // missing (not empty) entries in the output so that information is communicated\n        // downstream.\n        continue;\n      }\n      obj[path] = [];\n\n      for (const message of messagesByTopic[rosPath.topicName]) {\n        // Add the item (if it exists) to the array.\n        const queriedData = cachedGetMessagePathDataItems(path, message);\n        if (queriedData) {\n          obj[path].push({ message, queriedData });\n        }\n      }\n    }\n    return obj;\n  }, [memoizedPaths, cachedGetMessagePathDataItems]);\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport MenuDownIcon from \"@mdi/svg/svg/menu-down.svg\";\nimport cx from \"classnames\";\nimport { flatten, flatMap, partition } from \"lodash\";\nimport * as React from \"react\";\n\nimport type { RosPath, RosPrimitive } from \"./constants\";\nimport styles from \"./MessagePathInput.module.scss\";\nimport {\n  type StructureTraversalResult,\n  traverseStructure,\n  messagePathStructures,\n  messagePathsForDatatype,\n  validTerminatingStructureItem,\n} from \"./messagePathsForDatatype\";\nimport parseRosPath from \"./parseRosPath\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport useGlobalVariables, { type GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { getTopicNames, getTopicsByTopicName } from \"webviz-core/src/util/selectors\";\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\n\n// To show an input field with an autocomplete so the user can enter message paths, use:\n//\n//  <MessagePathInput path={this.state.path} onChange={path => this.setState({ path })} />\n//\n// To limit the autocomplete items to only certain types of values, you can use\n//\n//  <MessagePathInput types={[\"message\", \"array\", \"primitives\"]} />\n//\n// Or use actual ROS primitive types:\n//\n//  <MessagePathInput types={[\"uint16\", \"float64\"]} />\n//\n// If you don't use timestamps, you might want to hide the warning icon that we show when selecting\n// a topic that has no header: `<MessagePathInput hideTimestampWarning>`.\n//\n// If you are rendering many input fields, you might want to use `<MessagePathInput index={5}>`,\n// which gets passed down to `<MessagePathInput onChange>` as the second parameter, so you can\n// avoid creating anonymous functions on every render (which will prevent the component from\n// rendering unnecessarily).\n\nfunction topicHasNoHeaderStamp(topic: Topic, datatypes: RosDatatypes): boolean {\n  const structureTraversalResult = traverseStructure(messagePathStructures(datatypes)[topic.datatype], [\n    { type: \"name\", name: \"header\" },\n    { type: \"name\", name: \"stamp\" },\n  ]);\n\n  return (\n    !structureTraversalResult.valid || !validTerminatingStructureItem(structureTraversalResult.structureItem, [\"time\"])\n  );\n}\n\nexport function tryToSetDefaultGlobalVar(variableName: string, setGlobalVariables: (GlobalVariables) => void): boolean {\n  const defaultGlobalVars = getGlobalHooks().getDefaultPersistedState().panels.globalVariables;\n  if (Object.keys(defaultGlobalVars).includes(variableName)) {\n    setGlobalVariables({ [variableName]: defaultGlobalVars[variableName] });\n    return true;\n  }\n  return false;\n}\n\nexport function getFirstInvalidVariableFromRosPath(\n  rosPath: RosPath,\n  globalVariables: GlobalVariables,\n  setGlobalVariables: (GlobalVariables) => void\n): ?{| variableName: string, loc: number |} {\n  const { messagePath } = rosPath;\n  const globalVars = Object.keys(globalVariables);\n  return flatMap(messagePath, (path) => {\n    const messagePathParts = [];\n    if (path.type === \"filter\" && typeof path.value === \"object\" && !globalVars.includes(path.value.variableName)) {\n      const [variableName, loc] = [path.value.variableName, path.valueLoc];\n      messagePathParts.push({ variableName, loc });\n    } else if (path.type === \"slice\") {\n      if (typeof path.start === \"object\" && !globalVars.includes(path.start.variableName)) {\n        const [variableName, loc] = [path.start.variableName, path.start.startLoc];\n        messagePathParts.push({ variableName, loc });\n      }\n      if (path.end != null && typeof path.end === \"object\" && !globalVars.includes(path.end.variableName)) {\n        const [variableName, loc] = [path.end.variableName, path.end.startLoc];\n        messagePathParts.push({ variableName, loc });\n      }\n    }\n    return messagePathParts;\n  }).filter(({ variableName }) => !tryToSetDefaultGlobalVar(variableName, setGlobalVariables))[0];\n}\n\nfunction getExamplePrimitive(primitiveType: RosPrimitive) {\n  switch (primitiveType) {\n    case \"string\":\n      return '\"\"';\n    case \"bool\":\n      return \"true\";\n    case \"float32\":\n    case \"float64\":\n    case \"uint8\":\n    case \"uint16\":\n    case \"uint32\":\n    case \"uint64\":\n    case \"int8\":\n    case \"int16\":\n    case \"int32\":\n    case \"int64\":\n      return \"0\";\n    case \"duration\":\n    case \"time\":\n    case \"json\":\n      return \"\";\n    default:\n      (primitiveType: empty);\n      return \"\";\n  }\n}\n\ntype MessagePathInputBaseProps = {\n  path: string, // A path of the form `/topic.some_field[:]{id==42}.x`\n  index?: number, // Optional index field which gets passed to `onChange` (so you don't have to create anonymous functions)\n  onChange: (value: string, index: ?number) => void,\n  validTypes?: string[], // Valid types, like \"message\", \"array\", or \"primitive\", or a ROS primitive like \"float64\"\n  noMultiSlices?: boolean, // Don't suggest slices with multiple values `[:]`, only single values like `[0]`.\n  autoSize?: boolean,\n  placeholder?: string,\n  inputStyle?: any,\n  disableAutocomplete?: boolean, // Treat this as a normal input, with no autocomplete.\n\n  timestampMethod?: TimestampMethod,\n  onTimestampMethodChange?: (TimestampMethod, index: ?number) => void,\n};\ntype MessagePathInputProps = MessagePathInputBaseProps & {\n  topics: $ReadOnlyArray<Topic>,\n  datatypes: RosDatatypes,\n  prioritizedDatatype?: ?string,\n  globalVariables: GlobalVariables,\n  setGlobalVariables: (GlobalVariables) => void,\n};\ntype MessagePathInputState = {| focused: boolean |};\nclass MessagePathInputUnconnected extends React.PureComponent<MessagePathInputProps, MessagePathInputState> {\n  _input: ?HTMLInputElement;\n\n  constructor(props: MessagePathInputProps) {\n    super(props);\n    this.state = { focused: false };\n  }\n\n  _onChange = (event: SyntheticInputEvent<HTMLInputElement>, value: string) => {\n    // When typing a \"{\" character, also  insert a \"}\", so you get an\n    // autocomplete window immediately for selecting a filter name.\n    // $FlowFixMe\n    if (event.nativeEvent.data === \"{\") {\n      const newCursorPosition = event.target.selectionEnd;\n      value = `${value.slice(0, newCursorPosition)}}${value.slice(newCursorPosition)}`;\n\n      const target = event.target;\n      setImmediate(() => target.setSelectionRange(newCursorPosition, newCursorPosition));\n    }\n    this.props.onChange(value, this.props.index);\n  };\n\n  _onTimestampMethodChange = (value: TimestampMethod) => {\n    if (this.props.onTimestampMethodChange) {\n      this.props.onTimestampMethodChange(value, this.props.index);\n    }\n  };\n\n  _onSelect = (\n    value: string,\n    autocomplete: Autocomplete,\n    autocompleteType: ?(\"topicName\" | \"messagePath\" | \"globalVariables\"),\n    autocompleteRange: {| start: number, end: number |}\n  ) => {\n    // If we're dealing with a topic name, and we cannot validly end in a message type,\n    // add a \".\" so the user can keep typing to autocomplete the message path.\n    const keepGoingAfterTopicName =\n      autocompleteType === \"topicName\" && this.props.validTypes && !this.props.validTypes.includes(\"message\");\n    if (keepGoingAfterTopicName) {\n      value += \".\";\n    }\n    this.props.onChange(\n      this.props.path.substr(0, autocompleteRange.start) + value + this.props.path.substr(autocompleteRange.end),\n      this.props.index\n    );\n    // We want to continue typing if we're dealing with a topic name,\n    // or if we just autocompleted something with a filter (because we might want to\n    // edit that filter), or if the autocomplete already has a filter (because we might\n    // have just autocompleted a name inside that filter).\n    if (keepGoingAfterTopicName || value.includes(\"{\") || this.props.path.includes(\"{\")) {\n      const newCursorPosition = autocompleteRange.start + value.length;\n      setImmediate(() => autocomplete.setSelectionRange(newCursorPosition, newCursorPosition));\n    } else {\n      autocomplete.blur();\n    }\n  };\n\n  render() {\n    const {\n      path,\n      topics,\n      datatypes,\n      prioritizedDatatype,\n      validTypes,\n      autoSize,\n      placeholder,\n      noMultiSlices,\n      timestampMethod,\n      inputStyle,\n      disableAutocomplete,\n      globalVariables,\n      setGlobalVariables,\n    } = this.props;\n\n    const rosPath = parseRosPath(path);\n    let autocompleteType: ?(\"topicName\" | \"messagePath\" | \"globalVariables\");\n    let topic: ?Topic;\n    let structureTraversalResult: ?StructureTraversalResult;\n    if (rosPath) {\n      const { topicName } = rosPath;\n      topic = topics.find(({ name }) => name === topicName);\n\n      if (topic) {\n        structureTraversalResult = traverseStructure(\n          messagePathStructures(datatypes)[topic.datatype],\n          rosPath.messagePath\n        );\n      }\n\n      if (!topic) {\n        autocompleteType = \"topicName\";\n      } else if (\n        !structureTraversalResult ||\n        !structureTraversalResult.valid ||\n        !validTerminatingStructureItem(structureTraversalResult.structureItem, validTypes)\n      ) {\n        autocompleteType = \"messagePath\";\n      }\n    } else {\n      autocompleteType = \"topicName\";\n    }\n\n    let autocompleteItems = [];\n    let autocompleteFilterText = \"\";\n    let autocompleteRange = { start: 0, end: Infinity };\n    if (disableAutocomplete) {\n      autocompleteItems = [];\n    } else if (autocompleteType === \"topicName\") {\n      autocompleteItems = getTopicNames(topics);\n      autocompleteFilterText = path;\n    } else if (autocompleteType === \"messagePath\" && topic /*:: && rosPath */) {\n      if (\n        structureTraversalResult &&\n        !structureTraversalResult.valid &&\n        structureTraversalResult.msgPathPart &&\n        structureTraversalResult.msgPathPart.type === \"filter\" &&\n        structureTraversalResult.structureItem &&\n        structureTraversalResult.structureItem.structureType === \"message\"\n      ) {\n        const { msgPathPart } = structureTraversalResult;\n\n        // Provide filter suggestions for primitive values, since they're the only kinds of values\n        // that can be filtered on.\n        // TODO: add support for nested paths to primitives, such as \"/some_topic{foo.bar==3}\".\n        for (const name of Object.keys(structureTraversalResult.structureItem.nextByName)) {\n          const item = structureTraversalResult.structureItem.nextByName[name];\n          if (item.structureType === \"primitive\") {\n            autocompleteItems.push(`${name}==${getExamplePrimitive(item.primitiveType)}`);\n          }\n        }\n\n        autocompleteFilterText = msgPathPart.path.join(\".\");\n        autocompleteRange = {\n          start: msgPathPart.nameLoc,\n          end: msgPathPart.nameLoc + autocompleteFilterText.length,\n        };\n      } else {\n        autocompleteItems = messagePathsForDatatype(\n          topic.datatype,\n          datatypes,\n          validTypes,\n          noMultiSlices,\n          rosPath.messagePath\n        ).filter(\n          // .header.seq is pretty useless but shows up everryyywhere.\n          (msgPath) => msgPath !== \"\" && !msgPath.endsWith(\".header.seq\")\n        );\n\n        // Exclude any initial filters (\"/topic{foo=='bar'}\") from the range that will be replaced\n        // when the user chooses a new message path.\n        let initialFilterLength = 0;\n        for (const item of rosPath.messagePath) {\n          if (item.type === \"filter\") {\n            initialFilterLength += item.repr.length + 2; // add { and }\n          } else {\n            break;\n          }\n        }\n\n        autocompleteRange = { start: topic.name.length + initialFilterLength, end: Infinity };\n        // Filter out filters (hah!) in a pretty crude way, so autocomplete still works\n        // when already having specified a filter and you want to see what other object\n        // names you can complete it with. Kind of an edge case, and this doesn't work\n        // ideally (because it will remove your existing filter if you actually select\n        // the autocomplete item), but it's easy to do for now, and nice to have.\n        autocompleteFilterText = path.substr(topic.name.length).replace(/\\{[^}]*\\}/g, \"\");\n      }\n    } else if (rosPath) {\n      const invalidGlobalVariablesVariable = getFirstInvalidVariableFromRosPath(\n        rosPath,\n        globalVariables,\n        setGlobalVariables\n      );\n\n      if (invalidGlobalVariablesVariable) {\n        autocompleteType = \"globalVariables\";\n        autocompleteItems = Object.keys(globalVariables).map((key) => `$${key}`);\n        autocompleteRange = {\n          start: invalidGlobalVariablesVariable.loc,\n          end: invalidGlobalVariablesVariable.loc + invalidGlobalVariablesVariable.variableName.length + 1,\n        };\n        autocompleteFilterText = invalidGlobalVariablesVariable.variableName;\n      }\n    }\n\n    const noHeaderStamp = topic && topicHasNoHeaderStamp(topic, datatypes);\n    const orderedAutocompleteItems = prioritizedDatatype\n      ? flatten(\n          partition(autocompleteItems, (item) => getTopicsByTopicName(topics)[item]?.datatype === prioritizedDatatype)\n        )\n      : autocompleteItems;\n\n    return (\n      <div style={{ display: \"flex\", flex: \"1 1 auto\", minWidth: 0, justifyContent: \"space-between\" }}>\n        <Autocomplete\n          items={orderedAutocompleteItems}\n          filterText={autocompleteFilterText}\n          value={path}\n          onChange={this._onChange}\n          onSelect={(value: string, item: any, autocomplete: Autocomplete) =>\n            this._onSelect(value, autocomplete, autocompleteType, autocompleteRange)\n          }\n          hasError={!!autocompleteType && !disableAutocomplete && path.length}\n          autocompleteKey={autocompleteType}\n          placeholder={placeholder || \"/some/topic.msgs[0].field\"}\n          autoSize={autoSize}\n          inputStyle={inputStyle}\n          // Disable autoselect since people often construct complex queries, and it's very annoying\n          // to have the entire input selected whenever you want to make a change to a part it.\n          disableAutoSelect\n        />\n\n        {timestampMethod && (\n          <div className={styles.timestampMethodDropdownContainer}>\n            <Dropdown\n              onChange={this._onTimestampMethodChange}\n              value={timestampMethod}\n              toggleComponent={\n                <Tooltip contents=\"Timestamp used for x-axis\" placement=\"top\">\n                  <div\n                    className={cx({\n                      [styles.timestampMethodDropdown]: true,\n                      [styles.timestampMethodDropdownError]: timestampMethod === \"headerStamp\" && noHeaderStamp,\n                    })}>\n                    {timestampMethod === \"receiveTime\" ? \"(receive time)\" : \"(header.stamp)\"}\n                    <Icon style={{ position: \"relative\", top: 2, marginLeft: 2 }}>\n                      <MenuDownIcon />\n                    </Icon>\n                  </div>\n                </Tooltip>\n              }>\n              {/* $FlowFixMe - \"value\" is needed for <Dropdown>, but it's not part of <Tooltip>. */}\n              <Tooltip\n                value=\"receiveTime\"\n                placement=\"right\"\n                contents=\"ROS-time at which the message was received and recorded\">\n                <span>receive time</span>\n              </Tooltip>\n              {/* $FlowFixMe - \"value\" is needed for <Dropdown>, but it's not part of <Tooltip>. */}\n              <Tooltip\n                value=\"headerStamp\"\n                placement=\"below\"\n                contents={\n                  <div style={{ maxWidth: 200, lineHeight: \"normal\" }}>\n                    Value of the header.stamp field. Can mean different things for different topics. Be sure you know\n                    what this value means before using it.\n                    {noHeaderStamp && (\n                      <div className={styles.timestampItemError}>(header.stamp is not present in this topic)</div>\n                    )}\n                  </div>\n                }>\n                <span\n                  className={cx({\n                    [styles.timestampItemError]: noHeaderStamp,\n                  })}>\n                  header.stamp\n                </span>\n              </Tooltip>\n            </Dropdown>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default React.memo<MessagePathInputBaseProps>(function MessagePathInput(props: MessagePathInputBaseProps) {\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n  const { datatypes, topics } = PanelAPI.useDataSourceInfo();\n  return (\n    <MessagePathInputUnconnected\n      {...props}\n      topics={topics}\n      datatypes={datatypes}\n      globalVariables={globalVariables}\n      setGlobalVariables={setGlobalVariables}\n    />\n  );\n});\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport AlphaR from \"@mdi/svg/svg/alpha-r.svg\";\nimport AlphaT from \"@mdi/svg/svg/alpha-t.svg\";\nimport ArrowCollapseDown from \"@mdi/svg/svg/arrow-collapse-down.svg\";\nimport ArrowCollapseLeft from \"@mdi/svg/svg/arrow-collapse-left.svg\";\nimport ArrowCollapseRight from \"@mdi/svg/svg/arrow-collapse-right.svg\";\nimport ArrowCollapseUp from \"@mdi/svg/svg/arrow-collapse-up.svg\";\nimport ArrowDecision from \"@mdi/svg/svg/arrow-decision.svg\";\nimport ArrowLeft from \"@mdi/svg/svg/arrow-left.svg\";\nimport ArrowRight from \"@mdi/svg/svg/arrow-right.svg\";\nimport ArrowTopLeft from \"@mdi/svg/svg/arrow-top-left.svg\";\nimport ArrowTopRight from \"@mdi/svg/svg/arrow-top-right.svg\";\nimport Bike from \"@mdi/svg/svg/bike.svg\";\nimport BusSchool from \"@mdi/svg/svg/bus-school.svg\";\nimport Bus from \"@mdi/svg/svg/bus.svg\";\nimport CarBrakeAlert from \"@mdi/svg/svg/car-brake-alert.svg\";\nimport CarParkingLights from \"@mdi/svg/svg/car-parking-lights.svg\";\nimport Car from \"@mdi/svg/svg/car.svg\";\nimport CubeOutline from \"@mdi/svg/svg/cube-outline.svg\";\nimport HazardLights from \"@mdi/svg/svg/hazard-lights.svg\";\nimport HelpCircleOutline from \"@mdi/svg/svg/help-circle-outline.svg\";\nimport Help from \"@mdi/svg/svg/help.svg\";\nimport Motorbike from \"@mdi/svg/svg/motorbike.svg\";\nimport Octagon from \"@mdi/svg/svg/octagon.svg\";\nimport RoadVariant from \"@mdi/svg/svg/road-variant.svg\";\nimport RobotOffOutline from \"@mdi/svg/svg/robot-off-outline.svg\";\nimport RobotOutline from \"@mdi/svg/svg/robot-outline.svg\";\nimport SignalOff from \"@mdi/svg/svg/signal-off.svg\";\nimport Train from \"@mdi/svg/svg/train.svg\";\nimport Truck from \"@mdi/svg/svg/truck.svg\";\nimport Walk from \"@mdi/svg/svg/walk.svg\";\n\nexport const LAYER_INDEX_TEXT = 10;\nexport const LAYER_INDEX_OCCUPANCY_GRIDS = -1;\n\n// When the World is drawn in multiple passes, these values are used\n// to set the base for all markers in that render pass.\nexport const LAYER_INDEX_DEFAULT_BASE = 0;\nexport const LAYER_INDEX_HIGHLIGHT_OVERLAY = 500;\nexport const LAYER_INDEX_HIGHLIGHT_BASE = 1000;\nexport const LAYER_INDEX_DIFF_MODE_BASE_PER_PASS = 100;\n\n// Use for both 3D panel and ImageView panel. Use icon names from https://materialdesignicons.com for future icons.\nexport const ICON_BY_TYPE = {\n  // Supported icons, add more if needed.\n  \"alpha-r\": AlphaR,\n  \"alpha-t\": AlphaT,\n  \"arrow-collapse-down\": ArrowCollapseDown,\n  \"arrow-collapse-left\": ArrowCollapseLeft,\n  \"arrow-collapse-right\": ArrowCollapseRight,\n  \"arrow-collapse-up\": ArrowCollapseUp,\n  \"arrow-decision\": ArrowDecision,\n  \"arrow-left\": ArrowLeft,\n  \"arrow-right\": ArrowRight,\n  \"arrow-top-left\": ArrowTopLeft,\n  \"arrow-top-right\": ArrowTopRight,\n  \"bus-school\": BusSchool,\n  \"car-brake-alert\": CarBrakeAlert,\n  \"car-parking-lights\": CarParkingLights,\n  \"hazard-lights\": HazardLights,\n  \"help-circle-outline\": HelpCircleOutline,\n  \"road-variant\": RoadVariant,\n  \"signal-off\": SignalOff,\n  \"robot-outline\": RobotOutline,\n  \"robot-off-outline\": RobotOffOutline,\n  bike: Bike,\n  bus: Bus,\n  car: Car,\n  DEFAULT: CubeOutline,\n  help: Help,\n  motorbike: Motorbike,\n  octagon: Octagon,\n  train: Train,\n  truck: Truck,\n  walk: Walk,\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { vec3 } from \"gl-matrix\";\n// eslint-disable-next-line no-restricted-imports\nimport { mergeWith, get } from \"lodash\";\nimport { useRef } from \"react\";\nimport {\n  type CameraState,\n  type Vec3,\n  type Vec4,\n  type MouseEventObject,\n  cameraStateSelectors,\n  DEFAULT_CAMERA_STATE,\n} from \"regl-worldview\";\n\nimport { type GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport {\n  decodeData as decodePointCloudData,\n  getClickedPointColor,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/selection\";\nimport type { InteractionData } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\nimport { type LinkedGlobalVariables } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport { getField, isBobject, deepParse } from \"webviz-core/src/util/binaryObjects\";\nimport { useDeepMemo } from \"webviz-core/src/util/hooks\";\nimport { emptyPose } from \"webviz-core/src/util/Pose\";\n\nexport type TargetPose = { target: Vec3, targetOrientation: Vec4 };\n\nconst ZOOM_LEVEL_URL_PARAM = \"zoom\";\n\nfunction getZoomDistanceFromURLParam(): number | void {\n  const params = new URLSearchParams(location && location.search);\n  if (params.has(ZOOM_LEVEL_URL_PARAM)) {\n    return parseFloat(params.get(ZOOM_LEVEL_URL_PARAM));\n  }\n}\n\n// Get the camera target position and orientation\nexport function getTargetPose(followTf?: string | false, transforms: Transforms) {\n  if (followTf) {\n    let pose = emptyPose();\n    pose = transforms.apply(pose, pose, followTf, transforms.rootOfTransform(followTf).id);\n    if (pose) {\n      const { x: px, y: py, z: pz } = pose.position;\n      const { x: ox, y: oy, z: oz, w: ow } = pose.orientation;\n      return {\n        target: [px, py, pz],\n        targetOrientation: [ox, oy, oz, ow],\n      };\n    }\n  }\n  return null;\n}\n\nexport function useTransformedCameraState({\n  configCameraState,\n  followTf,\n  followOrientation,\n  transforms,\n}: {\n  configCameraState: $Shape<CameraState>,\n  followTf?: string | false,\n  followOrientation?: boolean,\n  transforms: Transforms,\n}): { transformedCameraState: CameraState, targetPose: ?TargetPose } {\n  let transformedCameraState = { ...configCameraState };\n  const targetPose = getTargetPose(followTf, transforms);\n  // Store last seen target pose because the target may become available/unavailable over time as\n  // the player changes, and we want to avoid moving the camera when it disappears.\n  const lastTargetPoseRef = useRef<?TargetPose>(null);\n  const lastTargetPose = lastTargetPoseRef.current;\n  // Recompute cameraState based on the new inputs at each render\n  if (targetPose) {\n    lastTargetPoseRef.current = targetPose;\n    transformedCameraState.target = targetPose.target;\n    if (followOrientation) {\n      transformedCameraState.targetOrientation = targetPose.targetOrientation;\n    }\n  } else if (followTf && lastTargetPose) {\n    // If follow is enabled but no target is available (such as when seeking), keep the camera\n    // position the same as it would have been by reusing the last seen target pose.\n    transformedCameraState.target = lastTargetPose.target;\n    if (followOrientation) {\n      transformedCameraState.targetOrientation = lastTargetPose.targetOrientation;\n    }\n  }\n  // Read the distance from URL when World is first loaded with empty cameraState distance in savedProps\n  if (configCameraState?.distance == null) {\n    transformedCameraState.distance = getZoomDistanceFromURLParam();\n  }\n\n  transformedCameraState = mergeWith(\n    transformedCameraState,\n    DEFAULT_CAMERA_STATE,\n    (objVal, srcVal) => objVal ?? srcVal\n  );\n\n  return useDeepMemo({ transformedCameraState, targetPose: targetPose || lastTargetPose });\n}\n\nexport const getInstanceObj = (marker: any, idx: number): any => {\n  if (!marker) {\n    return;\n  }\n  if (!isBobject(marker)) {\n    return marker?.metadataByIndex?.[idx];\n  }\n  if (!marker.metadataByIndex) {\n    return;\n  }\n  return marker.metadataByIndex()?.[idx];\n};\nexport const getObject = (selectedObject: MouseEventObject) => {\n  const object =\n    (selectedObject.instanceIndex !== undefined &&\n      selectedObject.object.metadataByIndex !== undefined &&\n      getInstanceObj(selectedObject.object, selectedObject.instanceIndex)) ||\n    selectedObject?.object;\n  return isBobject(object) ? deepParse(object) : object;\n};\nexport const getInteractionData = (selectedObject: MouseEventObject): ?InteractionData =>\n  selectedObject.object.interactionData || getObject(selectedObject)?.interactionData;\n\nexport function getUpdatedGlobalVariablesBySelectedObject(\n  selectedObject: MouseEventObject,\n  linkedGlobalVariables: LinkedGlobalVariables\n): ?GlobalVariables {\n  const object = getObject(selectedObject);\n  const interactionData = getInteractionData(selectedObject);\n  if (!linkedGlobalVariables.length || !interactionData?.topic) {\n    return;\n  }\n  const newGlobalVariables = {};\n  linkedGlobalVariables.forEach(({ topic, markerKeyPath, name }) => {\n    if (interactionData?.topic === topic) {\n      const objectForPath = get(object, [...markerKeyPath].reverse());\n      newGlobalVariables[name] = objectForPath;\n    }\n  });\n  return newGlobalVariables;\n}\n\n// Return targetOffset and thetaOffset that would yield the same camera position as the\n// given offsets if the target were (0,0,0) and targetOrientation were identity.\nfunction getEquivalentOffsetsWithoutTarget(\n  offsets: { +targetOffset: Vec3, +thetaOffset: number },\n  targetPose: { +target: Vec3, +targetOrientation: Vec4 },\n  followOrientation?: boolean\n): { targetOffset: Vec3, thetaOffset: number } {\n  const heading = followOrientation\n    ? cameraStateSelectors.targetHeading({ targetOrientation: targetPose.targetOrientation })\n    : 0;\n  const targetOffset = vec3.rotateZ([0, 0, 0], offsets.targetOffset, [0, 0, 0], -heading);\n  vec3.add(targetOffset, targetOffset, targetPose.target);\n  const thetaOffset = offsets.thetaOffset + heading;\n  return { targetOffset, thetaOffset };\n}\n\nexport function getNewCameraStateOnFollowChange({\n  prevCameraState,\n  prevTargetPose,\n  prevFollowTf,\n  prevFollowOrientation,\n  newFollowTf,\n  newFollowOrientation,\n}: {|\n  prevCameraState: CameraState,\n  prevTargetPose: ?TargetPose,\n  prevFollowTf: ?(string | false),\n  prevFollowOrientation: ?boolean,\n  newFollowTf: ?(string | false),\n  newFollowOrientation: ?boolean,\n|}): CameraState {\n  const newCameraState = { ...prevCameraState };\n  if (newFollowTf) {\n    // When switching to follow orientation, adjust thetaOffset to preserve camera rotation.\n    if (newFollowOrientation && !prevFollowOrientation && prevTargetPose) {\n      const heading = cameraStateSelectors.targetHeading({\n        targetOrientation: prevTargetPose.targetOrientation,\n      });\n      newCameraState.targetOffset = vec3.rotateZ(\n        [0, 0, 0],\n        newCameraState.targetOffset || DEFAULT_CAMERA_STATE.targetOffset,\n        [0, 0, 0],\n        heading\n      );\n      newCameraState.thetaOffset -= heading;\n    }\n    // When following a frame for the first time, snap to the origin.\n    if (!prevFollowTf) {\n      newCameraState.targetOffset = [0, 0, 0];\n    }\n  } else if (prevFollowTf && prevTargetPose) {\n    // When unfollowing, preserve the camera position and orientation.\n    Object.assign(\n      newCameraState,\n      getEquivalentOffsetsWithoutTarget(\n        {\n          targetOffset: prevCameraState.targetOffset || DEFAULT_CAMERA_STATE.targetOffset,\n          thetaOffset: prevCameraState.thetaOffset || DEFAULT_CAMERA_STATE.thetaOffset,\n        },\n        prevTargetPose,\n        !!prevFollowOrientation\n      ),\n      { target: [0, 0, 0] }\n    );\n  }\n\n  return newCameraState;\n}\n\n// Draw-data coming out of Worldview is pretty varied in shape. When we have grouped lines, we\n// really just want to send the individual lines across the worker boundary, so we\n//  - smooth out the instance-object stuff,\n//  - deep-parse any bobjects.\nexport const normalizeMouseEventObject = ({ object, instanceIndex }: MouseEventObject): MouseEventObject => {\n  const instanceObject = getInstanceObj(object, instanceIndex) ?? object;\n  const originalMessage = instanceObject.interactionData?.originalMessage ?? instanceObject;\n  const topic = instanceObject.interactionData?.topic ?? object.interactionData?.topic ?? \"\";\n  const parsedMessage = isBobject(originalMessage) ? deepParse(originalMessage) : originalMessage;\n\n  // Structured information we might use outside of the arbitrary original message display.\n  // These fields are used to display the selection disambiguation picker.\n  // Sometimes these come from bobjects, sometimes from draw-data.\n  const interestingObjectFields = {};\n  for (const field of [\"id\", \"ns\"]) {\n    const value = getField(instanceObject, field);\n    if (value != null) {\n      interestingObjectFields[field] = value;\n    }\n  }\n  const interactionData = { topic, originalMessage: parsedMessage };\n\n  // The selection dialog for point-clouds shows additional information:\n  //  - Values for the clicked point (and its color), and\n  //  - Decoded values for all points.\n  //  Because the `originalMessage` might not structurally be a PointCloud2, it's most robust to\n  //  do that from the draw data here, which _is_ of a predictable structure, but is not sent to\n  //   the object details dialog.\n  if (instanceObject.type === 102) {\n    interestingObjectFields.clickedPointDetails = {\n      color: getClickedPointColor(object, instanceIndex),\n      decodedData: decodePointCloudData(instanceObject),\n      index: instanceIndex,\n    };\n  }\n\n  return { object: { ...interestingObjectFields, interactionData } };\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type Color } from \"regl-worldview\";\n\nimport type { PointCloud2 } from \"webviz-core/src/types/Messages\";\n\nexport type ColorMode =\n  | {| mode: \"rgb\" |}\n  | {| mode: \"flat\", flatColor: Color |}\n  | {|\n      mode: \"gradient\",\n      colorField: string,\n      minColor: Color,\n      maxColor: Color,\n      minValue?: number,\n      maxValue?: number,\n    |}\n  | {|\n      mode: \"rainbow\",\n      colorField: string,\n      minValue?: number,\n      maxValue?: number,\n    |};\n\nexport const DEFAULT_FLAT_COLOR = { r: 1, g: 1, b: 1, a: 1 };\nexport const DEFAULT_MIN_COLOR = { r: 0, g: 0, b: 1, a: 1 };\nexport const DEFAULT_MAX_COLOR = { r: 1, g: 0, b: 0, a: 1 };\n\nexport type PointCloudSettings = {|\n  pointSize?: ?number,\n  pointShape?: ?string,\n  decayTime?: ?number,\n  colorMode: ?ColorMode,\n|};\n\nexport const DATATYPE = {\n  uint8: 2,\n  uint16: 4,\n  int16: 3,\n  int32: 5,\n  float32: 7,\n};\n\nexport type PointCloudMarker = PointCloud2 & {\n  settings?: PointCloudSettings,\n\n  // When hitmapColors are provided, we send them\n  // straight to GPU, ignoring computations based on\n  // color modes. As the name implies, this is only happening\n  // when rendering to the Hitmap\n  hitmapColors?: number[],\n};\n\n// Vertex buffer that will be used for attributes in shaders\nexport type VertexBuffer = {|\n  buffer: Float32Array,\n  offset: number, // number of float values from the start of each vertex\n  stride: number, // number of float values in between vertices\n|};\n\nexport type MemoizedMarker = {|\n  marker: PointCloudMarker,\n  settings?: PointCloudSettings,\n  hitmapColors?: number[],\n|};\n\nexport type MemoizedVertexBuffer = {|\n  vertexBuffer: VertexBuffer,\n  buffer: any,\n  offset: number,\n  stride: number,\n  divisor: number,\n|};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckIcon from \"@mdi/svg/svg/check.svg\";\nimport DatabaseIcon from \"@mdi/svg/svg/database.svg\";\nimport { uniq } from \"lodash\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport styles from \"webviz-core/src/components/PanelToolbar/index.module.scss\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport type TopicGroup = {\n  suffix: string,\n  datatype: string,\n};\n\ntype Props = {\n  onChange: (topic: string) => void,\n  topicToRender: string,\n  topics: $ReadOnlyArray<Topic>,\n  // Use either one of these (or neither, to expose all topics):\n  // singleTopicDatatype only supports a single datatype (search and select based on datatype)\n  // topicsGroups selects the \"parent\" path of a group of topics (if either of the group topics suffixes+datatypes match)\n  singleTopicDatatype?: string,\n  topicsGroups?: TopicGroup[],\n  defaultTopicToRender: ?string,\n};\n\nconst SDiv = styled.div`\n  display: flex;\n  cursor: pointer;\n  padding: 8px;\n  height: 32px;\n`;\n\nconst SSpan = styled.span`\n  flex: flex-start;\n  min-width: 150px;\n  height: 17px;\n`;\n\nconst SIconSpan = styled.span`\n  flex: flex-end;\n  svg {\n    fill: white;\n    width: 15px;\n    height: 15px;\n  }\n`;\n\nexport default function TopicToRenderMenu({\n  onChange,\n  topicToRender,\n  topics,\n  topicsGroups,\n  singleTopicDatatype,\n  defaultTopicToRender,\n}: Props) {\n  if (topicsGroups && singleTopicDatatype) {\n    throw new Error(\"Cannot set both topicsGroups and singleTopicDatatype\");\n  }\n  const availableTopics: string[] = [];\n  for (const topic of topics) {\n    if (topicsGroups) {\n      for (const topicGroup of topicsGroups) {\n        if (topic.name.endsWith(topicGroup.suffix) && topic.datatype === topicGroup.datatype) {\n          const parentTopic = topic.name.slice(0, topic.name.length - topicGroup.suffix.length);\n          availableTopics.push(parentTopic);\n        }\n      }\n    } else if (singleTopicDatatype == null || topic.datatype === singleTopicDatatype) {\n      availableTopics.push(topic.name);\n    }\n  }\n  // Keeps only the first occurrence of each topic.\n  // $FlowFixMe: Flow only understands .filter(Boolean), but we want to keep empty strings.\n  const renderTopics: string[] = uniq(\n    [defaultTopicToRender, ...availableTopics, topicToRender].filter((t) => t != null)\n  );\n  const parentTopicSpan = (topic: string, available: boolean) => {\n    const topicDiv = topic ? topic : <span style={{ fontStyle: \"italic\" }}>Default</span>;\n    return (\n      <span>\n        {topicDiv}\n        {available ? \"\" : \" (not available)\"}\n      </span>\n    );\n  };\n\n  const tooltip = topicsGroups\n    ? `Parent topics selected by topic suffixes:\\n ${topicsGroups.map((group) => group.suffix).join(\"\\n\")}`\n    : singleTopicDatatype != null\n    ? `Topics selected by datatype: ${singleTopicDatatype}`\n    : \"Select topic:\";\n  return (\n    <Dropdown\n      toggleComponent={\n        <Icon\n          fade\n          tooltip={tooltip}\n          tooltipProps={{ placement: \"top\" }}\n          style={{ color: topicToRender === defaultTopicToRender ? colors.LIGHT1 : colors.ORANGE }}\n          dataTest={\"topic-set\"}>\n          <DatabaseIcon className={styles.icon} />\n        </Icon>\n      }>\n      {renderTopics.map((topic) => (\n        <SDiv\n          style={topicToRender === topic ? { backgroundColor: \"rgba(59, 46, 118, 0.6)\" } : {}}\n          key={topic}\n          onClick={() => {\n            onChange(topic);\n          }}>\n          <SSpan>{parentTopicSpan(topic, availableTopics.includes(topic))}</SSpan>\n          {topicToRender === topic ? (\n            <SIconSpan>\n              <CheckIcon />\n            </SIconSpan>\n          ) : null}\n        </SDiv>\n      ))}\n    </Dropdown>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport function isTypicalFilterName(name: string) {\n  return /^id$|_id$|I[dD]$/.test(name);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport cx from \"classnames\";\nimport { maxBy } from \"lodash\";\nimport React, { PureComponent } from \"react\";\nimport ReactAutocomplete from \"react-autocomplete\";\nimport { createPortal } from \"react-dom\";\nimport textWidth from \"text-width\";\n\nimport styles from \"./Autocomplete.module.scss\";\nimport fuzzyFilter from \"webviz-core/src/util/fuzzyFilter\";\n\nconst fontFamily = \"'Inter UI', -apple-system, BlinkMacSystemFont, sans-serif\";\nconst fontSize = 12;\nfunction measureText(text: string): number {\n  return textWidth(text, { family: fontFamily, size: fontSize }) + 3;\n}\n\nconst rowHeight = parseInt(styles.rowHeight);\n\n// <Autocomplete> is a Webviz-specific autocomplete with support for things like multiple\n// autocompletes that seamlessly transition into each other, e.g. when building more complex\n// strings like in the Plot panel.\n//\n// The multiple autocompletes doesn't work super well with react-autocomplete, so we have to\n// reimplement some of its behaviour to make things work properly, such as the `_ignoreBlur`\n// stuff. Mostly, though, we can lean on react-autocomplete to do the heavy lifting.\n//\n// For future reference, the reason `<ReactAutocomplete>` (and we) has to do `_ignoreBlur`, is that\n// when you select an item from the autocomplete menu by clicking, it first triggers a `blur` event\n// on the `<input>`, before triggering a `click` event. If we wouldn't ignore that `blur` event,\n// we'd hide the menu before the `click` event even has a chance of getting fired. So the `blur`\n// event has to be ignored, and the subsequent `focus` event also has to be ignored since it's kind\n// of a \"false\" focus event. (In our case we just don't bother with ignoring the `focus` event since\n// it doesn't cause any problems.)\ntype AutocompleteProps = {|\n  items: mixed[],\n  getItemValue: (mixed) => string,\n  getItemText: (mixed) => string,\n  filterText?: string,\n  value?: string,\n  selectedItem: ?mixed,\n  onChange: (SyntheticInputEvent<HTMLInputElement>, string) => void,\n  onSelect: (string, mixed, Autocomplete) => void, // eslint-disable-line no-use-before-define\n  onBlur?: () => void,\n  hasError: ?boolean,\n  autocompleteKey?: ?string,\n  placeholder?: ?string,\n  autoSize?: boolean,\n  sortWhenFiltering: boolean,\n  clearOnFocus: boolean, // only for uncontrolled use (when onChange is not set)\n  minWidth: number,\n  menuStyle?: any,\n  inputStyle?: any,\n  disableAutoSelect?: boolean,\n|};\n\ntype AutocompleteState = {|\n  focused: boolean,\n  showAllItems: boolean,\n  value?: string,\n|};\n\nfunction defaultGetText(name: string) {\n  return function(item: mixed) {\n    if (typeof item === \"string\") {\n      return item;\n    } else if (item && typeof item === \"object\" && typeof item.value === \"string\") {\n      return item.value;\n    }\n    throw new Error(`you need to provide an implementation of ${name}`);\n  };\n}\n\nexport default class Autocomplete extends PureComponent<AutocompleteProps, AutocompleteState> {\n  _autocomplete: { current: null | Autocomplete };\n  _ignoreFocus: boolean = false;\n  _ignoreBlur: boolean = false;\n\n  static defaultProps = {\n    getItemText: defaultGetText(\"getItemText\"),\n    getItemValue: defaultGetText(\"getItemValue\"),\n    sortWhenFiltering: true,\n    clearOnFocus: false,\n    minWidth: 100,\n  };\n\n  constructor(props: AutocompleteProps) {\n    super(props);\n    this._autocomplete = React.createRef<ReactAutocomplete>();\n    this.state = { focused: false, showAllItems: false };\n  }\n\n  // When we lose the scrollbar, we can safely set `showAllItems: false` again, because all items\n  // will be in view anyway. We cannot set it to false earlier, as `<ReactAutocomplete>` may have a\n  // reference to the highlighted element, which can cause an error if we hide it.\n  componentDidUpdate() {\n    if (\n      this._autocomplete.current &&\n      this._autocomplete.current.refs.menu &&\n      this._autocomplete.current.refs.menu.scrollHeight <= this._autocomplete.current.refs.menu.clientHeight &&\n      this.state.showAllItems\n    ) {\n      this.setState({ showAllItems: false });\n    }\n  }\n\n  setSelectionRange(selectionStart: number, selectionEnd: number) {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.setSelectionRange(selectionStart, selectionEnd);\n    }\n    this.setState({ focused: true });\n  }\n\n  focus() {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.focus();\n    }\n  }\n\n  blur() {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.blur();\n    }\n    this._ignoreBlur = false;\n    this.setState({ focused: false });\n    if (this.props.onBlur) {\n      this.props.onBlur();\n    }\n  }\n\n  _onFocus = () => {\n    if (this._ignoreFocus) {\n      return;\n    }\n    const { clearOnFocus } = this.props;\n    if (\n      this._autocomplete.current &&\n      this._autocomplete.current.refs.input &&\n      document.activeElement === this._autocomplete.current.refs.input\n    ) {\n      this.setState({ focused: true });\n      if (clearOnFocus) {\n        this.setState({ value: \"\" });\n      }\n    }\n  };\n\n  // Wait for a mouseup event, and check in the mouseup event if anything was actually selected, or\n  // if it just was a click without a drag. In the latter case, select everything. This is very\n  // similar to how, say, the browser bar in Chrome behaves.\n  _onMouseDown = (_event: SyntheticMouseEvent<HTMLInputElement>) => {\n    if (this.props.disableAutoSelect) {\n      return;\n    }\n    if (this.state.focused) {\n      return;\n    }\n    const onMouseUp = (e: MouseEvent) => {\n      document.removeEventListener(\"mouseup\", onMouseUp, true);\n\n      if (\n        this._autocomplete.current &&\n        this._autocomplete.current.refs.input &&\n        // Make sure that the element is actually still focused.\n        document.activeElement === this._autocomplete.current.refs.input\n      ) {\n        if (\n          this._autocomplete.current.refs.input.selectionStart === this._autocomplete.current.refs.input.selectionEnd\n        ) {\n          this._autocomplete.current.refs.input.select();\n          e.stopPropagation();\n          e.preventDefault();\n        }\n        // Also set `state.focused` for good measure, since we know here that we're focused.\n        this.setState({ focused: true });\n      }\n    };\n    document.addEventListener(\"mouseup\", onMouseUp, true);\n  };\n\n  _onBlur = () => {\n    if (this._ignoreBlur) {\n      return;\n    }\n    if (\n      this._autocomplete.current &&\n      this._autocomplete.current.refs.input &&\n      document.activeElement === this._autocomplete.current.refs.input\n    ) {\n      // Bail if we actually still are focused.\n      return;\n    }\n    this.setState({ focused: false, value: undefined });\n    if (this.props.onBlur) {\n      this.props.onBlur();\n    }\n  };\n\n  _onChange = (event: SyntheticInputEvent<HTMLInputElement>) => {\n    if (this.props.onChange) {\n      this.props.onChange(event, event.target.value);\n    } else {\n      this.setState({ value: event.target.value });\n    }\n  };\n\n  // Make sure the input field gets focused again after selecting, in case we're doing multiple\n  // autocompletes. We pass in `this` to `onSelect` in case the user of this component wants to call\n  // `blur()`.\n  _onSelect = (value: string, item: any) => {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.focus();\n      this.setState({ focused: true, value: undefined }, () => {\n        this.props.onSelect(value, item, this);\n      });\n    }\n  };\n\n  // When scrolling down by even a little bit, just show all items. In most cases people won't\n  // do this and instead will type more text to narrow down their autocomplete.\n  _onScroll = (event: SyntheticMouseEvent<HTMLDivElement>) => {\n    if (event.currentTarget.scrollTop > 0) {\n      // Never set `showAllItems` to false here, as `<ReactAutocomplete>` may have a reference to\n      // the highlighted element. We only set it back to false in `componentDidUpdate`.\n      this.setState({ showAllItems: true });\n    }\n  };\n\n  _onKeyDown = (event: SyntheticKeyboardEvent<HTMLInputElement>) => {\n    if (event.key === \"Escape\" || (event.key === \"Enter\" && this.props.items.length === 0)) {\n      this.blur();\n    }\n  };\n\n  render() {\n    const {\n      autocompleteKey,\n      autoSize,\n      getItemValue,\n      getItemText,\n      items,\n      placeholder,\n      selectedItem,\n      value = this.state.value ?? (selectedItem ? getItemText(selectedItem) : null),\n      filterText = value,\n      sortWhenFiltering,\n      minWidth,\n      menuStyle = {},\n      inputStyle = {},\n    } = this.props;\n    const autocompleteItems = fuzzyFilter(items, filterText, getItemText, sortWhenFiltering);\n\n    const { hasError = autocompleteItems.length === 0 && value?.length } = this.props;\n\n    const open = this.state.focused && autocompleteItems.length > 0;\n    if (!open) {\n      this._ignoreBlur = false;\n    }\n\n    const selectedItemValue = selectedItem != null ? getItemValue(selectedItem) : null;\n    return (\n      <ReactAutocomplete\n        open={open}\n        items={autocompleteItems}\n        getItemValue={getItemValue}\n        renderItem={(item, isHighlighted) => {\n          const itemValue = getItemValue(item);\n          return (\n            <div\n              key={itemValue}\n              data-highlighted={isHighlighted}\n              data-test-auto-item\n              className={cx(styles.autocompleteItem, {\n                [styles.highlighted]: isHighlighted,\n                [styles.selected]: selectedItemValue != null && itemValue === selectedItemValue,\n              })}>\n              {getItemText(item)}\n            </div>\n          );\n        }}\n        onChange={this._onChange}\n        onSelect={this._onSelect}\n        value={value || \"\"}\n        inputProps={{\n          className: cx(styles.input, {\n            [styles.inputError]: hasError,\n            [styles.placeholder]: !value,\n          }),\n          autoCorrect: \"off\",\n          autoCapitalize: \"off\",\n          spellCheck: \"false\",\n          placeholder,\n          style: {\n            ...inputStyle,\n            fontFamily,\n            fontSize,\n            width: autoSize ? Math.max(measureText(value || placeholder || \"\"), minWidth) : \"100%\",\n          },\n          onFocus: this._onFocus,\n          onBlur: this._onBlur,\n          onMouseDown: this._onMouseDown,\n          onKeyDown: this._onKeyDown,\n        }}\n        renderMenu={(menuItems, val, style) => {\n          // Hacky virtualization. Either don't show all menuItems (typical when the user is still\n          // typing in the autcomplete), or do show them all (once the user scrolls). Not the most\n          // sophisticated, but good enough!\n          const maxNumberOfItems = Math.ceil(window.innerHeight / rowHeight + 10);\n          const menuItemsToShow =\n            this.state.showAllItems || menuItems.length <= maxNumberOfItems * 2\n              ? menuItems\n              : menuItems.slice(0, maxNumberOfItems).concat(menuItems.slice(-maxNumberOfItems));\n\n          // The longest string might not be the widest (e.g. \"|||\" vs \"www\"), but this is\n          // quite a bit faster, so we throw in a nice padding and call it good enough! :-)\n          const width = measureText(getItemText(maxBy(autocompleteItems, (item) => getItemText(item).length))) + 50;\n          const maxHeight = `calc(100vh - 10px - ${style.top}px)`;\n\n          return (\n            <div\n              className={styles.root}\n              key={autocompleteKey /* So we scroll to the top when selecting */}\n              style={\n                // If the autocomplete would fall off the screen, pin it to the right.\n                style.left + width <= window.innerWidth\n                  ? { ...menuStyle, ...style, width, maxWidth: \"100%\", maxHeight }\n                  : { ...menuStyle, ...style, width, maxWidth: \"100%\", maxHeight, left: \"auto\", right: 0 }\n              }\n              onScroll={this._onScroll}>\n              {/* Have to wrap onMouseEnter and onMouseLeave in a separate <div>, as react-autocomplete\n               * would override them on the root <div>. */}\n              <div onMouseEnter={() => (this._ignoreBlur = true)} onMouseLeave={() => (this._ignoreBlur = false)}>\n                {menuItemsToShow}\n              </div>\n            </div>\n          );\n        }}\n        renderMenuWrapper={(menu) => document.body && createPortal(menu, document.body)}\n        ref={this._autocomplete}\n        wrapperStyle={{ flex: \"1 1 auto\", overflow: \"hidden\", marginLeft: 6 }}\n      />\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { keyBy } from \"lodash\";\nimport memoize from \"micro-memoize\";\n\nimport {\n  type LinkedGlobalVariables,\n  type LinkedGlobalVariable,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\n\nexport function getTopicWithPath({ topic, markerKeyPath }: { topic: string, markerKeyPath: string[] }): string {\n  return `${topic}.${getPath(markerKeyPath)}`;\n}\n\nexport function getPath(markerKeyPath: string[]): string {\n  return [...markerKeyPath].reverse().join(\".\");\n}\n\nexport function getLinkedGlobalVariableKeyByTopicWithPath(\n  linkedGlobalVariables: LinkedGlobalVariables\n): { [string]: LinkedGlobalVariable } {\n  return keyBy(linkedGlobalVariables, ({ topic, markerKeyPath }) => getTopicWithPath({ topic, markerKeyPath }));\n}\n\nconst memoizedGetLinkedVariablesKeyByTopicWithPath = memoize(getLinkedGlobalVariableKeyByTopicWithPath);\n\nexport function getLinkedGlobalVariable({\n  topic,\n  markerKeyPath,\n  linkedGlobalVariables,\n}: {\n  topic: string,\n  markerKeyPath: string[],\n  linkedGlobalVariables: LinkedGlobalVariables,\n}): ?LinkedGlobalVariable {\n  const linkedGlobalVariablesKeyByTopicWithPath = memoizedGetLinkedVariablesKeyByTopicWithPath(linkedGlobalVariables);\n  const topicWithPath = getTopicWithPath({ topic, markerKeyPath });\n  return linkedGlobalVariablesKeyByTopicWithPath[topicWithPath];\n}\n\nfunction getLinkedGlobalVariablesKeyByName(linkedGlobalVariables: LinkedGlobalVariables) {\n  return linkedGlobalVariables.reduce((memo, { name, topic, markerKeyPath }) => {\n    if (!memo[name]) {\n      memo[name] = [];\n    }\n    memo[name].push({ topic, markerKeyPath, name });\n    return memo;\n  }, {});\n}\n\nexport const memoizedGetLinkedGlobalVariablesKeyByName = memoize(getLinkedGlobalVariablesKeyByName);\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { noop } from \"lodash\";\nimport React from \"react\";\n\nimport type { ColorOverrideBySourceIdxByVariable } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport type { Color } from \"webviz-core/src/types/Messages\";\n\n// Used to check if a Marker's path matches a value\n// For a marker: { foo: { bar: \"baz\" } }\n// markerKeyPath: ['foo', 'bar'] has a value of \"baz\"\nexport type MarkerPathCheck = {|\n  markerKeyPath?: string[],\n  value?: any,\n|};\n\nexport type MarkerMatcher = {|\n  topic: string,\n\n  // When set, any markers passing all the checks will have their color overridden with this color\n  color?: Color,\n\n  // MarkerMatchers \"match\" if ALL checks pass\n  checks?: MarkerPathCheck[],\n|};\n\nexport const ThreeDimensionalVizContext = React.createContext<{\n  setHoveredMarkerMatchers: (markerMatchers: MarkerMatcher[]) => void,\n\n  colorOverrideBySourceIdxByVariable: ColorOverrideBySourceIdxByVariable,\n  setColorOverrideBySourceIdxByVariable: (ColorOverrideBySourceIdxByVariable) => void,\n}>({\n  setHoveredMarkerMatchers: noop,\n  colorOverrideBySourceIdxByVariable: {},\n  setColorOverrideBySourceIdxByVariable: noop,\n});\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { upperFirst } from \"lodash\";\nimport React, { useCallback, type ComponentType } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport { SLabel, SDescription, SInput } from \"./common\";\nimport IconMarkerSettingsEditor from \"./IconMarkerSettingsEditor\";\nimport LaserScanSettingsEditor from \"./LaserScanSettingsEditor\";\nimport MarkerOverrideColorSettingsEditor from \"./MarkerOverrideColorSettingsEditor\";\nimport MarkerSettingsEditor from \"./MarkerSettingsEditor\";\nimport PointCloudSettingsEditor from \"./PointCloudSettingsEditor\";\nimport PoseSettingsEditor from \"./PoseSettingsEditor\";\nimport styles from \"./TopicSettingsEditor.module.scss\";\nimport ErrorBoundary from \"webviz-core/src/components/ErrorBoundary\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { Select, Option } from \"webviz-core/src/components/Select\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport type { StructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport {\n  SENSOR_MSGS$POINT_CLOUD_2,\n  GEOMETRY_MSGS$POSE_STAMPED,\n  SENSOR_MSGS$LASER_SCAN,\n  VISUALIZATION_MSGS$WEBVIZ_MARKER,\n  WEBVIZ_ICON_MSGS$WEBVIZ_3D_ICON_ARRAY,\n  VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY,\n  VISUALIZATION_MSGS$MARKER,\n  VISUALIZATION_MSGS$MARKER_ARRAY,\n  NAV_MSGS$PATH,\n} from \"webviz-core/src/util/globalConstants\";\n\nexport const LINED_CONVEX_HULL_RENDERING_SETTING = \"LinedConvexHull\";\n\nexport function CommonPointSettings({\n  defaultPointSize,\n  defaultPointShape = \"circle\",\n  settings,\n  onFieldChange,\n}: {\n  defaultPointSize: number,\n  defaultPointShape?: string,\n  settings: {\n    pointSize?: ?number,\n    pointShape?: ?string,\n  },\n  onFieldChange: (name: string, value: any) => void,\n}) {\n  const pointSizeVal = settings.pointSize === undefined ? \"\" : settings.pointSize;\n\n  const pointShape = settings.pointShape;\n  const pointShapeVal = pointShape ? pointShape : defaultPointShape;\n  const pointShapeOpts = [\"circle\", \"square\"].map((field) => (\n    <Option key={field} value={field}>\n      {upperFirst(field)}\n    </Option>\n  ));\n\n  return (\n    <Flex col>\n      <SLabel>Point size</SLabel>\n      <SInput\n        data-test=\"point-size-input\"\n        type=\"number\"\n        placeholder={defaultPointSize.toString()}\n        value={pointSizeVal}\n        min={1}\n        max={50}\n        step={1}\n        onChange={(e) => {\n          const isInputValid = !isNaN(parseFloat(e.target.value));\n          onFieldChange(\"pointSize\", isInputValid ? parseFloat(e.target.value) : undefined);\n        }}\n      />\n\n      <SLabel>Point shape</SLabel>\n      <Select\n        text={upperFirst(pointShapeVal)}\n        value={pointShapeVal}\n        onChange={(value) => onFieldChange(\"pointShape\", value)}>\n        {pointShapeOpts}\n      </Select>\n    </Flex>\n  );\n}\n\nexport function CommonDecaySettings({\n  settings,\n  onFieldChange,\n}: {\n  settings: { decayTime?: ?number },\n  onFieldChange: (name: string, value: any) => any,\n}) {\n  const decayTime = settings.decayTime;\n  const decayTimeValue = decayTime === undefined ? \"\" : decayTime;\n\n  return (\n    <Flex col>\n      <SLabel>Decay time (seconds)</SLabel>\n      <SDescription>When set to 0, only the latest received data will be displayed.</SDescription>\n      <SInput\n        type=\"number\"\n        placeholder=\"0\"\n        value={decayTimeValue}\n        min={0}\n        step={0.1}\n        onChange={(e) => {\n          const isInputValid = !isNaN(parseFloat(e.target.value));\n          onFieldChange(\"decayTime\", isInputValid ? parseFloat(e.target.value) : undefined);\n        }}\n      />\n    </Flex>\n  );\n}\n\nexport type TopicSettingsEditorProps<Msg, Settings: {}> = {|\n  message: ?Msg,\n  settings: Settings,\n  onFieldChange: (name: string, value: any) => void,\n  onSettingsChange: ({} | (({}) => {})) => void,\n|};\n\nexport function topicSettingsEditorForDatatype(\n  datatype: string,\n  structuralDatatypes: StructuralDatatypes\n): ?ComponentType<TopicSettingsEditorProps<any, any>> {\n  const editors = {\n    [SENSOR_MSGS$POINT_CLOUD_2]: PointCloudSettingsEditor,\n    [GEOMETRY_MSGS$POSE_STAMPED]: PoseSettingsEditor,\n    [SENSOR_MSGS$LASER_SCAN]: LaserScanSettingsEditor,\n    [VISUALIZATION_MSGS$WEBVIZ_MARKER]: MarkerSettingsEditor,\n    [VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY]: MarkerSettingsEditor,\n    [VISUALIZATION_MSGS$MARKER]: MarkerSettingsEditor,\n    [VISUALIZATION_MSGS$MARKER_ARRAY]: MarkerSettingsEditor,\n    [WEBVIZ_ICON_MSGS$WEBVIZ_3D_ICON_ARRAY]: IconMarkerSettingsEditor,\n    [NAV_MSGS$PATH]: MarkerOverrideColorSettingsEditor,\n    ...getGlobalHooks().perPanelHooks().ThreeDimensionalViz.topicSettingsEditors,\n  };\n  return editors[datatype] ?? editors[structuralDatatypes[datatype]];\n}\n\nexport function canEditDatatype(datatype: string, structuralDatatypes: StructuralDatatypes): boolean {\n  return topicSettingsEditorForDatatype(datatype, structuralDatatypes) != null;\n}\n\nexport function canEditNamespaceOverrideColorDatatype(\n  datatype: string,\n  structuralDatatypes: StructuralDatatypes\n): boolean {\n  const editor = topicSettingsEditorForDatatype(datatype, structuralDatatypes);\n  // $FlowFixMe added static field `canEditNamespaceOverrideColor` to the React component\n  return !!(editor && editor.canEditNamespaceOverrideColor);\n}\n\ntype Props = {|\n  topic: Topic,\n  message: any,\n  settings: ?{},\n  structuralDatatypes: StructuralDatatypes,\n  onSettingsChange: ({}) => void,\n|};\n\nconst TopicSettingsEditor = React.memo<Props>(function TopicSettingsEditor({\n  topic,\n  message,\n  settings,\n  structuralDatatypes,\n  onSettingsChange,\n}: Props) {\n  const onFieldChange = useCallback((fieldName: string, value: any) => {\n    onSettingsChange((newSettings) => ({ ...newSettings, [fieldName]: value }));\n  }, [onSettingsChange]);\n\n  const Editor = topicSettingsEditorForDatatype(topic.datatype, structuralDatatypes);\n  if (!Editor) {\n    throw new Error(`No topic settings editor available for ${topic.datatype}`);\n  }\n\n  return (\n    <div className={styles.container}>\n      <h3 className={styles.topicName}>{topic.name}</h3>\n      <h4 className={styles.datatype}>\n        <tt>{topic.datatype}</tt>\n      </h4>\n      <ErrorBoundary>\n        <Editor\n          message={message}\n          settings={settings || {}}\n          onFieldChange={onFieldChange}\n          onSettingsChange={onSettingsChange}\n        />\n      </ErrorBoundary>\n      <button onClick={() => onSettingsChange({})}>Reset to defaults</button>\n    </div>\n  );\n});\n\nexport default hot(TopicSettingsEditor);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { difference, keyBy, uniq, mapValues, xor, isEqual, flatten, omit } from \"lodash\";\nimport { useMemo, useCallback, useRef, createContext } from \"react\";\nimport { useDebounce } from \"use-debounce\";\n\nimport generateNodeKey from \"./generateNodeKey\";\nimport type {\n  TreeNode,\n  TopicTreeConfig,\n  UseTreeInput,\n  NamespacesByTopic,\n  UseTreeOutput,\n  DerivedCustomSettingsByKey,\n} from \"./types\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { TOPIC_DISPLAY_MODES } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicViewModeSelector\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\nimport { useShallowMemo } from \"webviz-core/src/util/hooks\";\n\nconst DEFAULT_TOPICS_COUNT_BY_KEY = {};\n\n// Recursive function to generate the tree nodes from config data.\nexport function generateTreeNode(\n  { children = [], topicName, name, description }: TopicTreeConfig,\n  {\n    availableTopicsNamesSet,\n    parentKey,\n    datatypesByTopic,\n    hasFeatureColumn,\n    staticallyAvailableNamespacesByTopic,\n  }: {|\n    availableTopicsNamesSet: Set<string>,\n    datatypesByTopic: { [topicName: string]: string },\n    parentKey: ?string,\n    hasFeatureColumn: boolean,\n    staticallyAvailableNamespacesByTopic: NamespacesByTopic,\n  |}\n): TreeNode {\n  const key = generateNodeKey({ name, topicName });\n  const featureKey = generateNodeKey({ name, topicName, isFeatureColumn: true });\n  const providerAvailable = availableTopicsNamesSet.size > 0;\n\n  if (topicName) {\n    const datatype = datatypesByTopic[topicName] || datatypesByTopic[`${$WEBVIZ_SOURCE_2}${topicName}`];\n    // Statically available namespace topics are always available to turn on or off.\n    const isAlwaysAvailable = !!staticallyAvailableNamespacesByTopic[topicName];\n    let availableByColumn;\n    if (isAlwaysAvailable) {\n      availableByColumn = hasFeatureColumn ? [true, true] : [true];\n    } else {\n      availableByColumn = hasFeatureColumn\n        ? [availableTopicsNamesSet.has(topicName), availableTopicsNamesSet.has(`${$WEBVIZ_SOURCE_2}${topicName}`)]\n        : [availableTopicsNamesSet.has(topicName)];\n    }\n    return {\n      type: \"topic\",\n      key,\n      featureKey,\n      topicName,\n      availableByColumn,\n      providerAvailable,\n      ...(parentKey ? { parentKey } : undefined),\n      ...(name ? { name } : undefined),\n      ...(datatype ? { datatype } : undefined),\n      ...(description ? { description } : undefined),\n    };\n  }\n  if (name) {\n    const childrenNodes = children.map((config) =>\n      generateTreeNode(config, {\n        availableTopicsNamesSet,\n        // First level children's parent key is undefined, not `root`.\n        parentKey: name === \"root\" ? undefined : key,\n        datatypesByTopic,\n        hasFeatureColumn,\n        staticallyAvailableNamespacesByTopic,\n      })\n    );\n    return {\n      key,\n      featureKey,\n      name,\n      type: \"group\",\n      // A group node is available when some children nodes are available.\n      availableByColumn: hasFeatureColumn\n        ? [\n            childrenNodes.some((node) => node.availableByColumn[0]),\n            childrenNodes.some((node) => node.availableByColumn[1]),\n          ]\n        : [childrenNodes.some((node) => node.availableByColumn[0])],\n      providerAvailable,\n      children: childrenNodes,\n      ...(parentKey ? { parentKey } : undefined),\n    };\n  }\n  throw new Error(`Incorrect topic tree config. Either topicName or name must be present.`);\n}\n\nexport function* flattenNode<T: TreeNode | TopicTreeConfig>(node: T): Generator<T, void, void> {\n  yield node;\n  if (node.children) {\n    for (const subNode of node.children) {\n      yield* flattenNode(subNode);\n    }\n  }\n}\n\nexport function getBaseKey(key: string): string {\n  return key.replace($WEBVIZ_SOURCE_2, \"\").replace(\"name_2:\", \"name:\");\n}\n\nconst parseNamespaceKey = (key: string): { topicName: string, namespace: string } => {\n  const [ns, topicName, ...namespaceParts] = key.split(\":\");\n  if (ns !== \"ns\") {\n    throw new Error(`${JSON.stringify(key)} is not a namespace key`);\n  }\n  return { topicName, namespace: namespaceParts.join(\":\") };\n};\n\nexport default function useTopicTree({\n  availableNamespacesByTopic,\n  checkedKeys,\n  defaultTopicSettings,\n  expandedKeys,\n  filterText,\n  modifiedNamespaceTopics,\n  providerTopics,\n  saveConfig,\n  sceneErrorsByTopicKey,\n  topicDisplayMode,\n  settingsByKey,\n  topicTreeConfig,\n  uncategorizedGroupName,\n  staticallyAvailableNamespacesByTopic,\n}: UseTreeInput): UseTreeOutput {\n  const topicTreeTopics = useMemo(\n    () =>\n      Array.from(flattenNode(topicTreeConfig))\n        .map((node) => (node.topicName && !node.namespace ? node.topicName : undefined))\n        .filter(Boolean),\n    [topicTreeConfig]\n  );\n\n  const hasFeatureColumn = useMemo(() => providerTopics.some(({ name }) => name.startsWith($WEBVIZ_SOURCE_2)), [\n    providerTopics,\n  ]);\n\n  const rootTreeNode = useMemo((): TreeNode => {\n    const allTopicNames = providerTopics.map((topic) => topic.name);\n    const nonPrefixedTopicNames = uniq(allTopicNames.map((name) => name.replace($WEBVIZ_SOURCE_2, \"\")));\n    const availableTopicsNamesSet = new Set(allTopicNames);\n\n    // Precompute uncategorized topics to add to the transformedTreeConfig before generating the TreeNodes.\n    const uncategorizedTopicNames = difference(nonPrefixedTopicNames, topicTreeTopics);\n    const datatypesByTopic = mapValues(keyBy(providerTopics, \"name\"), (item) => item.datatype);\n\n    const newChildren = [...(topicTreeConfig.children || [])];\n    if (uncategorizedTopicNames.length) {\n      // Add uncategorized group node to root config.\n      newChildren.push({\n        name: uncategorizedGroupName,\n        children: uncategorizedTopicNames.map((topicName) => ({ topicName })),\n      });\n    }\n    // Generate the rootTreeNode. Don't mutate the original treeConfig, just make a copy with newChildren.\n    return generateTreeNode(\n      { ...topicTreeConfig, children: newChildren },\n      {\n        parentKey: undefined,\n        datatypesByTopic,\n        availableTopicsNamesSet,\n        hasFeatureColumn,\n        staticallyAvailableNamespacesByTopic,\n      }\n    );\n  }, [\n    hasFeatureColumn,\n    providerTopics,\n    staticallyAvailableNamespacesByTopic,\n    topicTreeConfig,\n    topicTreeTopics,\n    uncategorizedGroupName,\n  ]);\n\n  const nodesByKey: { [key: string]: TreeNode } = useMemo(() => {\n    const flattenNodes = Array.from(flattenNode(rootTreeNode));\n    return keyBy(flattenNodes, \"key\");\n  }, [rootTreeNode]);\n\n  const selections = useMemo(() => {\n    const checkedKeysSet = new Set(checkedKeys);\n    // Memoize node selections for extracting topic/namespace selections and checking node's visibility state.\n    const isSelectedMemo: { [string]: boolean } = {};\n\n    // Check if a node is selected and fill in the isSelectedMemo cache for future access.\n    function isSelected(baseKey: ?string, isFeatureColumn: boolean): boolean {\n      // Only topic node or top level group node may not have parentKey, and if we reached this level,\n      // the descendants nodes should already been selected. Specifically, if a node key is included in the checkedKeys\n      // and it doesn't have any parent node, it's considered to be selected.\n      if (!baseKey) {\n        return true;\n      }\n\n      const node = nodesByKey[baseKey];\n      const featureKey = node?.featureKey || baseKey;\n      if (!isFeatureColumn && isSelectedMemo[baseKey] === undefined) {\n        isSelectedMemo[baseKey] =\n          checkedKeysSet.has(baseKey) &&\n          (node ? isSelected(node.parentKey, isFeatureColumn) : checkedKeysSet.has(`name:${uncategorizedGroupName}`));\n      } else if (isFeatureColumn && isSelectedMemo[featureKey] === undefined) {\n        isSelectedMemo[featureKey] =\n          checkedKeysSet.has(featureKey) &&\n          (node ? isSelected(node.parentKey, isFeatureColumn) : checkedKeysSet.has(`name_2:${uncategorizedGroupName}`));\n      }\n      return isSelectedMemo[isFeatureColumn ? featureKey : baseKey];\n    }\n\n    const selectedTopicNamesSet = new Set(\n      filterMap(checkedKeys, (key) => {\n        if (!key.startsWith(\"t:\") || !isSelected(getBaseKey(key), key.includes($WEBVIZ_SOURCE_2))) {\n          return;\n        }\n        return key.substr(\"t:\".length);\n      })\n    );\n\n    // Add namespace selections if a topic has any namespaces modified. Any topics that don't have\n    // the namespaces set in selectedNamespacesByTopic will have the namespaces turned on by default.\n    const selectedNamespacesByTopic = (modifiedNamespaceTopics || []).reduce(\n      (memo, topicName) => ({ ...memo, [topicName]: [] }),\n      {}\n    );\n\n    // Go through the checked namespace keys, split the key to topicName + namespace, and\n    // collect the namespaces if the topic is selected.\n    checkedKeys.forEach((key) => {\n      if (!key.startsWith(\"ns:\")) {\n        return;\n      }\n      const { topicName, namespace } = parseNamespaceKey(key);\n      if (!topicName || !namespace) {\n        throw new Error(`Incorrect checkedNode in panelConfig: ${key}`);\n      }\n      if (selectedTopicNamesSet.has(topicName)) {\n        if (!selectedNamespacesByTopic[topicName]) {\n          selectedNamespacesByTopic[topicName] = [];\n        }\n        selectedNamespacesByTopic[topicName].push(namespace);\n      }\n    });\n\n    const selectedTopicNames = Array.from(selectedTopicNamesSet);\n\n    // If any selectedNamespaces is empty, fill in all available namespaces as default if\n    // the topic for the namespace is not modified.\n    difference(selectedTopicNames, modifiedNamespaceTopics).forEach((topicName) => {\n      if (availableNamespacesByTopic[topicName] && !selectedNamespacesByTopic[topicName]) {\n        selectedNamespacesByTopic[topicName] = availableNamespacesByTopic[topicName];\n      }\n    });\n\n    // Returns whether a node/namespace is rendered in the 3d scene. Keep it inside useMemo since it needs to access the same isSelectedMemo.\n    // A node is visible if it's available, itself and all ancestor nodes are selected.\n    function getIsTreeNodeVisibleInScene(node: ?TreeNode, columnIndex: number, namespace?: string): boolean {\n      if (!node) {\n        return false;\n      }\n      const baseKey = getBaseKey(node.key);\n      const isFeatureColumn = columnIndex === 1;\n      if (namespace && node.type === \"topic\") {\n        const prefixedTopicName =\n          node.type === \"topic\"\n            ? isFeatureColumn\n              ? `${$WEBVIZ_SOURCE_2}${node.topicName}`\n              : node.topicName\n            : undefined;\n        if (!prefixedTopicName) {\n          return false;\n        }\n        if (!(selectedNamespacesByTopic[prefixedTopicName] || []).includes(namespace)) {\n          return false;\n        }\n        // A namespace node is visible if the parent topic node is visible.\n        return getIsTreeNodeVisibleInScene(node, columnIndex);\n      }\n      return !!node.availableByColumn[columnIndex] && isSelected(baseKey, isFeatureColumn);\n    }\n    return {\n      selectedTopicNames,\n      selectedNamespacesByTopic,\n      getIsTreeNodeVisibleInScene,\n    };\n  }, [availableNamespacesByTopic, checkedKeys, modifiedNamespaceTopics, nodesByKey, uncategorizedGroupName]);\n\n  const { selectedTopicNames, selectedNamespacesByTopic, getIsTreeNodeVisibleInScene } = selections;\n\n  const visibleTopicsCountByKey = useMemo(() => {\n    // No need to update if topics are unavailable.\n    if (!providerTopics.length) {\n      return DEFAULT_TOPICS_COUNT_BY_KEY;\n    }\n    const ret = {};\n\n    selectedTopicNames.forEach((topicName) => {\n      const isFeatureColumn = topicName.startsWith($WEBVIZ_SOURCE_2);\n      const baseTopicName = isFeatureColumn ? topicName.substr($WEBVIZ_SOURCE_2.length) : topicName;\n      const topicKey = generateNodeKey({ topicName: baseTopicName });\n      const node = nodesByKey[topicKey];\n      const isTopicNodeVisible = getIsTreeNodeVisibleInScene(node, isFeatureColumn ? 1 : 0);\n      if (!isTopicNodeVisible) {\n        return;\n      }\n      // The topic node is visible, now traverse up the tree and update all parent's visibleTopicsCount.\n      const parentKey = nodesByKey[topicKey]?.parentKey;\n      let parentNode = parentKey ? nodesByKey[parentKey] : undefined;\n      while (parentNode) {\n        ret[parentNode.key] = (ret[parentNode.key] || 0) + 1;\n        parentNode = parentNode.parentKey ? nodesByKey[parentNode.parentKey] : undefined;\n      }\n    });\n    return ret;\n  }, [getIsTreeNodeVisibleInScene, nodesByKey, providerTopics.length, selectedTopicNames]);\n\n  // Memoize topic names to prevent subscription update when expanding/collapsing nodes.\n  const memoizedSelectedTopicNames = useShallowMemo(selectedTopicNames);\n\n  const derivedCustomSettingsByKey = useMemo((): DerivedCustomSettingsByKey => {\n    const result = {};\n    for (const [topicKeyOrNamespaceKey, settings] of Object.entries(settingsByKey)) {\n      const isFeatureTopicOrNamespace = topicKeyOrNamespaceKey.includes($WEBVIZ_SOURCE_2);\n      const columnIndex = isFeatureTopicOrNamespace ? 1 : 0;\n      let key;\n      if (topicKeyOrNamespaceKey.startsWith(\"ns:\")) {\n        // Settings for namespace. Currently only handle overrideColor and there are no defaultTopicSettings for namespaces.\n        key = topicKeyOrNamespaceKey;\n        if (key.startsWith(`ns:${$WEBVIZ_SOURCE_2}`)) {\n          // Remove the feature prefix since we are going to store overrideColorByColumn under the base prefix.\n          key = key.replace(`ns:${$WEBVIZ_SOURCE_2}`, \"ns:\");\n        }\n        if (!result[key]) {\n          result[key] = {};\n        }\n      } else if (topicKeyOrNamespaceKey.startsWith(\"t:/\")) {\n        // Settings for topic.\n        const topicName = topicKeyOrNamespaceKey.substr(\"t:\".length);\n        const baseTopicName = isFeatureTopicOrNamespace ? topicName.substr($WEBVIZ_SOURCE_2.length) : topicName;\n        key = generateNodeKey({ topicName: baseTopicName });\n        // If any topic has default settings, compare settings with default settings to determine if settings has changed.\n        const isDefaultSettings = defaultTopicSettings[topicName]\n          ? isEqual(settings, defaultTopicSettings[topicName])\n          : false;\n\n        result[key] = !result[key]\n          ? { isDefaultSettings }\n          : // Both base and feature have to be default settings for `isDefaultSettings` to be true.\n            { ...result[key], isDefaultSettings: isDefaultSettings && result[key].isDefaultSettings };\n      }\n      if (!key) {\n        console.error(`Key ${topicKeyOrNamespaceKey} in settingsByKey is not a valid key.`);\n        continue;\n      }\n\n      // $FlowFixMe some settings have overideColor field\n      if (settings.overrideColor) {\n        if (!result[key].overrideColorByColumn) {\n          result[key].overrideColorByColumn = [undefined, undefined];\n        }\n        result[key].overrideColorByColumn[columnIndex] = settings.overrideColor;\n      }\n    }\n    return result;\n  }, [defaultTopicSettings, settingsByKey]);\n\n  const onNamespaceOverrideColorChange = useCallback((newColor: ?string, prefixedNamespaceKey: string) => {\n    const newSettingsByKey = newColor\n      ? { ...settingsByKey, [prefixedNamespaceKey]: { overrideColor: newColor } }\n      : omit(settingsByKey, prefixedNamespaceKey);\n    saveConfig({ settingsByKey: newSettingsByKey });\n  }, [saveConfig, settingsByKey]);\n\n  const checkedNamespacesByTopicName = useMemo(() => {\n    const checkedNamespaces = filterMap(checkedKeys, (item) => {\n      if (item.startsWith(\"ns:\")) {\n        return parseNamespaceKey(item);\n      }\n    });\n    return keyBy(checkedNamespaces, \"topicName\");\n  }, [checkedKeys]);\n\n  // A namespace is checked by default if none of the namespaces are in the checkedKeys and the selection is not modified.\n  const getIsNamespaceCheckedByDefault = useCallback(\n    (topicName: string, columnIndex) =>\n      !modifiedNamespaceTopics.includes(topicName) &&\n      !checkedNamespacesByTopicName[columnIndex === 1 ? `${$WEBVIZ_SOURCE_2}${topicName}` : topicName],\n    [checkedNamespacesByTopicName, modifiedNamespaceTopics]\n  );\n\n  const toggleNamespaceChecked = useCallback(({\n    topicName,\n    namespace,\n    columnIndex,\n  }: {|\n    topicName: string,\n    namespace: string,\n    columnIndex: number,\n  |}) => {\n    const isFeatureColumn = columnIndex === 1;\n    const prefixedNamespaceKey = generateNodeKey({ topicName, namespace, isFeatureColumn });\n\n    const prefixedTopicName = isFeatureColumn ? `${$WEBVIZ_SOURCE_2}${topicName}` : topicName;\n    const isNamespaceCheckedByDefault = getIsNamespaceCheckedByDefault(topicName, columnIndex);\n\n    let newCheckedKeys;\n    if (isNamespaceCheckedByDefault) {\n      // Add all other namespaces under the topic to the checked keys.\n      const allNsKeys = (availableNamespacesByTopic[prefixedTopicName] || []).map((ns) =>\n        generateNodeKey({ topicName, namespace: ns, isFeatureColumn })\n      );\n      const otherNamespaceKeys = difference(allNsKeys, [prefixedNamespaceKey]);\n      newCheckedKeys = [...checkedKeys, ...otherNamespaceKeys];\n    } else {\n      newCheckedKeys = xor(checkedKeys, [prefixedNamespaceKey]);\n    }\n\n    saveConfig({\n      checkedKeys: newCheckedKeys,\n      modifiedNamespaceTopics: uniq([...modifiedNamespaceTopics, prefixedTopicName]),\n    });\n  }, [availableNamespacesByTopic, checkedKeys, getIsNamespaceCheckedByDefault, modifiedNamespaceTopics, saveConfig]);\n\n  const toggleNodeChecked = useCallback((nodeKey: string, columnIndex: number) => {\n    const key = columnIndex === 1 ? nodesByKey[nodeKey].featureKey : nodeKey;\n    saveConfig({ checkedKeys: xor(checkedKeys, [key]) });\n  }, [checkedKeys, nodesByKey, saveConfig]);\n\n  const toggleCheckAllDescendants = useCallback((nodeKey: string, columnIndex: number) => {\n    const node = nodesByKey[nodeKey];\n    const isFeatureColumn = columnIndex === 1;\n    const keyWithPrefix = isFeatureColumn ? node.featureKey : nodeKey;\n    const isNowChecked = !checkedKeys.includes(keyWithPrefix);\n    const nodeAndChildren = Array.from(flattenNode(node));\n    const nodeAndChildrenKeys = nodeAndChildren.map((item) => (isFeatureColumn ? item.featureKey : item.key));\n    const topicNames = nodeAndChildren.map((item) => (item.type === \"topic\" ? item.topicName : null)).filter(Boolean);\n    const namespaceChildrenKeys = flatten(\n      topicNames.map((topicName) =>\n        (availableNamespacesByTopic[isFeatureColumn ? `${$WEBVIZ_SOURCE_2}${topicName}` : topicName] || []).map(\n          (namespace) => generateNodeKey({ topicName, namespace, isFeatureColumn })\n        )\n      )\n    );\n\n    let newModififiedNamespaceTopics = [...modifiedNamespaceTopics];\n    topicNames.forEach((topicName) => {\n      const prefixedTopicName = isFeatureColumn ? `${$WEBVIZ_SOURCE_2}${topicName}` : topicName;\n      if (availableNamespacesByTopic[prefixedTopicName]) {\n        newModififiedNamespaceTopics.push(prefixedTopicName);\n      }\n    });\n    newModififiedNamespaceTopics = isEqual(newModififiedNamespaceTopics, modifiedNamespaceTopics)\n      ? modifiedNamespaceTopics\n      : uniq(newModififiedNamespaceTopics);\n\n    const nodeKeysToToggle = [...nodeAndChildrenKeys, ...namespaceChildrenKeys];\n    // Toggle all children nodes' checked state to be the same as the new checked state for the node.\n    saveConfig({\n      modifiedNamespaceTopics: newModififiedNamespaceTopics,\n      checkedKeys: isNowChecked\n        ? uniq([...checkedKeys, ...nodeKeysToToggle])\n        : difference(checkedKeys, nodeKeysToToggle),\n    });\n  }, [availableNamespacesByTopic, checkedKeys, modifiedNamespaceTopics, nodesByKey, saveConfig]);\n\n  const toggleCheckAllAncestors = useCallback((\n    nodeKey: string,\n    columnIndex: number,\n    namespaceParentTopicName?: string\n  ) => {\n    const isFeatureColumn = columnIndex === 1;\n    const node = nodesByKey[nodeKey];\n    let keyWithPrefix = isFeatureColumn && node ? node.featureKey : nodeKey;\n    const prefixedTopicName =\n      isFeatureColumn && namespaceParentTopicName\n        ? `${$WEBVIZ_SOURCE_2}${namespaceParentTopicName}`\n        : namespaceParentTopicName;\n\n    let newModififiedNamespaceTopics = modifiedNamespaceTopics;\n    if (namespaceParentTopicName && prefixedTopicName) {\n      if (!modifiedNamespaceTopics.includes(prefixedTopicName)) {\n        newModififiedNamespaceTopics = [...modifiedNamespaceTopics, prefixedTopicName];\n      }\n      const { namespace } = parseNamespaceKey(nodeKey);\n      keyWithPrefix = generateNodeKey({ topicName: namespaceParentTopicName, namespace, isFeatureColumn });\n    }\n\n    let prevChecked = checkedKeys.includes(keyWithPrefix);\n    let newCheckedKeys = [...checkedKeys];\n    if (!prevChecked && namespaceParentTopicName) {\n      prevChecked = getIsNamespaceCheckedByDefault(namespaceParentTopicName, columnIndex);\n      if (prevChecked && prefixedTopicName) {\n        // Add all namespaces under the topic if it's checked by default.\n        const allNsKeys = (availableNamespacesByTopic[prefixedTopicName] || []).map((ns) =>\n          generateNodeKey({ topicName: namespaceParentTopicName, namespace: ns, isFeatureColumn })\n        );\n        newCheckedKeys = [...checkedKeys, ...allNsKeys];\n      }\n    }\n    const isNowChecked = !prevChecked;\n\n    const nodeAndAncestorKeys: string[] = [keyWithPrefix];\n    let parentKey = namespaceParentTopicName\n      ? generateNodeKey({ topicName: namespaceParentTopicName })\n      : node?.parentKey;\n\n    while (parentKey) {\n      const keyToToggle = isFeatureColumn ? nodesByKey[parentKey]?.featureKey : parentKey;\n      if (keyToToggle) {\n        nodeAndAncestorKeys.push(keyToToggle);\n      }\n      parentKey = nodesByKey[parentKey]?.parentKey;\n    }\n    // Toggle all ancestor nodes' checked state to be the same as the new checked state for the node.\n    saveConfig({\n      modifiedNamespaceTopics: newModififiedNamespaceTopics,\n      checkedKeys: isNowChecked\n        ? uniq([...newCheckedKeys, ...nodeAndAncestorKeys])\n        : difference(newCheckedKeys, nodeAndAncestorKeys),\n    });\n  }, [\n    availableNamespacesByTopic,\n    checkedKeys,\n    getIsNamespaceCheckedByDefault,\n    modifiedNamespaceTopics,\n    nodesByKey,\n    saveConfig,\n  ]);\n\n  const filterTextRef = useRef(filterText);\n  filterTextRef.current = filterText;\n  const toggleNodeExpanded = useCallback((nodeKey: string) => {\n    // Don't allow any toggling expansion when filtering because we automatically expand all nodes.\n    if (!filterTextRef.current) {\n      saveConfig({ expandedKeys: xor(expandedKeys, [nodeKey]) });\n    }\n  }, [expandedKeys, saveConfig]);\n\n  const sceneErrorsByKey = useMemo(() => {\n    const result = {};\n\n    function collectGroupErrors(groupKey: ?string, errors: string[]) {\n      if (!groupKey) {\n        return;\n      }\n      let nodeKey: ?string = groupKey;\n      while (nodeKey && nodesByKey[nodeKey]) {\n        if (!result[nodeKey]) {\n          result[nodeKey] = [];\n        }\n        result[nodeKey].push(...errors);\n        nodeKey = nodesByKey[nodeKey].parentKey;\n      }\n    }\n\n    for (const [topicKey, errors] of Object.entries(sceneErrorsByTopicKey)) {\n      const baseKey = getBaseKey(topicKey);\n      if (!result[baseKey]) {\n        result[baseKey] = [];\n      }\n      const errorsWithTopicName = ((errors: any): string[]).map((err) => `${topicKey.substr(\"t:\".length)}: ${err}`);\n      result[baseKey].push(...(hasFeatureColumn ? errorsWithTopicName : errors));\n      const topicNode = nodesByKey[baseKey];\n      collectGroupErrors(topicNode?.parentKey, errorsWithTopicName);\n    }\n    return result;\n  }, [hasFeatureColumn, nodesByKey, sceneErrorsByTopicKey]);\n\n  const [debouncedFilterText] = useDebounce(filterText, 150);\n  const { getIsTreeNodeVisibleInTree } = useMemo(() => {\n    const showVisible = topicDisplayMode === TOPIC_DISPLAY_MODES.SHOW_SELECTED.value;\n    const showAvailable = topicDisplayMode === TOPIC_DISPLAY_MODES.SHOW_AVAILABLE.value;\n    const providerAvailable = providerTopics.length > 0;\n\n    let hasCalculatedVisibility = false;\n    // This stores whether the row has been marked as visible, so that we don't do extra work.\n    const isVisibleByKey: { [string]: boolean } = {};\n\n    const searchText = debouncedFilterText.toLowerCase().trim();\n    function getIfTextMatches(node: TreeNode): boolean {\n      // Never match the root node.\n      if (node.name === \"root\") {\n        return false;\n      } else if (node.type === \"group\") {\n        // Group node\n        return node.name != null && node.name.toLowerCase().includes(searchText);\n      }\n      // Topic node, without namespace\n      return (\n        node.topicName.toLowerCase().includes(searchText) ||\n        (node.name != null && node.name.toLowerCase().includes(searchText)) ||\n        (hasFeatureColumn && `${$WEBVIZ_SOURCE_2}${node.topicName}`.toLowerCase().includes(searchText))\n      );\n    }\n\n    // Calculates whether a node is visible. This is a recursive function intended to be run on the root node.\n    function calculateIsVisible(node: TreeNode, isAncestorVisible: boolean): boolean {\n      // When the user is viewing available/visible nodes, we can skip setting the visibility for the children of\n      // unavailable/invisible nodes since they are not going to be rendered.\n      if (providerAvailable && node.name !== \"root\") {\n        const unavailable = hasFeatureColumn\n          ? !node.availableByColumn[0] && !node.availableByColumn[1]\n          : !node.availableByColumn[0];\n        const invisibleInScene = hasFeatureColumn\n          ? !getIsTreeNodeVisibleInScene(node, 0) && !getIsTreeNodeVisibleInScene(node, 1)\n          : !getIsTreeNodeVisibleInScene(node, 0);\n\n        if ((showAvailable && unavailable) || (showVisible && invisibleInScene)) {\n          isVisibleByKey[node.key] = false;\n          return false;\n        }\n      }\n      // Whether the ancestor is visible, or the current node matches the search text.\n      const isAncestorOrCurrentVisible = isAncestorVisible || getIfTextMatches(node);\n      let isChildVisible = false;\n\n      if (node.type === \"topic\") {\n        // Topic node: check if any namespace matches.\n        const namespaces =\n          availableNamespacesByTopic[node.topicName] ||\n          (hasFeatureColumn && availableNamespacesByTopic[`${$WEBVIZ_SOURCE_2}${node.topicName}`]) ||\n          [];\n\n        for (const namespace of namespaces) {\n          const thisNamespacesMatches = namespace.toLowerCase().includes(searchText);\n          isVisibleByKey[generateNodeKey({ topicName: node.topicName, namespace })] =\n            isAncestorOrCurrentVisible || thisNamespacesMatches;\n          isChildVisible = thisNamespacesMatches || isChildVisible;\n        }\n      } else {\n        // Group node: recurse and check if any children are visible.\n        for (const child of node.children) {\n          isChildVisible = calculateIsVisible(child, isAncestorOrCurrentVisible) || isChildVisible;\n        }\n      }\n      const isVisible = isAncestorOrCurrentVisible || isChildVisible;\n      isVisibleByKey[node.key] = isVisible;\n      return isVisible;\n    }\n\n    function getIsTreeNodeVisible(key: string): boolean {\n      if (!searchText) {\n        return true;\n      }\n\n      // Calculate the row visibility for all rows if we don't already have it stored.\n      if (!hasCalculatedVisibility) {\n        calculateIsVisible(rootTreeNode, false);\n        hasCalculatedVisibility = true;\n      }\n\n      return !!isVisibleByKey[key];\n    }\n\n    return { getIsTreeNodeVisibleInTree: getIsTreeNodeVisible };\n  }, [\n    topicDisplayMode,\n    providerTopics.length,\n    debouncedFilterText,\n    getIsTreeNodeVisibleInScene,\n    availableNamespacesByTopic,\n    rootTreeNode,\n    hasFeatureColumn,\n  ]);\n\n  const { allKeys, shouldExpandAllKeys } = useMemo(() => {\n    return {\n      allKeys: Object.keys(nodesByKey),\n      shouldExpandAllKeys: !!debouncedFilterText,\n    };\n  }, [debouncedFilterText, nodesByKey]);\n\n  return {\n    allKeys,\n    derivedCustomSettingsByKey,\n    getIsNamespaceCheckedByDefault,\n    getIsTreeNodeVisibleInScene,\n    getIsTreeNodeVisibleInTree,\n    hasFeatureColumn,\n    nodesByKey, // For testing.\n    onNamespaceOverrideColorChange,\n    rootTreeNode,\n    sceneErrorsByKey,\n    selectedNamespacesByTopic,\n    selectedTopicNames: memoizedSelectedTopicNames,\n    shouldExpandAllKeys,\n    toggleCheckAllAncestors,\n    toggleCheckAllDescendants,\n    toggleNamespaceChecked,\n    toggleNodeChecked,\n    toggleNodeExpanded,\n    visibleTopicsCountByKey,\n  };\n}\n\nexport const TopicTreeContext = createContext<UseTreeOutput | null>(null);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { sortBy, truncate } from \"lodash\";\nimport type { Time } from \"rosbag\";\n\nimport { type DiagnosticsBuffer } from \"webviz-core/src/panels/diagnostics/useDiagnostics\";\nimport type { Header } from \"webviz-core/src/types/Messages\";\nimport fuzzyFilter from \"webviz-core/src/util/fuzzyFilter\";\n\n// Trim the message if it's too long. We sometimes get crazy massive messages here that can\n// otherwise crash our entire UI. I looked at a bunch of messages manually and they are typically\n// way smaller than 5KB, so this is a very generous maximum. But feel free to increase it more if\n// necessary. Exported for tests.\nexport const MAX_STRING_LENGTH = 5000; // 5KB\n\nexport const LEVELS: { OK: 0, WARN: 1, ERROR: 2, STALE: 3 } = { OK: 0, WARN: 1, ERROR: 2, STALE: 3 };\n\nexport const LEVEL_NAMES = {\n  [0]: \"ok\",\n  [1]: \"warn\",\n  [2]: \"error\",\n  [3]: \"stale\",\n};\n\ninterface ToString {\n  toString(): string;\n}\n\nexport type DiagnosticId = string & ToString;\n\nexport type Level = $Values<typeof LEVELS>;\n\nexport type KeyValue = {| key: string, value: string |};\n\n// diagnostic_msgs/DiagnosticStatus\nexport type DiagnosticStatusMessage = {|\n  name: string,\n  hardware_id: string,\n  level: Level,\n  message: string,\n  values: KeyValue[],\n|};\n\nexport type DiagnosticInfo = {|\n  status: DiagnosticStatusMessage,\n  stamp: Time,\n  id: DiagnosticId,\n  displayName: string,\n|};\n\nexport type DiagnosticStatusArrayMsg = {|\n  header: Header,\n  status: DiagnosticStatusMessage[],\n|};\n\nexport type DiagnosticsById = Map<DiagnosticId, DiagnosticInfo>;\nexport type DiagnosticsByLevel = {| [Level]: DiagnosticsById |};\n\n// Remove leading slash from hardware_id if present.\nexport function trimHardwareId(hardwareId: string): string {\n  return hardwareId.startsWith(\"/\") ? hardwareId.slice(1) : hardwareId;\n}\n\nexport function getDiagnosticId(hardwareId: string, name: ?string): DiagnosticId {\n  const trimmedHardwareId = trimHardwareId(hardwareId);\n  return name != null ? `|${trimmedHardwareId}|${name}|` : `|${trimmedHardwareId}|`;\n}\n\nexport function getDisplayName(hardwareId: string, name: string) {\n  if (name.indexOf(hardwareId) === 0) {\n    return name;\n  }\n  return name ? `${hardwareId}: ${name}` : hardwareId;\n}\n\n// ensures the diagnostic status message's name consists of both the hardware id and the name\nexport function computeDiagnosticInfo(status: DiagnosticStatusMessage, stamp: Time): DiagnosticInfo {\n  const displayName = getDisplayName(status.hardware_id, status.name);\n  if (status.values && status.values.some(({ value }) => value.length > MAX_STRING_LENGTH)) {\n    status = {\n      ...status,\n      values: status.values\n        ? status.values.map((kv) =>\n            kv.value.length > MAX_STRING_LENGTH\n              ? { key: kv.key, value: truncate(kv.value, { length: MAX_STRING_LENGTH }) }\n              : kv\n          )\n        : undefined,\n    };\n  }\n  return {\n    status,\n    stamp,\n    id: getDiagnosticId(status.hardware_id, status.name),\n    displayName,\n  };\n}\n\nexport function getDiagnosticsByLevel(buffer: DiagnosticsBuffer): {| [Level]: DiagnosticInfo[] |} {\n  const ret = {\n    [LEVELS.OK]: [],\n    [LEVELS.WARN]: [],\n    [LEVELS.ERROR]: [],\n    [LEVELS.STALE]: [],\n  };\n  for (const diagnosticsByName of buffer.diagnosticsByNameByTrimmedHardwareId.values()) {\n    for (const diagnostic of diagnosticsByName.values()) {\n      ret[diagnostic.status.level].push(diagnostic);\n    }\n  }\n  return ret;\n}\n\nexport const getSortedDiagnostics = (\n  nodes: DiagnosticInfo[],\n  hardwareIdFilter: string,\n  pinnedIds: DiagnosticId[]\n): DiagnosticInfo[] => {\n  const unpinnedNodes = nodes.filter(({ id }) => !pinnedIds.includes(id));\n  if (!hardwareIdFilter) {\n    return sortBy(unpinnedNodes, (info) => info.displayName.replace(/^\\//, \"\"));\n  }\n  // fuzzyFilter sorts by match accuracy.\n  return fuzzyFilter(unpinnedNodes, hardwareIdFilter, ({ displayName }) => displayName);\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { compact, uniq } from \"lodash\";\nimport memoizeWeak from \"memoize-weak\";\nimport React, { useEffect, useCallback, useMemo, useRef } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { type Time, TimeUtil } from \"rosbag\";\n\nimport helpContent from \"./index.help.md\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { type MessageHistoryItemsByPath } from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport { getTopicsFromPaths } from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport { useDecodeMessagePathsForMessagesByTopic } from \"webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport { getTooltipItemForMessageHistoryItem, type TooltipItem } from \"webviz-core/src/components/TimeBasedChart/utils\";\nimport { useBlocksByTopic, useDataSourceInfo, useMessagesByTopic } from \"webviz-core/src/PanelAPI\";\nimport type { BasePlotPath, PlotPath } from \"webviz-core/src/panels/Plot/internalTypes\";\nimport PlotChart, { getDatasetsAndTooltips, type PlotDataByPath } from \"webviz-core/src/panels/Plot/PlotChart\";\nimport PlotLegend from \"webviz-core/src/panels/Plot/PlotLegend\";\nimport PlotMenu from \"webviz-core/src/panels/Plot/PlotMenu\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { useShallowMemo, useGetCurrentValue } from \"webviz-core/src/util/hooks\";\nimport { fromSec, subtractTimes, toSec } from \"webviz-core/src/util/time\";\n\nexport const plotableRosTypes = [\n  \"bool\",\n  \"int8\",\n  \"uint8\",\n  \"int16\",\n  \"uint16\",\n  \"int32\",\n  \"uint32\",\n  \"int64\",\n  \"uint64\",\n  \"float32\",\n  \"float64\",\n  \"time\",\n  \"duration\",\n  \"string\",\n  \"json\",\n  // We plot the length of arrays.\n  \"array\",\n];\n\n// X-axis values:\nexport type PlotXAxisVal =\n  | \"timestamp\" // Message playback time. Preloaded.\n  | \"index\" // Message-path value index. One \"current\" message at playback time.\n  | \"custom\" // Message path data. Preloaded.\n  | \"currentCustom\"; // Message path data. One \"current\" message at playback time.\n\nexport type PlotConfig = {\n  paths: PlotPath[],\n  minYValue: string,\n  maxYValue: string,\n  showLegend: boolean,\n  xAxisVal: PlotXAxisVal,\n  xAxisPath?: BasePlotPath,\n  followingViewWidth?: string,\n};\n\nexport function openSiblingPlotPanel(\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n  topicName: string\n) {\n  openSiblingPanel(\n    \"Plot\",\n    (config: PlotConfig) =>\n      ({\n        ...config,\n        paths: uniq(\n          config.paths\n            .concat([{ value: topicName, enabled: true, timestampMethod: \"receiveTime\" }])\n            .filter(({ value }) => value)\n        ),\n      }: PlotConfig)\n  );\n}\n\ntype Props = {\n  config: PlotConfig,\n  saveConfig: ($Shape<PlotConfig>) => void,\n};\n\n// messagePathItems contains the whole parsed message, and we don't need to cache all of that.\n// Instead, throw away everything but what we need (the timestamps).\nconst getPlotDataByPath = (itemsByPath: MessageHistoryItemsByPath): PlotDataByPath => {\n  const ret: PlotDataByPath = {};\n  Object.keys(itemsByPath).forEach((path) => {\n    ret[path] = [itemsByPath[path].map(getTooltipItemForMessageHistoryItem)];\n  });\n  return ret;\n};\n\nconst getMessagePathItemsForBlock = memoizeWeak(\n  (decodeMessagePathsForMessagesByTopic, block): PlotDataByPath => {\n    return Object.freeze(getPlotDataByPath(decodeMessagePathsForMessagesByTopic(block)));\n  }\n);\n\nconst ZERO_TIME = { sec: 0, nsec: 0 };\n\nfunction getBlockItemsByPath(decodeMessagePathsForMessagesByTopic, blocks) {\n  const ret = {};\n  const lastBlockIndexForPath = {};\n  blocks.forEach((block, i) => {\n    const messagePathItemsForBlock: PlotDataByPath = getMessagePathItemsForBlock(\n      decodeMessagePathsForMessagesByTopic,\n      block\n    );\n    Object.keys(messagePathItemsForBlock).forEach((path) => {\n      const existingItems: TooltipItem[][] = ret[path] || [];\n      // getMessagePathItemsForBlock returns an array of exactly one range of items.\n      const [pathItems] = messagePathItemsForBlock[path];\n      if (lastBlockIndexForPath[path] === i - 1) {\n        // If we are continuing directly from the previous block index (i - 1) then add to the\n        // existing range, otherwise start a new range\n        const currentRange = existingItems[existingItems.length - 1];\n        for (const item of pathItems) {\n          currentRange.push(item);\n        }\n      } else {\n        // Start a new contiguous range. Make a copy so we can extend it.\n        existingItems.push(pathItems.slice());\n      }\n      ret[path] = existingItems;\n      lastBlockIndexForPath[path] = i;\n    });\n  });\n  return ret;\n}\n\nfunction Plot(props: Props) {\n  const { saveConfig, config } = props;\n  const { followingViewWidth, paths: yAxisPaths, minYValue, maxYValue, showLegend, xAxisVal, xAxisPath } = config;\n  // Note that the below values are refs since they are only used in callbacks and are not rendered anywhere.\n  const currentMinY = useRef(null);\n  const currentMaxY = useRef(null);\n  const currentViewWidth = useRef(null);\n\n  const saveCurrentView = useCallback((minY: number, maxY: number, width: ?number) => {\n    currentMinY.current = minY;\n    currentMaxY.current = maxY;\n    currentViewWidth.current = width;\n  }, []);\n\n  const setWidth = useCallback(\n    () =>\n      saveConfig({\n        followingViewWidth: currentViewWidth.current != null ? currentViewWidth.current.toString() : \"\",\n      }),\n    [saveConfig]\n  );\n\n  const setMinMax = useCallback(\n    () =>\n      saveConfig({\n        minYValue: currentMinY.current != null ? currentMinY.current.toString() : \"\",\n        maxYValue: currentMaxY.current != null ? currentMaxY.current.toString() : \"\",\n      }),\n    [currentMaxY, currentMinY, saveConfig]\n  );\n\n  useEffect(() => {\n    if (!yAxisPaths.length) {\n      saveConfig({ paths: [{ value: \"\", enabled: true, timestampMethod: \"receiveTime\" }] });\n    }\n  });\n\n  const showSingleCurrentMessage = xAxisVal === \"currentCustom\" || xAxisVal === \"index\";\n  const historySize = showSingleCurrentMessage ? 1 : Infinity;\n\n  const allPaths = yAxisPaths.map(({ value }) => value).concat(compact([xAxisPath?.value]));\n  const memoizedPaths: string[] = useShallowMemo<string[]>(allPaths);\n  const subscribeTopics = useMemo(() => getTopicsFromPaths(memoizedPaths), [memoizedPaths]);\n  const messagesByTopic = useMessagesByTopic({\n    topics: subscribeTopics,\n    historySize,\n    // This subscription is used for two purposes:\n    //  1. A fallback for preloading when blocks are not available (nodes, websocket.)\n    //  2. Playback-synced plotting of index/custom data.\n    preloadingFallback: !showSingleCurrentMessage,\n    format: \"bobjects\",\n  });\n\n  const decodeMessagePathsForMessagesByTopic = useDecodeMessagePathsForMessagesByTopic(memoizedPaths);\n\n  const streamedItemsByPath = useMemo(() => getPlotDataByPath(decodeMessagePathsForMessagesByTopic(messagesByTopic)), [\n    decodeMessagePathsForMessagesByTopic,\n    messagesByTopic,\n  ]);\n\n  const blocks = useBlocksByTopic(subscribeTopics);\n  const blockItemsByPath = useMemo(\n    () => (showSingleCurrentMessage ? {} : getBlockItemsByPath(decodeMessagePathsForMessagesByTopic, blocks)),\n    [showSingleCurrentMessage, decodeMessagePathsForMessagesByTopic, blocks]\n  );\n  const { startTime } = useDataSourceInfo();\n\n  // If every streaming key is in the blocks, just use the blocks object for a stable identity.\n  const mergedItems = useMemo(\n    () =>\n      Object.keys(streamedItemsByPath).every((path) => blockItemsByPath[path] != null)\n        ? blockItemsByPath\n        : { ...streamedItemsByPath, ...blockItemsByPath },\n    [streamedItemsByPath, blockItemsByPath]\n  );\n\n  // Don't filter out disabled paths when passing into getDatasetsAndTooltips, because we still want\n  // easy access to the history when turning the disabled paths back on.\n  const { datasets, tooltips, pathsWithMismatchedDataLengths } = useMemo(\n    // TODO(steel): This memoization isn't quite ideal: getDatasetsAndTooltips is a bit expensive\n    // with lots of preloaded data, and when we preload a new block we re-generate the datasets for\n    // the whole timeline. We should try to use block memoization here.\n    () => getDatasetsAndTooltips(yAxisPaths, mergedItems, startTime || ZERO_TIME, xAxisVal, xAxisPath),\n    [yAxisPaths, mergedItems, startTime, xAxisVal, xAxisPath]\n  );\n\n  const { currentTime, endTime, seekPlayback: seek } = useMessagePipeline(\n    useCallback(\n      ({ seekPlayback, playerState: { activeData } }) => ({\n        currentTime: activeData?.currentTime,\n        endTime: activeData?.endTime,\n        seekPlayback,\n      }),\n      []\n    )\n  );\n  // Min/max x-values and playback position indicator are only used for preloaded plots. In non-\n  // preloaded plots min x-value is always the last seek time, and the max x-value is the current\n  // playback time.\n  const timeToXValueForPreloading = (t: ?Time): ?number => {\n    if (xAxisVal === \"timestamp\" && t && startTime) {\n      return toSec(subtractTimes(t, startTime));\n    }\n  };\n  const preloadingDisplayTime = timeToXValueForPreloading(currentTime);\n  const preloadingStartTime = timeToXValueForPreloading(startTime); // zero or undefined\n  const preloadingEndTime = timeToXValueForPreloading(endTime);\n  const hasPreloadingDisplayTime = preloadingDisplayTime != null;\n  const defaultView = useMemo(() => {\n    if (hasPreloadingDisplayTime) {\n      if (followingViewWidth != null && parseFloat(followingViewWidth) > 0) {\n        // Will be ignored in TimeBasedChart for non-preloading plots and non-timestamp plots.\n        return { type: \"following\", width: parseFloat(followingViewWidth) };\n      } else if (preloadingStartTime != null && preloadingEndTime != null) {\n        return { type: \"fixed\", minXValue: preloadingStartTime, maxXValue: preloadingEndTime };\n      }\n    }\n    return undefined;\n  }, [followingViewWidth, hasPreloadingDisplayTime, preloadingEndTime, preloadingStartTime]);\n\n  const onClick = useCallback((_, __, { X_AXIS_ID: seekSeconds }) => {\n    if (!startTime || seekSeconds == null || !seek || xAxisVal !== \"timestamp\") {\n      return;\n    }\n    // The player validates and clamps the time.\n    const seekTime = TimeUtil.add(startTime, fromSec(seekSeconds));\n    seek(seekTime);\n  }, [seek, startTime, xAxisVal]);\n\n  // We want to avoid rerendering the plot menu every frame, but datasets and tooltips change frequently.\n  const getDatasets = useGetCurrentValue(datasets);\n  const getTooltips = useGetCurrentValue(tooltips);\n\n  const plotMenu = useMemo(\n    () => (\n      <PlotMenu\n        displayWidth={followingViewWidth || \"\"}\n        minYValue={minYValue}\n        maxYValue={maxYValue}\n        saveConfig={saveConfig}\n        setMinMax={setMinMax}\n        setWidth={setWidth}\n        xAxisVal={xAxisVal}\n        getDatasets={getDatasets}\n        getTooltips={getTooltips}\n      />\n    ),\n    [followingViewWidth, minYValue, maxYValue, saveConfig, setMinMax, setWidth, xAxisVal, getDatasets, getTooltips]\n  );\n\n  return (\n    <Flex col clip center style={{ position: \"relative\" }}>\n      <PanelToolbar helpContent={helpContent} floating menuContent={plotMenu} />\n      <PlotChart\n        paths={yAxisPaths}\n        minYValue={parseFloat(minYValue)}\n        maxYValue={parseFloat(maxYValue)}\n        saveCurrentView={saveCurrentView}\n        datasets={datasets}\n        tooltips={tooltips}\n        xAxisVal={xAxisVal}\n        currentTime={preloadingDisplayTime}\n        onClick={onClick}\n        defaultView={defaultView}\n      />\n      <PlotLegend\n        paths={yAxisPaths}\n        saveConfig={saveConfig}\n        showLegend={showLegend}\n        xAxisVal={xAxisVal}\n        xAxisPath={xAxisPath}\n        pathsWithMismatchedDataLengths={pathsWithMismatchedDataLengths}\n      />\n    </Flex>\n  );\n}\nPlot.panelType = \"Plot\";\nPlot.defaultConfig = {\n  paths: [{ value: \"\", enabled: true, timestampMethod: \"receiveTime\" }],\n  minYValue: \"\",\n  maxYValue: \"\",\n  showLegend: true,\n  xAxisVal: \"timestamp\",\n};\nPlot.shortcuts = [\n  { description: \"Reset\", keys: [\"double click\"] },\n  { description: \"Pan\", keys: [\"drag\"] },\n  { description: \"Zoom\", keys: [\"scroll horizontally\"] },\n  { description: \"Zoom vertically\", keys: [\"v\" + \"scroll\"] },\n  { description: \"Zoom both vertically and horizontally\", keys: [\"b\" + \"scroll\"] },\n  { description: \"Zoom to percentage (10% - 100%)\", keys: [\"\", \"1|2|...|9|0\"] },\n];\n\nexport default hot(Panel<PlotConfig>(Plot));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { memoize } from \"lodash\";\nimport memoizeWeak from \"memoize-weak\";\n\nimport {\n  type MessagePathPart,\n  rosPrimitives,\n  type RosPrimitive,\n  type MessagePathStructureItem,\n  type MessagePathStructureItemMessage,\n} from \"./constants\";\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\n\n// Generate an easily navigable flat structure given some `datatypes`. We cache\n// this loosely as `datatypes` don't change after the player has connected.\n// The structure looks something like this:\n//\n// {\n//   \"/datatype/name\": {\n//     structureType: \"message\",\n//     nextByName: {\n//       \"some-sub-field\": {\n//         structureType: \"primitive\",\n//         primitiveType: \"uint8\",\n//       }\n//       \"some-boolean-array-sub-field\": {\n//         structureType: \"array\",\n//         next: {\n//           structureType: \"primitive\",\n//           primitiveType: \"bool\"\n//         }\n//       }\n//     }\n//   }\n// }\nlet lastDatatypes;\nlet lastStructures;\nexport function messagePathStructures(datatypes: RosDatatypes): { [string]: MessagePathStructureItemMessage } {\n  if (lastDatatypes !== datatypes) {\n    lastDatatypes = undefined;\n    const structureFor = memoize(\n      (datatype: string): MessagePathStructureItemMessage => {\n        const nextByName: { [string]: MessagePathStructureItem } = {};\n        const rosDatatype = datatype === \"json\" ? { fields: [] } : datatypes[datatype];\n        if (!rosDatatype) {\n          throw new Error(`datatype not found: \"${datatype}\"`);\n        }\n        rosDatatype.fields.forEach((msgField) => {\n          if (msgField.isConstant) {\n            return;\n          }\n\n          const next = rosPrimitives.includes(msgField.type)\n            ? {\n                structureType: \"primitive\",\n                primitiveType: ((msgField.type: any): RosPrimitive), // Flow doesn't understand includes()\n                datatype,\n              }\n            : structureFor(msgField.type);\n\n          if (msgField.isArray) {\n            nextByName[msgField.name] = { structureType: \"array\", next, datatype };\n          } else {\n            nextByName[msgField.name] = next;\n          }\n        });\n        return { structureType: \"message\", nextByName, datatype };\n      }\n    );\n\n    lastStructures = {};\n    Object.keys(datatypes).forEach((datatype) => {\n      lastStructures[datatype] = structureFor(datatype);\n    });\n    lastDatatypes = datatypes; // Set at the very end, in case there's an error earlier.\n  }\n  return lastStructures;\n}\n\nexport function validTerminatingStructureItem(\n  structureItem: ?MessagePathStructureItem,\n  validTypes: ?(string[])\n): boolean {\n  return (\n    !!structureItem &&\n    (!validTypes ||\n      validTypes.includes(structureItem.structureType) ||\n      (structureItem.structureType === \"primitive\" && validTypes.includes(structureItem.primitiveType)))\n  );\n}\n\n// Given a datatype, the array of datatypes, and a list of valid types,\n// list out all valid strings for the `messagePath` part of the path (sorted).\nexport function messagePathsForDatatype(\n  datatype: string,\n  datatypes: RosDatatypes,\n  validTypes: ?(string[]),\n  noMultiSlices: ?boolean,\n  messagePath?: MessagePathPart[] = []\n): string[] {\n  let clonedMessagePath = [...messagePath];\n  const messagePaths = [];\n  function traverse(structureItem: MessagePathStructureItem, builtString: string) {\n    if (validTerminatingStructureItem(structureItem, validTypes)) {\n      messagePaths.push(builtString);\n    }\n    if (structureItem.structureType === \"message\") {\n      for (const name of Object.keys(structureItem.nextByName)) {\n        traverse(structureItem.nextByName[name], `${builtString}.${name}`);\n      }\n    } else if (structureItem.structureType === \"array\") {\n      if (structureItem.next.structureType === \"message\") {\n        // When we have an array of messages, you probably want to filter on\n        // some field, like `/topic.object{some_id=123}`. If we can't find a\n        // typical filter name, fall back to `/topic.object[0]`.\n        const typicalFilterName = Object.keys(structureItem.next.nextByName).find((key) => isTypicalFilterName(key));\n        if (typicalFilterName) {\n          // Find matching filter from clonedMessagePath\n          const matchingFilterPart = clonedMessagePath.find(\n            (pathPart) => pathPart.type === \"filter\" && pathPart.path[0] === typicalFilterName\n          );\n\n          // Remove the matching filter from clonedMessagePath, for future searches\n          clonedMessagePath = clonedMessagePath.filter((pathPart) => pathPart !== matchingFilterPart);\n\n          // Format the displayed filter value\n          const filterVal =\n            matchingFilterPart && matchingFilterPart.type === \"filter\" && matchingFilterPart.value\n              ? matchingFilterPart.value\n              : 0;\n          traverse(\n            structureItem.next,\n            `${builtString}[:]{${typicalFilterName}==${\n              typeof filterVal === \"object\" ? `$${filterVal.variableName}` : filterVal\n            }}`\n          );\n        } else {\n          traverse(structureItem.next, `${builtString}[0]`);\n        }\n      } else if (!noMultiSlices) {\n        // When dealing with an array of primitives, you likely just want a\n        // scatter plot (if we can do multi-slices).\n        traverse(structureItem.next, `${builtString}[:]`);\n      } else {\n        traverse(structureItem.next, `${builtString}[0]`);\n      }\n    }\n  }\n  const structureItem = messagePathStructures(datatypes)[datatype];\n  if (!structureItem) {\n    throw new Error(`datatype not found \"${datatype}\"`);\n  }\n  traverse(structureItem, \"\");\n  return messagePaths.sort(naturalSort());\n}\n\nexport type StructureTraversalResult = {|\n  valid: boolean,\n  msgPathPart: ?MessagePathPart,\n  structureItem: ?MessagePathStructureItem,\n|};\n\n// Traverse down the structure given a `messagePath`. Return if the path\n// is valid, given the structure, `validTypes`, and `noMultiSlices`.\n//\n// We return the `msgPathPart` that was invalid to determine what sort\n// of autocomplete we should show.\n//\n// We use memoizeWeak because it works with multiple arguments (lodash's memoize\n// does not) and does not hold onto objects as strongly (it uses WeakMap).\nexport const traverseStructure = memoizeWeak(\n  (structureItem: ?MessagePathStructureItem, messagePath: MessagePathPart[]): StructureTraversalResult => {\n    if (!structureItem) {\n      return { valid: false, msgPathPart: undefined, structureItem: undefined };\n    }\n    for (const msgPathPart: MessagePathPart of messagePath) {\n      if (!structureItem) {\n        return { valid: false, msgPathPart, structureItem };\n      }\n      if (structureItem.primitiveType === \"json\") {\n        // No need to continue validating if we're dealing with JSON. We\n        // essentially treat all nested values as valid.\n        continue;\n      } else if (msgPathPart.type === \"name\") {\n        if (structureItem.structureType !== \"message\") {\n          return { valid: false, msgPathPart, structureItem };\n        }\n        const next: ?MessagePathStructureItem = structureItem.nextByName[msgPathPart.name];\n        const nextStructureIsJson = next && next.structureType === \"primitive\" && next?.primitiveType === \"json\";\n        structureItem = !nextStructureIsJson\n          ? next\n          : {\n              structureType: \"primitive\",\n              primitiveType: \"json\",\n              datatype: next ? next.datatype : \"\",\n            };\n      } else if (msgPathPart.type === \"slice\") {\n        if (structureItem.structureType !== \"array\") {\n          return { valid: false, msgPathPart, structureItem };\n        }\n        structureItem = structureItem.next;\n      } else if (msgPathPart.type === \"filter\") {\n        if (structureItem.structureType !== \"message\" || msgPathPart.path.length === 0 || msgPathPart.value == null) {\n          return { valid: false, msgPathPart, structureItem };\n        }\n        let currentItem = structureItem;\n        for (const name of msgPathPart.path) {\n          if (currentItem.structureType !== \"message\") {\n            return { valid: false, msgPathPart, structureItem };\n          }\n          currentItem = currentItem.nextByName[name];\n          if (currentItem == null) {\n            return { valid: false, msgPathPart, structureItem };\n          }\n        }\n      } else {\n        (msgPathPart.type: empty);\n        throw new Error(`Invalid msgPathPart.type: ${msgPathPart.type}`);\n      }\n    }\n    return { valid: true, msgPathPart: undefined, structureItem };\n  }\n);\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type GLContextType } from \"./GLContext\";\n\n// This is a costly operation. DO NOT use during rendering loop if possible\nexport const checkErrors = (ctx: GLContextType) => {\n  const { gl } = ctx;\n  const code = gl.getError();\n  switch (code) {\n    case gl.NO_ERROR:\n      return;\n    case gl.INVALID_ENUM:\n      return {\n        code,\n        msg: \"Invalid enum.\",\n      };\n    case gl.INVALID_VALUE:\n      return {\n        code,\n        msg: \"Invalid value.\",\n      };\n    case gl.INVALID_OPERATION:\n      return {\n        code,\n        msg: \"Invalid operation.\",\n      };\n    case gl.INVALID_FRAMEBUFFER_OPERATION:\n      return {\n        code,\n        msg: \"Invalid Framebuffer operation.\",\n      };\n    case gl.OUT_OF_MEMORY:\n      return {\n        code,\n        msg: \"Out of memory.\",\n      };\n    case gl.CONTEXT_LOST_WEBGL:\n      return {\n        code,\n        msg: \"Context lost.\",\n      };\n    default:\n      return {\n        code,\n        msg: \"Unknown error\",\n      };\n  }\n};\n\nexport const createShader = (ctx: GLContextType, type: number, source: string) => {\n  const { gl } = ctx;\n  if (!source.startsWith(\"#version\")) {\n    // Prepend GLES 3.0 version if none was provided\n    source = `#version 300 es\\n${source}`;\n  }\n  const shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  if (!success) {\n    const msg = gl.getShaderInfoLog(shader);\n    gl.deleteShader(shader);\n    throw new Error(msg);\n  }\n  return shader;\n};\n\nexport const createShaderProgram = (ctx: GLContextType, vert: string, frag: string) => {\n  const { gl } = ctx;\n  const vertexShader = createShader(ctx, gl.VERTEX_SHADER, vert);\n  const fragmentShader = createShader(ctx, gl.FRAGMENT_SHADER, frag);\n  if (!vertexShader || !fragmentShader) {\n    return;\n  }\n\n  const program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n  if (!success) {\n    const msg = gl.getProgramInfoLog(program);\n    gl.deleteProgram(program);\n    throw new Error(msg);\n  }\n\n  return program;\n};\n\nexport const createBuffer = (ctx: GLContextType, data: any) => {\n  const { gl } = ctx;\n  const buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n  return buffer;\n};\n\nexport const clearRect = (ctx: GLContextType, rect: any) => {\n  const { gl, scale } = ctx;\n  const width = scale * (rect.right - rect.left);\n  const height = scale * (rect.bottom - rect.top);\n  const left = scale * rect.left;\n  const bottom = scale * (gl.canvas.clientHeight - rect.bottom);\n\n  gl.viewport(left, bottom, width, height);\n  gl.scissor(left, bottom, width, height);\n  gl.clearColor(0, 0, 0, 0);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport memoize from \"lodash/memoize\";\n\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\n\nconst supportsOffscreenCanvas: () => boolean = memoize(\n  (): boolean => {\n    try {\n      // $FlowFixMe This is a function that is not yet in Flow.\n      document.createElement(\"canvas\").transferControlToOffscreen();\n    } catch (error) {\n      sendNotification(\n        \"Rendering to a canvas in a worker is unsupported in this browser, falling back to rendering using the main thread\",\n        \"\",\n        \"app\",\n        \"warn\"\n      );\n      return false;\n    }\n    return true;\n  }\n);\n\nexport default supportsOffscreenCanvas;\n","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./mixins.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./mixins.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./mixins.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { memoize } from \"lodash\";\nimport tinycolor from \"tinycolor2\";\n\nimport { toolsColorScheme } from \"webviz-core/src/util/toolsColorScheme\";\n\n// Inspired by the \"light\" scheme from https://personal.sron.nl/~pault/#sec:qualitative\n// but using our standard tools colors.\nexport const lineColors = [\n  toolsColorScheme.blue.medium,\n  toolsColorScheme.orange.medium,\n  toolsColorScheme.yellow.medium,\n  toolsColorScheme.purple.dark,\n  toolsColorScheme.cyan.medium,\n  toolsColorScheme.green.medium,\n  toolsColorScheme.paleGreen.medium,\n  \"#DDDDDD\",\n];\n\nexport const lightColor: (_: string) => string = memoize(\n  (color: string): string =>\n    tinycolor(color)\n      .brighten(15)\n      .toString()\n);\n\nexport const darkColor: (_: string) => string = memoize(\n  (color: string): string =>\n    tinycolor(color)\n      .darken(30)\n      .toString()\n);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { type Node, useMemo } from \"react\";\nimport type { Time } from \"rosbag\";\n\nimport { getTopicsFromPaths } from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport {\n  type MessagePathDataItem,\n  useDecodeMessagePathsForMessagesByTopic,\n} from \"webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport { useShallowMemo } from \"webviz-core/src/util/hooks\";\n\nexport type MessageHistoryItem = {\n  queriedData: MessagePathDataItem[],\n  message: Message,\n};\n\nexport type MessageHistoryItemsByPath = $ReadOnly<{ [string]: $ReadOnlyArray<MessageHistoryItem> }>;\n\nexport type MessageHistoryData = {|\n  itemsByPath: MessageHistoryItemsByPath,\n  startTime: Time,\n|};\n\ntype Props = {|\n  children: (MessageHistoryData) => Node,\n  paths: string[],\n  historySize?: number,\n|};\n\nconst ZERO_TIME = Object.freeze({ sec: 0, nsec: 0 });\n\n// DEPRECATED in favor of PanelAPI.useMessagesByTopic and useCachedGetMessagePathDataItems.\n//\n// Be sure to pass in a new render function when you want to force a rerender.\n// So you probably don't want to do `<MessageHistoryDEPRECATED>{this._renderSomething}</MessageHistoryDEPRECATED>`.\n// This might be a bit counterintuitive but we do this since performance matters here.\nexport default React.memo<Props>(function MessageHistoryDEPRECATED({ children, paths, historySize }: Props) {\n  const { startTime } = PanelAPI.useDataSourceInfo();\n  const memoizedPaths: string[] = useShallowMemo<string[]>(paths);\n  const subscribeTopics = useMemo(() => getTopicsFromPaths(memoizedPaths), [memoizedPaths]);\n\n  const messagesByTopic = PanelAPI.useMessagesByTopic({\n    topics: subscribeTopics,\n    historySize: historySize || Infinity,\n  });\n\n  const decodeMessagePathsForMessagesByTopic = useDecodeMessagePathsForMessagesByTopic(memoizedPaths);\n  const itemsByPath = useMemo(() => decodeMessagePathsForMessagesByTopic(messagesByTopic), [\n    decodeMessagePathsForMessagesByTopic,\n    messagesByTopic,\n  ]);\n\n  return useMemo(() => children({ itemsByPath, startTime: startTime || ZERO_TIME }), [\n    children,\n    itemsByPath,\n    startTime,\n  ]);\n});\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst { useRef, useState, useLayoutEffect, useCallback } = React;\n\nexport const STextField = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nexport const STextFieldLabel = styled.label(\n  ({ disabled }) => `\n  margin: 8px 0;\n  color: ${colors.LIGHT};\n  opacity: ${disabled ? 0.5 : 1};\n`\n);\n\nexport const SError = styled.div`\n  color: ${colors.RED};\n  margin: 4px 0;\n`;\n\ntype Props = {\n  defaultValue?: string,\n  focusOnMount?: boolean,\n  inputStyle: { [string]: string | number },\n  hideInlineError?: boolean,\n  label?: string,\n  onBlur: () => void,\n  onChange: (value: string) => void,\n  onError?: (error: ?string) => void,\n  placeholder?: string,\n  style: { [string]: string | number },\n  validateOnBlur?: boolean,\n  validator: (value: any) => ?string,\n  value?: string,\n};\n\nexport default function TextField({\n  defaultValue,\n  focusOnMount,\n  inputStyle,\n  hideInlineError,\n  label,\n  onBlur,\n  onChange,\n  onError,\n  placeholder,\n  style,\n  validateOnBlur,\n  validator,\n  value,\n  ...rest\n}: Props) {\n  const [error, setError] = useState<?string>();\n  const [inputStr, setInputStr] = useState<string>(value || defaultValue || \"\");\n\n  const prevIncomingVal = useRef(\"\");\n  const inputRef = useRef(null);\n\n  useLayoutEffect(() => {\n    // only compare if it's a controlled component\n    if (!defaultValue && !validateOnBlur && prevIncomingVal.current !== value) {\n      const validationResult = validator(value);\n      setError(validationResult || null);\n      setInputStr(value || \"\");\n    }\n    prevIncomingVal.current = value;\n  }, [defaultValue, validateOnBlur, validator, value]);\n\n  useLayoutEffect(() => {\n    if (inputRef.current && focusOnMount) {\n      inputRef.current.focus();\n    }\n  }, [focusOnMount]);\n\n  useLayoutEffect(() => {\n    if (onError) {\n      onError(error);\n    }\n  }, [error, onError]);\n\n  const validate = useCallback((val) => {\n    const validationResult = validator(val);\n    if (validationResult) {\n      setError(validationResult);\n    } else {\n      setError(null);\n      onChange(val);\n    }\n  }, [onChange, validator]);\n\n  const handleChange = useCallback(({ target }) => {\n    setInputStr(target.value);\n    if (!validateOnBlur) {\n      validate(target.value);\n    }\n  }, [validate, validateOnBlur]);\n\n  const handleBlur = useCallback(\n    () => {\n      if (validateOnBlur) {\n        validate(inputStr);\n      }\n      if (onBlur) {\n        onBlur();\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [inputStr, onBlur, validate, validateOnBlur]\n  );\n\n  // only show red border when there is some input and it's not valid\n  const errorStyle = inputStr && error ? { border: `1px solid ${colors.RED}` } : {};\n\n  return (\n    <STextField style={style}>\n      {label && <STextFieldLabel>{label}</STextFieldLabel>}\n      <input\n        onBlur={handleBlur}\n        ref={inputRef}\n        placeholder={placeholder}\n        style={{ marginLeft: 0, ...errorStyle, ...inputStyle }}\n        value={inputStr}\n        onChange={handleChange}\n        {...rest}\n      />\n      {error && !hideInlineError && <SError>{error}</SError>}\n    </STextField>\n  );\n}\n\nTextField.defaultProps = {\n  validator: () => undefined,\n  onChange: () => {},\n  onBlur: () => {},\n  inputStyle: {},\n  style: {},\n};\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport type { Vec3, Dimensions, RGBA, Color } from \"regl-worldview\";\nimport { Overlay } from \"regl-worldview\";\n\nimport type { Interactive } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\nimport type { OverlayIconMarker } from \"webviz-core/src/types/Messages\";\nimport { emptyPose } from \"webviz-core/src/util/Pose\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\n\nexport const DEFAULT_TEXT_COLOR = { r: 1, g: 1, b: 1, a: 1 };\n\ntype IconTypeItem = {| icon_type: number | string, color?: RGBA |};\nexport type RenderItemOutput = {|\n  text: string,\n  textColor: Color,\n  coordinates: Vec3,\n  name: string,\n  dimension: Dimensions,\n  markerStyle: any,\n  iconOffset: any,\n  iconTypes: IconTypeItem[],\n|};\n\ntype Props = {\n  children: any[],\n  setOverlayIcons: ({\n    renderItems: RenderItemOutput[],\n    sceneBuilderDrawables: Interactive<OverlayIconMarker>[],\n  }) => void,\n};\n\nlet sentNotification = false;\nexport function sendIconTypeDeprecatedNotification() {\n  if (!sentNotification) {\n    sendNotification(\n      `Deprecated icon_type usage`,\n      `icon_type has been deprecated. Use 'icon_types' instead. Example format: 'iconTypes: [{icon_type: 'arrow-left', color: {r: 1, g: 1, b: 1, a: 1}}]'`,\n      \"user\",\n      \"warn\"\n    );\n    sentNotification = true;\n  }\n}\n\nexport const getIconName = (icon: Interactive<OverlayIconMarker>): string =>\n  JSON.stringify([icon.interactionData?.topic, icon.ns, icon.id]);\n\nconst projectItem = ({\n  item,\n  item: { metadata = {}, icon_type },\n  coordinates,\n  dimension: { width, height },\n}: {|\n  item: Interactive<OverlayIconMarker>,\n  coordinates: ?Vec3,\n  dimension: Dimensions,\n|}): ?RenderItemOutput => {\n  if (!coordinates) {\n    return null;\n  }\n  const [left, top] = coordinates;\n  if (left < -10 || top < -10 || left > width + 10 || top > height + 10) {\n    return null; // Don't render anything that's too far outside of the canvas\n  }\n  const name = getIconName(item);\n  const markerStyle = metadata.markerStyle || {};\n  let iconTypes: ?(IconTypeItem[]) = metadata.icon_types;\n  // TODO[Audrey]: deprecate the support for icon_type in late 2021.\n  const iconType = icon_type || metadata.icon_type;\n  if (!iconTypes && iconType) {\n    sendIconTypeDeprecatedNotification();\n    iconTypes = [{ icon_type: iconType, color: item.color }];\n  }\n\n  return iconTypes && iconTypes.length > 0\n    ? {\n        textColor: item.color || DEFAULT_TEXT_COLOR,\n        name,\n        coordinates,\n        dimension: { width, height },\n        text: item.text,\n        markerStyle,\n        ...(metadata.iconOffset ? { iconOffset: metadata.iconOffset } : undefined),\n        iconTypes,\n      }\n    : undefined;\n};\n\nconst OverlayProjector = (props: Props) => {\n  const { children, setOverlayIcons } = props;\n  const renderItems = [];\n  // We call setOverlayIcons after the last child has been processed. If there are no children, we\n  // still want to delay calling setOverlayIcons until regl renders, so add a dummy child.\n  const nonEmptyChildren = children.length === 0 ? [{ pose: emptyPose(), dummy: true }] : children;\n  return (\n    <Overlay\n      renderItem={({ item, index, coordinates, dimension }) => {\n        if (index === 0) {\n          renderItems.length = 0;\n        }\n        if (!(\"dummy\" in item)) {\n          renderItems.push(projectItem({ item, coordinates, dimension }));\n        }\n        if (index === nonEmptyChildren.length - 1) {\n          // Set icons even if there aren't any, so the main thread knows when the last ones have\n          // disappeared.\n          setOverlayIcons({ renderItems: renderItems.filter(Boolean), sceneBuilderDrawables: children });\n        }\n        return null;\n      }}>\n      {nonEmptyChildren}\n    </Overlay>\n  );\n};\n\nexport default OverlayProjector;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { MutablePose, Orientation, Point } from \"webviz-core/src/types/Messages\";\n\n// contains backing classes for point, orientation, and pose\n// because we create them a _lot_\nclass PointClass {\n  x: number;\n  y: number;\n  z: number;\n\n  static empty() {\n    // $FlowFixMe: Classes are inexact in flow.\n    const point = new PointClass();\n    point.x = 0;\n    point.y = 0;\n    point.z = 0;\n    return point;\n  }\n}\n\nclass OrientationClass {\n  x: number;\n  y: number;\n  z: number;\n  w: number;\n\n  static empty() {\n    // $FlowFixMe: Classes are inexact in flow.\n    const orientation = new OrientationClass();\n    orientation.x = 0;\n    orientation.y = 0;\n    orientation.z = 0;\n    orientation.w = 1;\n    return orientation;\n  }\n}\n\nclass PoseClass {\n  position: Point;\n  orientation: Orientation;\n}\n\n// create a new empty pose object\nexport function emptyPose(): MutablePose {\n  // $FlowFixMe: Classes are inexact in flow.\n  const pose = new PoseClass();\n  pose.position = PointClass.empty();\n  pose.orientation = OrientationClass.empty();\n  return pose;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CursorDefault from \"@mdi/svg/svg/cursor-default.svg\";\nimport TextBoxSearchIcon from \"@mdi/svg/svg/text-box-search.svg\";\nimport * as React from \"react\";\nimport { type MouseEventObject } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport LinkedGlobalVariableList from \"./LinkedGlobalVariableList\";\nimport PointCloudDetails from \"./PointCloudDetails\";\nimport useLinkedGlobalVariables from \"./useLinkedGlobalVariables\";\nimport Checkbox from \"webviz-core/src/components/Checkbox\";\nimport ExpandingToolbar, { ToolGroup, ToolGroupFixedSizePane } from \"webviz-core/src/components/ExpandingToolbar\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport ObjectDetails from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/ObjectDetails\";\nimport TopicLink from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/TopicLink\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport type { SaveConfig, PanelConfig } from \"webviz-core/src/types/panels\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SRow = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 0;\n  margin: 4px 0;\n`;\nexport const SLabel = styled.label`\n  width: ${(props) => (props.width ? `${props.width}px` : \"80px\")};\n  margin: 4px 0;\n  font-size: 10px;\n`;\nexport const SValue = styled.div`\n  color: ${colors.HIGHLIGHT};\n  word-break: break-word;\n`;\nexport const SEmptyState = styled.div`\n  color: ${colors.TEXT_MUTED};\n  line-height: 1.4;\n  margin-bottom: 8px;\n`;\n\nexport const OBJECT_TAB_TYPE = \"Selected object\";\nexport const LINKED_VARIABLES_TAB_TYPE = \"Linked variables\";\nexport type TabType = typeof OBJECT_TAB_TYPE | typeof LINKED_VARIABLES_TAB_TYPE;\n\ntype Props = {|\n  interactionsTabType: ?TabType,\n  setInteractionsTabType: (?TabType) => void,\n  selectedObject: ?MouseEventObject,\n  findTopicInTopicTree: (string) => void,\n|};\n\ntype PropsWithConfig = {|\n  ...Props,\n  disableAutoOpenClickedObject: boolean,\n  saveConfig: SaveConfig<PanelConfig>,\n|};\n\nconst InteractionsBaseComponent = React.memo<PropsWithConfig>(function InteractionsBaseComponent({\n  selectedObject,\n  interactionsTabType,\n  setInteractionsTabType,\n  disableAutoOpenClickedObject,\n  saveConfig,\n  findTopicInTopicTree,\n}: PropsWithConfig) {\n  const { object } = selectedObject || {};\n  const { originalMessage, topic } = object?.interactionData ?? {};\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n\n  const findTopic = React.useCallback(() => findTopicInTopicTree(topic), [findTopicInTopicTree, topic]);\n\n  return (\n    <ExpandingToolbar\n      tooltip=\"Inspect Objects\"\n      icon={\n        <Icon style={{ color: \"white\" }}>\n          <CursorDefault />\n        </Icon>\n      }\n      className={styles.buttons}\n      selectedTab={interactionsTabType}\n      onSelectTab={(newSelectedTab) => setInteractionsTabType(newSelectedTab)}>\n      <ToolGroup name={OBJECT_TAB_TYPE}>\n        <ToolGroupFixedSizePane>\n          {object && originalMessage ? (\n            <>\n              {topic && (\n                <SRow>\n                  <SValue>\n                    <TopicLink topic={topic} />\n                  </SValue>\n                  <Icon\n                    fade\n                    onClick={findTopic}\n                    style={{ margin: \"0 8px\" }}\n                    tooltip=\"Find in Topic Tree\"\n                    dataTest=\"find-in-topic-tree\">\n                    <TextBoxSearchIcon />\n                  </Icon>\n                </SRow>\n              )}\n              {object.clickedPointDetails && <PointCloudDetails pointDetails={object.clickedPointDetails} />}\n              <ObjectDetails selectedObject={originalMessage} topic={topic} />\n            </>\n          ) : (\n            <SEmptyState>Click an object in the 3D view to select it.</SEmptyState>\n          )}\n          <Checkbox\n            label=\"Open this panel automatically\"\n            checked={!disableAutoOpenClickedObject}\n            onChange={() => saveConfig({ disableAutoOpenClickedObject: !disableAutoOpenClickedObject })}\n          />\n        </ToolGroupFixedSizePane>\n      </ToolGroup>\n      <ToolGroup name={LINKED_VARIABLES_TAB_TYPE}>\n        <ToolGroupFixedSizePane>\n          <LinkedGlobalVariableList linkedGlobalVariables={linkedGlobalVariables} />\n        </ToolGroupFixedSizePane>\n      </ToolGroup>\n    </ExpandingToolbar>\n  );\n});\n\n// Wrap the Interactions so that we don't rerender every time any part of the PanelContext config changes, but just the\n// one value that we care about.\nexport default function Interactions(props: Props) {\n  const { saveConfig, config: { disableAutoOpenClickedObject } = {} } = React.useContext(PanelContext) || {};\n  return (\n    <InteractionsBaseComponent\n      {...props}\n      saveConfig={saveConfig}\n      disableAutoOpenClickedObject={disableAutoOpenClickedObject}\n    />\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SCheckbox = styled.div`\n  display: flex;\n  align-items: center;\n  flex-direction: ${(props) => (props.labelDirection === \"top\" ? \"column\" : \"row\")};\n  align-items: ${(props) => (props.labelDirection === \"top\" ? \"flex-start\" : \"center\")};\n  color: ${(props) => (props.disabled ? colors.GRAY : colors.LIGHT1)};\n  cursor: ${(props) => (props.disabled ? \"not-allowed\" : \"pointer\")};\n`;\n\nexport const SLabel = styled.label`\n  margin: ${(props) => (props.labelDirection === \"top\" ? \"6px 6px 6px 0\" : \"6px\")};\n  color: ${(props) => (props.disabled || props.labelDirection === \"top\" ? colors.GRAY : colors.LIGHT1)};\n  cursor: ${(props) => (props.disabled ? \"not-allowed\" : \"pointer\")};\n`;\n\nexport type Props = {\n  checked: boolean,\n  disabled?: boolean,\n  label: string,\n  labelStyle?: { [string]: string | number },\n  labelDirection?: \"top\" | \"left\" | \"right\",\n  tooltip?: string,\n  onChange: (newChecked: boolean) => void,\n  style?: { [string]: string | number },\n  dataTest?: string,\n};\n\nexport default function Checkbox({\n  label,\n  labelStyle,\n  labelDirection = \"right\",\n  checked,\n  tooltip,\n  onChange,\n  disabled,\n  style = {},\n  dataTest,\n}: Props) {\n  const Component = checked ? CheckboxMarkedIcon : CheckboxBlankOutlineIcon;\n  const onClick = React.useCallback(() => {\n    if (!disabled) {\n      onChange(!checked);\n    }\n  }, [checked, disabled, onChange]);\n\n  const styledLabel = (\n    <SLabel labelDirection={labelDirection} disabled={disabled} style={labelStyle}>\n      {label}\n    </SLabel>\n  );\n\n  if (labelDirection === \"top\") {\n    return (\n      <SCheckbox disabled={disabled} labelDirection={labelDirection} style={style}>\n        {styledLabel}\n      </SCheckbox>\n    );\n  }\n\n  return (\n    <SCheckbox disabled={disabled} labelDirection={labelDirection} style={style} onClick={onClick} dataTest={dataTest}>\n      {labelDirection === \"left\" && styledLabel}\n      <Icon small tooltip={tooltip}>\n        <Component />\n      </Icon>\n      {labelDirection === \"right\" && styledLabel}\n    </SCheckbox>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowCollapseIcon from \"@mdi/svg/svg/arrow-collapse.svg\";\nimport cx from \"classnames\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport styles from \"./ExpandingToolbar.module.scss\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\n\nconst PANE_WIDTH = 268;\nconst PANE_HEIGHT = 240;\n\nexport const SToolGroupFixedSizePane = styled.div`\n  overflow-x: hidden;\n  overflow-y: auto;\n  padding: 8px 0;\n`;\n\nexport function ToolGroup<T>({ children }: { name: T, children: React.Node }) {\n  return children;\n}\n\nexport function ToolGroupFixedSizePane({ children }: { children: React.Node }) {\n  return (\n    <SToolGroupFixedSizePane style={{ width: PANE_WIDTH - 28, height: PANE_HEIGHT }}>\n      {children}\n    </SToolGroupFixedSizePane>\n  );\n}\n\ntype Props<T: string> = {|\n  // $FlowFixMe typeof does not work with generics well, getting \"`typeof` can only be used to get the type of variables\"\n  children: React.ChildrenArray<React.Element<typeof ToolGroup<T>>>,\n  className?: ?string,\n  icon: React.Node,\n  onSelectTab: (name: ?T) => void,\n  selectedTab: ?T, // collapse the toolbar if selectedTab is null\n  tooltip: string,\n  style?: StyleObj,\n|};\n\nexport default function ExpandingToolbar<T: string>({\n  children,\n  className,\n  icon,\n  onSelectTab,\n  selectedTab,\n  tooltip,\n  style,\n}: Props<T>) {\n  const expanded = !!selectedTab;\n  if (!expanded) {\n    let selectedTabLocal = selectedTab;\n    if (!selectedTabLocal) {\n      // default to the first child's name if no tab is selected\n      React.Children.forEach(children, (child) => {\n        if (!selectedTabLocal) {\n          selectedTabLocal = child.props.name;\n        }\n      });\n    }\n    return (\n      <div className={className}>\n        <Button tooltip={tooltip} onClick={() => onSelectTab(selectedTabLocal)}>\n          <Icon dataTest={`ExpandingToolbar-${tooltip}`}>{icon}</Icon>\n        </Button>\n      </div>\n    );\n  }\n  let selectedChild;\n  React.Children.forEach(children, (child) => {\n    if (!selectedChild || child.props.name === selectedTab) {\n      selectedChild = child;\n    }\n  });\n  return (\n    <div className={cx(className, styles.expanded)}>\n      <Flex row className={styles.tabBar}>\n        {React.Children.map(children, (child) => {\n          return (\n            <Button\n              className={cx(styles.tab, { [styles.selected]: child === selectedChild })}\n              onClick={() => onSelectTab(child.props.name)}>\n              {child.props.name}\n            </Button>\n          );\n        })}\n        <div className={styles.spaceSeparator} />\n        <Button onClick={() => onSelectTab(null)}>\n          <Icon>\n            <ArrowCollapseIcon />\n          </Icon>\n        </Button>\n      </Flex>\n      <div className={styles.tabBody} style={style}>\n        {selectedChild}\n      </div>\n    </div>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { validationErrorToString, type ValidationResult } from \"webviz-core/shared/validators\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport YAML from \"webviz-core/src/util/yaml\";\n\nconst { useState, useCallback, useRef, useLayoutEffect, useEffect } = React;\n\nexport const EDIT_FORMAT = { JSON: \"json\", YAML: \"yaml\" };\n\nconst SEditBox = styled.div`\n  display: flex;\n  flex-direction: column;\n  min-height: 200px;\n  max-height: 800px;\n`;\n// TODO(Audrey): work with design to update Dropdown UI\nconst STransparentDropdownButton = styled.div`\n  padding-top: 6px;\n  display: inline-flex;\n  button {\n    background: transparent;\n    display: inline-flex;\n  }\n`;\nconst StyledTextarea = styled.textarea`\n  flex: 1 1 auto;\n  resize: none;\n  border: 1px solid ${colors.GRAY};\n`;\nconst SError = styled.div`\n  color: ${colors.RED};\n  padding: 8px 4px;\n`;\n\ntype Value = any;\ntype OnChange = (obj: any) => void;\ntype ParseAndStringifyFn = {\n  stringify: (obj: any) => string,\n  parse: (val: string) => any,\n};\nexport type EditFormat = $Values<typeof EDIT_FORMAT>;\nexport type BaseProps = {\n  dataValidator?: (data: any) => ?ValidationResult,\n  inputStyle?: { [attr: string]: string | number },\n  onChange?: OnChange,\n  onError?: (err: string) => void,\n  value: Value,\n};\ntype Props = BaseProps & {\n  format: EditFormat,\n  children?: React.Node, // addition UI next to the format select\n  onSelectFormat?: (format: EditFormat) => void,\n};\n\n/**\n * The base component for ValidatedInput which handles the value change, data validation\n * and data stringifying/parsing. Any external value change will cause the input string to change\n * and trigger new validations. Only valid internal value change will call onChange. Any data processing\n * and validation error will trigger onError.\n */\nexport function ValidatedInputBase({\n  dataValidator = () => {},\n  inputStyle = {},\n  onChange,\n  onError,\n  parse,\n  stringify,\n  value,\n}: BaseProps & ParseAndStringifyFn) {\n  const [error, setError] = useState<string>(\"\");\n  const [inputStr, setInputStr] = useState<string>(\"\");\n  const prevIncomingVal = useRef(\"\");\n  const inputRef = useRef<?HTMLTextAreaElement>(null);\n  const [isEditing, setIsEditing] = useState<boolean>(false);\n\n  // validate the input string, and setError or call onChange if needed\n  const memorizedInputValidation = useCallback((newInputVal: string, onChangeFcn?: OnChange) => {\n    let newVal;\n    let newError;\n    // parse the empty string directly as empty array or object for validation and onChange callback\n    if (newInputVal.trim() === \"\") {\n      newVal = Array.isArray(value) ? [] : {};\n    } else {\n      try {\n        newVal = parse(newInputVal);\n      } catch (e) {\n        newError = e.message;\n      }\n    }\n\n    if (newError) {\n      setError(newError);\n      return;\n    }\n    setError(\"\"); // clear the previous error\n    const validationResult = dataValidator(newVal);\n    if (validationResult) {\n      setError(validationErrorToString(validationResult));\n      return;\n    }\n    if (onChangeFcn) {\n      onChangeFcn(newVal);\n    }\n  }, [dataValidator, parse, value]);\n\n  // when not in editing mode, whenever the incoming value changes, we'll compare the new value with prevIncomingVal, and reset local state values if they are different\n  useLayoutEffect(() => {\n    if (!isEditing && value !== prevIncomingVal.current) {\n      if (isEqual(value, prevIncomingVal.current)) {\n        return;\n      }\n      let newVal = \"\";\n      let newError;\n      try {\n        newVal = stringify(value);\n      } catch (e) {\n        newError = `Error stringifying the new value, using \"\" as default. ${e.message}`;\n      }\n      setInputStr(newVal);\n      prevIncomingVal.current = value;\n      if (newError) {\n        setError(newError);\n        return;\n      }\n      // try to validate if successfully stringified the new value\n      memorizedInputValidation(newVal);\n    }\n  }, [value, stringify, memorizedInputValidation, isEditing]);\n\n  const handleChange = useCallback((e) => {\n    const val = e.currentTarget && e.currentTarget.value;\n    if (!isEditing) {\n      setIsEditing(true);\n    }\n    setInputStr(val);\n    memorizedInputValidation(val, onChange);\n  }, [isEditing, memorizedInputValidation, onChange]);\n\n  useEffect(() => {\n    if (onError && error) {\n      onError(error);\n    }\n  }, [error, onError]);\n\n  // scroll to the bottom when the text gets too long\n  useLayoutEffect(\n    () => {\n      if (!isEditing) {\n        const inputElem = inputRef.current;\n        if (inputElem) {\n          inputElem.scrollTop = inputElem.scrollHeight;\n        }\n      }\n    },\n    [isEditing, inputStr] // update whenever inputStr changes\n  );\n\n  return (\n    <>\n      <StyledTextarea\n        data-test=\"validated-input\"\n        style={inputStyle}\n        ref={inputRef}\n        value={inputStr}\n        onChange={handleChange}\n      />\n      {error && <SError>{error}</SError>}\n    </>\n  );\n}\n\nexport function JsonInput(props: BaseProps) {\n  function stringify(val) {\n    return JSON.stringify(val, null, 2);\n  }\n  return <ValidatedInputBase parse={JSON.parse} stringify={stringify} {...props} />;\n}\n\nexport function YamlInput(props: BaseProps) {\n  return <ValidatedInputBase parse={YAML.parse} stringify={YAML.stringify} {...props} />;\n}\n\n// An enhanced input component that allows editing values in json or yaml format with custom validations\nexport default function ValidatedInput({ format = EDIT_FORMAT.JSON, onSelectFormat, children, ...rest }: Props) {\n  const InputComponent = format === EDIT_FORMAT.JSON ? JsonInput : YamlInput;\n  return (\n    <Flex col>\n      <Flex row reverse>\n        {children}\n        <STransparentDropdownButton>\n          <Dropdown position=\"right\" value={format} text={format.toUpperCase()} onChange={onSelectFormat}>\n            {Object.keys(EDIT_FORMAT).map((key) => (\n              <option value={EDIT_FORMAT[key]} key={key}>\n                {key}\n              </option>\n            ))}\n          </Dropdown>\n        </STransparentDropdownButton>\n      </Flex>\n      <SEditBox>\n        <InputComponent {...rest} />\n      </SEditBox>\n    </Flex>\n  );\n}\n\n// For component consumers that don't care about maintaining the editFormat state, use this instead\nexport function UncontrolledValidatedInput({ format = EDIT_FORMAT.YAML, ...rest }: Props) {\n  const [editFormat, setEditFormat] = React.useState<EditFormat>(format);\n  return <ValidatedInput {...rest} format={editFormat} onSelectFormat={(newFormat) => setEditFormat(newFormat)} />;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ChevronDownIcon from \"@mdi/svg/svg/chevron-down.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport MagnifyIcon from \"@mdi/svg/svg/magnify.svg\";\nimport LessIcon from \"@mdi/svg/svg/unfold-less-horizontal.svg\";\nimport MoreIcon from \"@mdi/svg/svg/unfold-more-horizontal.svg\";\nimport { clamp, groupBy } from \"lodash\";\nimport Tree from \"rc-tree\";\nimport React, { useCallback, useEffect, useMemo, useRef } from \"react\";\nimport { useSpring, animated } from \"react-spring\";\nimport styled from \"styled-components\";\n\nimport { type Save3DConfig } from \"../index\";\nimport DiffModeSettings from \"./DiffModeSettings\";\nimport NoMatchesSvg from \"./noMatches.svg\";\nimport renderTreeNodes, { SWITCHER_WIDTH } from \"./renderTreeNodes\";\nimport TopicTreeSwitcher, { SWITCHER_HEIGHT } from \"./TopicTreeSwitcher\";\nimport TopicViewModeSelector from \"./TopicViewModeSelector\";\nimport { ROW_HEIGHT } from \"./TreeNodeRow\";\nimport type {\n  DerivedCustomSettingsByKey,\n  GetIsNamespaceCheckedByDefault,\n  GetIsTreeNodeVisibleInScene,\n  GetIsTreeNodeVisibleInTree,\n  NamespacesByTopic,\n  OnNamespaceOverrideColorChange,\n  SceneErrorsByKey,\n  SetCurrentEditingTopic,\n  SetEditingNamespace,\n  TopicDisplayMode,\n  TreeNode,\n  VisibleTopicsCountByKey,\n} from \"./types\";\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport useLinkedGlobalVariables from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport type { StructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst CONTAINER_SPACING = 15;\nconst DEFAULT_WIDTH = 360;\nconst DEFAULT_XS_WIDTH = 240;\n// Computed height--not actually set to the search bar component.\nconst SEARCH_BAR_HEIGHT = 40;\n// Computed height--not actually set to diff mode.\nconst DIFF_MODE_HEIGHT = 42;\nconst SWITCHER_ICON_SIZE = 20;\nexport const TREE_SPACING = 8;\nconst MAX_CONTAINER_WIDTH_RATIO = 0.9;\n\nconst STopicTreeWrapper = styled.div`\n  position: absolute;\n  top: ${CONTAINER_SPACING}px;\n  left: ${CONTAINER_SPACING}px;\n  z-index: 102;\n  max-width: ${MAX_CONTAINER_WIDTH_RATIO * 100}%;\n\n  // Allow clicks right above the TopicTree to close it\n  pointer-events: none;\n`;\n\nconst STopicTree = styled(animated.div)`\n  position: relative;\n  color: ${colors.TEXT};\n  border-radius: 6px;\n  background-color: ${colors.DARK2};\n  padding-bottom: 6px;\n  max-width: 100%;\n  overflow: auto;\n  pointer-events: auto;\n`;\n\nconst STopicTreeInner = styled.div`\n  .rc-tree {\n    li {\n      ul {\n        padding: 0 0 0 ${SWITCHER_WIDTH}px;\n      }\n    }\n    .rc-tree-node-content-wrapper {\n      cursor: unset;\n    }\n    /* Make the chevron icon transition nicely between pointing down and right. */\n    .rc-tree-switcher {\n      height: ${ROW_HEIGHT}px;\n      transition: transform 80ms ease-in-out;\n    }\n    .rc-tree-switcher_close {\n      transform: rotate(-90deg);\n    }\n    .rc-tree-switcher_open {\n      transform: rotate(0deg);\n    }\n    /* Hide the chevron switcher icon when it's not usable. */\n    .rc-tree-switcher-noop {\n      visibility: hidden;\n    }\n    .rc-tree-treenode {\n      display: flex;\n      padding: 0 ${({ isXSWidth }) => (isXSWidth ? 0 : TREE_SPACING)}px;\n      &:hover {\n        background: ${colors.DARK4};\n      }\n      &.rc-tree-treenode-disabled {\n        color: ${colors.TEXT_MUTED};\n        cursor: unset;\n        .rc-tree-node-content-wrapper {\n          cursor: unset;\n        }\n      }\n    }\n    .rc-tree-indent {\n      width: 100%;\n    }\n    .rc-tree-indent-unit {\n      width: 24px;\n    }\n    .rc-tree-treenode-switcher-close,\n    .rc-tree-treenode-switcher-open {\n      .rc-tree-node-content-wrapper {\n        padding: 0;\n      }\n    }\n  }\n`;\n\nconst STopicTreeHeader = styled.div`\n  position: sticky;\n  top: 0;\n  z-index: 1;\n  display: flex;\n  padding-left: 8px;\n  align-items: center;\n  background-color: ${colors.DARK5};\n  border-top-left-radius: 6px;\n  border-top-right-radius: 6px;\n`;\n\nconst SFilter = styled.div`\n  display: flex;\n  padding: 8px 4px;\n  align-items: center;\n  flex: 1;\n`;\n\nconst SInput = styled.input`\n  height: 24px;\n  background: transparent;\n  flex: 1;\n  overflow: auto;\n  font-size: 12px;\n  margin-left: 4px;\n  padding: 4px 8px;\n  min-width: 80px;\n  border: none;\n  :focus,\n  :hover {\n    outline: none;\n    background: transparent;\n  }\n`;\n\nconst SSwitcherIcon = styled.div`\n  width: ${SWITCHER_WIDTH}px;\n  height: ${ROW_HEIGHT}px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst SNoMatches = styled.div`\n  margin-top: 57px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 74px;\n`;\n\nconst SNoMatchesText = styled.div`\n  margin-top: 25px;\n  font-size: 16px;\n  width: 205px;\n  text-align: center;\n  line-height: 130%;\n`;\n\ntype SharedProps = {|\n  allKeys: string[],\n  availableNamespacesByTopic: NamespacesByTopic,\n  checkedKeys: string[],\n  derivedCustomSettingsByKey: DerivedCustomSettingsByKey,\n  expandedKeys: string[],\n  filterText: string,\n  getIsNamespaceCheckedByDefault: GetIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene: GetIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree: GetIsTreeNodeVisibleInTree,\n  hasFeatureColumn: boolean,\n  isPlaying?: boolean,\n  onExitTopicTreeFocus: () => void,\n  onNamespaceOverrideColorChange: OnNamespaceOverrideColorChange,\n  pinTopics: boolean,\n  diffModeEnabled: boolean,\n  rootTreeNode: TreeNode,\n  saveConfig: Save3DConfig,\n  sceneErrorsByKey: SceneErrorsByKey,\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  setEditingNamespace: SetEditingNamespace,\n  setFilterText: (string) => void,\n  setShowTopicTree: (boolean | ((boolean) => boolean)) => void,\n  shouldExpandAllKeys: boolean,\n  showTopicTree: boolean,\n  structuralDatatypes: StructuralDatatypes,\n  topicDisplayMode: TopicDisplayMode,\n  visibleTopicsCountByKey: VisibleTopicsCountByKey,\n|};\n\ntype Props = {|\n  ...SharedProps,\n  containerHeight: number,\n  containerWidth: number,\n|};\n\ntype BaseProps = {|\n  ...SharedProps,\n  showDiffMode: boolean,\n  treeWidth: number,\n  treeHeight: number,\n|};\n\nfunction TopicTree({\n  allKeys,\n  availableNamespacesByTopic,\n  checkedKeys,\n  derivedCustomSettingsByKey,\n  expandedKeys,\n  filterText,\n  getIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree,\n  hasFeatureColumn,\n  onNamespaceOverrideColorChange,\n  pinTopics,\n  diffModeEnabled,\n  rootTreeNode,\n  saveConfig,\n  sceneErrorsByKey,\n  setCurrentEditingTopic,\n  setEditingNamespace,\n  setFilterText,\n  setShowTopicTree,\n  shouldExpandAllKeys,\n  showTopicTree,\n  showDiffMode,\n  structuralDatatypes,\n  topicDisplayMode,\n  treeHeight,\n  treeWidth,\n  visibleTopicsCountByKey,\n}: BaseProps) {\n  const renderTopicTree = pinTopics || showTopicTree;\n  const scrollContainerRef = useRef<?HTMLDivElement>();\n  const checkedKeysSet = useMemo(() => new Set(checkedKeys), [checkedKeys]);\n\n  const filterTextFieldRef = useRef<?HTMLInputElement>();\n\n  // HACK: rc-tree does not auto expand dynamic tree nodes. Create a copy of expandedNodes\n  // to ensure newly added nodes such as `uncategorized` are properly expanded:\n  // https://github.com/ant-design/ant-design/issues/18012\n  const expandedKeysRef = useRef(expandedKeys);\n  const hasRootNodeChanged = useChangeDetector([rootTreeNode], false);\n  expandedKeysRef.current = hasRootNodeChanged ? [...expandedKeys] : expandedKeys;\n\n  useEffect(() => {\n    // auto focus whenever first rendering the topic tree\n    if (renderTopicTree && filterTextFieldRef.current) {\n      const filterTextFieldEl: HTMLInputElement = filterTextFieldRef.current;\n      filterTextFieldEl.focus();\n      filterTextFieldEl.select();\n    }\n  }, [renderTopicTree]);\n\n  const topLevelNodesCollapsed = useMemo(() => {\n    const topLevelChildren = rootTreeNode.type === \"group\" ? rootTreeNode.children : [];\n    const topLevelKeys = topLevelChildren.map(({ key }) => key);\n    return topLevelKeys.every((key) => !expandedKeys.includes(key));\n  }, [expandedKeys, rootTreeNode]);\n\n  const showNoMatchesState = !getIsTreeNodeVisibleInTree(rootTreeNode.key);\n\n  const isXSWidth = treeWidth < DEFAULT_XS_WIDTH;\n  const headerRightIconStyle = { margin: `4px ${(isXSWidth ? 0 : TREE_SPACING) + 2}px 4px 8px` };\n\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  const linkedGlobalVariablesByTopic = groupBy(linkedGlobalVariables, ({ topic }) => topic);\n\n  // Close the TopicTree if the user hits the \"Escape\" key\n  const onKeyDown = useCallback((event: SyntheticKeyboardEvent<HTMLInputElement>) => {\n    if (event.key === \"Escape\" && document.activeElement) {\n      document.activeElement.blur();\n      setShowTopicTree(false);\n    }\n  }, [setShowTopicTree]);\n\n  return (\n    <STopicTreeInner style={{ width: treeWidth }} isXSWidth={isXSWidth}>\n      <STopicTreeHeader>\n        <SFilter>\n          <Icon style={{ color: \"rgba(255,255,255, 0.3)\" }}>\n            <MagnifyIcon style={{ width: 16, height: 16 }} />\n          </Icon>\n          <SInput\n            size={3}\n            data-test=\"topic-tree-filter-input\"\n            value={filterText}\n            placeholder=\"Type to filter\"\n            onChange={(event) => setFilterText(event.target.value)}\n            onKeyDown={onKeyDown}\n            ref={filterTextFieldRef}\n          />\n        </SFilter>\n        {rootTreeNode.providerAvailable && (\n          <TopicViewModeSelector isXSWidth={isXSWidth} saveConfig={saveConfig} topicDisplayMode={topicDisplayMode} />\n        )}\n        {!filterText && (\n          <Icon\n            dataTest=\"expand-all-icon\"\n            tooltip={topLevelNodesCollapsed ? \"Expand all\" : \"Collapse all\"}\n            small\n            fade\n            onClick={() => {\n              saveConfig({ expandedKeys: topLevelNodesCollapsed ? allKeys : [] });\n            }}\n            style={headerRightIconStyle}>\n            {topLevelNodesCollapsed ? <MoreIcon /> : <LessIcon />}\n          </Icon>\n        )}\n        {filterText && (\n          <Icon dataTest=\"clear-filter-icon\" small fade style={headerRightIconStyle} onClick={() => setFilterText(\"\")}>\n            <CloseIcon />\n          </Icon>\n        )}\n      </STopicTreeHeader>\n      {showDiffMode && <DiffModeSettings enabled={diffModeEnabled} saveConfig={saveConfig} />}\n      <div ref={scrollContainerRef} style={{ overflow: \"auto\", width: treeWidth }}>\n        {showNoMatchesState ? (\n          <SNoMatches>\n            <NoMatchesSvg />\n            <SNoMatchesText>No results found. Try searching a different term.</SNoMatchesText>\n          </SNoMatches>\n        ) : (\n          <Tree\n            treeData={renderTreeNodes({\n              availableNamespacesByTopic,\n              checkedKeysSet,\n              children: rootTreeNode.children || [],\n              getIsTreeNodeVisibleInScene,\n              getIsTreeNodeVisibleInTree,\n              getIsNamespaceCheckedByDefault,\n              hasFeatureColumn,\n              isXSWidth,\n              onNamespaceOverrideColorChange,\n              sceneErrorsByKey,\n              setCurrentEditingTopic,\n              derivedCustomSettingsByKey,\n              setEditingNamespace,\n              structuralDatatypes,\n              topicDisplayMode,\n              visibleTopicsCountByKey,\n              width: treeWidth,\n              filterText,\n              linkedGlobalVariablesByTopic,\n              diffModeEnabled: hasFeatureColumn && diffModeEnabled,\n            })}\n            height={treeHeight}\n            itemHeight={ROW_HEIGHT}\n            // Disable motion because it seems to cause a bug in the `rc-tree` (used under the hood by `antd` for\n            // the tree). This bug would result in nodes no longer being rendered after a search.\n            motion={null}\n            selectable={false}\n            onExpand={(newExpandedKeys) => {\n              if (!shouldExpandAllKeys) {\n                saveConfig({ expandedKeys: newExpandedKeys });\n              }\n            }}\n            expandedKeys={shouldExpandAllKeys ? allKeys : expandedKeysRef.current}\n            autoExpandParent={false /* Set autoExpandParent to true when filtering */}\n            switcherIcon={\n              <SSwitcherIcon style={filterText ? { visibility: \"hidden\" } : {}}>\n                <ChevronDownIcon\n                  fill=\"currentColor\"\n                  style={{ width: SWITCHER_ICON_SIZE, height: SWITCHER_ICON_SIZE }}\n                />\n              </SSwitcherIcon>\n            }\n          />\n        )}\n      </div>\n    </STopicTreeInner>\n  );\n}\n\n// A wrapper that can be resized horizontally, and it dynamically calculates the width of the base topic tree component.\nfunction TopicTreeWrapper({\n  containerWidth,\n  containerHeight,\n  pinTopics,\n  showTopicTree,\n  hasFeatureColumn,\n  ...rest\n}: Props) {\n  const defaultTreeWidth = clamp(containerWidth, DEFAULT_XS_WIDTH, DEFAULT_WIDTH);\n  const renderTopicTree = pinTopics || showTopicTree;\n  const { sceneErrorsByKey, saveConfig, setShowTopicTree, isPlaying } = rest;\n  const springProps = useSpring({\n    native: true,\n    unique: true,\n    precision: 0.1,\n    // Skip the animation if we are playing because it looks nicer than having the animation lag\n    immediate: isPlaying,\n    to: { opacity: renderTopicTree ? 1 : 0, transformX: renderTopicTree ? 0 : -20 },\n    config: { tension: 340, friction: 26, clamp: true },\n  });\n\n  const showDiffMode = hasFeatureColumn;\n  // TODO(troy): Remove hardcoded heights. We could use the <Dimension />\n  // component on top of the topic tree for a cleaner result.\n  const treeHeightRaw = containerHeight - SEARCH_BAR_HEIGHT - SWITCHER_HEIGHT - CONTAINER_SPACING * 2;\n  const treeHeight = showDiffMode ? treeHeightRaw - DIFF_MODE_HEIGHT : treeHeightRaw;\n\n  return (\n    <STopicTreeWrapper style={{ height: containerHeight - CONTAINER_SPACING * 3 }} className=\"ant-component\">\n      <Dimensions>\n        {({ width }) => (\n          <div\n            style={{\n              width: defaultTreeWidth,\n              resize: renderTopicTree ? \"horizontal\" : \"none\",\n              overflow: renderTopicTree ? \"hidden auto\" : \"visible\",\n              minWidth: DEFAULT_XS_WIDTH,\n              maxWidth: containerWidth - 100,\n            }}\n            onClick={(ev) => ev.stopPropagation()}>\n            <TopicTreeSwitcher\n              showErrorBadge={!renderTopicTree && Object.keys(sceneErrorsByKey).length > 0}\n              pinTopics={pinTopics}\n              renderTopicTree={renderTopicTree}\n              saveConfig={saveConfig}\n              setShowTopicTree={setShowTopicTree}\n            />\n            <STopicTree\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                pointerEvents: renderTopicTree ? \"auto\" : \"none\",\n                opacity: springProps.opacity,\n                transform: springProps.transformX.interpolate((x) =>\n                  x === 0 ? \"none\" : `translate3d(${x}px, 0px, 0px)`\n                ),\n              }}>\n              {renderTopicTree && (\n                <TopicTree\n                  {...rest}\n                  pinTopics={pinTopics}\n                  showTopicTree={showTopicTree}\n                  treeWidth={width}\n                  treeHeight={treeHeight}\n                  showDiffMode={showDiffMode}\n                  hasFeatureColumn={hasFeatureColumn}\n                />\n              )}\n            </STopicTree>\n          </div>\n        )}\n      </Dimensions>\n    </STopicTreeWrapper>\n  );\n}\n\nexport default React.memo<Props>(TopicTreeWrapper);\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\n\nimport { type Save3DConfig } from \"..\";\n\nexport const TOPIC_DISPLAY_MODES = {\n  SHOW_ALL: {\n    value: \"SHOW_ALL\",\n    label: \"All\",\n  },\n  SHOW_AVAILABLE: {\n    value: \"SHOW_AVAILABLE\",\n    label: \"Available\",\n  },\n  SHOW_SELECTED: {\n    value: \"SHOW_SELECTED\",\n    label: \"Visible\",\n  },\n};\n\nconst DEFAULT_DISPLAY_MODE = TOPIC_DISPLAY_MODES.SHOW_ALL.value;\nconst DEFAULT_BTN_WIDTH = 88; // Width for the longest selected option in dropdown.\nconst XS_WIDTH_BTN_WIDTH = 48;\n\nconst dropdownOptions = Object.keys(TOPIC_DISPLAY_MODES)\n  .filter((item) => item !== \"SHOW_TREE\")\n  .map((key) => ({\n    label: TOPIC_DISPLAY_MODES[key].label,\n    value: TOPIC_DISPLAY_MODES[key].value,\n  }));\n\nexport type TopicDisplayMode = $Keys<typeof TOPIC_DISPLAY_MODES>;\n\nconst STopicViewModeSelector = styled.div`\n  div {\n    button {\n      justify-content: space-between;\n      line-height: 1.4;\n    }\n  }\n`;\ntype Props = {|\n  isXSWidth: boolean,\n  topicDisplayMode: TopicDisplayMode,\n  saveConfig: Save3DConfig,\n|};\n\nexport default function TopicViewModeSelector({\n  isXSWidth,\n  topicDisplayMode: topicDisplayModeProp,\n  saveConfig,\n}: Props) {\n  const topicDisplayMode = TOPIC_DISPLAY_MODES[topicDisplayModeProp] ? topicDisplayModeProp : DEFAULT_DISPLAY_MODE;\n  return (\n    <STopicViewModeSelector>\n      <Dropdown\n        btnStyle={{ width: isXSWidth ? XS_WIDTH_BTN_WIDTH : DEFAULT_BTN_WIDTH }}\n        position=\"below\"\n        value={topicDisplayMode}\n        text={TOPIC_DISPLAY_MODES[topicDisplayMode].label}\n        onChange={(newValue) => saveConfig({ topicDisplayMode: newValue })}>\n        {dropdownOptions.map(({ label, value }) => (\n          <option value={value} key={value}>\n            {label}\n          </option>\n        ))}\n      </Dropdown>\n    </STopicViewModeSelector>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { uniqBy, sortedUniqBy, max, min, isEqual, throttle } from \"lodash\";\nimport { useEffect, useCallback, useState } from \"react\";\nimport type { Time } from \"rosbag\";\nimport uuid from \"uuid\";\n\nimport type { MessageHistoryItem } from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport type { MessagePathDataItem } from \"webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems\";\nimport { type ScaleBounds } from \"webviz-core/src/components/ReactChartjs/zoomAndPanHelpers\";\nimport { objectValues } from \"webviz-core/src/util\";\nimport { isBobject, maybeGetBobjectHeaderStamp } from \"webviz-core/src/util/binaryObjects\";\nimport { useDeepChangeDetector, useForceUpdate } from \"webviz-core/src/util/hooks\";\nimport { defaultGetHeaderStamp } from \"webviz-core/src/util/synchronizeMessages\";\n\nexport type Bounds = {| minX: ?number, maxX: ?number |};\n\nconst boundsById: { [string]: Bounds } = {};\nconst forceUpdateById: { [string]: () => any } = {};\nlet output: Bounds = { minX: undefined, maxX: undefined };\nlet hasRenderedIds = new Set();\nconst THROTTLE_TIME_MS = 500;\nconst throttledForceUpdate = throttle(\n  (id?: string) => {\n    // Throttle updates because it's not imporant that components update immediately and calling `forceUpdate` often\n    // lead to suboptimal performance. Most of the time, synced plots will update within THROTTLE_TIME_MS anyways,\n    // making a forceUpdate unncessary.\n    Object.keys(forceUpdateById).forEach((forceUpdateId) => {\n      if (id !== forceUpdateId && !hasRenderedIds.has(forceUpdateId)) {\n        forceUpdateById[forceUpdateId]();\n      }\n    });\n  },\n  THROTTLE_TIME_MS,\n  { leading: false, trailing: true }\n);\n// If a chart updates when it is syncing its bounds, this will update all charts' bounds.\nexport const useSyncedTimeAxis = (bounds: Bounds, isSynced: boolean): Bounds => {\n  const [id] = useState(uuid.v4());\n  const forceUpdate = useForceUpdate();\n  if (isSynced) {\n    boundsById[id] = bounds;\n    forceUpdateById[id] = forceUpdate;\n    hasRenderedIds.add(id);\n  }\n\n  const recompute = useCallback(() => {\n    const allBounds = objectValues(boundsById);\n    const calculatedBounds = {\n      minX: min(allBounds.map(({ minX }) => (minX == null ? undefined : minX))),\n      maxX: max(allBounds.map(({ maxX }) => (maxX == null ? undefined : maxX))),\n    };\n    if (!isEqual(output, calculatedBounds)) {\n      output = calculatedBounds;\n      hasRenderedIds = new Set();\n      throttledForceUpdate(id);\n    }\n  }, [id]);\n\n  // Recompute and potentially update all subscribed components if the bounds update.\n  const hasUpdated = useDeepChangeDetector([bounds], true);\n  if (hasUpdated && isSynced) {\n    recompute();\n  }\n\n  // When this component unmounts, no longer update it.\n  useEffect(() => {\n    return () => {\n      if (isSynced) {\n        delete boundsById[id];\n        delete forceUpdateById[id];\n        recompute();\n      }\n    };\n  }, [id, isSynced, recompute]);\n\n  return output;\n};\n\nexport type TooltipItem = {|\n  queriedData: MessagePathDataItem[],\n  receiveTime: Time,\n  headerStamp: ?Time,\n|};\n\nexport type TimeBasedChartTooltipData = {|\n  x: number,\n  y: number | string,\n  datasetKey?: string,\n  item: TooltipItem,\n  path: string,\n  value: number | boolean | string,\n  constantName?: ?string,\n  startTime: Time,\n  source?: ?number,\n|};\n\nexport type DataPoint = {|\n  x: number,\n  y: number | string,\n  label?: string,\n  labelColor?: string,\n|};\n\ntype Point = $ReadOnly<{\n  x: number,\n  y: number | string,\n}>;\n\ntype Datum = $ReadOnly<{\n  data: Point,\n  colors: ?string,\n  display: ?boolean | ?string,\n  pointBackgroundColor: ?string,\n}>;\n\nexport type DataSet = $ReadOnly<{\n  data: $ReadOnlyArray<Point>,\n  label: string,\n  borderDash?: $ReadOnlyArray<number>,\n  colors?: (?string)[],\n  datalabels?: { display: (?boolean | ?string)[] },\n  pointBackgroundColor?: string | (?string)[],\n  color?: string,\n  showLine?: boolean,\n}>;\n\nexport const getTooltipItemForMessageHistoryItem = (item: MessageHistoryItem): TooltipItem => {\n  const { message } = item.message;\n  const headerStamp = isBobject(message) ? maybeGetBobjectHeaderStamp(message) : defaultGetHeaderStamp(message);\n  return { queriedData: item.queriedData, receiveTime: item.message.receiveTime, headerStamp };\n};\n\nconst STEP_SIZES = [0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1, 2, 5, 10, 15, 30, 60];\nexport const stepSize = ({ min: minValue, max: maxValue, minAlongAxis, maxAlongAxis }: ScaleBounds) => {\n  // Pick the smallest step size that gives lines greater than 50px apart\n  const secondsPer50Pixels = 50 * ((maxValue - minValue) / (maxAlongAxis - minAlongAxis));\n  return STEP_SIZES.find((step) => step > secondsPer50Pixels) || 60;\n};\n\nexport const scalePerPixel = (bounds: ?ScaleBounds): ?number =>\n  bounds && Math.abs(bounds.max - bounds.min) / Math.abs(bounds.maxAlongAxis - bounds.minAlongAxis);\nconst screenCoord = (value, valuePerPixel) => (valuePerPixel == null ? value : Math.trunc(value / valuePerPixel));\nconst datumStringPixel = (\n  { data: { x, y }, colors, display, pointBackgroundColor }: Datum,\n  xScale: ?number,\n  yScale: ?number\n): string =>\n  `\n  ${screenCoord(x, xScale)},\n  ${typeof y === \"string\" ? y : screenCoord(y, yScale)},\n  ${colors ?? \"\"},\n  ${display ? display.toString() : \"\"},\n  ${pointBackgroundColor ?? \"\"}\n  `;\n\n// Exported for tests\nexport const filterDatasets = (\n  datasets: $ReadOnlyArray<DataSet>,\n  linesToHide: { [string]: boolean },\n  xScalePerPixel: ?number,\n  yScalePerPixel: ?number\n): DataSet[] =>\n  datasets\n    // Only draw enabled lines. Needed for correctness.\n    .filter(({ label }) => !linesToHide[label])\n    // Remove redundant points to make drawing the chart more efficient.\n    .map(\n      (dataset): DataSet => {\n        // grab values from dataset\n        // if there is only one value, these are strings\n        // if there are multiple values, they are arrays of strings\n        const oldData = dataset.data;\n        const oldColors: ?((?string)[]) = dataset.colors;\n        // display is usually a string[], but we unshift a bool to declare whether or not to show labels\n        const oldDisplay: ?boolean | ?string | (?boolean | ?string)[] = dataset?.datalabels?.display;\n        const oldPointBackgroundColor: ?string | (?string)[] = dataset.pointBackgroundColor;\n\n        // check if values from dataset are non-empty arrays\n        // if it is an array, add it to the mapped datapoints to uniq it\n        // if not an array, pass the value through\n        const includeColors = Array.isArray(oldColors) && oldColors.length;\n        const includeDisplay = Array.isArray(oldDisplay) && oldDisplay.length;\n        const includePointBackgroundColor = Array.isArray(oldPointBackgroundColor) && oldPointBackgroundColor.length;\n\n        // need to turn this data into a single array so we can pass it through uniq\n        const groupedData: Datum[] = oldData.map((datum, i) => {\n          return {\n            data: datum,\n            // if we don't put Array.isArray here, flow complains\n            colors: Array.isArray(oldColors) ? oldColors[i] : undefined,\n            display: Array.isArray(oldDisplay) ? oldDisplay[i] : undefined,\n            pointBackgroundColor: Array.isArray(oldPointBackgroundColor) ? oldPointBackgroundColor[i] : undefined,\n          };\n        });\n\n        let uniqData;\n\n        // For line charts, just remove adjacent points on top of each other so we can draw self-\n        // intersecting (loopy) lines.\n        if (dataset.showLine) {\n          uniqData = sortedUniqBy(groupedData, (datum) => datumStringPixel(datum, xScalePerPixel, yScalePerPixel));\n        } else {\n          // For scatter charts there's no point in drawing any overlapping points.\n          uniqData = uniqBy(groupedData, (datum) => datumStringPixel(datum, xScalePerPixel, yScalePerPixel));\n        }\n\n        const result = { ...dataset };\n\n        // break uniqData back into 4 separate arrays\n        result.data = uniqData.map(({ data }) => data);\n        if (includeColors) {\n          result.colors = uniqData.map(({ colors }) => colors);\n        }\n        if (includeDisplay) {\n          result.datalabels = {\n            display: uniqData.map(({ display }) => display),\n          };\n        }\n        if (includePointBackgroundColor) {\n          result.pointBackgroundColor = uniqData.map(({ pointBackgroundColor }) => pointBackgroundColor);\n        }\n\n        return result;\n      }\n    );\n\nexport const useForceRerenderOnVisibilityChange = () => {\n  const forceUpdate = useForceUpdate();\n\n  const onVisibilityChange = useCallback(() => {\n    if (document.visibilityState === \"visible\") {\n      // HACK: There is a Chrome bug that causes 2d canvas elements to get cleared when the page\n      // becomes hidden on certain hardware:\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=588434\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=591374\n      // We can hack around this by forcing a re-render when the page becomes visible again.\n      // There may be other canvases that this affects, but these seemed like the most important.\n      // Ideally we can find a global workaround but we're not sure there is one  can't just\n      // twiddle the width/height attribute of the canvas as suggested in one of the comments on\n      // a chrome bug; it seems like you really have to redraw the frame from scratch.\n      forceUpdate();\n    }\n  }, [forceUpdate]);\n  useEffect(() => {\n    document.addEventListener(\"visibilitychange\", onVisibilityChange);\n    return () => {\n      document.removeEventListener(\"visibilitychange\", onVisibilityChange);\n    };\n  }, [onVisibilityChange]);\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport tinycolor from \"tinycolor2\";\n\nexport const toolsColorScheme = {\n  base: {\n    dark: \"#1F1E27\",\n    medium: \"#8B8B8D\",\n    light: \"#F7F7F3\",\n  },\n  red: {\n    dark: \"#F24366\",\n    medium: \"#ff7c96\",\n    light: \"#FFAABB\",\n  },\n  blue: {\n    dark: \"#1b83ec\",\n    medium: \"#4e98e2\",\n    light: \"#77AADD\",\n  },\n  paleGreen: {\n    dark: \"#B4CC00\",\n    medium: \"#cad660\",\n    light: \"#CDD67E\",\n  },\n  orange: {\n    dark: \"#ea531f\",\n    medium: \"#f5774d\",\n    light: \"#faa487\",\n  },\n  cyan: {\n    dark: \"#22b5ff\",\n    medium: \"#61cbff\",\n    light: \"#99DDFF\",\n  },\n  green: {\n    dark: \"#05d27d\",\n    medium: \"#5cd6a9\",\n    light: \"#8de0c9\",\n  },\n  purple: {\n    dark: \"#6E51EE\",\n    medium: \"#a395e2\",\n    light: \"#c7c0e7\",\n  },\n  yellow: {\n    dark: \"#EDCC28\",\n    medium: \"#f7df71\",\n    light: \"#f1e4a\",\n  },\n};\n\nexport const grey = tinycolor(`hsv(0, 0%, 75%)`).toHexString();\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport styled from \"styled-components\";\n\nexport const PanelToolbarLabel = styled.label`\n  display: block;\n  padding-bottom: 5px;\n`;\n\nexport const PanelToolbarInput = styled.input`\n  width: 100%;\n  margin: 0;\n`;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { uniq } from \"lodash\";\nimport React, { useCallback } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport stringHash from \"string-hash\";\nimport styled, { css } from \"styled-components\";\nimport tinycolor from \"tinycolor2\";\n\nimport helpContent from \"./index.help.md\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport MessageHistoryDEPRECATED, { type MessageHistoryData } from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TimeBasedChart from \"webviz-core/src/components/TimeBasedChart\";\nimport {\n  getTooltipItemForMessageHistoryItem,\n  type TimeBasedChartTooltipData,\n  type DataPoint,\n} from \"webviz-core/src/components/TimeBasedChart/utils\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport mixins from \"webviz-core/src/styles/mixins.module.scss\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { positiveModulo } from \"webviz-core/src/util\";\nimport { darkColor, lineColors } from \"webviz-core/src/util/plotColors\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\nimport { subtractTimes, toSec } from \"webviz-core/src/util/time\";\nimport { grey } from \"webviz-core/src/util/toolsColorScheme\";\n\nexport const transitionableRosTypes = [\n  \"bool\",\n  \"int8\",\n  \"uint8\",\n  \"int16\",\n  \"uint16\",\n  \"int32\",\n  \"uint32\",\n  \"int64\",\n  \"uint64\",\n  \"string\",\n  \"json\",\n];\n\nconst fontFamily = \"'Inter UI', -apple-system, sans-serif\";\nconst fontSize = 10;\nconst fontWeight = \"bold\";\n\nconst SRoot = styled.div`\n  display: flex;\n  flex-grow: 1;\n  z-index: 0; // create new stacking context\n  overflow: hidden;\n`;\n\nconst SAddButton = styled.div`\n  position: absolute;\n  top: 30px;\n  right: 5px;\n  opacity: ${({ show }) => (show ? 1 : 0)};\n  transition: opacity 0.1s ease-in-out;\n  z-index: 1;\n`;\n\nconst SChartContainerOuter = styled.div`\n  width: 100%;\n  flex-grow: 1;\n  overflow-x: hidden;\n  overflow-y: auto;\n`;\n\nconst SChartContainerInner = styled.div`\n  position: relative;\n  margin-top: 10px;\n`;\n\nconst inputColor = tinycolor(colors.DARK3)\n  .setAlpha(0.7)\n  .toHexString();\nconst inputColorBright = tinycolor(colors.DARK3)\n  .lighten(8)\n  .toHexString();\nconst inputLeft = 20;\nconst SInputContainer = styled.div`\n  display: flex;\n  position: absolute;\n  padding-left: ${inputLeft}px;\n  margin-top: -2px;\n  height: 20px;\n  padding-right: 4px;\n  max-width: calc(100% - ${inputLeft}px);\n  min-width: min(100%, 150px); // Don't let it get too small.\n  overflow: hidden;\n  line-height: 20px;\n\n  &:hover {\n    background: ${inputColor};\n  }\n\n  // Move over the first input on hover for the toolbar.\n  ${({ shrink }) =>\n    shrink &&\n    css`\n      max-width: calc(100% - 150px);\n    `}\n`;\n\nconst SInputDelete = styled.div`\n  display: none;\n  position: absolute;\n  left: ${inputLeft}px;\n  transform: translateX(-100%);\n  user-select: none;\n  height: 20px;\n  line-height: 20px;\n  padding: 0 6px;\n  background: ${inputColor};\n  cursor: pointer;\n\n  &:hover {\n    background ${inputColorBright};\n  }\n\n  ${SInputContainer}:hover & {\n    display: block;\n  }\n`;\n\nconst yAxes = [\n  {\n    ticks: {\n      fontFamily: mixins.monospaceFont,\n      fontSize: 10,\n      fontColor: \"#eee\",\n      maxRotation: 0,\n    },\n    type: \"category\",\n    offset: true,\n  },\n];\n\nconst plugins = {\n  datalabels: {\n    anchor: \"center\",\n    align: -45,\n    offset: 6,\n    clip: true,\n    font: {\n      family: fontFamily,\n      size: fontSize,\n      weight: fontWeight,\n    },\n  },\n  multicolorLineYOffset: 6,\n};\n\nconst scaleOptions = {\n  // Hide all y-axis ticks since each bar on the y-axis is just a separate path.\n  yAxisTicks: \"hide\",\n};\n\nexport type StateTransitionPath = { value: string, timestampMethod: TimestampMethod };\nexport type StateTransitionConfig = { paths: StateTransitionPath[] };\n\nexport function openSiblingStateTransitionsPanel(\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n  topicName: string\n) {\n  openSiblingPanel(\"StateTransitions\", (config: StateTransitionConfig) => {\n    return ({\n      ...config,\n      paths: uniq(config.paths.concat([{ value: topicName, enabled: true, timestampMethod: \"receiveTime\" }])),\n    }: StateTransitionConfig);\n  });\n}\n\ntype Props = {\n  config: StateTransitionConfig,\n  saveConfig: ($Shape<StateTransitionConfig>) => void,\n  isHovered: boolean,\n};\n\nconst StateTransitions = (props: Props) => {\n  const { config, saveConfig, isHovered } = props;\n  const { paths } = config;\n  const onlyTopicsHeight = paths.length * 55;\n  const heightPerTopic = onlyTopicsHeight / paths.length;\n  const xAxisHeight = 30;\n  const height = Math.max(80, onlyTopicsHeight + xAxisHeight);\n\n  const onInputChange = useCallback((value: string, index: ?number) => {\n    if (index == null) {\n      throw new Error(\"index not set\");\n    }\n    const newPaths = config.paths.slice();\n    newPaths[index] = { ...newPaths[index], value: value.trim() };\n    saveConfig({ paths: newPaths });\n  }, [config.paths, saveConfig]);\n\n  const onInputTimestampMethodChange = useCallback((value: TimestampMethod, index: ?number) => {\n    if (index == null) {\n      throw new Error(\"index not set\");\n    }\n    const newPaths = config.paths.slice();\n    newPaths[index] = { ...newPaths[index], timestampMethod: value };\n    saveConfig({ paths: newPaths });\n  }, [config.paths, saveConfig]);\n\n  return (\n    <SRoot>\n      <PanelToolbar floating helpContent={helpContent} />\n      <SAddButton show={isHovered}>\n        <Button\n          onClick={() =>\n            saveConfig({\n              paths: [...config.paths, { value: \"\", timestampMethod: \"receiveTime\" }],\n            })\n          }>\n          add\n        </Button>\n      </SAddButton>\n      <MessageHistoryDEPRECATED paths={paths.map(({ value }) => value)}>\n        {({ itemsByPath, startTime }: MessageHistoryData) => {\n          const tooltips = [];\n          const data = {\n            yLabels: paths.map((_path, pathIndex) => pathIndex.toString()),\n            datasets: paths.map(({ value: path, timestampMethod }, pathIndex) => {\n              const dataItem = {\n                borderWidth: 10,\n                colors: [undefined], // First should be undefined to make sure we don't color in the bar before the change.\n                data: [],\n                fill: false,\n                label: pathIndex.toString(),\n                key: pathIndex.toString(),\n                pointBackgroundColor: [],\n                pointBorderColor: \"transparent\",\n                pointHoverRadius: 3,\n                pointRadius: 1.25,\n                pointStyle: \"circle\",\n                showLine: true,\n                datalabels: {\n                  display: [],\n                },\n              };\n              const baseColors = getGlobalHooks().perPanelHooks().StateTransitions.customStateTransitionColors[\n                path\n              ] || [grey, ...lineColors];\n              let previousValue, previousTimestamp;\n              for (let index = 0; index < itemsByPath[path].length; index++) {\n                const item = getTooltipItemForMessageHistoryItem(itemsByPath[path][index]);\n                if (item.queriedData.length !== 1) {\n                  continue;\n                }\n\n                const timestamp = timestampMethod === \"headerStamp\" ? item.headerStamp : item.receiveTime;\n                if (!timestamp) {\n                  continue;\n                }\n\n                const { constantName, value } = item.queriedData[0];\n\n                // Skip duplicates.\n                if (\n                  previousTimestamp &&\n                  toSec(subtractTimes(previousTimestamp, timestamp)) === 0 &&\n                  previousValue === value\n                ) {\n                  continue;\n                }\n                previousTimestamp = timestamp;\n\n                // Skip anything that cannot be cast to a number or is a string.\n                if (Number.isNaN(value) && typeof value !== \"string\") {\n                  continue;\n                }\n\n                if (typeof value !== \"number\" && typeof value !== \"boolean\" && typeof value !== \"string\") {\n                  continue;\n                }\n\n                const valueForColor = typeof value === \"string\" ? stringHash(value) : Math.round(Number(value));\n                const color = baseColors[positiveModulo(valueForColor, Object.values(baseColors).length)];\n                // We add all points, colors, tooltips, etc to the *beginning* of the list, not the end. When\n                // datalabels overlap we usually care about the later ones (further right). By putting those points\n                // first in the list, we prioritize datalabels there when the library does its autoclipping.\n                dataItem.pointBackgroundColor.unshift(darkColor(color));\n                dataItem.colors.unshift(color);\n                const label = constantName ? `${constantName} (${String(value)})` : String(value);\n                const x = toSec(subtractTimes(timestamp, startTime));\n                const y = pathIndex;\n                const tooltip: TimeBasedChartTooltipData = {\n                  x,\n                  y,\n                  item,\n                  path,\n                  value,\n                  constantName,\n                  startTime,\n                };\n                tooltips.unshift(tooltip);\n                const dataPoint: DataPoint = { x, y };\n                const showDatalabel = previousValue === undefined || previousValue !== value;\n                // Use \"auto\" here so that the datalabels library can clip datalabels if they overlap.\n                dataItem.datalabels.display.unshift(showDatalabel ? \"auto\" : undefined);\n                if (showDatalabel) {\n                  dataPoint.label = label;\n                  dataPoint.labelColor = color;\n                }\n                dataItem.data.unshift(dataPoint);\n                previousValue = value;\n              }\n              return dataItem;\n            }),\n          };\n\n          const marginRight = 20;\n\n          return (\n            <SChartContainerOuter>\n              <Dimensions>\n                {({ width }) => (\n                  <SChartContainerInner style={{ width: width - marginRight, height }}>\n                    <TimeBasedChart\n                      zoom\n                      isSynced\n                      width={width - marginRight}\n                      height={height}\n                      data={data}\n                      type=\"multicolorLine\"\n                      xAxisIsPlaybackTime\n                      yAxes={yAxes}\n                      plugins={plugins}\n                      scaleOptions={scaleOptions}\n                      tooltips={tooltips}\n                    />\n\n                    {paths.map(({ value: path, timestampMethod }, index) => (\n                      <SInputContainer\n                        key={index}\n                        style={{ top: index * heightPerTopic }}\n                        shrink={index === 0 && isHovered}>\n                        <SInputDelete\n                          onClick={() => {\n                            const newPaths = config.paths.slice();\n                            newPaths.splice(index, 1);\n                            saveConfig({ paths: newPaths });\n                          }}>\n                          \n                        </SInputDelete>\n                        <MessagePathInput\n                          path={path}\n                          onChange={onInputChange}\n                          index={index}\n                          autoSize\n                          validTypes={transitionableRosTypes}\n                          noMultiSlices\n                          timestampMethod={timestampMethod}\n                          onTimestampMethodChange={onInputTimestampMethodChange}\n                        />\n                      </SInputContainer>\n                    ))}\n                  </SChartContainerInner>\n                )}\n              </Dimensions>\n            </SChartContainerOuter>\n          );\n        }}\n      </MessageHistoryDEPRECATED>\n    </SRoot>\n  );\n};\n\nStateTransitions.panelType = \"StateTransitions\";\nStateTransitions.defaultConfig = { paths: [] };\n\nexport default hot(Panel<StateTransitionConfig>(StateTransitions));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { useCallback, useMemo } from \"react\";\n\nimport parseRosPath from \"./parseRosPath\";\nimport { useCachedGetMessagePathDataItems, type MessagePathDataItem } from \"./useCachedGetMessagePathDataItems\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message, MessageFormat } from \"webviz-core/src/players/types\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\n\ntype MessageAndData = {| message: Message, queriedData: MessagePathDataItem[] |};\n\n// Get the last message for a path, but *after* applying filters. In other words, we'll keep the\n// last message that matched.\nexport function useLatestMessageDataItem(path: string, format: MessageFormat, bigInts: ?true): ?MessageAndData {\n  const rosPath = useMemo(() => parseRosPath(path), [path]);\n  const topics = useMemo(() => (rosPath ? [rosPath.topicName] : []), [rosPath]);\n  const cachedGetMessagePathDataItems = useCachedGetMessagePathDataItems([path]);\n\n  const addMessages: (?MessageAndData, $ReadOnlyArray<Message>) => ?MessageAndData = useCallback((\n    prevMessageAndData: ?MessageAndData,\n    messages: $ReadOnlyArray<Message>\n  ) => {\n    // Iterate in reverse so we can early-return and not process all messages.\n    for (let i = messages.length - 1; i >= 0; --i) {\n      const message = messages[i];\n      const queriedData = cachedGetMessagePathDataItems(path, message, bigInts);\n      if (queriedData == null) {\n        // Invalid path.\n        return;\n      }\n      if (queriedData.length > 0) {\n        return { message, queriedData };\n      }\n    }\n    return prevMessageAndData;\n  }, [bigInts, cachedGetMessagePathDataItems, path]);\n\n  const restore = useCallback((prevMessageAndData: ?MessageAndData): ?MessageAndData => {\n    if (prevMessageAndData) {\n      const queriedData = cachedGetMessagePathDataItems(path, prevMessageAndData.message, bigInts);\n      if (queriedData && queriedData.length > 0) {\n        return { message: prevMessageAndData.message, queriedData };\n      }\n    }\n  }, [bigInts, cachedGetMessagePathDataItems, path]);\n\n  // A backfill is not automatically requested when the above callbacks' identities change, so we\n  // need to do that manually.\n  const { requestBackfill } = useMessagePipeline(\n    useCallback((messagePipeline) => ({ requestBackfill: messagePipeline.requestBackfill }), [])\n  );\n  if (useChangeDetector([cachedGetMessagePathDataItems, path], false)) {\n    requestBackfill();\n  }\n\n  const addMessageCallbackName = format === \"parsedMessages\" ? \"addMessages\" : \"addBobjects\";\n  const messageAndData = PanelAPI.useMessageReducer({\n    topics,\n    [addMessageCallbackName]: addMessages,\n    restore,\n  });\n  return rosPath ? messageAndData : undefined;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport Interactions from \"./Interactions\";\n\nexport * from \"./Interactions\";\nexport { default as InteractionContextMenu } from \"./InteractionContextMenu\";\nexport { default as GlobalVariableLink, UnlinkGlobalVariables } from \"./GlobalVariableLink\";\nexport * from \"./types\";\n\nexport default Interactions;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type FieldReader, Uint8Reader, getReader } from \"./readers\";\nimport { DATATYPE, type VertexBuffer, type ColorMode } from \"./types\";\nimport maybeConvertSphericalCoordinatePointCloudToCartesian from \"webviz-core/src/panels/ThreeDimensionalViz/commands/utils/maybeConvertSphericalCoordinatePointCloudToCartesian\";\nimport type { PointField } from \"webviz-core/src/types/Messages\";\n\nexport type FieldOffsetsAndReaders = {\n  [name: string]: { datatype: string, offset: number, reader: ?FieldReader },\n};\n\nexport function getFieldOffsetsAndReaders(fields: $ReadOnlyArray<PointField>): FieldOffsetsAndReaders {\n  const result = {};\n  for (const { name, datatype, offset = 0 } of fields) {\n    result[name] = { datatype, offset, reader: getReader(datatype, offset) };\n  }\n  return result;\n}\n\nexport const FLOAT_SIZE = Float32Array.BYTES_PER_ELEMENT;\n\n// Reinterpret a buffer of bytes as a buffer of float values\nexport function reinterpretBufferToFloat(buffer: Uint8Array): Float32Array {\n  return new Float32Array(new Uint8Array(buffer).buffer, 0, buffer.length / Float32Array.BYTES_PER_ELEMENT);\n}\n\n// Expand a buffer of byte values, transforming each value into a float\nexport function expandBufferToFloat(buffer: Uint8Array): Float32Array {\n  return new Float32Array(buffer);\n}\n\n// Utility function to get values from vertex buffers.\n// Since data is stored as floats, we need to divide both offset and stride\n// to get the actual values within the buffer\nexport function getVertexValue(buffer: VertexBuffer, index: number): number {\n  const data = buffer.buffer;\n  const offset = buffer.offset;\n  const stride = buffer.stride;\n  return data[index * stride + offset];\n}\n\n// Utility function to get multiple consecutive values from vertex buffers.\nexport function getVertexValues(buffer: VertexBuffer, index: number, count: number): number[] {\n  const ret = [];\n  const data = buffer.buffer;\n  const offset = buffer.offset;\n  const stride = buffer.stride;\n  for (let i = 0; i < count; i++) {\n    ret.push(data[index * stride + offset + i]);\n  }\n  return ret;\n}\n\n// The number of points in a buffer is equal to the length of the buffer\n// divided by the number of float values in each vertex\nexport function getVertexCount(buffer: VertexBuffer): number {\n  return buffer.buffer.length / buffer.stride;\n}\n\n// Utility function to check if the size of each vertex in a buffer is\n// supported by WebGL 1.0. The maximum stride size is 255 bytes.\n// Also, stride must be a multiple of sizeof(float) in order for us\n// to reinterpret the data buffer\nfunction hasValidStride(stride: number): boolean {\n  return stride <= 255 && stride % FLOAT_SIZE === 0;\n}\n\n// This is a fallback function to extract values from data buffers\n// It's used on some cases where we cannot send the data as is to the GPU,\n// either because we ended up with an unsupported vertex size (see hasValidStride())\n// or because the color field has a datatype that is not easy to work with in shaders\n// This function always returns a Float32Array with three values for each point\n// in the cloud since it might be used for both colors and/or positions.\nfunction extractValues({\n  data,\n  readers,\n  pointCount,\n  stride,\n}: {\n  data: Uint8Array,\n  readers: (?FieldReader)[],\n  pointCount: number,\n  stride: number,\n}): VertexBuffer {\n  const COMPONENT_COUNT = 3;\n  const buffer = new Float32Array(COMPONENT_COUNT * pointCount);\n  for (let i = 0; i < pointCount; i++) {\n    const pointStart = i * stride;\n    for (let j = 0; j < readers.length; j++) {\n      const reader = readers[j];\n      let value = Number.NaN;\n      if (reader != null) {\n        value = reader.read(data, pointStart);\n      }\n      buffer[i * COMPONENT_COUNT + j] = value;\n    }\n  }\n  return {\n    buffer,\n    offset: 0,\n    stride: COMPONENT_COUNT,\n  };\n}\n\ntype PointCloudData = $ReadOnly<{|\n  data: Uint8Array,\n  fields: FieldOffsetsAndReaders,\n  pointCount: number,\n  stride: number,\n  sphericalRangeScale?: number,\n|}>;\n\nexport function createPositionBuffer({\n  data,\n  fields,\n  pointCount,\n  stride,\n  sphericalRangeScale,\n}: {|\n  ...PointCloudData,\n|}): VertexBuffer {\n  const positions = maybeConvertSphericalCoordinatePointCloudToCartesian({\n    data,\n    fields,\n    pointCount,\n    stride,\n    sphericalRangeScale,\n  });\n  if (positions) {\n    return positions;\n  }\n\n  // Check if all position components are stored next to each other\n  const positionIsValid =\n    fields.y.offset - fields.x.offset === FLOAT_SIZE && fields.z.offset - fields.y.offset === FLOAT_SIZE;\n  if (positionIsValid && hasValidStride(stride)) {\n    // Create a VBO for positions by recasting the data array into a float array\n    // This will give us the correct values for (x,y,z) tuples.\n    // This way we don't need to traverse the array in order to get the [x, y, z] values\n    // We're paying a memory cost in order to achieve the best performance.\n    return {\n      buffer: reinterpretBufferToFloat(data),\n      // Divide by sizeof(float) since offset and stride are defined based on number of\n      // float values, not bytes\n      offset: fields.x.offset / FLOAT_SIZE,\n      stride: stride / FLOAT_SIZE,\n    };\n  }\n\n  // We cannot use positions as is from data buffer. Extract them.\n  console.info(`Vertex buffer stride will be too big (${stride}). Extracting positions from data in CPU`);\n  return extractValues({\n    data,\n    readers: [fields.x.reader, fields.y.reader, fields.z.reader],\n    pointCount,\n    stride,\n  });\n}\n\nexport function createColorBuffer({\n  data,\n  fields,\n  colorMode,\n  pointCount,\n  stride,\n}: {|\n  data: Uint8Array,\n  fields: FieldOffsetsAndReaders,\n  colorMode: ColorMode,\n  pointCount: number,\n  stride: number,\n|}): ?VertexBuffer {\n  if (colorMode.mode === \"flat\") {\n    // If color mode is \"flat\", we don't need a color buffer since\n    // we'll be using a constant value\n    return null;\n  }\n\n  if (colorMode.mode === \"rgb\") {\n    const rgbOffset = fields.rgb.offset || 0;\n    if (hasValidStride(FLOAT_SIZE * stride)) {\n      return {\n        // RGB colors are encoded in a single 4-byte tuple and unfortunately we cannot extract\n        // them in shaders by just reinterpreting the data buffer.\n        // In addition, the supported WebGL implementation constraints VBOs to be of type float,\n        // so we cannot send the data as is. Then, we're converting the data array into a float\n        // array, transforming each byte value into a float.\n        // We're definitely paying a memory cost here\n        buffer: expandBufferToFloat(data),\n        // No need to divide/multiply by sizeof(float) here since now every byte value\n        // in data array is transformed to a float value.\n        offset: rgbOffset, //< float values from the start of each vertex\n        stride, //< float values between vertices\n      };\n    }\n    // stride is too big. Extract colors from data\n    console.info(`Vertex buffer stride will be too big (${4 * stride}). Extracting RGB colors from data in CPU`);\n    return extractValues({\n      data,\n      readers: [new Uint8Reader(rgbOffset + 0), new Uint8Reader(rgbOffset + 1), new Uint8Reader(rgbOffset + 2)],\n      stride,\n      pointCount,\n    });\n  }\n\n  const colorField = fields[colorMode.colorField || \"rgb\"];\n\n  // If the color is computed from any of the other float fields (i.e. x positions)\n  // we can do the same trick as for positions, with just a different offset\n  // based on the selected color field. We also need to make sure the offset\n  // memory alignment is correct (that is, it's divisible by sizeof(float)). There\n  // might be other values previous to this one that have different memory alignments.\n  if (colorField.datatype === DATATYPE.float32 && colorField.offset % FLOAT_SIZE === 0 && hasValidStride(stride)) {\n    return {\n      buffer: reinterpretBufferToFloat(data),\n      // Divide by sizeof(float) since offset and stride are defined based on number of\n      // float values, not bytes\n      offset: colorField.offset / FLOAT_SIZE, //< float values from the start of each vertex\n      stride: stride / FLOAT_SIZE, //< float values between vertices\n    };\n  }\n\n  // Color datatype is not float or stride is too big\n  // Just extract color data from buffer using CPU\n  console.info(\"Cannot reinterpret data. Extracting color buffer using CPU\");\n  return extractValues({\n    data,\n    readers: [colorField.reader],\n    stride,\n    pointCount,\n  });\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { every, uniq, keyBy, isEmpty } from \"lodash\";\n\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const diffArrow = \"->\";\nexport const diffLabels = {\n  ADDED: { labelText: \"WEBVIZ_DIFF___ADDED\", color: colors.DARK6, backgroundColor: \"#182924\", indicator: \"+\" },\n  DELETED: { labelText: \"WEBVIZ_DIFF___DELETED\", color: colors.DARK6, backgroundColor: \"#3d2327\", indicator: \"-\" },\n  CHANGED: { labelText: \"WEBVIZ_DIFF___CHANGED\", color: jsonTreeTheme.base0B },\n  ID: { labelText: \"WEBVIZ_DIFF___ID\" },\n};\n\n// $FlowFixMe - Flow doesn't understand `Object.values`.\nexport const diffLabelsByLabelText = keyBy(Object.values(diffLabels), \"labelText\");\n\nconst stringify = (value: mixed) => {\n  if (typeof value === \"number\") {\n    // NaN, -0.0, Infinity etc to not go through JSON.stringify cleanly.\n    return value.toString();\n  }\n  return JSON.stringify(value);\n};\n\nexport default function getDiff(\n  before: mixed,\n  after: mixed,\n  idLabel: ?string = null,\n  showFullMessageForDiff: boolean = false\n) {\n  if (Array.isArray(before) && Array.isArray(after)) {\n    let idToCompareWith: ?string;\n    const allItems = before.concat(after);\n    if (allItems[0] && typeof allItems[0] === \"object\") {\n      let candidateIdsToCompareWith = {};\n      if (allItems[0].id != null) {\n        candidateIdsToCompareWith.id = { before: [], after: [] };\n      }\n      for (const key in allItems[0]) {\n        if (isTypicalFilterName(key)) {\n          candidateIdsToCompareWith[key] = { before: [], after: [] };\n        }\n      }\n      if (!every(allItems, (item) => item && typeof item === \"object\")) {\n        candidateIdsToCompareWith = {};\n      }\n      for (const idKey in candidateIdsToCompareWith) {\n        for (const beforeItem of before) {\n          // $FlowFixMe - we know beforeItem is an object at this point\n          if (beforeItem[idKey] != null) {\n            candidateIdsToCompareWith[idKey].before.push(beforeItem[idKey]);\n          }\n        }\n      }\n      for (const idKey in candidateIdsToCompareWith) {\n        for (const afterItem of after) {\n          // $FlowFixMe - we know afterItem is an object at this point\n          if (afterItem[idKey] != null) {\n            candidateIdsToCompareWith[idKey].after.push(afterItem[idKey]);\n          }\n        }\n      }\n      for (const idKey in candidateIdsToCompareWith) {\n        const { before: candidateIdBefore, after: candidateIdAfter } = candidateIdsToCompareWith[idKey];\n        if (uniq(candidateIdBefore).length === before.length && uniq(candidateIdAfter).length === after.length) {\n          idToCompareWith = idKey;\n          break;\n        }\n      }\n    }\n\n    if (idToCompareWith) {\n      const unmatchedAfterById = keyBy(after, idToCompareWith);\n      const diff = [];\n      for (const beforeItem of before) {\n        if (!beforeItem || typeof beforeItem !== \"object\") {\n          throw new Error(\"beforeItem is invalid; should have checked this earlier\");\n        }\n        const id = beforeItem[idToCompareWith];\n        const innerDiff = getDiff(beforeItem, unmatchedAfterById[id], idToCompareWith, showFullMessageForDiff);\n        delete unmatchedAfterById[id];\n        if (!isEmpty(innerDiff)) {\n          const isDeleted =\n            Object.keys(innerDiff).length === 1 && Object.keys(innerDiff)[0] === diffLabels.DELETED.labelText;\n          diff.push(isDeleted ? innerDiff : { [diffLabels.ID.labelText]: { [idToCompareWith]: id }, ...innerDiff });\n        }\n      }\n      for (const afterItem of Object.values(unmatchedAfterById)) {\n        const innerDiff = getDiff(undefined, afterItem, idToCompareWith, showFullMessageForDiff);\n        if (!isEmpty(innerDiff)) {\n          diff.push(innerDiff);\n        }\n      }\n      return diff;\n    }\n  }\n\n  if (before && after && typeof before === \"object\" && typeof after === \"object\") {\n    const diff = {};\n    const allKeys = Object.keys(before).concat(Object.keys(after));\n    for (const key of uniq(allKeys)) {\n      const innerDiff = getDiff(before[key], after[key], null, showFullMessageForDiff);\n      if (!isEmpty(innerDiff)) {\n        diff[key] = innerDiff;\n      } else if (showFullMessageForDiff) {\n        diff[key] = before[key];\n      }\n    }\n    return diff;\n  }\n\n  if (Object.is(before, after)) {\n    return undefined;\n  }\n  if (before === undefined) {\n    const afterIsNotObj = Array.isArray(after) || typeof after !== \"object\";\n    if (!idLabel || afterIsNotObj) {\n      return { [diffLabels.ADDED.labelText]: after };\n    }\n    const idLabelObj = { [diffLabels.ID.labelText]: { [idLabel]: { ...after }[idLabel] } };\n    return { [diffLabels.ADDED.labelText]: { ...idLabelObj, ...after } };\n  }\n  if (after === undefined) {\n    const beforeIsNotObj = Array.isArray(before) || typeof before !== \"object\";\n    if (!idLabel || beforeIsNotObj) {\n      return { [diffLabels.DELETED.labelText]: before };\n    }\n    const idLabelObj = { [diffLabels.ID.labelText]: { [idLabel]: { ...before }[idLabel] } };\n    return { [diffLabels.DELETED.labelText]: { ...idLabelObj, ...before } };\n  }\n  return {\n    [diffLabels.CHANGED.labelText]: `${stringify(before) || \"\"} ${diffArrow} ${stringify(after) || \"\"}`,\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport clamp from \"lodash/clamp\";\n\nimport CameraModel from \"./CameraModel\";\nimport type { Topic, Message } from \"webviz-core/src/players/types\";\nimport type { CameraInfo } from \"webviz-core/src/types/Messages\";\n\n// The OffscreenCanvas type is not yet in Flow. It's similar to, but more restrictive than HTMLCanvasElement.\n// TODO: change this to the Flow definition once it's been added.\nexport type OffscreenCanvas = HTMLCanvasElement;\n\nexport type Dimensions = {| width: number, height: number |};\n\nexport type MarkerOption = {\n  topic: string,\n  name: string,\n};\n\nexport type RawMarkerData = {|\n  markers: Message[],\n  scale: number,\n  transformMarkers: boolean,\n  cameraInfo: ?CameraInfo,\n|};\n\nexport type MarkerData = ?{|\n  markers: Message[],\n  originalWidth: ?number, // null means no scaling is needed (use the image's size)\n  originalHeight: ?number, // null means no scaling is needed (use the image's size)\n  cameraModel: ?CameraModel, // null means no transformation is needed\n|};\n\nexport function getMarkerOptions(\n  imageTopic: string,\n  topics: $ReadOnlyArray<Topic>,\n  allCameraNamespaces: string[],\n  imageMarkerDatatypes: string[]\n): string[] {\n  const results = [];\n  const cameraNamespace = getCameraNamespace(imageTopic);\n  for (const { name, datatype } of topics) {\n    if (\n      cameraNamespace &&\n      (name.startsWith(cameraNamespace) || name.startsWith(`/old${cameraNamespace}`)) &&\n      imageMarkerDatatypes.includes(datatype)\n    ) {\n      results.push(name);\n    }\n  }\n  return results.sort();\n}\n\nexport function getRelatedMarkerTopics(enabledMarkerTopics: string[], availableMarkerTopics: string[]): string[] {\n  return availableMarkerTopics.filter((topic) => {\n    return enabledMarkerTopics.some((enabledTopic) => topic.endsWith(enabledTopic.split(\"/\").pop()));\n  });\n}\n\n// get the sensor_msgs/CameraInfo topic associated with an image topic\nexport function getCameraInfoTopic(imageTopic: string): ?string {\n  const cameraNamespace = getCameraNamespace(imageTopic);\n  if (cameraNamespace) {\n    return `${cameraNamespace}/camera_info`;\n  }\n  return null;\n}\n\nexport function getCameraNamespace(topicName: string): ?string {\n  let splitTopic = topicName.split(\"/\");\n  // Remove the last part of the selected topic to get the camera namespace.\n  splitTopic.pop();\n  splitTopic = splitTopic.filter((topicPart) => topicPart !== \"old\");\n\n  // Since there is a leading slash in the topicName, splitTopic will always have at least one empty string to start.\n  // If we can't find the namespace, return null.\n  return splitTopic.length > 1 ? splitTopic.join(\"/\") : null;\n}\n\n// group topics by the first component of their name\nexport function groupTopics(topics: Topic[]): Map<string, Topic[]> {\n  const imageTopicsByNamespace: Map<string, Topic[]> = new Map();\n  for (const topic of topics) {\n    const key = getCameraNamespace(topic.name) || topic.name;\n    const vals = imageTopicsByNamespace.get(key);\n    if (vals) {\n      vals.push(topic);\n    } else {\n      imageTopicsByNamespace.set(key, [topic]);\n    }\n  }\n  return imageTopicsByNamespace;\n}\n\n// check if we pan out of bounds with the given top, left, right, bottom\n// x, y, scale is the state after we pan\n// if out of bound, return newX and newY satisfying the bounds\n// else, return the original x and y\nexport function checkOutOfBounds(\n  x: number,\n  y: number,\n  outsideWidth: number,\n  outsideHeight: number,\n  insideWidth: number,\n  insideHeight: number\n): number[] {\n  const leftX = 0;\n  const topY = 0;\n  const rightX = outsideWidth - insideWidth;\n  const bottomY = outsideHeight - insideHeight;\n  return [\n    clamp(x, Math.min(leftX, rightX), Math.max(leftX, rightX)),\n    clamp(y, Math.min(topY, bottomY), Math.max(topY, bottomY)),\n  ];\n}\n\nexport function buildMarkerData(rawMarkerData: RawMarkerData): ?MarkerData {\n  const { markers, scale, transformMarkers, cameraInfo } = rawMarkerData;\n  if (markers.length === 0) {\n    return {\n      markers,\n      cameraModel: null,\n      originalHeight: undefined,\n      originalWidth: undefined,\n    };\n  }\n  let cameraModel;\n  if (transformMarkers) {\n    if (!cameraInfo) {\n      return null;\n    }\n    cameraModel = new CameraModel(cameraInfo);\n  }\n\n  // Markers can only be rendered if we know the original size of the image.\n  let originalWidth;\n  let originalHeight;\n  if (cameraInfo && cameraInfo.width && cameraInfo.height) {\n    // Prefer using CameraInfo can be used to determine the image size.\n    originalWidth = cameraInfo.width;\n    originalHeight = cameraInfo.height;\n  } else if (scale === 1) {\n    // Otherwise, if scale === 1, the image was not downsampled, so the size of the bitmap is accurate.\n    originalWidth = undefined;\n    originalHeight = undefined;\n  } else {\n    return null;\n  }\n\n  return {\n    markers,\n    cameraModel,\n    originalWidth,\n    originalHeight,\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { createContext } from \"react\";\n\nexport const TAB_DRAG_TYPE = \"TAB\";\nexport type DraggingTabItem = { type: typeof TAB_DRAG_TYPE, tabIndex: number, panelId: string };\nexport type DraggingTabPanelState = {\n  item: ?DraggingTabItem,\n  isOver: boolean,\n};\n\nexport type TabActions = {|\n  addTab: () => void,\n  removeTab: (tabIndex: number) => void,\n  selectTab: (tabIndex: number) => void,\n  setTabTitle: (tabIndex: number, title: string) => void,\n|};\n\n// It allows nested TabPanels to know if their parent tab is being dragged.\n// This allows us to prevent situations where the parent tab is dragged into a child tab.\nexport const TabDndContext = createContext<{\n  preventTabDrop: boolean,\n}>({ preventTabDrop: false });\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { isEqual } from \"lodash\";\n\ntype Rule = (value: any) => ?string;\ntype Rules = {\n  [name: string]: ((value: any) => ?string)[],\n};\n\nconst layoutNameRegex = /[@%]/; // Don't allow these characters in layoutName.\n\nfunction isEmpty(value: any) {\n  return value == null;\n}\n\nexport const isEmail = (value: any): boolean => {\n  const regex = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return !isEmpty(value) && regex.test(value);\n};\n\nexport const isRequired = (value: any): ?string => (value == null ? \"is required\" : undefined);\n\nexport const isNumber = (value: any): ?string =>\n  !isEmpty(value) && typeof value !== \"number\" ? \"must be a number\" : undefined;\n\nexport const isBoolean = (value: any): ?string =>\n  !isEmpty(value) && typeof value !== \"boolean\" ? `must be \"true\" or \"false\"` : undefined;\n\nexport const isNumberArray = (expectArrLen: number = 0) => (value: any): ?string => {\n  if (Array.isArray(value)) {\n    if (value.length !== expectArrLen) {\n      return `must contain ${expectArrLen} array items`;\n    }\n    for (const item of value) {\n      if (typeof item !== \"number\") {\n        return `must contain only numbers in the array. \"${item}\" is not a number.`;\n      }\n    }\n  }\n};\n\nexport const isOrientation = (value: any): ?string => {\n  const isNumberArrayErr = isNumberArray(4)(value);\n  if (isNumberArrayErr) {\n    return isNumberArrayErr;\n  }\n  if (value) {\n    const quaternionSum = value.reduce((memo, item) => memo + item * item, 0);\n    // Very rough validation to make sure the quaternion numbers are not too far off\n    if (Math.abs(quaternionSum - 1) > 0.1) {\n      return \"must be valid quaternion\";\n    }\n  }\n};\n\nexport const isString = (value: any): ?string => (typeof value !== \"string\" ? \"must be string\" : undefined);\n\nexport const minLen = (minLength: number = 0) => (value: any): ?string => {\n  if (Array.isArray(value)) {\n    return value.length < minLength\n      ? `must contain at least ${minLength} array ${minLength === 1 ? \"item\" : \"items\"}`\n      : undefined;\n  } else if (typeof value === \"string\") {\n    return value.length < minLength\n      ? `must contain at least ${minLength} ${minLength === 1 ? \"character\" : \"characters\"}`\n      : undefined;\n  }\n};\n\nexport const maxLen = (maxLength: number = 0) => (value: any): ?string => {\n  if (Array.isArray(value)) {\n    return value.length > maxLength ? `must contain at most ${maxLength} array items` : undefined;\n  } else if (typeof value === \"string\") {\n    return value.length > maxLength ? `must contain at most ${maxLength} characters` : undefined;\n  }\n};\n\nexport const hasLen = (len: number = 0) => (value: string | any[]): ?string => {\n  if (Array.isArray(value)) {\n    return value.length !== len\n      ? `must contain exact ${len} array items (current item count: ${value.length})`\n      : undefined;\n  } else if (typeof value === \"string\") {\n    return value.length !== len ? `must contain ${len} characters (current count: ${value.length})` : undefined;\n  }\n};\n\nexport const isNotPrivate = (value: any): ?string =>\n  typeof value !== \"string\" && value.startsWith(\"_\") ? \"must not start with _\" : undefined;\n\n// return the first error\nconst join = (rules) => (value) => rules.map((rule) => rule(value)).filter((error) => !!error)[0];\n\nexport const getWebsocketUrlError = (websocketUrl: string) => {\n  return `\"${websocketUrl}\" is an invalid WebSocket URL`;\n};\nexport const isWebsocketUrl = (value: string): ?string => {\n  const pattern = new RegExp(`wss?://[a-z.-_\\\\d]+(:(d+))?`, \"gi\");\n  if (!pattern.test(value)) {\n    return getWebsocketUrlError(value);\n  }\n};\n\nexport const createValidator = (rules: Rules) => {\n  return (data: any = {}): { [field: string]: string } => {\n    const errors = {};\n    Object.keys(rules).forEach((key) => {\n      // concat enables both functions and arrays of functions\n      const rule = join([].concat(rules[key]));\n      const error = rule(data[key]);\n      if (error) {\n        errors[key] = error;\n      }\n    });\n    return errors;\n  };\n};\n\nexport const createPrimitiveValidator = (rules: Rule[]) => {\n  return (data: any): ?string => {\n    for (let i = 0; i < rules.length; i++) {\n      const error = rules[i](data);\n      if (error) {\n        return error;\n      }\n    }\n  };\n};\n\nexport type ValidationResult =\n  | string\n  | {\n      [fieldName: string]: string,\n    };\n\nexport const validationErrorToString = (validationResult: ValidationResult): string =>\n  typeof validationResult === \"string\"\n    ? validationResult\n    : Object.keys(validationResult)\n        .map((key) => `${key}: ${validationResult[key]}`)\n        .join(\", \");\n\nexport const cameraStateValidator = (jsonData: any): ?ValidationResult => {\n  const data = typeof jsonData !== \"object\" ? {} : jsonData;\n  const rules = {\n    distance: [isNumber],\n    perspective: [isBoolean],\n    phi: [isNumber],\n    thetaOffset: [isNumber],\n    target: [isNumberArray(3)],\n    targetOffset: [isNumberArray(3)],\n    targetOrientation: [isOrientation],\n  };\n  const validator = createValidator(rules);\n  const result = validator(data);\n\n  return Object.keys(result).length === 0 ? undefined : result;\n};\n\nconst isXYPointArray = (value: any): ?string => {\n  if (Array.isArray(value)) {\n    for (const item of value) {\n      if (!item || item.x == null || item.y == null) {\n        return `must contain x and y points`;\n      }\n      if (typeof item.x !== \"number\" || typeof item.y !== \"number\") {\n        return `x and y points must be numbers`;\n      }\n    }\n  } else {\n    return \"must be an array of x and y points\";\n  }\n};\n\nconst isPolygons = (value: any): ?string => {\n  if (Array.isArray(value)) {\n    for (const item of value) {\n      const error = isXYPointArray(item);\n      if (error) {\n        return error;\n      }\n    }\n  } else {\n    return \"must be an array of nested x and y points\";\n  }\n};\n\n// validate the polygons must be a nested array of xy points\nexport const polygonPointsValidator = (jsonData: any): ?ValidationResult => {\n  if (!jsonData || isEqual(jsonData, []) || isEqual(jsonData, {})) {\n    return undefined;\n  }\n  const rules = { polygons: [isPolygons] };\n  const validator = createValidator(rules);\n  const result = validator({ polygons: jsonData });\n  return Object.keys(result).length === 0 ? undefined : result.polygons;\n};\n\nexport const point2DValidator = (jsonData: any): ?ValidationResult => {\n  const data = typeof jsonData !== \"object\" ? {} : jsonData;\n  const rules = { x: [isRequired, isNumber], y: [isRequired, isNumber] };\n  const validator = createValidator(rules);\n  const result = validator(data);\n  return Object.keys(result).length === 0 ? undefined : result;\n};\n\nexport const getLayoutNameError = (layoutName: string) => {\n  return `\"${layoutName}\" is an invalid layout name. Layout name cannot contain @, %, or spaces`;\n};\nconst isLayoutName = (value: string): ?string => {\n  const pattern = new RegExp(layoutNameRegex);\n  if (pattern.test(value)) {\n    return getLayoutNameError(value);\n  }\n};\n\nexport const layoutNameValidator = createPrimitiveValidator([minLen(1), maxLen(120), isLayoutName]);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport { type ReglClickInfo } from \"regl-worldview\";\n\nimport type { Point } from \"webviz-core/src/types/Messages\";\nimport { arrayToPoint } from \"webviz-core/src/util\";\n\nexport type MeasureState = \"idle\" | \"place-start\" | \"place-finish\";\n\nexport type MeasureInfo = {|\n  measureState: MeasureState,\n  measurePoints: { start: ?Point, end: ?Point },\n|};\n\ntype Props = {|\n  onMeasureInfoChange: (MeasureInfo) => void,\n  ...MeasureInfo,\n|};\n\n/* eslint-disable no-restricted-syntax */\n\nexport default class MeasuringTool extends React.Component<Props> {\n  mouseDownCoords: number[] = [-1, -1];\n\n  toggleMeasureState = () => {\n    const newMeasureState = this.props.measureState === \"idle\" ? \"place-start\" : \"idle\";\n    this.props.onMeasureInfoChange({\n      measureState: newMeasureState,\n      measurePoints: { start: undefined, end: undefined },\n    });\n  };\n\n  reset = () => {\n    this.props.onMeasureInfoChange({\n      measureState: \"idle\",\n      measurePoints: { start: undefined, end: undefined },\n    });\n  };\n\n  _canvasMouseDownHandler = (e: MouseEvent, _clickInfo: ReglClickInfo) => {\n    this.mouseDownCoords = [e.clientX, e.clientY];\n  };\n\n  _canvasMouseUpHandler = (e: MouseEvent, _clickInfo: ReglClickInfo) => {\n    const mouseUpCoords = [e.clientX, e.clientY];\n    const { measureState, measurePoints, onMeasureInfoChange } = this.props;\n\n    if (!isEqual(mouseUpCoords, this.mouseDownCoords)) {\n      return;\n    }\n\n    if (measureState === \"place-start\") {\n      onMeasureInfoChange({ measureState: \"place-finish\", measurePoints });\n    } else if (measureState === \"place-finish\") {\n      // Use setImmediate so there is a tick between resetting the measure state and clicking the 3D canvas.\n      // If we call onMeasureInfoChange right away, the clicked object context menu will show up upon finishing measuring.\n      setImmediate(() => {\n        onMeasureInfoChange({ measurePoints, measureState: \"idle\" });\n      });\n    }\n  };\n\n  _canvasMouseMoveHandler = (e: MouseEvent, clickInfo: ReglClickInfo) => {\n    const { measureState, measurePoints, onMeasureInfoChange } = this.props;\n    switch (measureState) {\n      case \"place-start\":\n        onMeasureInfoChange({\n          measureState,\n          measurePoints: {\n            start: arrayToPoint(clickInfo.ray.planeIntersection([0, 0, 0], [0, 0, 1])),\n            end: undefined,\n          },\n        });\n        break;\n\n      case \"place-finish\":\n        onMeasureInfoChange({\n          measureState,\n          measurePoints: {\n            ...measurePoints,\n            end: arrayToPoint(clickInfo.ray.planeIntersection([0, 0, 0], [0, 0, 1])),\n          },\n        });\n        break;\n    }\n  };\n\n  get onMouseMove(): ?(MouseEvent, ReglClickInfo) => void {\n    if (!this.measureActive) {\n      return null;\n    }\n\n    return this._canvasMouseMoveHandler;\n  }\n\n  get onMouseUp(): ?(MouseEvent, ReglClickInfo) => void {\n    if (!this.measureActive) {\n      return null;\n    }\n\n    return this._canvasMouseUpHandler;\n  }\n\n  get onMouseDown(): ?(MouseEvent, ReglClickInfo) => void {\n    if (!this.measureActive) {\n      return null;\n    }\n\n    return this._canvasMouseDownHandler;\n  }\n\n  get measureActive(): boolean {\n    const { measureState } = this.props;\n    return measureState === \"place-start\" || measureState === \"place-finish\";\n  }\n\n  get measureDistance(): string {\n    const { start, end } = this.props.measurePoints;\n    let dist_string = \"\";\n    if (start && end) {\n      const dist = Math.hypot(end.x - start.x, end.y - start.y, end.z - start.z);\n      dist_string = `${dist.toFixed(2)}m`;\n    }\n\n    return dist_string;\n  }\n\n  render() {\n    return null;\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { uniq } from \"lodash\";\nimport React, { type Node } from \"react\";\nimport styled from \"styled-components\";\n\nimport renderNamespaceNodes, { type NamespaceNode } from \"./renderNamespaceNodes\";\nimport { renderStyleExpressionNodes } from \"./renderStyleExpressionNodes\";\nimport TreeNodeRow from \"./TreeNodeRow\";\nimport type {\n  DerivedCustomSettingsByKey,\n  GetIsNamespaceCheckedByDefault,\n  GetIsTreeNodeVisibleInScene,\n  GetIsTreeNodeVisibleInTree,\n  NamespacesByTopic,\n  OnNamespaceOverrideColorChange,\n  SceneErrorsByKey,\n  SetCurrentEditingTopic,\n  SetEditingNamespace,\n  TopicDisplayMode,\n  TreeNode,\n  TreeTopicNode,\n  VisibleTopicsCountByKey,\n} from \"./types\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport type { LinkedGlobalVariable } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport { canEditNamespaceOverrideColorDatatype } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/index\";\nimport generateNodeKey from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/generateNodeKey\";\nimport { TOPIC_DISPLAY_MODES } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicViewModeSelector\";\nimport type { StructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SWITCHER_WIDTH = 24;\n\nexport const SToggles = styled.div`\n  display: flex;\n  align-items: center;\n`;\nexport const SToggle = styled.div`\n  width: 24px;\n  height: 24px;\n`;\n\nexport const TooltipRow = styled.div`\n  margin: 4px 0;\n  &:first-child {\n    margin-top: 0;\n  }\n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\nconst TooltipDescription = styled(TooltipRow)`\n  line-height: 1.3;\n  max-width: 300px;\n`;\n\nexport const TooltipTable = styled.table`\n  th,\n  td {\n    border: none;\n    padding: 0;\n  }\n  td {\n    word-break: break-word;\n  }\n  max-width: 100%;\n  th {\n    color: ${colors.TEXT_MUTED};\n    padding-right: 4px;\n  }\n`;\n\ntype Props = {|\n  availableNamespacesByTopic: NamespacesByTopic,\n  checkedKeysSet: Set<string>,\n  children: TreeNode[],\n  derivedCustomSettingsByKey: DerivedCustomSettingsByKey,\n  filterText: string,\n  getIsNamespaceCheckedByDefault: GetIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene: GetIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree: GetIsTreeNodeVisibleInTree,\n  hasFeatureColumn: boolean,\n  isXSWidth: boolean,\n  onNamespaceOverrideColorChange: OnNamespaceOverrideColorChange,\n  sceneErrorsByKey: SceneErrorsByKey,\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  setEditingNamespace: SetEditingNamespace,\n  structuralDatatypes: StructuralDatatypes,\n  topicDisplayMode: TopicDisplayMode,\n  visibleTopicsCountByKey: VisibleTopicsCountByKey,\n  width: number,\n  linkedGlobalVariablesByTopic: { [string]: LinkedGlobalVariable[] },\n  diffModeEnabled: boolean,\n|};\n\nexport type TreeUINode = {| title: Node, key: string, children?: TreeUINode[], disabled?: boolean |};\n\nexport function getNamespaceNodes({\n  availableNamespacesByTopic,\n  canEditNamespaceOverrideColor,\n  checkedKeysSet,\n  derivedCustomSettingsByKey,\n  getIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene,\n  hasFeatureColumn,\n  node,\n  showVisible,\n}: {|\n  availableNamespacesByTopic: NamespacesByTopic,\n  canEditNamespaceOverrideColor: boolean,\n  checkedKeysSet: Set<string>,\n  derivedCustomSettingsByKey: DerivedCustomSettingsByKey,\n  getIsNamespaceCheckedByDefault: GetIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene: GetIsTreeNodeVisibleInScene,\n  hasFeatureColumn: boolean,\n  node: TreeTopicNode,\n  showVisible: boolean,\n|}): NamespaceNode[] {\n  const topicName = node.topicName;\n  const baseNamespacesSet = new Set((topicName && availableNamespacesByTopic[topicName]) || []);\n  const featureNamespacesSet = new Set(\n    (topicName && hasFeatureColumn && availableNamespacesByTopic[`${$WEBVIZ_SOURCE_2}${topicName}`]) || []\n  );\n  const uniqueNamespaces = uniq([...Array.from(baseNamespacesSet), ...Array.from(featureNamespacesSet)]);\n  const columns = hasFeatureColumn ? [0, 1] : [0];\n  return filterMap(uniqueNamespaces, (namespace) => {\n    const namespaceKey = generateNodeKey({ topicName, namespace });\n    const featureKey = generateNodeKey({ topicName, namespace, isFeatureColumn: true });\n    const topicNodeKey = node.key;\n    const overrideColorByColumn = [];\n    const hasNamespaceOverrideColorChangedByColumn = [];\n\n    if (canEditNamespaceOverrideColor) {\n      // Use namespace overrideColor by default, and fall back to topic overrideColor.\n      const namespaceOverrideColorByColumn =\n        (derivedCustomSettingsByKey[namespaceKey] && derivedCustomSettingsByKey[namespaceKey].overrideColorByColumn) ||\n        [];\n      const topicOverrideColorByColumn =\n        (derivedCustomSettingsByKey[topicNodeKey] && derivedCustomSettingsByKey[topicNodeKey].overrideColorByColumn) ||\n        [];\n      columns.forEach((columnIdx) => {\n        overrideColorByColumn.push(namespaceOverrideColorByColumn[columnIdx] || topicOverrideColorByColumn[columnIdx]);\n        // The namespace color has changed if there is an override color.\n        hasNamespaceOverrideColorChangedByColumn.push(!!namespaceOverrideColorByColumn[columnIdx]);\n      });\n    }\n    const namespaceNode = {\n      key: namespaceKey,\n      featureKey,\n      namespace,\n      overrideColorByColumn,\n      hasNamespaceOverrideColorChangedByColumn,\n      availableByColumn: columns.map((columnIdx) =>\n        columnIdx === 1 ? featureNamespacesSet.has(namespace) : baseNamespacesSet.has(namespace)\n      ),\n      checkedByColumn: columns.map(\n        (columnIdx) =>\n          checkedKeysSet.has(columnIdx === 1 ? featureKey : namespaceKey) ||\n          getIsNamespaceCheckedByDefault(topicName, columnIdx)\n      ),\n      visibleInSceneByColumn: columns.map((columnIdx) => getIsTreeNodeVisibleInScene(node, columnIdx, namespace)),\n    };\n\n    const visible = namespaceNode.visibleInSceneByColumn[0] || namespaceNode.visibleInSceneByColumn[1];\n    // Don't render namespaces that are not visible when the user selected to view Visible only.\n    if (node.providerAvailable && showVisible && !visible) {\n      return undefined;\n    }\n    return namespaceNode;\n  });\n}\n\n// A recursive function for generating tree nodes UI. Must use function instead of React component as the\n// return signature is different from React component.\nexport default function renderTreeNodes({\n  availableNamespacesByTopic,\n  checkedKeysSet,\n  children,\n  derivedCustomSettingsByKey,\n  filterText,\n  getIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree,\n  hasFeatureColumn,\n  isXSWidth,\n  onNamespaceOverrideColorChange,\n  sceneErrorsByKey,\n  setCurrentEditingTopic,\n  setEditingNamespace,\n  structuralDatatypes,\n  topicDisplayMode,\n  visibleTopicsCountByKey,\n  width,\n  linkedGlobalVariablesByTopic,\n  diffModeEnabled,\n}: Props): TreeUINode[] {\n  const titleWidth = width - SWITCHER_WIDTH;\n  return children\n    .filter(({ key }) => getIsTreeNodeVisibleInTree(key))\n    .map((item) => {\n      const { key, providerAvailable } = item;\n      const visibleByColumn = hasFeatureColumn\n        ? [getIsTreeNodeVisibleInScene(item, 0), getIsTreeNodeVisibleInScene(item, 1)]\n        : [getIsTreeNodeVisibleInScene(item, 0)];\n\n      const nodeVisibleInScene = !!(visibleByColumn[0] || visibleByColumn[1]);\n      const nodeAvailable = item.availableByColumn[0] || item.availableByColumn[1];\n\n      const showVisible = topicDisplayMode === TOPIC_DISPLAY_MODES.SHOW_SELECTED.value;\n      const showAvailable = topicDisplayMode === TOPIC_DISPLAY_MODES.SHOW_AVAILABLE.value;\n\n      // Render all nodes regardless of the displayMode when datasources are unavailable.\n      if (providerAvailable && ((showVisible && !nodeVisibleInScene) || (showAvailable && !nodeAvailable))) {\n        return null;\n      }\n\n      const itemChildren = item.type === \"group\" ? item.children : [];\n      const topicName = item.type === \"topic\" ? item.topicName : \"\";\n      const datatype = item.type === \"topic\" ? item.datatype : undefined;\n\n      const namespaceNodes =\n        item.type === \"topic\"\n          ? getNamespaceNodes({\n              availableNamespacesByTopic,\n              canEditNamespaceOverrideColor: !!(\n                datatype && canEditNamespaceOverrideColorDatatype(datatype, structuralDatatypes)\n              ),\n              checkedKeysSet,\n              derivedCustomSettingsByKey,\n              getIsNamespaceCheckedByDefault,\n              getIsTreeNodeVisibleInScene,\n              hasFeatureColumn,\n              node: item,\n              showVisible,\n            })\n          : [];\n\n      const tooltips = [];\n      if (topicName) {\n        tooltips.push(\n          <TooltipRow key={tooltips.length}>\n            <TooltipTable>\n              <tbody>\n                <tr>\n                  <th>Topic:</th>\n                  <td>\n                    <tt>{topicName}</tt>\n                  </td>\n                </tr>\n                {item.type === \"topic\" && item.datatype && (\n                  <tr>\n                    <th>Type:</th>\n                    <td>\n                      <tt>{item.datatype}</tt>\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </TooltipTable>\n          </TooltipRow>\n        );\n      }\n      if (item.description) {\n        tooltips.push(<TooltipDescription key={tooltips.length}>{item.description}</TooltipDescription>);\n      }\n\n      const title = (\n        <TreeNodeRow\n          checkedKeysSet={checkedKeysSet}\n          derivedCustomSettings={derivedCustomSettingsByKey[key]}\n          filterText={filterText}\n          hasChildren={itemChildren.length > 0 || namespaceNodes.length > 0}\n          hasFeatureColumn={hasFeatureColumn}\n          isXSWidth={isXSWidth}\n          node={item}\n          nodeVisibleInScene={nodeVisibleInScene}\n          sceneErrors={sceneErrorsByKey[item.key]}\n          setCurrentEditingTopic={setCurrentEditingTopic}\n          structuralDatatypes={structuralDatatypes}\n          visibleByColumn={visibleByColumn}\n          width={titleWidth}\n          visibleTopicsCount={visibleTopicsCountByKey[item.key] || 0}\n          {...(tooltips.length ? { tooltips } : undefined)}\n          diffModeEnabled={diffModeEnabled}\n        />\n      );\n\n      const childrenNodes = [];\n      if (item.type === \"topic\") {\n        childrenNodes.push(\n          ...renderStyleExpressionNodes({\n            isXSWidth,\n            topicName,\n            hasFeatureColumn,\n            linkedGlobalVariablesByTopic,\n            visible: nodeVisibleInScene,\n            width: titleWidth,\n          })\n        );\n\n        childrenNodes.push(\n          ...renderNamespaceNodes({\n            children: namespaceNodes.sort(naturalSort(\"namespace\")),\n            getIsTreeNodeVisibleInTree,\n            hasFeatureColumn,\n            isXSWidth,\n            onNamespaceOverrideColorChange,\n            setEditingNamespace,\n            topicNode: item,\n            width: titleWidth,\n            filterText,\n            diffModeEnabled,\n          })\n        );\n      }\n      if (itemChildren) {\n        childrenNodes.push(\n          ...renderTreeNodes({\n            availableNamespacesByTopic,\n            checkedKeysSet,\n            children: itemChildren,\n            getIsTreeNodeVisibleInScene,\n            getIsTreeNodeVisibleInTree,\n            getIsNamespaceCheckedByDefault,\n            hasFeatureColumn,\n            isXSWidth,\n            onNamespaceOverrideColorChange,\n            setEditingNamespace,\n            topicDisplayMode,\n            sceneErrorsByKey,\n            setCurrentEditingTopic,\n            structuralDatatypes,\n            derivedCustomSettingsByKey,\n            visibleTopicsCountByKey,\n            width: titleWidth,\n            filterText,\n            linkedGlobalVariablesByTopic,\n            diffModeEnabled,\n          })\n        );\n      }\n      return {\n        key,\n        title,\n        ...(childrenNodes.length ? { children: childrenNodes } : undefined),\n        // Add `disabled` so that the switcher has the correct color.\n        disabled: !nodeVisibleInScene,\n      };\n    })\n    .filter(Boolean);\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\n\n// TODO(Audrey): opaque type for node keys: https://flow.org/en/docs/types/opaque-types/\nexport default function generateNodeKey({\n  topicName,\n  name,\n  namespace,\n  isFeatureColumn,\n}: {|\n  topicName?: ?string,\n  name?: ?string,\n  namespace?: ?string,\n  isFeatureColumn?: boolean,\n|}): string {\n  const prefixedTopicName = topicName ? (isFeatureColumn ? `${$WEBVIZ_SOURCE_2}${topicName}` : topicName) : undefined;\n  if (namespace) {\n    if (prefixedTopicName) {\n      return `ns:${prefixedTopicName}:${namespace}`;\n    }\n    throw new Error(\n      \"Incorrect input for generating the node key. If a namespace is present, then the topicName must be present\"\n    );\n  }\n  if (prefixedTopicName) {\n    return `t:${prefixedTopicName}`;\n  }\n  if (name) {\n    return isFeatureColumn ? `name_2:${name}` : `name:${name}`;\n  }\n\n  throw new Error(`Incorrect input for generating the node key. Either topicName or name must be present.`);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport BlockHelperIcon from \"@mdi/svg/svg/block-helper.svg\";\nimport React, { useCallback } from \"react\";\nimport { type Color } from \"regl-worldview\";\nimport styled from \"styled-components\";\nimport tinyColor from \"tinycolor2\";\n\nimport { ROW_HEIGHT } from \"./TreeNodeRow\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { getHexFromColorSettingWithDefault } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/ColorPickerForTopicSettings\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const TOPIC_ROW_PADDING = 3;\n\nconst DEFAULT_COLOR = colors.LIGHT1;\nexport const DISABLED_COLOR = colors.TEXT_MUTED;\nexport const TOGGLE_WRAPPER_SIZE = 24;\n\nexport const TOGGLE_SIZE_CONFIG = {\n  NORMAL: { name: \"NORMAL\", size: 12 },\n  SMALL: { name: \"SMALL\", size: 10 },\n};\n\nconst SToggle = styled.label`\n  width: ${TOGGLE_WRAPPER_SIZE}px;\n  height: ${TOGGLE_WRAPPER_SIZE}px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  cursor: pointer;\n  outline: 0;\n  :hover {\n    background-color: rgba(255, 255, 255, 0.1);\n  }\n  :focus {\n    span {\n      border: 1px solid ${colors.BLUE} !important;\n    }\n  }\n`;\n\nconst SSpan = styled.span`\n  :hover {\n    transform: scale(1.2);\n  }\n`;\n\nexport type Size = $Keys<typeof TOGGLE_SIZE_CONFIG>;\ntype Props = {|\n  available: boolean,\n  checked: boolean,\n  dataTest?: string,\n  onAltToggle?: () => void,\n  onShiftToggle?: () => void,\n  onToggle: () => void,\n  onMouseEnter?: (MouseEvent) => void,\n  onMouseLeave?: (MouseEvent) => void,\n  overrideColor?: ?Color,\n  size?: ?Size,\n  unavailableTooltip?: string,\n  visibleInScene: boolean,\n  diffModeEnabled: boolean,\n  columnIndex: number,\n|};\n\nfunction diffModeStyleOverrides(checked: boolean, columnIndex: number): any {\n  if (!checked) {\n    return {\n      border: `1px solid ${DISABLED_COLOR}`,\n    };\n  }\n\n  const firstColor = columnIndex === 0 ? colors.DIFF_MODE_SOURCE_1 : colors.DIFF_MODE_SOURCE_BOTH;\n  const secondColor = columnIndex === 0 ? colors.DIFF_MODE_SOURCE_BOTH : colors.DIFF_MODE_SOURCE_2;\n  return {\n    background: `linear-gradient(90deg, ${firstColor} 0%, ${firstColor} 50%, ${secondColor} 51%, ${secondColor} 100%)`,\n  };\n}\n\nfunction getStyles({\n  checked,\n  visibleInScene,\n  overrideColor,\n  size,\n  diffModeEnabled,\n  columnIndex,\n}: {\n  checked: boolean,\n  visibleInScene: boolean,\n  overrideColor: ?Color,\n  size: ?Size,\n  diffModeEnabled: boolean,\n  columnIndex: number,\n}): any {\n  const sizeInNumber =\n    size === TOGGLE_SIZE_CONFIG.SMALL.name ? TOGGLE_SIZE_CONFIG.SMALL.size : TOGGLE_SIZE_CONFIG.NORMAL.size;\n  let styles = { width: sizeInNumber, height: sizeInNumber, borderRadius: sizeInNumber / 2 };\n\n  if (diffModeEnabled) {\n    return {\n      ...styles,\n      ...diffModeStyleOverrides(checked, columnIndex),\n    };\n  }\n\n  const overrideHexColor = getHexFromColorSettingWithDefault(overrideColor);\n  const { enabledColor, disabledColor } = overrideColor\n    ? {\n        enabledColor: overrideHexColor,\n        disabledColor: tinyColor(overrideHexColor)\n          .setAlpha(0.5)\n          .toRgbString(),\n      }\n    : { enabledColor: DEFAULT_COLOR, disabledColor: DISABLED_COLOR };\n\n  const color = visibleInScene ? enabledColor : disabledColor;\n  if (checked) {\n    styles = { ...styles, background: color };\n  } else {\n    styles = { ...styles, border: `1px solid ${color}` };\n  }\n\n  return styles;\n}\n\n// A toggle component that supports using tab key to focus and using space key to check/uncheck.\nexport default function VisibilityToggle({\n  available,\n  checked,\n  dataTest,\n  onAltToggle,\n  onShiftToggle,\n  onToggle,\n  overrideColor,\n  size,\n  unavailableTooltip,\n  visibleInScene,\n  onMouseEnter,\n  onMouseLeave,\n  diffModeEnabled,\n  columnIndex,\n}: Props) {\n  // Handle shift + click/enter, option + click/enter, and click/enter.\n  const onChange = useCallback((e: MouseEvent | KeyboardEvent) => {\n    if (onShiftToggle && e.shiftKey) {\n      onShiftToggle();\n    } else if (onAltToggle && e.altKey) {\n      onAltToggle();\n    } else {\n      onToggle();\n    }\n  }, [onAltToggle, onShiftToggle, onToggle]);\n\n  if (!available) {\n    return (\n      <Icon\n        tooltipProps={{ placement: \"top\" }}\n        tooltip={unavailableTooltip || \"Unavailable\"}\n        fade\n        small\n        clickable={false}\n        style={{\n          fontSize: 10,\n          cursor: \"not-allowed\",\n          height: ROW_HEIGHT,\n          width: TOGGLE_WRAPPER_SIZE,\n          display: \"inline-flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          transition: \"all 80ms ease-in-out\",\n        }}>\n        <BlockHelperIcon />\n      </Icon>\n    );\n  }\n\n  return (\n    <SToggle\n      data-test={dataTest}\n      tabIndex={0}\n      onKeyDown={(e: KeyboardEvent) => {\n        if (e.key === \"Enter\") {\n          onChange(e);\n        }\n      }}\n      onClick={onChange}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}>\n      <SSpan\n        style={getStyles({\n          checked,\n          visibleInScene,\n          size,\n          overrideColor,\n          diffModeEnabled,\n          columnIndex,\n        })}\n      />\n    </SToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport memoizeWeak from \"memoize-weak\";\nimport React, { useMemo, useCallback } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { type Time } from \"rosbag\";\nimport styled from \"styled-components\";\n\nimport AudioPlayer, { type Config } from \"./AudioPlayer\";\nimport helpContent from \"./index.help.md\";\nimport { type AudioFrame, generateSamplesFromFrames, isAudioDatatype } from \"./utils\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport SpinningLoadingIcon from \"webviz-core/src/components/SpinningLoadingIcon\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport { useBlocksByTopic } from \"webviz-core/src/PanelAPI\";\nimport BlockLoadingProgress from \"webviz-core/src/panels/Audio/BlockLoadingProgress\";\nimport type { TypedMessage } from \"webviz-core/src/players/types\";\nimport { type Header } from \"webviz-core/src/types/Messages\";\nimport { deepParse } from \"webviz-core/src/util/binaryObjects\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SContainer = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  flex-direction: column;\n`;\nconst SLoading = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\nconst SLoadingToolbarWrapper = styled.div`\n  height: 32px;\n  display: flex;\n  align-items: center;\n  background: ${colors.DARK1};\n  fill: ${colors.LIGHT};\n`;\nconst SSpinningWrapper = styled.span`\n  padding: 4px 8px;\n`;\n\nconst { defaultTopic } = getGlobalHooks().perPanelHooks().Audio;\nconst DEFAULT_SAMPLING_RATE = 48000;\nconst DEFAULT_FRAME_PER_MESSAGE = 1024;\nexport const DEFAULT_SAMPLE_VALUE = 0;\nconst DEFAULT_MESSAGE_PER_BLOCK = 4;\n\ntype AudioMessage = $ReadOnly<{|\n  header: Header,\n  sampling_rate_hz: number,\n  frames: $ReadOnlyArray<AudioFrame>,\n|}>;\n\ntype AudioBlock = TypedMessage<AudioMessage>[];\ntype MessageTimestamps = { headerStamp: Time, receiveTime: Time }[];\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n};\n\nexport type ProcessedAudioData = {|\n  channelCount: number,\n  messageTimestamps: MessageTimestamps,\n  samples: number[][],\n  samplingRate: number,\n|};\n\nconst memoizedGetAudioDataFromBlocks = memoizeWeak(\n  (audioBlocks: AudioBlock[]): ?ProcessedAudioData => {\n    if (audioBlocks.length === 0) {\n      return;\n    }\n    const firstAudioMsg = audioBlocks[0][0].message;\n    const { frames, sampling_rate_hz } = firstAudioMsg;\n    const channelCnt = frames[0].channels.length;\n\n    const audioMsgTimestamps = [];\n    const audioSamples = new Array(channelCnt).fill().map(() => []);\n\n    audioBlocks.forEach((block) => {\n      block.forEach((msg) => {\n        audioMsgTimestamps.push({ receiveTime: msg.receiveTime, headerStamp: msg.message.header.stamp });\n        const msgFrames = msg.message.frames;\n        const perMsgSample = generateSamplesFromFrames(msgFrames);\n        perMsgSample.forEach((item, channelIdx) => {\n          for (let i = 0; i < item.length; i++) {\n            audioSamples[channelIdx].push(item[i]);\n          }\n        });\n      });\n    });\n    return {\n      messageTimestamps: audioMsgTimestamps,\n      samplingRate: sampling_rate_hz,\n      samples: audioSamples,\n      channelCount: channelCnt,\n    };\n  }\n);\n\nfunction Audio({ config, config: { topicToRender: configTopic }, saveConfig }: Props) {\n  const availableTopics = useMessagePipeline(\n    useCallback(\n      ({ sortedTopics, datatypes }) => sortedTopics.filter(({ datatype }) => isAudioDatatype(datatype, datatypes)),\n      []\n    )\n  );\n  // If there's no default, pick the first available but don't save it to the config. If there are none available show\n  // \"Default (not available)\" and don't save it to the config.\n  const topicToRender = configTopic ?? defaultTopic ?? availableTopics[0] ?? \"\";\n  const isAudioTopicAvailable = useMemo(() => !!availableTopics.find((item) => item.name === topicToRender), [\n    availableTopics,\n    topicToRender,\n  ]);\n\n  const blocks = useBlocksByTopic([topicToRender]);\n  const { blockLoadingStates, isAllAudioBlocksLoaded } = useMemo(() => {\n    const blockLoadingInfo = blocks.map((block) => !!block[topicToRender]);\n    return {\n      blockLoadingStates: blockLoadingInfo,\n      isAllAudioBlocksLoaded: blockLoadingInfo.length > 0 && blockLoadingInfo.every((loaded) => !!loaded),\n    };\n  }, [blocks, topicToRender]);\n  const defaultBlocks = useMemo(\n    () =>\n      new Array(blocks.length).fill().map(() =>\n        new Array(DEFAULT_MESSAGE_PER_BLOCK).fill().map(() => ({\n          message: {\n            header: { frame_id: \"\", seq: 0, stamp: { sec: 0, nsec: 0 } },\n            sampling_rate_hz: DEFAULT_SAMPLING_RATE,\n            frames: new Array(DEFAULT_FRAME_PER_MESSAGE).fill().map(() => ({ channels: [DEFAULT_SAMPLE_VALUE] })),\n          },\n          receiveTime: { sec: 0, nsec: 0 },\n          topic: topicToRender,\n        }))\n      ),\n    [blocks.length, topicToRender]\n  );\n  const processedAudioData = useMemo(() => {\n    // Use default blocks if any audio block is not yet loaded.\n    const nonEmptyBlocks = !isAllAudioBlocksLoaded\n      ? defaultBlocks\n      : blocks\n          .map((block) => {\n            const audioBlock = block[topicToRender];\n            // memoizedGetAudioDataFromBlocks expects each audioBlock to not be empty since it needs to read at least one msg to\n            // get sampling rate and channel count.\n            if (audioBlock.length === 0) {\n              return undefined;\n            }\n            return ((audioBlock.map((msg) => ({\n              ...msg,\n              message: deepParse(msg.message),\n            })): any): AudioBlock);\n          })\n          .filter(Boolean);\n    return memoizedGetAudioDataFromBlocks(nonEmptyBlocks);\n  }, [isAllAudioBlocksLoaded, defaultBlocks, blocks, topicToRender]);\n\n  const renderAudioPlayer = isAllAudioBlocksLoaded && processedAudioData;\n  return (\n    <SContainer>\n      <PanelToolbar\n        helpContent={helpContent}\n        additionalIcons={\n          <TopicToRenderMenu\n            topicToRender={topicToRender}\n            onChange={(topic) => saveConfig({ topicToRender: topic })}\n            topics={availableTopics}\n            defaultTopicToRender={defaultTopic}\n          />\n        }\n        floating\n      />\n      {!isAudioTopicAvailable && <EmptyState>No audio messages</EmptyState>}\n      {renderAudioPlayer && <AudioPlayer config={config} {...processedAudioData} saveConfig={saveConfig} />}\n      {!renderAudioPlayer && isAudioTopicAvailable && (\n        <SLoading>\n          <Flex center style={{ flex: 1 }}>\n            <BlockLoadingProgress blockLoadingStates={blockLoadingStates} />\n          </Flex>\n          <SLoadingToolbarWrapper>\n            <SSpinningWrapper>\n              <SpinningLoadingIcon />\n            </SSpinningWrapper>\n            Loading audio...\n          </SLoadingToolbarWrapper>\n        </SLoading>\n      )}\n    </SContainer>\n  );\n}\n\nAudio.panelType = \"Audio\";\n\nAudio.defaultConfig = {\n  showAllChannels: false,\n  volume: 1,\n  playbackRate: 1,\n  selectedChannel: 0,\n  topicToRender: defaultTopic,\n};\n\nexport default hot(Panel<Config>(Audio));\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport audioBufferToWav from \"audiobuffer-to-wav\";\n\nimport { DEFAULT_SAMPLE_VALUE } from \"./index\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { isNumberType } from \"webviz-core/src/util/binaryObjects/messageDefinitionUtils\";\n\nexport type AudioSample = number[];\n\nexport type AudioFrame = {\n  channels: $ReadOnlyArray<number>,\n};\n\nexport const isAudioDatatype = (typeName: string, datatypes: RosDatatypes) => {\n  const datatype = datatypes[typeName];\n  if (datatype == null) {\n    return false;\n  }\n  return (\n    datatype.fields.some(({ name, type }) => name === \"sampling_rate_hz\" && isNumberType(type)) &&\n    datatype.fields.some(({ name, isArray }) => name === \"frames\" && isArray) &&\n    datatype.fields.some(({ name }) => name === \"header\")\n  );\n};\n\ntype Bound = {\n  min: number,\n  max: number,\n  missingData: boolean,\n};\n\ntype WaveformConfig = {\n  color: string,\n  playedColor: string,\n  missingDataColor: string,\n  activeChannelColor: string,\n  activeChannelPlayedColor: string,\n  markerColor: string,\n  pointWidth: number,\n  heightScaleFactor: number,\n  multiChannelHeightScaleFactor: number,\n};\n\n// convert the frame data we got from ROS messages to audio samples\nexport function generateSamplesFromFrames(frames: $ReadOnlyArray<AudioFrame>): AudioSample[] {\n  const samples = new Array(frames[0].channels.length).fill().map(() => []);\n  for (let i = 0; i < frames.length; i++) {\n    const channels = frames[i].channels;\n    for (let c = 0; c < channels.length; c++) {\n      // scale the AudioFrame which is formatted as int32 to [-1, 1]\n      // by dividing by 2**31\n      samples[c].push(channels[c] / 2147483648);\n    }\n  }\n  return samples;\n}\n\nexport function generateAudioBuffersFromSample(\n  samples: AudioSample[],\n  selectedChanel: number,\n  showAllChannels: boolean,\n  audioContext: AudioContext,\n  samplingRate: number\n): AudioBuffer[] {\n  const samplesAlt = showAllChannels ? samples : [samples[selectedChanel]];\n  return samplesAlt.map((sample) => {\n    // left and right output will have the data from the same selected channel\n    const newBuffer = audioContext.createBuffer(1, sample.length, samplingRate);\n    const floatArray = Float32Array.from(sample);\n    newBuffer.copyToChannel(floatArray, 0, 0);\n    return newBuffer;\n  });\n}\n\n// Get the min and max value of an array, more performant to use for loop.\n// Mark the bound as missing data if both min and max are equal DEFAULT_SAMPLE_VALUE.\nfunction getBound(values) {\n  let min = Infinity;\n  let max = -Infinity;\n  for (let i = 0; i < values.length; i++) {\n    const value = values[i];\n    min = value > min ? min : value;\n    max = value < max ? max : value;\n  }\n  return { min, max, missingData: min === DEFAULT_SAMPLE_VALUE && max === DEFAULT_SAMPLE_VALUE };\n}\n\n// calculate the bounds of each step in the buffer\nfunction getBoundArray(wave: Float32Array, pointCount: number, step: number): Bound[] {\n  const bounds = [];\n  for (let i = 0; i < pointCount; i++) {\n    // get the max and min values at this step\n    bounds.push(getBound(wave.slice(i * step, i * step + step)));\n  }\n  return bounds;\n}\n\n// generate wave data based on the audio buffer, canvas width and pointWidth\nexport function calculateWaveformData(buffer: ?AudioBuffer, width: number, pointWidth: number): Bound[] {\n  if (!buffer) {\n    return [];\n  }\n  const wave = buffer.getChannelData(0);\n  const pointCount = width / pointWidth;\n  // total steps we are drawing\n  const step = Math.ceil(wave.length / pointCount);\n  // get the bounds (min and max) for each step\n  return getBoundArray(wave, pointCount, step);\n}\n\n// draw the waveform points\nfunction drawPoints({\n  ctx,\n  color,\n  missingDataColor,\n  bounds,\n  maxAmp,\n  offsetX,\n  offsetY,\n  pointWidth,\n  heightScaleFactor,\n}: {|\n  ctx: CanvasRenderingContext2D,\n  color: string,\n  missingDataColor: string,\n  bounds: Bound[],\n  maxAmp: number,\n  offsetX: number,\n  offsetY: number,\n  pointWidth: number,\n  heightScaleFactor: number,\n|}) {\n  ctx.fillStyle = color;\n\n  for (let i = 0; i < bounds.length; i++) {\n    const bound = bounds[i];\n    const x = i * pointWidth + offsetX;\n    const y = (1 + bound.min) * maxAmp + offsetY;\n    const fillStyle = bound.missingData ? missingDataColor : color;\n    if (ctx.fillStyle !== fillStyle) {\n      ctx.fillStyle = fillStyle;\n    }\n    const height = Math.max(1, (bound.max - bound.min) * maxAmp);\n    const offset = Math.floor(heightScaleFactor / 2);\n    // draw a point, offset a little so the waveform looks centered vertically\n    // the alternative is to draw: ctx.fillRect(x, y, width - 1, height);\n    ctx.fillRect(x, y - height * offset, pointWidth - 1, height * heightScaleFactor);\n  }\n}\n\n// draw the waveform on the provided canvas\nexport function drawWaveform(\n  bounds: Bound[][],\n  canvas: ?HTMLCanvasElement,\n  waveformConfig: WaveformConfig,\n  playedRatio: number = 0,\n  selectedChanel: number = 0\n) {\n  if (!canvas || !bounds.length || !bounds[0].length) {\n    return;\n  }\n  const ctx = canvas.getContext(\"2d\");\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  const pointWidth = waveformConfig.pointWidth;\n  const hasMultiWaveForms = bounds.length > 1;\n  const heightScaleFactor = hasMultiWaveForms\n    ? waveformConfig.multiChannelHeightScaleFactor\n    : waveformConfig.heightScaleFactor;\n\n  // find the max height we can draw\n  const maxAmp = canvas.height / (2 * bounds.length);\n  const maxPlayedBound = Math.ceil(bounds[0].length * playedRatio);\n  const playedAll = maxPlayedBound === bounds[0].length;\n  let playedBounds = [];\n  let unplayedBounds = [];\n  bounds.forEach((channelBounds, idx) => {\n    if (playedAll) {\n      playedBounds = channelBounds;\n      unplayedBounds = [];\n    } else if (maxPlayedBound === 0) {\n      playedBounds = [];\n      unplayedBounds = channelBounds;\n    } else {\n      playedBounds = channelBounds.slice(0, maxPlayedBound);\n      unplayedBounds = channelBounds.slice(maxPlayedBound, channelBounds.length);\n    }\n    const useActiveChannelColor = (hasMultiWaveForms && selectedChanel === idx) || !hasMultiWaveForms;\n\n    // set up drawing style for unplayed waveform\n    const unplayedDrawColor = useActiveChannelColor ? waveformConfig.activeChannelColor : waveformConfig.color;\n    const offsetX = playedBounds.length * pointWidth;\n    drawPoints({\n      ctx,\n      color: unplayedDrawColor,\n      missingDataColor: waveformConfig.missingDataColor,\n      bounds: unplayedBounds,\n      maxAmp,\n      offsetX,\n      offsetY: maxAmp * idx * 2,\n      pointWidth,\n      heightScaleFactor,\n    });\n\n    // set up drawing style for played waveform\n    const playedDrawColor = useActiveChannelColor\n      ? waveformConfig.activeChannelPlayedColor\n      : waveformConfig.playedColor;\n    drawPoints({\n      ctx,\n      color: playedDrawColor,\n      missingDataColor: waveformConfig.missingDataColor,\n      bounds: playedBounds,\n      maxAmp,\n      offsetX: 0,\n      offsetY: maxAmp * idx * 2,\n      pointWidth,\n      heightScaleFactor,\n    });\n  });\n\n  // draw the marker\n  ctx.fillStyle = waveformConfig.markerColor;\n  ctx.fillRect((playedBounds.length - 1) * pointWidth, 0, pointWidth, canvas.height);\n}\n\nexport function bufferToFileBlob(buffer: AudioBuffer): Blob {\n  const wav = audioBufferToWav(buffer, null);\n  return new window.Blob([new DataView(wav)], { type: \"audio/wav\" });\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// Fuzzy matching: allow filter \"fzmg\" to match \"fuzzy/matching\".\n// Score by how early in the string matches appear.\nexport default function fuzzyFilter<T>(\n  options: T[],\n  filter: ?string,\n  getText: (T) => string = (x: any) => x,\n  sort: boolean = true\n): T[] {\n  if (!filter) {\n    return options;\n  }\n  const needle = filter.toLowerCase().replace(/[^a-z0-9]/g, \"\");\n  if (needle.length === 0) {\n    return options;\n  }\n\n  type Result = {| option: T, score: number |};\n  const results: Result[] = [];\n\n  for (const option of options) {\n    const haystack = getText(option).toLowerCase();\n    let charPos = -1;\n    let score = 0;\n    for (const char of needle) {\n      charPos = haystack.indexOf(char, charPos + 1);\n      if (charPos === -1) {\n        break;\n      }\n      score += charPos;\n    }\n    if (charPos !== -1) {\n      results.push({\n        option,\n        score: score * haystack.length,\n      });\n    }\n  }\n\n  if (sort) {\n    results.sort((a, b) => a.score - b.score);\n  }\n  return results.map((result: Result): T => result.option);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nconst RosPrimitives = {\n  bool: null,\n  int8: null,\n  uint8: null,\n  int16: null,\n  uint16: null,\n  int32: null,\n  uint32: null,\n  int64: null,\n  uint64: null,\n  float32: null,\n  float64: null,\n  string: null,\n  time: null,\n  duration: null,\n  json: null,\n};\n\nexport type RosPrimitive = $Keys<typeof RosPrimitives>;\nexport const rosPrimitives: RosPrimitive[] = Object.keys(RosPrimitives);\n\nexport type MessagePathFilter = {|\n  type: \"filter\",\n  path: string[],\n  value: void | number | string | {| variableName: string, startLoc: number |},\n  nameLoc: number,\n  valueLoc: number,\n  repr: string, // the original string representation of the filter\n|};\n\n// A parsed version of paths.\nexport type MessagePathPart =\n  | {| type: \"name\", name: string |}\n  | {|\n      type: \"slice\",\n      start: number | {| variableName: string, startLoc: number |},\n      end: number | {| variableName: string, startLoc: number |},\n    |}\n  | MessagePathFilter;\n\nexport type RosPath = {|\n  topicName: string,\n  messagePath: MessagePathPart[],\n  modifier: ?string,\n|};\n\n// \"Structure items\" are a more useful version of `datatypes`. They can be\n// easily traversed to either validate message paths or generate message paths.\nexport type MessagePathStructureItemMessage = {|\n  structureType: \"message\",\n  nextByName: { [string]: MessagePathStructureItem }, // eslint-disable-line no-use-before-define\n  datatype: string,\n|};\ntype MessagePathStructureItemArray = {|\n  structureType: \"array\",\n  next: MessagePathStructureItem, // eslint-disable-line no-use-before-define\n  datatype: string,\n|};\ntype MessagePathStructureItemPrimitive = {|\n  structureType: \"primitive\",\n  primitiveType: RosPrimitive,\n  datatype: string,\n|};\nexport type MessagePathStructureItem =\n  | MessagePathStructureItemMessage\n  | MessagePathStructureItemArray\n  | MessagePathStructureItemPrimitive;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { groupBy, mapValues } from \"lodash\";\nimport { TimeUtil, type Time } from \"rosbag\";\n\nimport { cast, type Message } from \"webviz-core/src/players/types\";\nimport type { RosObject } from \"webviz-core/src/players/types\";\nimport type { StampedMessage } from \"webviz-core/src/types/Messages\";\nimport { maybeGetBobjectHeaderStamp } from \"webviz-core/src/util/binaryObjects\";\n\nexport const defaultGetHeaderStamp = (message: ?$ReadOnly<RosObject>): ?Time => {\n  if (message != null && message.header != null) {\n    return cast<StampedMessage>(message).header.stamp;\n  }\n};\n\nfunction allMessageStampsNewestFirst(\n  messagesByTopic: $ReadOnly<{ [topic: string]: $ReadOnlyArray<Message> }>,\n  getHeaderStamp?: (itemMessage: Message) => ?Time\n) {\n  const stamps = [];\n  for (const topic in messagesByTopic) {\n    for (const message of messagesByTopic[topic]) {\n      const stamp = getHeaderStamp ? getHeaderStamp(message) : defaultGetHeaderStamp(message.message);\n      if (stamp) {\n        stamps.push(stamp);\n      }\n    }\n  }\n  return stamps.sort((a, b) => -TimeUtil.compare(a, b));\n}\n\n// Get a subset of items matching a particular timestamp\nfunction messagesMatchingStamp(\n  stamp: Time,\n  messagesByTopic: $ReadOnly<{ [topic: string]: $ReadOnlyArray<Message> }>,\n  getHeaderStamp?: (itemMessage: Message) => ?Time\n): ?$ReadOnly<{ [topic: string]: $ReadOnlyArray<Message> }> {\n  const synchronizedMessagesByTopic = {};\n  for (const topic in messagesByTopic) {\n    const synchronizedMessage = messagesByTopic[topic].find((message) => {\n      const thisStamp = getHeaderStamp ? getHeaderStamp(message) : defaultGetHeaderStamp(message.message);\n      return thisStamp && TimeUtil.areSame(stamp, thisStamp);\n    });\n    if (synchronizedMessage != null) {\n      synchronizedMessagesByTopic[topic] = [synchronizedMessage];\n    } else {\n      return null;\n    }\n  }\n  return synchronizedMessagesByTopic;\n}\n\n// Return a synchronized subset of the messages in `messagesByTopic` with exactly matching\n// header.stamps.\n// If multiple sets of synchronized messages are included, the one with the later header.stamp is\n// returned.\nexport default function synchronizeMessages(\n  messagesByTopic: $ReadOnly<{ [topic: string]: $ReadOnlyArray<Message> }>,\n  getHeaderStamp?: (itemMessage: Message) => ?Time\n): ?$ReadOnly<{ [topic: string]: $ReadOnlyArray<Message> }> {\n  for (const stamp of allMessageStampsNewestFirst(messagesByTopic, getHeaderStamp)) {\n    const synchronizedMessagesByTopic = messagesMatchingStamp(stamp, messagesByTopic, getHeaderStamp);\n    if (synchronizedMessagesByTopic != null) {\n      return synchronizedMessagesByTopic;\n    }\n  }\n  return null;\n}\n\nfunction getSynchronizedMessages(\n  stamp: Time,\n  topics: $ReadOnlyArray<string>,\n  messages: { [topic: string]: Message[] }\n): ?{ [topic: string]: Message } {\n  const synchronizedMessages = {};\n  for (const topic of topics) {\n    const matchingMessage = messages[topic].find(({ message }) => {\n      const thisStamp = maybeGetBobjectHeaderStamp(message);\n      return thisStamp && TimeUtil.areSame(stamp, thisStamp);\n    });\n    if (!matchingMessage) {\n      return null;\n    }\n    synchronizedMessages[topic] = matchingMessage;\n  }\n  return synchronizedMessages;\n}\n\ntype ReducedValue = {|\n  messagesByTopic: { [topic: string]: Message[] },\n  synchronizedMessages: ?{ [topic: string]: Message },\n|};\n\nfunction getSynchronizedState(\n  topics: $ReadOnlyArray<string>,\n  { messagesByTopic, synchronizedMessages }: ReducedValue\n): ReducedValue {\n  let newMessagesByTopic = messagesByTopic;\n  let newSynchronizedMessages = synchronizedMessages;\n\n  const headerStamps = allMessageStampsNewestFirst(messagesByTopic, ({ message }) =>\n    maybeGetBobjectHeaderStamp(message)\n  );\n  for (const stamp of headerStamps) {\n    const syncedMsgs = getSynchronizedMessages(stamp, topics, messagesByTopic);\n    if (syncedMsgs) {\n      // We've found a new synchronized set; remove messages older than these.\n      newSynchronizedMessages = syncedMsgs;\n      newMessagesByTopic = mapValues(newMessagesByTopic, (msgsByTopic) =>\n        msgsByTopic.filter(({ message }) => {\n          const thisStamp = maybeGetBobjectHeaderStamp(message);\n          return thisStamp && !TimeUtil.isLessThan(thisStamp, stamp);\n        })\n      );\n      break;\n    }\n  }\n  return { messagesByTopic: newMessagesByTopic, synchronizedMessages: newSynchronizedMessages };\n}\n\n// Returns reducers for use with PanelAPI.useMessageReducer\nexport function getSynchronizingReducers(topics: $ReadOnlyArray<string>) {\n  return {\n    restore(previousValue: ?ReducedValue) {\n      const messagesByTopic = {};\n      for (const topic of topics) {\n        messagesByTopic[topic] = (previousValue && previousValue.messagesByTopic[topic]) || [];\n      }\n      return getSynchronizedState(topics, { messagesByTopic, synchronizedMessages: null });\n    },\n    addBobjects({ messagesByTopic, synchronizedMessages }: ReducedValue, newMessages: $ReadOnlyArray<Message>) {\n      // Add newMessages to messagesByTopic\n      const newMessagesByTopic = groupBy(newMessages, \"topic\");\n      Object.keys(messagesByTopic).forEach((topic) => {\n        newMessagesByTopic[topic] = messagesByTopic[topic].concat(newMessagesByTopic[topic] ?? []);\n      });\n\n      return getSynchronizedState(topics, { messagesByTopic: newMessagesByTopic, synchronizedMessages });\n    },\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { max, min, flatten } from \"lodash\";\nimport React, { memo, useEffect, useCallback, useState, useRef, useMemo } from \"react\";\nimport DocumentEvents from \"react-document-events\";\nimport ReactDOM from \"react-dom\";\nimport styled from \"styled-components\";\nimport uuid from \"uuid\";\n\nimport TimeBasedChartTooltip from \"./TimeBasedChartTooltip\";\nimport {\n  useSyncedTimeAxis,\n  stepSize,\n  type TimeBasedChartTooltipData,\n  type DataSet,\n  scalePerPixel,\n  filterDatasets,\n  useForceRerenderOnVisibilityChange,\n} from \"./utils\";\nimport Button from \"webviz-core/src/components/Button\";\nimport GLChart from \"webviz-core/src/components/GLChart\";\nimport HoverBar, { getChartTopAndHeight, SBar } from \"webviz-core/src/components/HoverBar\";\nimport { useClearHoverValue, useSetHoverValue } from \"webviz-core/src/components/HoverBar/context\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport ReactChartjs, {\n  type HoveredElement,\n  type ChartCallbacks,\n  type ScaleOptions,\n  DEFAULT_PROPS,\n} from \"webviz-core/src/components/ReactChartjs\";\nimport {\n  getChartValue,\n  inBounds,\n  getChartPx,\n  type ScaleBounds,\n} from \"webviz-core/src/components/ReactChartjs/zoomAndPanHelpers\";\nimport TimeBasedChartLegend from \"webviz-core/src/components/TimeBasedChart/TimeBasedChartLegend\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport mixins from \"webviz-core/src/styles/mixins.module.scss\";\nimport { useDeepChangeDetector, useDeepMemo, useForceUpdate } from \"webviz-core/src/util/hooks\";\n\nconst SRoot = styled.div`\n  position: relative;\n`;\n\nconst SResetZoom = styled.div`\n  position: absolute;\n  bottom: 33px;\n  right: 10px;\n`;\n\nconst SLegend = styled.div`\n  display: flex;\n  width: 10%;\n  min-width: 90px;\n  overflow-y: auto;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: start;\n  padding: 30px 0px 10px 0px;\n`;\n\nconst SCurrentTimeBar = styled.div`\n  position: absolute;\n  top: 6px;\n  bottom: 0;\n  width: 1px;\n  background: #aaa;\n  will-change: transform;\n  pointer-events: none;\n`;\n\n// Sometimes a click gets fired at the end of a pan. Probably subtle touchpad stuff. Ignore \"clicks\"\n// that happen too soon after a pan.\nconst PAN_CLICK_SUPPRESS_THRESHOLD_MS = 100;\n// Drag-pans and playback following sometimes fight. We suppress automatic following moves during\n// drag pans to avoid it.\nconst FOLLOW_PLAYBACK_PAN_THRESHOLD_MS = 100;\n\nconst MemoizedTooltips = memo<{}>(function Tooltips() {\n  return (\n    <React.Fragment>\n      <Tooltip contents={<div>Hold v to zoom vertically, or b to zoom both axes</div>} delay={0}>\n        <div style={{ position: \"absolute\", left: 0, top: 0, width: 30, bottom: 0 }} />\n      </Tooltip>\n    </React.Fragment>\n  );\n});\n\ntype FollowPlaybackState = $ReadOnly<{|\n  xOffsetMin: number, // -1 means the left edge of the plot is one second before the current time.\n  xOffsetMax: number, // 1 means the right edge of the plot is one second after the current time.\n|}>;\n\n// Calculation mode for the \"reset view\" view.\nexport type ChartDefaultView =\n  | void // Zoom to fit\n  | {| type: \"fixed\", minXValue: number, maxXValue: number |}\n  | {| type: \"following\", width: number |};\n\ntype Props = {|\n  type: \"scatter\" | \"multicolorLine\",\n  width: number,\n  height: number,\n  zoom: boolean,\n  data: {| datasets: $ReadOnlyArray<DataSet>, yLabels?: $ReadOnlyArray<string>, minIsZero?: boolean |},\n  tooltips?: TimeBasedChartTooltipData[],\n  xAxes?: any,\n  yAxes: any,\n  annotations?: any[],\n  drawLegend?: boolean,\n  isSynced?: boolean,\n  canToggleLines?: boolean,\n  toggleLine?: (datasetId: string | typeof undefined, lineToHide: string) => void,\n  linesToHide?: { [string]: boolean },\n  datasetId?: string,\n  onClick?: ?(SyntheticMouseEvent<HTMLCanvasElement>, datalabel: ?any, values: { [axis: string]: number }) => void,\n  saveCurrentView?: (minY: number, maxY: number, width: ?number) => void,\n  // If the x axis represents playback time (\"timestamp\"), the hover cursor will be synced.\n  // Note, this setting should not be used for other time values.\n  xAxisIsPlaybackTime: boolean,\n  plugins?: any,\n  scaleOptions?: ?ScaleOptions,\n  currentTime?: ?number,\n  defaultView?: ChartDefaultView,\n  renderPath?: \"webgl\" | \"chartjs\",\n|};\n\n// Create a chart with any y-axis but with an x-axis that shows time since the\n// start of the bag, and which is kept in sync with other instances of this\n// component. Uses chart.js internally, with a zoom/pan plugin, and with our\n// standard tooltips.\nexport default memo<Props>(function TimeBasedChart(props: Props) {\n  const { data, defaultView, currentTime, linesToHide, isSynced } = props;\n  const chartCallbacks = React.useRef<?ChartCallbacks>(null);\n  const tooltip = useRef<?HTMLDivElement>(null);\n  const hasUnmounted = useRef<boolean>(false);\n\n  const [hasUserPannedOrZoomed, setHasUserPannedOrZoomed] = useState<boolean>(false);\n  const hasUserPannedOrZoomedRef = useRef(hasUserPannedOrZoomed);\n  hasUserPannedOrZoomedRef.current = hasUserPannedOrZoomed;\n  const [followPlaybackState, setFollowPlaybackState] = useState<?FollowPlaybackState>(null);\n\n  useForceRerenderOnVisibilityChange();\n\n  const { saveCurrentView, yAxes } = props;\n  const forceUpdate = useForceUpdate();\n  const scaleBounds = useRef<?$ReadOnlyArray<ScaleBounds>>();\n  const hoverBar = useRef<?HTMLElement>();\n  const onScaleBoundsUpdate = useCallback((scales) => {\n    const previousScaleBounds = scaleBounds.current;\n    scaleBounds.current = scales;\n    if (!previousScaleBounds) {\n      // Ensure that we force a re-render the first time we set the scaleBounds.\n      forceUpdate();\n    }\n    const firstYScale = scales.find(({ axes }) => axes === \"yAxes\");\n    const firstXScale = scales.find(({ axes }) => axes === \"xAxes\");\n    const width = firstXScale && firstXScale.max - firstXScale.min;\n    if (firstYScale && saveCurrentView && typeof firstYScale.min === \"number\" && typeof firstYScale.max === \"number\") {\n      saveCurrentView(firstYScale.min, firstYScale.max, width);\n    }\n  }, [forceUpdate, saveCurrentView]);\n\n  const { onClick } = props;\n  const lastPanTime = useRef<?Date>();\n\n  const onClickAddingValues = useCallback((ev: SyntheticMouseEvent<HTMLCanvasElement>, datalabel: ?any) => {\n    if (!onClick) {\n      return;\n    }\n    if (lastPanTime.current && new Date() - lastPanTime.current < PAN_CLICK_SUPPRESS_THRESHOLD_MS) {\n      // Ignore clicks that happen too soon after a pan. Sometimes clicks get fired at the end of\n      // drags on touchpads.\n      return;\n    }\n    const values = {};\n    (scaleBounds.current || []).forEach((bounds) => {\n      const chartPx =\n        bounds.axes === \"xAxes\"\n          ? // $FlowFixMe: getBoundingClientRect, ClientRect.x\n            ev.clientX - ev.target.getBoundingClientRect().x\n          : // $FlowFixMe: getBoundingClientRect, ClientRect.y\n            ev.clientY - ev.target.getBoundingClientRect().y;\n      const value = getChartValue(bounds, chartPx);\n      if (value == null) {\n        return;\n      }\n      values[bounds.id] = value;\n    });\n    return onClick(ev, datalabel, values);\n  }, [onClick]);\n\n  // Keep a ref to props.currentTime so onPanZoom can have stable identity\n  const currentTimeRef = useRef<?number>();\n  currentTimeRef.current = currentTime;\n  const onPanZoom = useCallback((newScaleBounds: ScaleBounds[]) => {\n    if (!hasUserPannedOrZoomedRef.current) {\n      setHasUserPannedOrZoomed(true);\n    }\n    // Preloaded plots follow playback at a fixed zoom and x-offset unless the user is in the\n    // initial \"zoom to fit\" state. Subsequent zooms/pans adjust the offsets.\n    const bounds = newScaleBounds.find(({ axes }) => axes === \"xAxes\");\n    if (bounds != null && bounds.min != null && bounds.max != null && currentTimeRef.current != null) {\n      const currentTimeFromRef = currentTimeRef.current;\n      setFollowPlaybackState({\n        xOffsetMin: bounds.min - currentTimeFromRef,\n        xOffsetMax: bounds.max - currentTimeFromRef,\n      });\n    }\n    lastPanTime.current = new Date();\n  }, []);\n\n  const onResetZoom = useCallback(() => {\n    if (chartCallbacks.current) {\n      chartCallbacks.current.resetZoom();\n      setHasUserPannedOrZoomed(false);\n    }\n    setFollowPlaybackState(null);\n  }, [setHasUserPannedOrZoomed, setFollowPlaybackState]);\n\n  if (useDeepChangeDetector([props.defaultView], false)) {\n    // Reset the view to the default when the default changes.\n    if (hasUserPannedOrZoomed) {\n      setHasUserPannedOrZoomed(false);\n    }\n    if (followPlaybackState != null) {\n      setFollowPlaybackState(null);\n    }\n  }\n\n  const [hasVerticalExclusiveZoom, setHasVerticalExclusiveZoom] = useState<boolean>(false);\n  const [hasBothAxesZoom, setHasBothAxesZoom] = useState<boolean>(false);\n  let zoomMode = \"x\";\n  if (hasVerticalExclusiveZoom) {\n    zoomMode = \"y\";\n  } else if (hasBothAxesZoom) {\n    zoomMode = \"xy\";\n  }\n  const keyDownHandlers = useMemo(\n    () => ({\n      v: () => setHasVerticalExclusiveZoom(true),\n      b: () => setHasBothAxesZoom(true),\n    }),\n    [setHasVerticalExclusiveZoom, setHasBothAxesZoom]\n  );\n  const keyUphandlers = useMemo(\n    () => ({\n      v: () => setHasVerticalExclusiveZoom(false),\n      b: () => setHasBothAxesZoom(false),\n    }),\n    [setHasVerticalExclusiveZoom, setHasBothAxesZoom]\n  );\n\n  const removeTooltip = useCallback(() => {\n    if (tooltip.current) {\n      ReactDOM.unmountComponentAtNode(tooltip.current);\n    }\n    if (tooltip.current && tooltip.current.parentNode) {\n      // Satisfy flow.\n      tooltip.current.parentNode.removeChild(tooltip.current);\n      tooltip.current = null;\n    }\n  }, []);\n  // Always clean up tooltips when unmounting.\n  useEffect(() => {\n    return () => {\n      hasUnmounted.current = true;\n      removeTooltip();\n    };\n  }, [removeTooltip]);\n\n  const tooltips = props.tooltips || [];\n  // We use a custom tooltip so we can style it more nicely, and so that it can break\n  // out of the bounds of the canvas, in case the panel is small.\n  const updateTooltip = useCallback((canvas: HTMLCanvasElement, tooltipItem: ?HoveredElement) => {\n    // This is an async callback, so it can fire after this component is unmounted. Make sure that we remove the\n    // tooltip if this fires after unmount.\n    if (!tooltipItem || hasUnmounted.current) {\n      return removeTooltip();\n    }\n\n    // We have to iterate through all of the tooltips every time the user hovers over a point. However, the cost of\n    // running this search is small (< 10ms even with many tooltips) compared to the cost of indexing tooltips by\n    // coordinates and we care more about render time than tooltip responsiveness.\n    const tooltipData = tooltips.find(\n      (_tooltip) => _tooltip.x === tooltipItem.data.x && String(_tooltip.y) === String(tooltipItem.data.y)\n    );\n    if (!tooltipData) {\n      return removeTooltip();\n    }\n\n    if (!tooltip.current) {\n      tooltip.current = document.createElement(\"div\");\n      if (canvas.parentNode) {\n        canvas.parentNode.appendChild(tooltip.current);\n      }\n    }\n\n    if (tooltip.current) {\n      ReactDOM.render(\n        <TimeBasedChartTooltip tooltip={tooltipData}>\n          <div\n            style={{\n              position: \"absolute\",\n              left: 0,\n              top: 0,\n              transform: `translate(${tooltipItem.view.x}px, ${tooltipItem.view.y}px)`,\n            }}\n          />\n        </TimeBasedChartTooltip>,\n        tooltip.current\n      );\n    }\n  }, [removeTooltip, tooltips]);\n\n  const [hoverComponentId] = useState(() => uuid.v4());\n  const { xAxisIsPlaybackTime } = props;\n  const clearHoverValue = useClearHoverValue();\n  const setHoverValue = useSetHoverValue();\n  const clearGlobalHoverTime = useCallback(() => {\n    clearHoverValue(hoverComponentId);\n  }, [clearHoverValue, hoverComponentId]);\n  const setGlobalHoverTime = useCallback((value) => {\n    setHoverValue({ componentId: hoverComponentId, value, type: xAxisIsPlaybackTime ? \"PLAYBACK_SECONDS\" : \"OTHER\" });\n  }, [hoverComponentId, setHoverValue, xAxisIsPlaybackTime]);\n\n  const onMouseMove = useCallback(async (event: MouseEvent) => {\n    const canvas = chartCallbacks.current && chartCallbacks.current.canvasRef.current;\n    if (!canvas) {\n      removeTooltip();\n      clearGlobalHoverTime();\n      return;\n    }\n    const canvasRect = canvas.getBoundingClientRect();\n    const xBounds = scaleBounds.current && scaleBounds.current.find(({ axes }) => axes === \"xAxes\");\n    const yBounds = scaleBounds.current && scaleBounds.current.find(({ axes }) => axes === \"yAxes\");\n    const xMousePosition = event.pageX - canvasRect.left;\n    const yMousePosition = event.pageY - canvasRect.top;\n    const isTargetingCanvas = event.target === canvas;\n    if (!inBounds(xMousePosition, xBounds) || !inBounds(yMousePosition, yBounds) || !isTargetingCanvas) {\n      removeTooltip();\n      clearGlobalHoverTime();\n      return;\n    }\n\n    const value = getChartValue(xBounds, xMousePosition);\n    if (value != null) {\n      setGlobalHoverTime(value);\n    } else {\n      clearGlobalHoverTime();\n    }\n\n    if (tooltips && tooltips.length && chartCallbacks.current) {\n      const tooltipElement = await chartCallbacks.current.getElementAtXAxis(event);\n      updateTooltip(canvas, tooltipElement);\n    } else {\n      removeTooltip();\n    }\n  }, [updateTooltip, removeTooltip, tooltips, clearGlobalHoverTime, setGlobalHoverTime, scaleBounds]);\n\n  // Normally we set the x axis step-size and display automatically, but we need consistency when\n  // scrolling with playback because the vertical lines can flicker, and x axis labels can have an\n  // inconsistent number of digits.\n  const xBounds = useDeepMemo(scaleBounds.current && scaleBounds.current.find(({ axes }) => axes === \"xAxes\"));\n  const yBounds = useDeepMemo(scaleBounds.current && scaleBounds.current.find(({ axes }) => axes === \"yAxes\"));\n\n  const xScaleOptions = useMemo(() => followPlaybackState && xBounds && stepSize(xBounds), [\n    followPlaybackState,\n    xBounds,\n  ]);\n\n  const filteredData = useMemo(\n    () => ({\n      ...data,\n      datasets: filterDatasets(data.datasets, linesToHide || {}, scalePerPixel(xBounds), scalePerPixel(yBounds)),\n    }),\n    [data, linesToHide, xBounds, yBounds]\n  );\n\n  let minX, maxX;\n  const xVals = flatten(data.datasets.map(({ data: pts }) => (pts.length > 1 ? pts.map(({ x }) => x) : undefined)));\n  if (defaultView == null || (defaultView.type === \"following\" && currentTime == null)) {\n    // Zoom to fit if the view is \"following\" but there's no playback cursor. Unlikely.\n    minX = min(xVals);\n    maxX = max(xVals);\n  } else if (defaultView.type === \"fixed\") {\n    minX = defaultView.minXValue;\n    maxX = defaultView.maxXValue;\n  } else {\n    // Following with non-null currentTime.\n    if (currentTime == null) {\n      throw new Error(\"Flow doesn't know that currentTime != null\");\n    }\n    minX = currentTime - defaultView.width / 2;\n    maxX = currentTime + defaultView.width / 2;\n  }\n\n  // only sync when using x-axis timestamp and actually plotting data.\n  const hasData = filteredData.datasets.some((dataset) => dataset.data.length);\n  const usingSyncedBounds = !!isSynced && currentTime == null && xAxisIsPlaybackTime && hasData;\n  const syncedBounds = useSyncedTimeAxis({ minX, maxX }, usingSyncedBounds);\n  const syncedMinX = syncedBounds.minX != null ? min([minX, syncedBounds.minX]) : minX;\n  const syncedMaxX = syncedBounds.maxX != null ? max([maxX, syncedBounds.maxX]) : maxX;\n\n  const bounds = usingSyncedBounds ? { minX: syncedMinX, maxX: syncedMaxX } : { minX, maxX };\n\n  const enableFollowingPlayback =\n    followPlaybackState &&\n    (lastPanTime.current == null || new Date() - lastPanTime.current > FOLLOW_PLAYBACK_PAN_THRESHOLD_MS);\n  const followPlaybackCurrentTime = enableFollowingPlayback ? currentTime : undefined;\n  const chartJsOptions = useMemo(() => {\n    const plugins = props.plugins || {};\n    const annotations = [...(props.annotations || [])];\n\n    // We create these objects every time so that they can be modified.\n    const defaultXTicksSettings = {\n      fontFamily: mixins.monospaceFont,\n      fontSize: 10,\n      fontColor: \"#eee\",\n      maxRotation: 0,\n      stepSize: xScaleOptions,\n    };\n    const defaultYTicksSettings = {\n      fontFamily: mixins.monospaceFont,\n      fontSize: 10,\n      fontColor: \"#eee\",\n      padding: 0,\n    };\n    const defaultXAxis = {\n      id: \"X_AXIS_ID\",\n      ticks: defaultXTicksSettings,\n      gridLines: { color: \"rgba(255, 255, 255, 0.2)\", zeroLineColor: \"rgba(255, 255, 255, 0.2)\" },\n    };\n    const xAxes = props.xAxes\n      ? props.xAxes.map((xAxis) => ({\n          ...defaultXAxis,\n          ...xAxis,\n          ticks: {\n            ...defaultXTicksSettings,\n            ...xAxis.ticks,\n          },\n        }))\n      : [defaultXAxis];\n\n    const options = {\n      maintainAspectRatio: false,\n      animation: { duration: 0 },\n      responsiveAnimationDuration: 0,\n      legend: { display: false },\n      // Disable splines, they seem to cause weird rendering artifacts:\n      elements: { line: { tension: 0 } },\n      hover: {\n        intersect: false,\n        mode: \"x\",\n      },\n      tooltips: {\n        intersect: false,\n        mode: \"x\",\n        enabled: false, // Disable native tooltips since we use custom ones.\n      },\n      scales: {\n        xAxes,\n        yAxes: yAxes.map((yAxis) => {\n          const ticks = {\n            ...defaultYTicksSettings,\n            ...yAxis.ticks,\n          };\n          // If the user is manually panning or zooming, don't constrain the y-axis\n          if (hasUserPannedOrZoomed) {\n            delete ticks.min;\n            delete ticks.max;\n          }\n\n          return {\n            ...yAxis,\n            ticks,\n          };\n        }),\n      },\n      plugins,\n      annotation: { annotations },\n    };\n    if (followPlaybackState != null) {\n      // Follow playback, but don't force it if the user has recently panned or zoomed -- playback\n      // will fight with the user's action.\n      if (enableFollowingPlayback) {\n        // $FlowFixMe\n        options.scales.xAxes[0].ticks.min = followPlaybackCurrentTime + followPlaybackState.xOffsetMin;\n        // $FlowFixMe\n        options.scales.xAxes[0].ticks.max = followPlaybackCurrentTime + followPlaybackState.xOffsetMax;\n      }\n    } else if (!hasUserPannedOrZoomed) {\n      // $FlowFixMe\n      options.scales.xAxes[0].ticks.min = bounds.minX;\n      // $FlowFixMe\n      options.scales.xAxes[0].ticks.max = bounds.maxX;\n    }\n    return options;\n  }, [\n    bounds.maxX,\n    bounds.minX,\n    enableFollowingPlayback,\n    followPlaybackCurrentTime,\n    followPlaybackState,\n    hasUserPannedOrZoomed,\n    props.annotations,\n    props.plugins,\n    props.xAxes,\n    xScaleOptions,\n    yAxes,\n  ]);\n\n  const { datasetId, type, width, height, drawLegend, canToggleLines, toggleLine } = props;\n  const scaleOptions = useMemo(\n    () => (xScaleOptions != null ? { ...props.scaleOptions, xAxisTicks: \"follow\" } : props.scaleOptions),\n    [props.scaleOptions, xScaleOptions]\n  );\n\n  const zoomOptions = useMemo(\n    () => ({\n      ...DEFAULT_PROPS.zoomOptions,\n      enabled: props.zoom,\n      mode: zoomMode,\n    }),\n    [props.zoom, zoomMode]\n  );\n\n  const currentTimePx: ?number = currentTime != null ? getChartPx(xBounds, currentTime) : undefined;\n  const chartTopAndHeight = getChartTopAndHeight(scaleBounds.current);\n\n  const ChartComponent = props.renderPath === \"webgl\" ? GLChart : ReactChartjs;\n\n  return (\n    <div style={{ display: \"flex\", width: \"100%\" }}>\n      <div style={{ display: \"flex\", width }}>\n        <SRoot onDoubleClick={onResetZoom}>\n          <HoverBar componentId={hoverComponentId} isTimestampScale={xAxisIsPlaybackTime} scaleBounds={scaleBounds}>\n            <SBar xAxisIsPlaybackTime={xAxisIsPlaybackTime} ref={hoverBar} />\n          </HoverBar>\n          {currentTimePx != null && chartTopAndHeight != null && (\n            <SCurrentTimeBar\n              style={{\n                transform: `translateX(${currentTimePx}px)`,\n                top: `${chartTopAndHeight.topPx}px`,\n                height: `${chartTopAndHeight.heightPx}px`,\n              }}\n            />\n          )}\n          <ChartComponent\n            type={type}\n            width={width}\n            height={height}\n            key={`${width}x${height}`}\n            data={filteredData}\n            onScaleBoundsUpdate={onScaleBoundsUpdate}\n            onPanZoom={onPanZoom}\n            onClick={onClickAddingValues}\n            zoomOptions={zoomOptions}\n            scaleOptions={scaleOptions}\n            options={chartJsOptions}\n            panOptions={DEFAULT_PROPS.panOptions}\n            callbacksRef={chartCallbacks}\n          />\n\n          {hasUserPannedOrZoomed && (\n            <SResetZoom>\n              <Button tooltip=\"(shortcut: double-click)\" onClick={onResetZoom}>\n                reset view\n              </Button>\n            </SResetZoom>\n          )}\n\n          {/* Handle tooltips while dragging by checking all document events. */}\n          <DocumentEvents\n            capture\n            onMouseDown={onMouseMove}\n            onMouseUp={onMouseMove}\n            onMouseMove={onMouseMove}\n            onMouseLeave={onMouseMove}\n          />\n          <KeyListener global keyDownHandlers={keyDownHandlers} keyUpHandlers={keyUphandlers} />\n        </SRoot>\n      </div>\n      {props.zoom && <MemoizedTooltips />}\n      {drawLegend && (\n        <SLegend>\n          <TimeBasedChartLegend\n            datasetId={datasetId}\n            canToggleLines={canToggleLines}\n            datasets={data.datasets}\n            linesToHide={linesToHide}\n            toggleLine={toggleLine || (() => {})}\n          />\n        </SLegend>\n      )}\n    </div>\n  );\n});\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Mat4 } from \"gl-matrix\";\nimport React, { useEffect, useMemo, useRef } from \"react\";\n\nimport gridRenderer from \"./gridRenderer\";\nimport lineRenderer from \"./linesRenderer\";\nimport pointRenderer from \"./pointRenderer\";\nimport type { Bounds } from \"./types\";\nimport { type GLContextType, useGLContext } from \"webviz-core/src/components/GLCanvas/GLContext\";\nimport { clearRect } from \"webviz-core/src/components/GLCanvas/utils\";\nimport { type Props } from \"webviz-core/src/components/ReactChartjs\";\nimport { useDeepMemo } from \"webviz-core/src/util/hooks\";\n\n// Compute the min/max values for each axis\n// This is an expensive operation and should be called as few\n// times as possible.\nfunction computeDataBounds(data: any, options: any): Bounds {\n  const {\n    scales: { xAxes, yAxes },\n  } = options;\n\n  let minX = xAxes[0].ticks.min;\n  let maxX = xAxes[0].ticks.max;\n  let minY = yAxes[0].ticks.min;\n  let maxY = yAxes[0].ticks.max;\n\n  if (minX == null || maxX == null || minY == null || maxY == null) {\n    data.datasets.forEach((dataset) => {\n      dataset.data.forEach((datum) => {\n        const { x, y } = datum;\n        minX = !(minX == null || isNaN(minX)) ? minX : x;\n        maxX = !(maxX == null || isNaN(maxX)) ? maxX : x;\n        minY = !(minY == null || isNaN(minY)) ? minY : y;\n        maxY = !(maxY == null || isNaN(maxY)) ? maxY : y;\n\n        minX = Math.min(minX, x);\n        maxX = Math.max(maxX, x);\n        minY = Math.min(minY, y);\n        maxY = Math.max(maxY, y);\n      });\n    });\n  }\n\n  const bounds = {\n    x: {\n      min: minX,\n      max: maxX,\n    },\n    y: {\n      min: minY,\n      max: maxY,\n    },\n  };\n\n  return bounds;\n}\n\n// Compute a projection matrix\n// TODO: Add types for parameters\nfunction computeProjectionMatrix(bounds: Bounds): Mat4 {\n  const minX = bounds.x.min;\n  const maxX = bounds.x.max;\n  const minY = bounds.y.min;\n  const maxY = bounds.y.max;\n\n  // This is the standard OpenGL orthographic matrix, except that we set\n  // the third row to 0 since we don't do any operations on the Z axis\n  // prettier-ignore\n  return [\n    2 / (maxX - minX), 0, 0, -(maxX + minX) / (maxX - minX),\n    0, 2 / (maxY - minY), 0, -(maxY + minY) / (maxY - minY),\n    0, 0, 0, 0,\n    0, 0, 0, 1,\n  ];\n}\n\n// Compute a scaling matrix to leave some space for labels and margin\nfunction computePaddingMatrix(ctx: GLContextType, x: number, y: number): Mat4 {\n  const { gl, scale } = ctx;\n  const { width, height } = gl.canvas;\n  const sx = 1 - (scale * x) / width;\n  const sy = 1 - (scale * y) / height;\n\n  // This is a simple scaling matrix for X and Y axes.\n  // prettier-ignore\n  return [\n    sx, 0, 0, 0,\n    0, sy, 0, 0,\n    0, 0, 1, 0,\n    0, 0, 0, 1,\n  ];\n}\n\nexport default function GLChart({ width, height, data, options }: Props) {\n  const elRef = useRef<?HTMLDivElement>();\n  const prevRectRef = useRef();\n\n  const glContext = useGLContext();\n\n  const renderGrid = useMemo(() => gridRenderer(glContext), [glContext]);\n  const renderPoints = useMemo(() => pointRenderer(glContext), [glContext]);\n  const renderLines = useMemo(() => lineRenderer(glContext), [glContext]);\n\n  // Memoizing data and options helps rendering functions to update\n  // internal buffers only when the values actually change.\n  const memoizedData = useDeepMemo(data);\n  const memoizedOptions = useDeepMemo(options);\n  const bounds = useMemo(() => computeDataBounds(memoizedData, memoizedOptions), [memoizedData, memoizedOptions]);\n  const proj = useMemo(() => computeProjectionMatrix(bounds), [bounds]);\n\n  // We need to use `useEffect` for rendering in order to obtain the\n  // correct values for the bounding client rect.\n  // TODO (hernan): I'll improve this once I fix the concurrency issue\n  // happening when rendering multiple panels at the same time.\n  useEffect(() => {\n    const el = elRef.current;\n    if (el && glContext) {\n      const rect = el.getBoundingClientRect();\n      clearRect(glContext, rect);\n      prevRectRef.current = rect;\n\n      // Add some margin around the chart\n      const padding = computePaddingMatrix(glContext, 20, 20);\n\n      if (renderGrid) {\n        renderGrid({ proj, bounds, padding });\n      }\n\n      if (renderLines) {\n        renderLines({ data: memoizedData, proj, padding });\n      }\n\n      if (renderPoints) {\n        renderPoints({ data: memoizedData, proj, padding });\n      }\n    }\n  }, [bounds, glContext, height, memoizedData, proj, renderGrid, renderLines, renderPoints, width]);\n\n  useEffect(() => {\n    return () => {\n      // We need to clear the shared canvas during unmounting\n      if (glContext && prevRectRef.current) {\n        clearRect(glContext, prevRectRef.current);\n      }\n    };\n  }, [glContext]);\n\n  return <div ref={elRef} style={{ width, height }} />;\n}\n","// @flow\n\n/* eslint-disable header/header */\n\n// This file is forked from https://github.com/jerairrest/react-chartjs-2/tree/111f3590a008b8211217e613b5531fb00c3a431b.\n// We are upgrading this wrapper of Chart.js to handle rendering Chart.js within a worker.\n\n// The follow license applies to this file only:\n\n// The MIT License (MIT)\n\n// Copyright (c) 2017 Jeremy Ayerst\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n// documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the\n// Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\n// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nimport Hammer from \"hammerjs\";\nimport React, { useState, useRef, useCallback, useEffect } from \"react\";\nimport uuid from \"uuid\";\n\nimport { useMessagePipeline } from \"../MessagePipeline\";\nimport type { ScaleOptions as ManagerScaleOptions } from \"./ChartJSManager\";\nimport ChartJSWorker from \"./ChartJSWorker.worker\";\nimport { type ScaleBounds, type ZoomOptions, type PanOptions, wheelZoomHandler } from \"./zoomAndPanHelpers\";\nimport { objectValues } from \"webviz-core/src/util\";\nimport { getFakeRpcs, type RpcLike } from \"webviz-core/src/util/FakeRpc\";\nimport { useDeepMemo, useShallowMemo } from \"webviz-core/src/util/hooks\";\nimport supportsOffscreenCanvas from \"webviz-core/src/util/supportsOffscreenCanvas\";\nimport WebWorkerManager from \"webviz-core/src/util/WebWorkerManager\";\n\nconst getMainThreadChartJSWorker = () => import(/* webpackChunkName: \"main-thread-chartjs\" */ \"./ChartJSWorker\");\n\nexport type HoveredElement = any;\nexport type ScaleOptions = ManagerScaleOptions;\n\nexport type ChartCallbacks = $ReadOnly<{|\n  canvasRef: $ReadOnly<{ current: ?HTMLCanvasElement }>,\n  getElementAtXAxis: (event: SyntheticMouseEvent<any> | MouseEvent) => Promise<?HoveredElement>,\n  resetZoom: () => Promise<void>,\n|}>;\n\nexport type Props = {|\n  id?: string,\n  data: any,\n  height: number,\n  width: number,\n  legend?: any,\n  options: any,\n  type: string,\n  zoomOptions: ZoomOptions,\n  panOptions: PanOptions,\n  onScaleBoundsUpdate?: (ScaleBounds[]) => void,\n  onPanZoom?: (ScaleBounds[]) => void,\n  onClick?: (SyntheticMouseEvent<HTMLCanvasElement>, datalabel: ?any) => void,\n  forceDisableWorkerRendering?: ?boolean,\n  scaleOptions?: ?ScaleOptions,\n  callbacksRef: { current: ?ChartCallbacks },\n|};\n\nconst devicePixelRatio = window.devicePixelRatio || 1;\n\nconst webWorkerManager = new WebWorkerManager(ChartJSWorker, 4);\n\nexport const DEFAULT_PROPS = {\n  legend: {\n    display: true,\n    position: \"bottom\",\n  },\n  type: \"doughnut\",\n  height: 150,\n  width: 300,\n  options: {},\n  zoomOptions: { mode: \"xy\", enabled: true, sensitivity: 3, speed: 0.1 },\n  panOptions: { mode: \"xy\", enabled: true, speed: 20, threshold: 10 },\n};\n\nexport default function ChartComponent({\n  forceDisableWorkerRendering,\n  type,\n  data,\n  options,\n  scaleOptions,\n  height = DEFAULT_PROPS.height,\n  width = DEFAULT_PROPS.width,\n  onScaleBoundsUpdate,\n  onPanZoom,\n  panOptions = DEFAULT_PROPS.panOptions,\n  zoomOptions = DEFAULT_PROPS.zoomOptions,\n  onClick: onClickHandler,\n  callbacksRef,\n}: Props) {\n  const [id] = useState<string>(uuid);\n\n  const usingWebWorker = useRef<boolean>(false);\n  const chartRpc = useRef<?RpcLike>();\n  const canvasRef = useRef<?HTMLCanvasElement>(null);\n  const initialized = useRef(false);\n  const panning = useRef(false);\n  const currentDeltaX = useRef();\n  const currentDeltaY = useRef();\n  const currentPinchScaling = useRef(1);\n  const nodeRef = useRef();\n\n  const getRpc = useCallback(async (): Promise<RpcLike> => {\n    if (chartRpc.current) {\n      return chartRpc.current;\n    }\n\n    if (!forceDisableWorkerRendering && supportsOffscreenCanvas()) {\n      // Only use a real chart worker if we support offscreenCanvas.\n      const rpc = webWorkerManager.registerWorkerListener(id);\n      chartRpc.current = rpc;\n      usingWebWorker.current = true;\n      return rpc;\n    }\n\n    // Otherwise use a fake RPC so that we don't have to maintain two separate APIs.\n    const { mainThreadRpc, workerRpc } = getFakeRpcs();\n    const { default: MainThreadChartJSWorker } = await getMainThreadChartJSWorker();\n    new MainThreadChartJSWorker(workerRpc);\n    chartRpc.current = mainThreadRpc;\n    usingWebWorker.current = false;\n    return mainThreadRpc;\n  }, [forceDisableWorkerRendering, id]);\n\n  const sendToRpc = useCallback(async (\n    event: string,\n    dataToSend: any,\n    transferrables?: any[]\n  ): Promise<ScaleBounds[]> => {\n    const rpc = await getRpc();\n    return rpc.send(event, dataToSend, transferrables);\n  }, [getRpc]);\n\n  const handleScaleBoundsUpdate = useCallback((scaleBoundsUpdate) => {\n    if (onScaleBoundsUpdate && scaleBoundsUpdate) {\n      onScaleBoundsUpdate(scaleBoundsUpdate);\n    }\n  }, [onScaleBoundsUpdate]);\n\n  const handlePanZoom = useCallback((scaleBoundsUpdate) => {\n    if (onPanZoom && scaleBoundsUpdate) {\n      onPanZoom(scaleBoundsUpdate);\n    }\n  }, [onPanZoom]);\n\n  const onWheel = useCallback(async (event: SyntheticWheelEvent<HTMLCanvasElement>) => {\n    if (!zoomOptions.enabled) {\n      return;\n    }\n    const { percentZoomX, percentZoomY, focalPoint } = wheelZoomHandler(event, zoomOptions);\n    const scaleBoundsUpdate = await sendToRpc(\"doZoom\", {\n      id,\n      zoomOptions,\n      percentZoomX,\n      percentZoomY,\n      focalPoint,\n      whichAxesParam: \"xy\",\n    });\n\n    handleScaleBoundsUpdate(scaleBoundsUpdate);\n    handlePanZoom(scaleBoundsUpdate);\n  }, [zoomOptions, sendToRpc, id, handleScaleBoundsUpdate, handlePanZoom]);\n\n  const onClick = useCallback(async (event: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    if (!panning.current && onClickHandler && canvasRef.current) {\n      const rect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      const newEvent = { x, y };\n      // Since our next call is asynchronous, we have to persist the event so that React doesn't clear it.\n      event.persist();\n      const datalabel = await sendToRpc(\"getDatalabelAtEvent\", { id, event: newEvent });\n      onClickHandler(event, datalabel);\n    }\n  }, [id, onClickHandler, sendToRpc]);\n\n  const getElementAtXAxis = useCallback(async (\n    event: SyntheticMouseEvent<any> | MouseEvent\n  ): Promise<?HoveredElement> => {\n    if (!canvasRef.current) {\n      return Promise.resolve(undefined);\n    }\n\n    const boundingRect = canvasRef.current.getBoundingClientRect();\n    if (\n      event.clientX < boundingRect.left ||\n      event.clientX > boundingRect.right ||\n      event.clientY < boundingRect.top ||\n      event.clientY > boundingRect.bottom\n    ) {\n      return Promise.resolve(undefined);\n    }\n\n    const newEvent = {\n      native: true,\n      x: event.clientX - boundingRect.left,\n      y: event.clientY - boundingRect.top,\n    };\n    return sendToRpc(\"getElementAtXAxis\", { id, event: newEvent });\n  }, [id, sendToRpc]);\n\n  // Pan/zoom section\n\n  const resetZoom = useCallback(async () => {\n    const scaleBoundsUpdate = await sendToRpc(\"resetZoom\", { id });\n    handleScaleBoundsUpdate(scaleBoundsUpdate);\n  }, [handleScaleBoundsUpdate, id, sendToRpc]);\n\n  callbacksRef.current = useShallowMemo({\n    canvasRef,\n    getElementAtXAxis,\n    resetZoom,\n  });\n\n  const setupPanAndPinchHandlers = useCallback(() => {\n    const { threshold } = panOptions;\n    const hammerManager = new Hammer.Manager(canvasRef.current);\n    hammerManager.add(new Hammer.Pinch());\n    hammerManager.add(new Hammer.Pan({ threshold }));\n\n    const hammerPanHandler = async (event: any) => {\n      if (!panOptions.enabled) {\n        return;\n      }\n      if (currentDeltaX.current != null && currentDeltaY.current != null) {\n        const deltaX = event.deltaX - currentDeltaX.current;\n        const deltaY = event.deltaY - currentDeltaY.current;\n        currentDeltaX.current = event.deltaX;\n        currentDeltaY.current = event.deltaY;\n        const scaleBoundsUpdate = await sendToRpc(\"doPan\", {\n          id,\n          panOptions,\n          deltaX,\n          deltaY,\n        });\n        handlePanZoom(scaleBoundsUpdate);\n        handleScaleBoundsUpdate(scaleBoundsUpdate);\n      }\n    };\n\n    hammerManager.on(\"panstart\", (event) => {\n      panning.current = true;\n      currentDeltaX.current = 0;\n      currentDeltaY.current = 0;\n      hammerPanHandler(event);\n    });\n    hammerManager.on(\"panmove\", hammerPanHandler);\n    hammerManager.on(\"panend\", () => {\n      currentDeltaX.current = null;\n      currentDeltaY.current = null;\n      sendToRpc(\"resetPanDelta\", id);\n      setTimeout(() => {\n        panning.current = false;\n      }, 500);\n    });\n\n    // TODO: pinch gestures only kind of work right now - the built-in browser pinch zoom takes over if pinch is too\n    // aggressive. Figure out why this is happening and fix it. This is almost identical to the original plugin that\n    // does not have this problem.\n    const handlePinch = async (e) => {\n      if (!panOptions.enabled) {\n        return;\n      }\n      const diff = (1 / currentPinchScaling.current) * e.scale;\n      const rect = e.target.getBoundingClientRect();\n      const offsetX = e.center.x - rect.left;\n      const offsetY = e.center.y - rect.top;\n      const center = {\n        x: offsetX,\n        y: offsetY,\n      };\n\n      // fingers position difference\n      const x = Math.abs(e.pointers[0].clientX - e.pointers[1].clientX);\n      const y = Math.abs(e.pointers[0].clientY - e.pointers[1].clientY);\n\n      // diagonal fingers will change both (xy) axes\n      const p = x / y;\n      let xy;\n      if (p > 0.3 && p < 1.7) {\n        xy = \"xy\";\n      } else if (x > y) {\n        xy = \"x\"; // x axis\n      } else {\n        xy = \"y\"; // y axis\n      }\n\n      // Keep track of overall scale\n      currentPinchScaling.current = e.scale;\n\n      const scaleBoundsUpdate = await sendToRpc(\"doZoom\", {\n        id,\n        zoomOptions,\n        percentZoomX: diff,\n        percentZoomY: diff,\n        focalPoint: center,\n        whichAxesParam: xy,\n      });\n      handlePanZoom(scaleBoundsUpdate);\n      handleScaleBoundsUpdate(scaleBoundsUpdate);\n    };\n\n    hammerManager.on(\"pinchstart\", () => {\n      currentPinchScaling.current = 1; // reset tracker\n    });\n    hammerManager.on(\"pinch\", handlePinch);\n    hammerManager.on(\"pinchend\", (e) => {\n      handlePinch(e);\n      currentPinchScaling.current = 1; // reset\n      sendToRpc(\"resetZoomDelta\", { id });\n    });\n  }, [handlePanZoom, handleScaleBoundsUpdate, id, panOptions, sendToRpc, zoomOptions]);\n\n  // Initialization\n  useEffect(() => {\n    if (initialized.current) {\n      return;\n    }\n\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n\n    setupPanAndPinchHandlers();\n\n    let node = canvas;\n    if (!forceDisableWorkerRendering && supportsOffscreenCanvas()) {\n      // $FlowFixMe\n      node = canvas.transferControlToOffscreen();\n    }\n    initialized.current = true;\n    nodeRef.current = node;\n    sendToRpc(\n      \"initialize\",\n      {\n        node,\n        id,\n        type,\n        data,\n        options,\n        scaleOptions,\n        devicePixelRatio,\n        width,\n        height,\n      },\n      [node]\n    ).then(handleScaleBoundsUpdate);\n  }, [\n    data,\n    forceDisableWorkerRendering,\n    handleScaleBoundsUpdate,\n    height,\n    id,\n    onScaleBoundsUpdate,\n    options,\n    scaleOptions,\n    sendToRpc,\n    setupPanAndPinchHandlers,\n    type,\n    width,\n  ]);\n\n  const memoizedData = useDeepMemo(data);\n  const memoizedOptions = useDeepMemo(options);\n  const memoizedScaleOptions = useDeepMemo(scaleOptions);\n\n  const { pauseFrame } = useMessagePipeline(\n    useCallback((messagePipeline) => ({ pauseFrame: messagePipeline.pauseFrame }), [])\n  );\n\n  // Keep track of playback callbacks in order to resume them in case this\n  // component is unmounted during the update step in workers.\n  const resumeFrameRefs = useRef({});\n\n  useEffect(() => {\n    (async () => {\n      if (!initialized.current) {\n        return;\n      }\n\n      const chartUpdateId = uuid.v4();\n      resumeFrameRefs.current[chartUpdateId] = pauseFrame(\"ReactChartjs\");\n\n      const scales = await sendToRpc(\"update\", {\n        id,\n        data: memoizedData,\n        options: memoizedOptions,\n        scaleOptions: memoizedScaleOptions,\n      });\n\n      // Prevent forwarding scales if the component was unmounted during the update call.\n      if (initialized.current) {\n        handleScaleBoundsUpdate(scales);\n      }\n\n      // Resume frame playback\n      const resumeFrame = resumeFrameRefs.current[chartUpdateId];\n      resumeFrame();\n      delete resumeFrameRefs.current[chartUpdateId];\n    })();\n  }, [handleScaleBoundsUpdate, id, memoizedData, memoizedOptions, memoizedScaleOptions, pauseFrame, sendToRpc]);\n\n  useEffect(() => {\n    const resumeFrameCallbacks = resumeFrameRefs.current;\n    return () => {\n      // If this component will unmount, resolve any pending playback callback.\n      objectValues(resumeFrameCallbacks).forEach((callback) => callback());\n      if (chartRpc.current) {\n        chartRpc.current.send(\"destroy\", { id });\n        chartRpc.current = null;\n        if (usingWebWorker.current) {\n          webWorkerManager.unregisterWorkerListener(id);\n        }\n      }\n      initialized.current = false;\n    };\n  }, [id]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      height={height / devicePixelRatio}\n      width={width / devicePixelRatio}\n      id={id}\n      onWheel={onWheel}\n      onClick={onClick}\n      style={{ width, height }}\n    />\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport findIndex from \"lodash/findIndex\";\nimport sortBy from \"lodash/sortBy\";\n\nimport Rpc from \"webviz-core/src/util/Rpc\";\nimport { setupMainThreadRpc } from \"webviz-core/src/util/RpcMainThreadUtils\";\n\n// This file provides a convenient way to set up and tear down workers as needed. It will create only a single worker\n// of each class, and terminate the worker when all listeners are unregistered.\n\ntype WorkerListenerState = {| rpc: Rpc, worker: any, listenerIds: string[] |};\n\nexport default class WebWorkerManager {\n  _classType: any;\n  _maxWorkerCount: number;\n  _workerStates: (?WorkerListenerState)[];\n  _allListeners: Set<string>;\n\n  constructor(classType: any, maxWorkerCount: number) {\n    this._classType = classType;\n    this._maxWorkerCount = maxWorkerCount;\n    this._workerStates = new Array(maxWorkerCount);\n    this._allListeners = new Set();\n  }\n\n  testing_getWorkerState(id: string): ?WorkerListenerState {\n    return this._workerStates.find((workerState) => workerState && workerState.listenerIds.includes(id));\n  }\n\n  registerWorkerListener(id: string): Rpc {\n    if (this._allListeners.has(id)) {\n      throw new Error(\"cannot register the same listener id twice\");\n    }\n    this._allListeners.add(id);\n\n    const currentWorkerCount = this._workerStates.filter(Boolean).length;\n    if (currentWorkerCount < this._maxWorkerCount) {\n      const worker = new this._classType();\n      const rpc = new Rpc(worker);\n      setupMainThreadRpc(rpc);\n\n      const emptyIndex = findIndex(this._workerStates, (x) => !x);\n      this._workerStates[emptyIndex] = { worker, rpc, listenerIds: [id] };\n      return rpc;\n    }\n    const workerStateByListenerCount = sortBy(\n      this._workerStates.filter(Boolean),\n      (workerState) => workerState && workerState.listenerIds.length\n    );\n    const workerState = workerStateByListenerCount[0];\n    workerState.listenerIds.push(id);\n    return workerState.rpc;\n  }\n\n  unregisterWorkerListener(id: string) {\n    if (!this._allListeners.has(id)) {\n      throw new Error(\"Cannot find listener to unregister\");\n    }\n    this._allListeners.delete(id);\n\n    const workerStateIndex = findIndex(\n      this._workerStates,\n      (workerState) => workerState && workerState.listenerIds.includes(id)\n    );\n    const workerState = this._workerStates[workerStateIndex];\n    if (workerStateIndex >= 0 && workerState) {\n      workerState.listenerIds = workerState.listenerIds.filter((_id) => _id !== id);\n      if (workerState.listenerIds.length === 0) {\n        this._workerStates[workerStateIndex] = undefined;\n        workerState.worker.terminate();\n      }\n    }\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\n\nexport type BasePlotPath = {\n  value: string,\n  enabled: boolean,\n};\n\nexport type PlotPath = BasePlotPath & {\n  timestampMethod: TimestampMethod,\n};\n\n// A \"reference line\" plot path is a numeric value. It creates a horizontal line on the plot at the specified value.\nexport function isReferenceLinePlotPathType(path: BasePlotPath): boolean {\n  return !isNaN(Number.parseFloat(path.value));\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { sortedIndexBy } from \"lodash\";\n\nimport {\n  type DiagnosticStatusArrayMsg,\n  type DiagnosticsById,\n  type DiagnosticId,\n  computeDiagnosticInfo,\n  getDiagnosticId,\n  trimHardwareId,\n} from \"./util\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message } from \"webviz-core/src/players/types\";\n\nexport type DiagnosticAutocompleteEntry = {|\n  name: ?string, // Null for \"combined hardware_id\" entries for showing diagnostics with any name.\n  hardware_id: string,\n  id: DiagnosticId,\n  displayName: string,\n  sortKey: string,\n|};\n\nexport type DiagnosticsBuffer = {|\n  diagnosticsByNameByTrimmedHardwareId: Map<string, DiagnosticsById>,\n  sortedAutocompleteEntries: DiagnosticAutocompleteEntry[],\n|};\n\n// Returns whether the buffer has been modified\nfunction maybeAddMessageToBuffer(buffer: DiagnosticsBuffer, message: Message): boolean {\n  const { header, status: statusArray }: DiagnosticStatusArrayMsg = message.message;\n  if (statusArray.length === 0) {\n    return false;\n  }\n\n  for (const status of statusArray) {\n    const info = computeDiagnosticInfo(status, header.stamp);\n    let newHardwareId = false;\n    let newDiagnostic = false;\n    const trimmedHardwareId = trimHardwareId(status.hardware_id);\n    const hardwareDiagnosticsByName = buffer.diagnosticsByNameByTrimmedHardwareId.get(trimmedHardwareId);\n    if (hardwareDiagnosticsByName == null) {\n      newHardwareId = true;\n      newDiagnostic = true;\n      buffer.diagnosticsByNameByTrimmedHardwareId.set(trimmedHardwareId, new Map([[status.name, info]]));\n    } else {\n      const previousNumberOfDiagnostics = hardwareDiagnosticsByName.size;\n      hardwareDiagnosticsByName.set(status.name, info);\n      newDiagnostic = hardwareDiagnosticsByName.size > previousNumberOfDiagnostics;\n    }\n\n    // add to sortedAutocompleteEntries if we haven't seen this id before\n    if (newDiagnostic) {\n      const newEntry = {\n        hardware_id: status.hardware_id,\n        name: status.name,\n        id: info.id,\n        displayName: info.displayName,\n        sortKey: info.displayName.replace(/^\\//, \"\").toLowerCase(),\n      };\n      const index = sortedIndexBy(buffer.sortedAutocompleteEntries, newEntry, \"displayName\");\n      buffer.sortedAutocompleteEntries.splice(index, 0, newEntry);\n\n      if (newHardwareId) {\n        const newHardwareEntry = {\n          hardware_id: info.status.hardware_id,\n          id: getDiagnosticId(status.hardware_id),\n          name: undefined,\n          displayName: info.status.hardware_id,\n          sortKey: info.status.hardware_id.replace(/^\\//, \"\").toLowerCase(),\n        };\n        const hardwareIdx = sortedIndexBy(buffer.sortedAutocompleteEntries, newHardwareEntry, \"displayName\");\n        buffer.sortedAutocompleteEntries.splice(hardwareIdx, 0, newHardwareEntry);\n      }\n    }\n  }\n  return true;\n}\n\n// Exported for tests\nexport function addMessages(buffer: DiagnosticsBuffer, messages: $ReadOnlyArray<Message>): DiagnosticsBuffer {\n  // maybeAddMessageToBuffer mutates the buffer instead of doing an immutable update for performance\n  // reasons. There are large numbers of diagnostics messages, and often many diagnostics panels in\n  // a layout.\n  let modified = false;\n  for (const message of messages) {\n    modified = maybeAddMessageToBuffer(buffer, message) || modified;\n  }\n  // We shallow-copy the buffer when it changes to help users know when to rerender.\n  return modified ? { ...buffer } : buffer;\n}\n\n// Exported for tests\nexport function defaultDiagnosticsBuffer(): DiagnosticsBuffer {\n  return {\n    diagnosticsByNameByTrimmedHardwareId: new Map(),\n    sortedAutocompleteEntries: [],\n  };\n}\n\nexport default function useDiagnostics(topic: string): DiagnosticsBuffer {\n  return PanelAPI.useMessageReducer<DiagnosticsBuffer>({\n    topics: [topic],\n    restore: defaultDiagnosticsBuffer,\n    addMessages,\n  });\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { reject } from \"lodash\";\n\n// toggles an item in an array based on reference equality\n// or an optional predicate to determine if the item should be toggled in/out\n// this function is pure - it always returns a new array\nexport default function toggle<T>(array: T[], item: T, predicate: (T) => boolean = (el) => el === item): T[] {\n  const newArray = reject(array, predicate);\n  if (newArray.length === array.length) {\n    newArray.push(item);\n  }\n  return newArray;\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useRef, useState } from \"react\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst keyValMap = { ArrowDown: -1, ArrowUp: 1 };\n\nexport function JSONInput(props: {| value: string, dataTest?: string, onChange: (mixed) => void |}) {\n  const [internalValue, setInternalValue] = useState<string>(props.value);\n  const lastPropsValue = useRef<string>(props.value);\n  if (lastPropsValue.current !== props.value) {\n    lastPropsValue.current = props.value;\n    setInternalValue(props.value);\n  }\n  const parsedValue = parseJson(internalValue);\n  const isValid = parsedValue !== undefined;\n  return (\n    <input\n      style={{ color: isValid ? \"white\" : colors.RED }}\n      data-test={props.dataTest || \"json-input\"}\n      type=\"text\"\n      value={internalValue}\n      onChange={(e) => {\n        setInternalValue(e.target.value);\n        const newParsedValue = parseJson(e.target.value);\n        if (newParsedValue !== undefined) {\n          props.onChange(newParsedValue);\n        }\n      }}\n      onKeyDown={(e) => {\n        if (typeof parsedValue === \"number\" && keyValMap[e.key]) {\n          const newParsedValue = parsedValue + keyValMap[e.key];\n          setInternalValue(`${newParsedValue}`);\n          props.onChange(newParsedValue);\n        }\n      }}\n    />\n  );\n}\n\nfunction parseJson(val: string): ?mixed {\n  try {\n    return JSON.parse(val);\n  } catch (e) {\n    return undefined;\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { clamp, isEqual } from \"lodash\";\nimport React, { type Node } from \"react\";\nimport styled from \"styled-components\";\nimport tinyColor from \"tinycolor2\";\n\nimport { type RenderItemOutput } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/OverlayProjector\";\nimport { ICON_BY_TYPE } from \"webviz-core/src/panels/ThreeDimensionalViz/constants\";\nimport type { Interactive } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\nimport type { OverlayIconMarker } from \"webviz-core/src/types/Messages\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\nimport Rpc from \"webviz-core/src/util/Rpc\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\n// Unfortunately, we call onIconClick with a nasty \"drawable icon data\" message, for which we have\n// no good type. It bears a little resemblance to a parsed icon marker, though.\ntype OnIconClick = (iconMarker: Interactive<OverlayIconMarker>, {| clientX: number, clientY: number |}) => void;\n\ntype Props = {\n  cameraDistance: number,\n  onIconClick: OnIconClick,\n  rpc: Rpc,\n};\n\nexport const SText = styled.span`\n  margin-left: 4px;\n  margin-right: 8px;\n`;\n\nconst ICON_WRAPPER_SIZE = 24;\nconst ICON_SIZE = 16;\nconst ICON_WIDTH = 28;\nexport const BG_COLOR = tinyColor(colors.DARK2)\n  .setAlpha(0.75)\n  .toRgbString();\nexport const SIconWrapper = styled.div`\n  box-shadow: 0px 1px 8px rgba(0, 0, 0, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.075);\n  border-radius: ${ICON_WIDTH / 2}px;\n  display: flex;\n  overflow: hidden;\n  align-items: center;\n  background: ${BG_COLOR};\n  position: absolute;\n  top: 0;\n  left: 0;\n  cursor: pointer;\n`;\n\nconst MIN_SCALE = 0.6;\nconst MIN_DISTANCE = 50;\nconst MAX_DISTANCE = 100;\n// The icons will scale according to camera distance between MIN_DISTANCE and MAX_DISTANCE, from 100% to MIN_SCALE.\nfunction getIconScaleByCameraDistance(distance: number): number {\n  const effectiveIconDistance = clamp(distance, MIN_DISTANCE, MAX_DISTANCE);\n  return 1 - ((effectiveIconDistance - MIN_DISTANCE) * (1 - MIN_SCALE)) / (MAX_DISTANCE - MIN_DISTANCE);\n}\n\nfunction getIconStyles(\n  distance: number\n): {|\n  iconWrapperPadding: number,\n  scaledIconSize: number,\n  scaledIconWrapperSize: number,\n|} {\n  const scale = getIconScaleByCameraDistance(distance);\n  const scaledIconWrapperSize = Math.round(scale * ICON_WRAPPER_SIZE);\n  const scaledIconSize = Math.round(scale * ICON_SIZE);\n  const iconWrapperPadding = Math.floor((scaledIconWrapperSize - scaledIconSize) / 2);\n  return {\n    iconWrapperPadding,\n    scaledIconSize,\n    scaledIconWrapperSize,\n  };\n}\n\nconst IconOverlay = (props: Props) => {\n  const { cameraDistance, onIconClick, rpc } = props;\n  const [overlayIcons, setOverlayIcons] = React.useState<RenderItemOutput[]>([]);\n  const updateOverlayIcons = React.useCallback((newIcons) => {\n    // Make sure the new icons are different from the existing ones in order to\n    // prevent re-renders if the state does not actually change. Also, use the\n    // functional type state setter to avoid the `updateOverlayIcons` function\n    // to change when the icon state does.\n    setOverlayIcons((oldIcons) => (isEqual(oldIcons, newIcons) ? oldIcons : newIcons));\n  }, [setOverlayIcons]);\n  if (useChangeDetector([rpc], true)) {\n    rpc.receive(\"updateOverlayIcons\", updateOverlayIcons);\n  }\n\n  // Render smaller icons when camera is zoomed out.\n  const { scaledIconWrapperSize, iconWrapperPadding, scaledIconSize } = getIconStyles(cameraDistance);\n  const onClick = React.useCallback(async (ev) => {\n    const name = ev.currentTarget.dataset.iconName;\n    const marker = await rpc.send<?Interactive<OverlayIconMarker>>(\"getIconData\", name);\n    if (marker) {\n      onIconClick(marker, { clientX: ev.clientX, clientY: ev.clientY });\n    }\n  }, [onIconClick, rpc]);\n\n  return overlayIcons.map<Node>((icon) => {\n    if (!icon) {\n      return null;\n    }\n    const {\n      textColor,\n      name,\n      iconTypes,\n      text,\n      markerStyle = {},\n      iconOffset: { x = 0, y = 0 } = {},\n      coordinates: [left, top],\n    } = icon;\n\n    return (\n      <SIconWrapper\n        key={name}\n        data-icon-name={name}\n        onClick={onClick}\n        style={{\n          ...markerStyle,\n          color: `rgba(${textColor.r * 255},${textColor.g * 255},${textColor.b * 255},${textColor.a})`,\n          borderRadius: scaledIconWrapperSize / 2,\n          padding: iconWrapperPadding,\n          transform: `translate(${(left - scaledIconWrapperSize / 2 + x).toFixed()}px,${(\n            top -\n            scaledIconWrapperSize / 2 +\n            y\n          ).toFixed()}px)`,\n        }}>\n        {iconTypes.map(({ icon_type, color }, idx) => {\n          const SvgIcon = ICON_BY_TYPE[`${icon_type}`] || ICON_BY_TYPE.DEFAULT;\n          let fill = colors.BLUE;\n          if (color) {\n            const { r, g, b, a } = color; // Use color to control the background color of the icon.\n            fill = `rgba(${r * 255},${g * 255},${b * 255},${a})`;\n          }\n          return <SvgIcon key={`${icon_type}${idx}`} width={scaledIconSize} height={scaledIconSize} fill={fill} />;\n        })}\n        {text && <SText>{text}</SText>}\n      </SIconWrapper>\n    );\n  });\n};\n\nexport default IconOverlay;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { getPath, memoizedGetLinkedGlobalVariablesKeyByName } from \"../interactionUtils\";\nimport useLinkedGlobalVariables, { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport { SGlobalVariableLink, SPath, GlobalVariableName } from \"./index\";\nimport UnlinkWrapper from \"./UnlinkWrapper\";\nimport Button from \"webviz-core/src/components/Button\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SForm = styled.form`\n  background-color: ${colors.DARK3};\n  margin-left: 8px;\n  width: 320px;\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\n  pointer-events: auto;\n  flex: 0 0 auto;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst SExistingLinks = styled.div`\n  margin-bottom: 8px;\n`;\n\nconst SList = styled.ul`\n  margin: 12px 6px;\n`;\n\nconst SListItem = styled.li`\n  display: flex;\n  align-items: center;\n  margin: 6px;\n  width: 100%;\n  overflow: hidden;\n`;\n\nconst STopicWithPath = styled.span`\n  margin-left: 12px;\n  margin-right: 12px;\n  flex: 1 1 0;\n  overflow-wrap: break-word;\n  overflow: hidden;\n`;\n\ntype Props = {\n  name: string,\n  showList?: boolean,\n};\n\nexport default function UnlinkGlobalVariables({ name, showList }: Props) {\n  const { linkedGlobalVariables, setLinkedGlobalVariables } = useLinkedGlobalVariables();\n  const linkedGlobalVariablesKeyByName = memoizedGetLinkedGlobalVariablesKeyByName(linkedGlobalVariables);\n  const links: LinkedGlobalVariable[] = linkedGlobalVariablesKeyByName[name] || [];\n\n  if (links.length === 0) {\n    return null;\n  }\n\n  const listStyle = showList ? { marginLeft: 0, marginRight: 0 } : {};\n\n  // the list UI is shared between 3D panel and Global Variables panel\n  const listHtml = (\n    <SList style={listStyle}>\n      {links.map(({ topic, markerKeyPath, name: linkedGlobalVariableName }, idx) => {\n        return (\n          <SListItem key={idx} style={listStyle}>\n            <Button\n              danger\n              small\n              style={{ flexShrink: 0 }}\n              onClick={() => {\n                const newLinkedGlobalVariables = linkedGlobalVariables.filter(\n                  (linkedGlobalVariable) =>\n                    !(\n                      linkedGlobalVariable.topic === topic &&\n                      isEqual(linkedGlobalVariable.markerKeyPath, markerKeyPath) &&\n                      linkedGlobalVariable.name === linkedGlobalVariableName\n                    )\n                );\n                setLinkedGlobalVariables(newLinkedGlobalVariables);\n              }}>\n              Unlink\n            </Button>\n            <STopicWithPath>\n              {topic}.<SPath>{getPath(markerKeyPath)}</SPath>\n            </STopicWithPath>\n          </SListItem>\n        );\n      })}\n    </SList>\n  );\n  if (showList) {\n    return (\n      <SExistingLinks>\n        <p style={{ marginTop: 0, lineHeight: \"1.4\" }}>\n          Some links already exist for this variable. The variables value will be taken from the most recently clicked\n          linked topic.\n        </p>\n        {listHtml}\n      </SExistingLinks>\n    );\n  }\n\n  return (\n    <SGlobalVariableLink>\n      <UnlinkWrapper\n        tooltip={\n          <span>\n            Unlink <GlobalVariableName name={name} />\n          </span>\n        }\n        linkedGlobalVariable={links[0]}>\n        {() => <SForm data-test=\"unlink-form\">{listHtml}</SForm>}\n      </UnlinkWrapper>\n    </SGlobalVariableLink>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LinkVariantOffIcon from \"@mdi/svg/svg/link-variant-off.svg\";\nimport LinkVariantIcon from \"@mdi/svg/svg/link-variant.svg\";\nimport React, { useState, useCallback, type Node } from \"react\";\nimport styled from \"styled-components\";\n\nimport { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport { GlobalVariableName } from \"./index\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\n\nconst SIconWrapper = styled.span`\n  .icon {\n    /* TODO(Audrey): remove the hard-coded icon style once we clean up 3D panel styles   */\n    width: 15px !important;\n    height: 15px !important;\n    font-size: 15px !important;\n  }\n  .linked-icon {\n    opacity: 1;\n    display: inline-block;\n  }\n  .link-off-icon {\n    opacity: 0;\n    display: none;\n  }\n  &:hover {\n    .linked-icon {\n      opacity: 0;\n      display: none;\n    }\n    .link-off-icon {\n      opacity: 1;\n      display: inline-block;\n    }\n  }\n`;\n\ntype Props = {\n  linkedGlobalVariable: LinkedGlobalVariable,\n  style?: any,\n  children: ({\n    setIsOpen: (boolean) => void,\n    linkedGlobalVariable: LinkedGlobalVariable,\n  }) => Node,\n  tooltip?: Node,\n};\n\nexport default function UnlinkWrapper({ children, linkedGlobalVariable, tooltip }: Props) {\n  const [isOpen, setIsOpen] = useState<boolean>(false);\n  const onToggle = useCallback(() => setIsOpen((open) => !open), []);\n  return (\n    <>\n      <ChildToggle\n        dataTest={`unlink-${linkedGlobalVariable.name}`}\n        position=\"above\"\n        onToggle={onToggle}\n        isOpen={isOpen}>\n        <SIconWrapper>\n          <Icon\n            fade\n            tooltipProps={{\n              contents: tooltip || (\n                <span>\n                  Unlink this field from <GlobalVariableName name={linkedGlobalVariable.name} />\n                </span>\n              ),\n            }}>\n            <LinkVariantOffIcon className=\"link-off-icon\" />\n            <LinkVariantIcon className=\"linked-icon\" />\n          </Icon>\n        </SIconWrapper>\n        <span>{children({ setIsOpen, linkedGlobalVariable })}</span>\n      </ChildToggle>\n      <GlobalVariableName name={linkedGlobalVariable.name} leftPadding />\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { difference, isEmpty, isNil } from \"lodash\";\nimport { type MouseEventObject, toRGBA, type Color } from \"regl-worldview\";\n\nimport { getVertexValues, getVertexValue, getFieldOffsetsAndReaders, getVertexCount } from \"./buffers\";\nimport { DEFAULT_FLAT_COLOR, DEFAULT_MIN_COLOR, DEFAULT_MAX_COLOR } from \"./types\";\nimport type { PointCloud2, PointField } from \"webviz-core/src/types/Messages\";\nimport { lerp } from \"webviz-core/src/util\";\n\nexport type ClickedInfo = {\n  clickedPoint: number[],\n  clickedPointColor?: number[],\n  additionalFieldValues?: { [name: string]: ?number },\n};\n\nexport function toRgba(rgba: Color): Color {\n  return toRGBA({ r: rgba.r * 255, g: rgba.g * 255, b: rgba.b * 255, a: rgba.a });\n}\n\n// extract clicked point's position, color and additional field values to display in the UI\nexport function getClickedPointColor(maybeFullyDecodedMarker: MouseEventObject, instanceIndex: ?number): ?(number[]) {\n  const { positionBuffer, colorBuffer, settings, is_bigendian } = maybeFullyDecodedMarker;\n  if (isEmpty(positionBuffer) || isNil(instanceIndex) || instanceIndex >= getVertexCount(positionBuffer)) {\n    return;\n  }\n\n  const pointIndex = instanceIndex || 0;\n\n  const { colorMode } = settings;\n  if (!colorMode) {\n    return;\n  }\n  if (colorMode.mode === \"rgb\" && !isEmpty(colorBuffer)) {\n    // Extract [r, g, b, a] from colors buffer\n    const vertexValues = getVertexValues(colorBuffer, pointIndex, 3);\n    // When data uses little endianess, colors are in BGR format\n    // and we must swap R and B channels to display them correclty.\n    // alpha value is set to 1 since 'colorBuffer' only stores\n    // [r, g, b] components. Shaders always use an alpha value\n    // of 1 as well.\n    return is_bigendian ? [...vertexValues, 1.0] : [vertexValues[2], vertexValues[1], vertexValues[0], 1.0];\n  }\n  if (colorMode.mode === \"gradient\" && !isEmpty(colorBuffer)) {\n    const { minColorValue, maxColorValue } = maybeFullyDecodedMarker;\n    const colorFieldValue = getVertexValue(colorBuffer, pointIndex);\n    const colorFieldRange = maxColorValue - minColorValue || Infinity;\n    const pct = Math.max(0, Math.min((colorFieldValue - minColorValue) / colorFieldRange, 1));\n    const { minColor, maxColor } = colorMode;\n    const parsedMinColor = toRgba(minColor || DEFAULT_MIN_COLOR);\n    const parsedMaxColor = toRgba(maxColor || DEFAULT_MAX_COLOR);\n    return [\n      lerp(pct, parsedMinColor[0], parsedMaxColor[0]), // R\n      lerp(pct, parsedMinColor[1], parsedMaxColor[1]), // G\n      lerp(pct, parsedMinColor[2], parsedMaxColor[2]), // B\n      1.0,\n    ];\n  }\n  if (colorMode.mode === \"rainbow\" && !isEmpty(colorBuffer)) {\n    const { minColorValue, maxColorValue } = maybeFullyDecodedMarker;\n    const colorFieldValue = getVertexValue(colorBuffer, pointIndex);\n    const colorFieldRange = maxColorValue - minColorValue || Infinity;\n    const pct = Math.max(0, Math.min((colorFieldValue - minColorValue) / colorFieldRange, 1));\n    return getRainbowColor(pct);\n  }\n  if (colorMode.mode === \"flat\") {\n    return toRgba(colorMode.flatColor || DEFAULT_FLAT_COLOR);\n  }\n}\n\nexport function getAdditionalFieldNames(fields: $ReadOnlyArray<PointField>): string[] {\n  const allFields = fields.map((field) => field.name);\n  return difference(allFields, [\"rgb\", \"x\", \"y\", \"z\"]);\n}\n\nexport function decodeData(marker: PointCloud2): { [fieldName: string]: number }[] {\n  const { fields, data, width, row_step, height, point_step } = marker;\n  const offsets = getFieldOffsetsAndReaders(fields);\n  const ret = [];\n  if (!offsets) {\n    return ret;\n  }\n\n  for (let row = 0; row < height; row++) {\n    const dataOffset = row * row_step;\n    for (let col = 0; col < width; col++) {\n      const dataStart = col * point_step + dataOffset;\n      const values = {};\n      for (const field of fields) {\n        const reader = offsets[field.name].reader;\n        if (reader) {\n          values[field.name] = reader.read(data, dataStart);\n        }\n      }\n      ret.push(values);\n    }\n  }\n  return ret;\n}\n\n// taken from http://docs.ros.org/jade/api/rviz/html/c++/point__cloud__transformers_8cpp_source.html\n// line 47\nexport function getRainbowColor(pct: number): number[] {\n  const h = (1 - pct) * 5.0 + 1.0;\n  const i = Math.floor(h);\n  let f = h % 1.0;\n  // if i is even\n  if ((i & 1) === 0) {\n    f = 1 - f;\n  }\n  const n = 1 - f;\n  let r = 0;\n  let g = 0;\n  let b = 0;\n  if (i <= 1) {\n    r = n;\n    g = 0;\n    b = 1;\n  } else if (i === 2) {\n    r = 0;\n    g = n;\n    b = 1;\n  } else if (i === 3) {\n    r = 0;\n    g = 1;\n    b = n;\n  } else if (i === 4) {\n    r = n;\n    g = 1;\n    b = 0;\n  } else {\n    r = 1;\n    g = n;\n    b = 0;\n  }\n  return [r * 255, g * 255, b * 255, 1.0];\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { first, sortBy } from \"lodash\";\nimport * as React from \"react\";\nimport Tree from \"react-json-tree\";\nimport styled from \"styled-components\";\n\nimport GlobalVariableLink from \"./GlobalVariableLink/index\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\n\n// Sort the keys of objects to make their presentation more predictable\nconst PREFERRED_OBJECT_KEY_ORDER = [\n  \"id\",\n  \"ns\",\n  \"type\",\n  \"action\",\n  \"header\",\n  \"lifetime\",\n  \"color\",\n  \"colors\",\n  \"pose\",\n  \"points\",\n].reverse();\n\nconst SObjectDetails = styled.div`\n  padding: 12px 0 16px 0;\n`;\n\ntype Props = $ReadOnly<{|\n  selectedObject: any,\n  topic?: ?string,\n|}>;\n\nfunction ObjectDetails({ selectedObject, topic }: Props) {\n  if (!topic) {\n    // show the original object directly if there is no interaction data. e.g. DrawPolygons\n    return (\n      <SObjectDetails>\n        <Tree\n          data={selectedObject}\n          shouldExpandNode={(markerKeyPath, data, level) => level < 2}\n          invertTheme={false}\n          theme={{ ...jsonTreeTheme, tree: { margin: 0 } }}\n          hideRoot\n        />\n      </SObjectDetails>\n    );\n  }\n\n  const sortedDataObject = Object.fromEntries(\n    sortBy(Object.keys(selectedObject), (key) => -PREFERRED_OBJECT_KEY_ORDER.indexOf(key)).map((key) => [\n      key,\n      selectedObject[key],\n    ])\n  );\n\n  return (\n    <SObjectDetails>\n      <Tree\n        data={sortedDataObject}\n        shouldExpandNode={() => false}\n        invertTheme={false}\n        theme={{ ...jsonTreeTheme, tree: { margin: 0 } }}\n        hideRoot\n        getItemString={(type, data, itemType, itemString) => <span>{itemString}</span>}\n        labelRenderer={(markerKeyPath: string[], p1, p2, hasChildren: boolean) => {\n          const label = first(markerKeyPath);\n          if (!hasChildren) {\n            return <span style={{ padding: \"0 4px\" }}>{label}</span>;\n          }\n\n          let objectForPath = sortedDataObject;\n          for (let i = markerKeyPath.length - 1; i >= 0; i--) {\n            objectForPath = objectForPath[markerKeyPath[i]];\n            if (!objectForPath) {\n              break;\n            }\n          }\n\n          if (objectForPath) {\n            return (\n              <GlobalVariableLink\n                hasNestedValue\n                style={{ marginLeft: 4 }}\n                label={label}\n                markerKeyPath={markerKeyPath}\n                topic={topic}\n                variableValue={objectForPath}\n              />\n            );\n          }\n        }}\n        valueRenderer={(label: string, itemValue: any, ...markerKeyPath: string[]) => {\n          return (\n            <GlobalVariableLink\n              style={{ marginLeft: 16 }}\n              label={label}\n              markerKeyPath={markerKeyPath}\n              topic={topic}\n              variableValue={itemValue}\n            />\n          );\n        }}\n      />\n    </SObjectDetails>\n  );\n}\n\nexport default ObjectDetails;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { usePanelContext } from \"webviz-core/src/components/PanelContext\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport RawMessages, { type RawMessagesConfig } from \"webviz-core/src/panels/RawMessages/index\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\nconst STopicLink = styled.span`\n  cursor: pointer;\n  color: ${colors.highlight};\n`;\n\ntype Props = {\n  topic: string,\n};\n\nexport default function TopicLink({ topic }: Props) {\n  const { openSiblingPanel } = usePanelContext();\n  const openRawMessages = React.useCallback(() => {\n    if (!openSiblingPanel) {\n      return;\n    }\n    openSiblingPanel(\n      RawMessages.panelType,\n      // $FlowFixMe\n      (config: RawMessagesConfig) => ({ ...config, topicPath: topic }: RawMessagesConfig)\n    );\n  }, [openSiblingPanel, topic]);\n\n  return (\n    <Tooltip placement=\"top\" contents={`View ${topic} in Raw Messages panel`}>\n      {/* extra span to work around tooltip NaN positioning bug */}\n      <span>\n        <STopicLink onClick={openRawMessages}>{topic}</STopicLink>\n      </span>\n    </Tooltip>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport ConsoleLineIcon from \"@mdi/svg/svg/console-line.svg\";\nimport PlusMinusIcon from \"@mdi/svg/svg/plus-minus.svg\";\nimport LessIcon from \"@mdi/svg/svg/unfold-less-horizontal.svg\";\nimport MoreIcon from \"@mdi/svg/svg/unfold-more-horizontal.svg\";\n// eslint-disable-next-line no-restricted-imports\nimport { first, isEqual, get, last } from \"lodash\";\nimport React, { useState, useCallback, useMemo } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport ReactHoverObserver from \"react-hover-observer\";\nimport Tree from \"react-json-tree\";\n\nimport { HighlightedValue, SDiffSpan, MaybeCollapsedValue } from \"./Diff\";\nimport { type ValueAction, getValueActionForValue, getStructureItemForPath } from \"./getValueActionForValue\";\nimport helpContent from \"./index.help.md\";\nimport styles from \"./index.module.scss\";\nimport Metadata from \"./Metadata\";\nimport RawMessagesIcons from \"./RawMessagesIcons\";\nimport { DATA_ARRAY_PREVIEW_LIMIT, getItemString, getItemStringForDiff } from \"./utils\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport type { RosPath, MessagePathStructureItem } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport {\n  messagePathStructures,\n  traverseStructure,\n} from \"webviz-core/src/components/MessagePathSyntax/messagePathsForDatatype\";\nimport parseRosPath from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport {\n  useCachedGetMessagePathDataItems,\n  type MessagePathDataItem,\n} from \"webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems\";\nimport { useLatestMessageDataItem } from \"webviz-core/src/components/MessagePathSyntax/useLatestMessageDataItem\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { useDataSourceInfo, useMessagesByTopic } from \"webviz-core/src/PanelAPI\";\nimport getDiff, { diffLabels, diffLabelsByLabelText } from \"webviz-core/src/panels/RawMessages/getDiff\";\nimport { cast, type Topic } from \"webviz-core/src/players/types\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { objectValues } from \"webviz-core/src/util\";\nimport {\n  type ArrayView,\n  deepParse,\n  fieldNames,\n  getField,\n  getIndex,\n  isArrayView,\n  isBobject,\n} from \"webviz-core/src/util/binaryObjects\";\nimport { jsonTreeTheme, $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\nimport { enumValuesByDatatypeAndField } from \"webviz-core/src/util/selectors\";\n\nexport const CUSTOM_METHOD = \"custom\";\nexport const PREV_MSG_METHOD = \"previous message\";\nexport const OTHER_SOURCE_METHOD = \"other source\";\nexport type RawMessagesConfig = {|\n  topicPath: string,\n  diffMethod: \"custom\" | \"previous message\" | \"other source\",\n  diffTopicPath: string,\n  diffEnabled: boolean,\n  showFullMessageForDiff: boolean,\n|};\n\ntype Props = {\n  config: RawMessagesConfig,\n  saveConfig: ($Shape<RawMessagesConfig>) => void,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n};\n\nconst isSingleElemArray = (obj) => {\n  if (!Array.isArray(obj) && !isArrayView(obj)) {\n    return false;\n  }\n  const arr = isArrayView(obj) ? cast<ArrayView<any>>(obj).toArray() : cast<any[]>(obj);\n  return arr.filter((a) => a != null).length === 1;\n};\nconst dataWithoutWrappingArray = (data) => {\n  return isSingleElemArray(data) && typeof getIndex(data, 0) === \"object\" ? getIndex(data, 0) : data;\n};\n\nconst maybeShallowParse = (obj: mixed): mixed => {\n  if (!isBobject(obj)) {\n    return obj;\n  }\n  if (isArrayView(obj)) {\n    return cast<ArrayView<any>>(obj).toArray();\n  }\n  const ret = {};\n  // $FlowFixMe: We've checked obj is a bobject above.\n  fieldNames(obj).forEach((field) => {\n    ret[field] = getField(obj, field, true);\n  });\n  return ret;\n};\n\nconst maybeDeepParse = (obj: mixed): mixed => {\n  if (!isBobject(obj)) {\n    return obj;\n  }\n  return deepParse(obj);\n};\n\nfunction RawMessages(props: Props) {\n  const { config, saveConfig, openSiblingPanel } = props;\n  const { topicPath, diffMethod, diffTopicPath, diffEnabled, showFullMessageForDiff } = config;\n  const { topics, datatypes } = useDataSourceInfo();\n\n  const topicRosPath: ?RosPath = useMemo(() => parseRosPath(topicPath), [topicPath]);\n  const topic: ?Topic = useMemo(() => topicRosPath && topics.find(({ name }) => name === topicRosPath.topicName), [\n    topicRosPath,\n    topics,\n  ]);\n  const rootStructureItem: ?MessagePathStructureItem = useMemo(() => {\n    if (!topic || !topicRosPath) {\n      return;\n    }\n    return traverseStructure(messagePathStructures(datatypes)[topic.datatype], topicRosPath.messagePath).structureItem;\n  }, [datatypes, topic, topicRosPath]);\n\n  // When expandAll is unset, we'll use expandedFields to get expanded info\n  const [expandAll, setExpandAll] = useState(false);\n  const [expandedFields, setExpandedFields] = useState(() => new Set());\n\n  const topicName = topicRosPath?.topicName || \"\";\n  const consecutiveMsgs = useMessagesByTopic({ topics: [topicName], historySize: 2, format: \"bobjects\" })[topicName];\n  const cachedGetMessagePathDataItems = useCachedGetMessagePathDataItems([topicPath]);\n  const prevTickMsg = consecutiveMsgs[consecutiveMsgs.length - 2];\n  const [prevTickObj, currTickObj] = [\n    prevTickMsg && {\n      message: prevTickMsg,\n      queriedData: cachedGetMessagePathDataItems(topicPath, prevTickMsg, true) || [],\n    },\n    useLatestMessageDataItem(topicPath, \"bobjects\", true),\n  ];\n\n  const otherSourceTopic = topicName.startsWith($WEBVIZ_SOURCE_2)\n    ? topicName.replace($WEBVIZ_SOURCE_2, \"\")\n    : `${$WEBVIZ_SOURCE_2}${topicName}`;\n  const inOtherSourceDiffMode = diffEnabled && diffMethod === OTHER_SOURCE_METHOD;\n  const diffTopicObj = useLatestMessageDataItem(\n    diffEnabled ? (inOtherSourceDiffMode ? otherSourceTopic : diffTopicPath) : \"\",\n    \"parsedMessages\",\n    true\n  );\n\n  const inTimetickDiffMode = diffEnabled && diffMethod === PREV_MSG_METHOD;\n  const baseItem = inTimetickDiffMode ? prevTickObj : currTickObj;\n  const diffItem = inTimetickDiffMode ? currTickObj : diffTopicObj;\n\n  const onTopicPathChange = useCallback((newTopicPath: string) => {\n    saveConfig({ topicPath: newTopicPath });\n  }, [saveConfig]);\n\n  const onDiffTopicPathChange = useCallback((newDiffTopicPath: string) => {\n    saveConfig({ diffTopicPath: newDiffTopicPath });\n  }, [saveConfig]);\n\n  const onToggleDiff = useCallback(() => {\n    saveConfig({ diffEnabled: !diffEnabled });\n  }, [diffEnabled, saveConfig]);\n\n  const onToggleExpandAll = useCallback(() => {\n    setExpandedFields(new Set());\n    setExpandAll((currVal) => !currVal);\n  }, []);\n\n  const onLabelClick = useCallback((keypath: string[]) => {\n    // Create a unique key according to the keypath / raw\n    const key = keypath.join(\"~\");\n    const expandedFieldsCopy = new Set(expandedFields);\n    if (expandedFieldsCopy.has(key)) {\n      expandedFieldsCopy.delete(key);\n      setExpandedFields(expandedFieldsCopy);\n    } else {\n      expandedFieldsCopy.add(key);\n      setExpandedFields(expandedFieldsCopy);\n    }\n    setExpandAll(null);\n  }, [expandedFields]);\n\n  const valueRenderer = useCallback(\n    (\n      structureItem: ?MessagePathStructureItem,\n      data: mixed[],\n      queriedData: MessagePathDataItem[],\n      label: string,\n      itemValue: mixed,\n      ...keyPath: (number | string)[]\n    ) => (\n      <ReactHoverObserver className={styles.iconWrapper}>\n        {({ isHovering }) => {\n          // $FlowFixMe: We make sure to always pass in a number at the end, but that's hard to express in Flow.\n          const lastKeyPath: number = last(keyPath);\n          let valueAction: ?ValueAction;\n          if (isHovering && structureItem) {\n            valueAction = getValueActionForValue(data[lastKeyPath], structureItem, keyPath.slice(0, -1).reverse());\n          }\n\n          // Find enum name. When the message-path items are messages, we have enough datatype\n          // information to associate nested fields with specific enums using structureItem.\n          let constantName: ?string;\n          if (structureItem) {\n            const childStructureItem = getStructureItemForPath(\n              structureItem,\n              keyPath\n                .slice(0, -1)\n                .reverse()\n                .join(\",\")\n            );\n            if (childStructureItem) {\n              const field = keyPath[0];\n              if (typeof field === \"string\") {\n                const enumMapping = enumValuesByDatatypeAndField(datatypes);\n                const datatype = childStructureItem.datatype;\n                if (enumMapping[datatype] && enumMapping[datatype][field] && enumMapping[datatype][field][itemValue]) {\n                  constantName = enumMapping[datatype][field][itemValue];\n                }\n              }\n            }\n          }\n          // When the message-path items are primitives, the datatype info (uint8, etc) isn't\n          // sufficient to deduce names based on values. In this case we use the constants\n          // associated with the values returned by the message path algorithm.\n          if (\n            constantName == null &&\n            keyPath.length === 1 &&\n            typeof keyPath[0] === \"number\" &&\n            itemValue === queriedData[keyPath[0]].value // just in case\n          ) {\n            constantName = queriedData[keyPath[0]].constantName;\n          }\n          const basePath: string = queriedData[lastKeyPath] && queriedData[lastKeyPath].path;\n          let itemLabel = label;\n          // output preview for the first x items if the data is in binary format\n          // sample output: Int8Array(331776) [-4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, ...]\n          let smallNumberArrayStr = \"\";\n          if (ArrayBuffer.isView(itemValue)) {\n            // $FlowFixMe flow doesn't know itemValue is an array\n            smallNumberArrayStr = `(${itemValue.length}) [${itemValue.slice(0, DATA_ARRAY_PREVIEW_LIMIT).join(\", \")}${\n              // $FlowFixMe\n              itemValue.length >= DATA_ARRAY_PREVIEW_LIMIT ? \", ...\" : \"\"\n            }] `;\n            // $FlowFixMe\n            itemLabel = itemValue.constructor.name;\n          }\n          if (constantName) {\n            itemLabel = `${itemLabel} (${constantName})`;\n          }\n          return (\n            <span>\n              <HighlightedValue itemLabel={itemLabel} />\n              {smallNumberArrayStr && (\n                <>\n                  {smallNumberArrayStr}\n                  <Icon\n                    fade\n                    className={styles.icon}\n                    onClick={() => console.log(itemValue)}\n                    tooltip=\"Log data to browser console\">\n                    <ConsoleLineIcon />\n                  </Icon>\n                </>\n              )}\n              <span className={styles.iconBox}>\n                {valueAction && (\n                  <RawMessagesIcons\n                    valueAction={valueAction}\n                    basePath={basePath}\n                    onTopicPathChange={onTopicPathChange}\n                    openSiblingPanel={openSiblingPanel}\n                  />\n                )}\n              </span>\n            </span>\n          );\n        }}\n      </ReactHoverObserver>\n    ),\n    [datatypes, onTopicPathChange, openSiblingPanel]\n  );\n\n  const renderSingleTopicOrDiffOutput = useCallback(() => {\n    let shouldExpandNode;\n    if (expandAll !== null) {\n      shouldExpandNode = () => expandAll;\n    } else {\n      shouldExpandNode = (keypath) => {\n        return expandedFields.has(keypath.join(\"~\"));\n      };\n    }\n\n    if (!topicPath) {\n      return <EmptyState>No topic selected</EmptyState>;\n    }\n    if (diffEnabled && diffMethod === CUSTOM_METHOD && (!baseItem || !diffItem)) {\n      return <EmptyState>{`Waiting to diff next messages from \"${topicPath}\" and \"${diffTopicPath}\"`}</EmptyState>;\n    }\n    if (diffEnabled && diffMethod === OTHER_SOURCE_METHOD && (!baseItem || !diffItem)) {\n      return <EmptyState>{`Waiting to diff next messages from \"${topicPath}\" and \"${otherSourceTopic}\"`}</EmptyState>;\n    }\n    if (!baseItem) {\n      return <EmptyState>Waiting for next message</EmptyState>;\n    }\n\n    const data = dataWithoutWrappingArray(baseItem.queriedData.map(({ value }) => (value: any)));\n    const hideWrappingArray = baseItem.queriedData.length === 1 && typeof baseItem.queriedData[0].value === \"object\";\n    const shouldDisplaySingleVal =\n      (data !== undefined && typeof data !== \"object\") ||\n      (isSingleElemArray(data) && getIndex(data, 0) != null && typeof getIndex(data, 0) !== \"object\");\n    let singleVal = String(isSingleElemArray(data) ? getIndex(data, 0) : data);\n    if (baseItem.queriedData.length && baseItem.queriedData[0].constantName) {\n      // Handles the message path algorithm returning a single-element array (e.g. [enum]), but not nested arrays (e.g. [[enum]]) - arrays of enums are uncommon.\n      // Handle queriedData.length==0, which happens sometimes when diff-mode is enabled.\n      singleVal += ` (${baseItem.queriedData[0].constantName})`;\n    }\n\n    const diffData = diffItem && dataWithoutWrappingArray(diffItem.queriedData.map(({ value }) => (value: any)));\n    const diff = diffEnabled && getDiff(maybeDeepParse(data), maybeDeepParse(diffData), null, showFullMessageForDiff);\n    const diffLabelTexts = objectValues(diffLabels).map(({ labelText }) => labelText);\n\n    const CheckboxComponent = showFullMessageForDiff ? CheckboxMarkedIcon : CheckboxBlankOutlineIcon;\n    return (\n      <Flex col clip scroll className={styles.container}>\n        <Metadata\n          data={data}\n          diffData={diffData}\n          diff={diff}\n          datatype={topic?.datatype}\n          message={baseItem.message}\n          diffMessage={diffItem?.message}\n        />\n        {shouldDisplaySingleVal ? (\n          <div className={styles.singleVal}>\n            <MaybeCollapsedValue itemLabel={singleVal} />\n          </div>\n        ) : diffEnabled && isEqual({}, diff) ? (\n          <EmptyState>No difference found</EmptyState>\n        ) : (\n          <>\n            {diffEnabled && (\n              <div\n                style={{ cursor: \"pointer\", fontSize: \"11px\" }}\n                onClick={() => saveConfig({ showFullMessageForDiff: !showFullMessageForDiff })}>\n                <Icon style={{ verticalAlign: \"middle\" }}>\n                  <CheckboxComponent />\n                </Icon>{\" \"}\n                Show full msg\n              </div>\n            )}\n            <Tree\n              labelRenderer={(raw) => <SDiffSpan onClick={() => onLabelClick(raw)}>{first(raw)}</SDiffSpan>}\n              shouldExpandNode={shouldExpandNode}\n              hideRoot\n              invertTheme={false}\n              getItemString={diffEnabled ? getItemStringForDiff : getItemString}\n              isCustomNode={(value) => {\n                // Tree otherwise renders these as \"<BigInt>\"\n                // eslint-disable-next-line valid-typeof\n                return typeof value === \"bigint\";\n              }}\n              valueRenderer={(...args) => {\n                if (diffEnabled) {\n                  return valueRenderer(null, diff, diff, ...args);\n                }\n                if (hideWrappingArray) {\n                  // When the wrapping array is hidden, put it back here.\n                  return valueRenderer(rootStructureItem, [data], baseItem.queriedData, ...args, 0);\n                }\n                return valueRenderer(rootStructureItem, data, baseItem.queriedData, ...args);\n              }}\n              postprocessValue={(rawVal: mixed) => {\n                const val = maybeShallowParse(rawVal);\n                if (\n                  val != null &&\n                  typeof val === \"object\" &&\n                  (!Array.isArray(val) && !ArrayBuffer.isView(val)) &&\n                  Object.keys(val).length === 1 &&\n                  diffLabelTexts.includes(Object.keys(val)[0])\n                ) {\n                  if (Object.keys(val)[0] !== diffLabels.ID.labelText) {\n                    return objectValues(val)[0];\n                  }\n                }\n                return val;\n              }}\n              theme={{\n                ...jsonTreeTheme,\n                tree: { margin: 0 },\n                nestedNode: ({ style }, keyPath) => {\n                  const baseStyle = {\n                    ...style,\n                    padding: \"2px 0 2px 5px\",\n                    marginTop: 2,\n                    textDecoration: \"inherit\",\n                  };\n                  if (!diffEnabled) {\n                    return { style: baseStyle };\n                  }\n                  let backgroundColor;\n                  let textDecoration;\n                  if (diffLabelsByLabelText[keyPath[0]]) {\n                    backgroundColor = diffLabelsByLabelText[keyPath[0]].backgroundColor;\n                    textDecoration = keyPath[0] === diffLabels.DELETED.labelText ? \"line-through\" : \"none\";\n                  }\n                  const nestedObj = get(diff, keyPath.slice().reverse(), {});\n                  const nestedObjKey = Object.keys(nestedObj)[0];\n                  if (diffLabelsByLabelText[nestedObjKey]) {\n                    backgroundColor = diffLabelsByLabelText[nestedObjKey].backgroundColor;\n                    textDecoration = nestedObjKey === diffLabels.DELETED.labelText ? \"line-through\" : \"none\";\n                  }\n                  return {\n                    style: { ...baseStyle, backgroundColor, textDecoration: textDecoration || \"inherit\" },\n                  };\n                },\n                nestedNodeLabel: ({ style }) => ({\n                  style: { ...style, textDecoration: \"inherit\" },\n                }),\n                nestedNodeChildren: ({ style }) => ({\n                  style: { ...style, textDecoration: \"inherit\" },\n                }),\n                value: ({ style }, nodeType, keyPath) => {\n                  const baseStyle = { ...style, textDecoration: \"inherit\" };\n                  if (!diffEnabled) {\n                    return { style: baseStyle };\n                  }\n                  let backgroundColor;\n                  let textDecoration;\n                  const nestedObj = get(diff, keyPath.slice().reverse(), {});\n                  const nestedObjKey = Object.keys(nestedObj)[0];\n                  if (diffLabelsByLabelText[nestedObjKey]) {\n                    backgroundColor = diffLabelsByLabelText[nestedObjKey].backgroundColor;\n                    textDecoration = nestedObjKey === diffLabels.DELETED.labelText ? \"line-through\" : \"none\";\n                  }\n                  return {\n                    style: { ...baseStyle, backgroundColor, textDecoration: textDecoration || \"inherit\" },\n                  };\n                },\n                label: { textDecoration: \"inherit\" },\n              }}\n              data={diffEnabled ? diff : data}\n            />\n          </>\n        )}\n      </Flex>\n    );\n  }, [\n    baseItem,\n    diffEnabled,\n    diffItem,\n    diffMethod,\n    diffTopicPath,\n    expandAll,\n    expandedFields,\n    onLabelClick,\n    otherSourceTopic,\n    rootStructureItem,\n    saveConfig,\n    showFullMessageForDiff,\n    topic,\n    topicPath,\n    valueRenderer,\n  ]);\n\n  return (\n    <Flex col clip style={{ position: \"relative\" }}>\n      <PanelToolbar helpContent={helpContent}>\n        <Icon tooltip=\"Toggle diff\" medium fade onClick={onToggleDiff} active={diffEnabled}>\n          <PlusMinusIcon />\n        </Icon>\n        <Icon\n          tooltip={expandAll ? \"Collapse all\" : \"Expand all\"}\n          medium\n          fade\n          onClick={onToggleExpandAll}\n          style={{ position: \"relative\", top: 1 }}>\n          {expandAll ? <LessIcon /> : <MoreIcon />}\n        </Icon>\n        <div className={styles.topicInputs}>\n          <MessagePathInput index={0} path={topicPath} onChange={onTopicPathChange} inputStyle={{ height: \"100%\" }} />\n          {diffEnabled && (\n            <Flex>\n              <Tooltip contents=\"Diff method\" placement=\"top\">\n                <>\n                  <Dropdown\n                    value={diffMethod}\n                    onChange={(newDiffMethod) => saveConfig({ diffMethod: newDiffMethod })}\n                    noPortal>\n                    <span value={PREV_MSG_METHOD}>{PREV_MSG_METHOD}</span>\n                    <span value={OTHER_SOURCE_METHOD}>{OTHER_SOURCE_METHOD}</span>\n                    <span value={CUSTOM_METHOD}>custom</span>\n                  </Dropdown>\n                </>\n              </Tooltip>\n              {diffMethod === CUSTOM_METHOD ? (\n                <MessagePathInput\n                  index={1}\n                  path={diffTopicPath}\n                  onChange={onDiffTopicPathChange}\n                  inputStyle={{ height: \"100%\" }}\n                  prioritizedDatatype={topic?.datatype}\n                />\n              ) : null}\n            </Flex>\n          )}\n        </div>\n      </PanelToolbar>\n      {renderSingleTopicOrDiffOutput()}\n    </Flex>\n  );\n}\n\nRawMessages.defaultConfig = {\n  topicPath: \"\",\n  diffTopicPath: \"\",\n  diffMethod: CUSTOM_METHOD,\n  diffEnabled: false,\n  showFullMessageForDiff: false,\n};\nRawMessages.panelType = \"RawMessages\";\n\nexport default hot(Panel<RawMessagesConfig>(RawMessages));\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { first, last } from \"lodash\";\nimport React from \"react\";\n\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport { diffLabels } from \"webviz-core/src/panels/RawMessages/getDiff\";\nimport { format, formatDuration } from \"webviz-core/src/util/formatTime\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst DURATION_20_YEARS_SEC = 20 * 365 * 24 * 60 * 60;\nexport const DATA_ARRAY_PREVIEW_LIMIT = 20;\nexport const ROS_COMMON_MSGS: Set<string> = new Set([\n  \"actionlib_msgs\",\n  \"diagnostic_msgs\",\n  \"geometry_msgs\",\n  \"nav_msgs\",\n  \"sensor_msgs\",\n  \"shape_msgs\",\n  \"std_msgs\",\n  \"stereo_msgs\",\n  \"trajectory_msgs\",\n  \"visualization_msgs\",\n]);\n\nfunction getArrow(x: number, y: number) {\n  if (x === 0 && y === 0) {\n    return;\n  }\n  return <span style={{ transform: `rotate(${Math.atan2(-y, x)}rad)`, display: \"inline-block\" }}></span>;\n}\n\nexport function getItemString(type: string, data: any, itemType: string, itemString: string) {\n  const keys = Object.keys(data);\n  if (keys.length === 2) {\n    const { sec, nsec } = data;\n    if (sec != null && nsec != null) {\n      // Values \"too small\" to be absolute epoch-based times are probably relative durations.\n      return sec < DURATION_20_YEARS_SEC ? formatDuration(data) : <span>{format(data)}</span>;\n    }\n  }\n\n  // for vectors/points display length\n  if (keys.length === 2) {\n    const { x, y } = data;\n    if (x != null && y != null) {\n      const length = Math.sqrt(x * x + y * y);\n      return (\n        <span>\n          norm = {length.toFixed(2)} {getArrow(x, y)}\n        </span>\n      );\n    }\n  }\n\n  if (keys.length === 3) {\n    const { x, y, z } = data;\n    if (x != null && y != null && z != null) {\n      const length = Math.sqrt(x * x + y * y + z * z);\n      return (\n        <span>\n          norm = {length.toFixed(2)} {z === 0 ? getArrow(x, y) : undefined}\n        </span>\n      );\n    }\n  }\n\n  // Surface typically-used keys directly in the object summary so the user doesn't have to expand it.\n  const filterKeys = keys\n    .filter(isTypicalFilterName)\n    .map((key) => `${key}: ${data[key]}`)\n    .join(\", \");\n  return (\n    <span>\n      {itemType} {filterKeys || itemString}\n    </span>\n  );\n}\n\nfunction getChangeCounts(data, startingCounts) {\n  const possibleLabelTexts = Object.keys(startingCounts);\n  for (const key in data) {\n    if (possibleLabelTexts.includes(key)) {\n      startingCounts[key]++;\n    } else if (typeof data[key] === \"object\") {\n      getChangeCounts(data[key], startingCounts);\n    }\n  }\n  return startingCounts;\n}\n\nexport const getItemStringForDiff = (type: string, data: any, itemType: string) => {\n  const { ADDED, DELETED, CHANGED, ID } = diffLabels;\n  const id = data[ID.labelText];\n  const idLabel = id\n    ? Object.keys(id)\n        .map((key) => `${key}: ${id[key]}`)\n        .join(\", \")\n    : null;\n  const startingCounts = { [ADDED.labelText]: 0, [CHANGED.labelText]: 0, [DELETED.labelText]: 0 };\n  const counts = getChangeCounts(data, startingCounts);\n  return (\n    <>\n      {id ? (\n        <span>\n          {itemType} {idLabel}\n        </span>\n      ) : null}\n      <span style={{ float: \"right\", color: CHANGED.color }}>\n        {counts[ADDED.labelText] || counts[DELETED.labelText] ? (\n          <span\n            style={{\n              display: \"inline-block\",\n              fontSize: \"0.8em\",\n              padding: 2,\n              borderRadius: 3,\n              backgroundColor: ADDED.color,\n              marginRight: 5,\n            }}>\n            <span style={{ color: colors.GREEN }}>\n              {counts[ADDED.labelText] ? `${diffLabels.ADDED.indicator}${counts[ADDED.labelText]} ` : null}\n            </span>\n            <span style={{ color: colors.RED }}>\n              {counts[DELETED.labelText] ? `${diffLabels.DELETED.indicator}${counts[DELETED.labelText]}` : null}\n            </span>\n          </span>\n        ) : null}\n        {counts[CHANGED.labelText] ? (\n          <span\n            style={{\n              display: \"inline-block\",\n              width: 3,\n              height: 3,\n              borderRadius: 3,\n              backgroundColor: CHANGED.color,\n              marginRight: 5,\n            }}>\n            {counts[CHANGED.labelText] ? \" \" : null}\n          </span>\n        ) : null}\n      </span>\n    </>\n  );\n};\n\nexport function getMessageDocumentationLink(datatype: string): ?string {\n  const parts = datatype.split(\"/\");\n  const pkg = first(parts);\n  const filename = last(parts);\n  return ROS_COMMON_MSGS.has(pkg)\n    ? `http://docs.ros.org/api/${pkg}/html/msg/${filename}.html`\n    : getGlobalHooks()\n        .perPanelHooks()\n        .RawMessages.docLinkFunction(filename);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport _, { flatten, groupBy, isEqual, keyBy, mapValues, some, xor } from \"lodash\";\nimport type { Time } from \"rosbag\";\nimport shallowequal from \"shallowequal\";\n\nimport type { SkipTransformSpec, ThreeDimensionalVizHooks } from \"./types\";\nimport type { GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport MessageCollector from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/MessageCollector\";\nimport type { MarkerMatcher } from \"webviz-core/src/panels/ThreeDimensionalViz/ThreeDimensionalVizContext\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport type { StructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport { cast, type BobjectMessage, type Topic, type Frame, type Message } from \"webviz-core/src/players/types\";\nimport type {\n  BinaryPath,\n  BinaryMarker,\n  BinaryIconMarker,\n  BinaryPolygonStamped,\n  BinaryPoseStamped,\n  BinaryInstancedMarker,\n  WrappedPointCloud,\n} from \"webviz-core/src/types/BinaryMessages\";\nimport type {\n  Color,\n  Marker,\n  Namespace,\n  NavMsgs$OccupancyGrid,\n  MutablePose,\n  Pose,\n  StampedMessage,\n} from \"webviz-core/src/types/Messages\";\nimport type { MarkerProvider, MarkerCollector, Scene } from \"webviz-core/src/types/Scene\";\nimport { objectValues } from \"webviz-core/src/util\";\nimport { getField, getIndex, deepParse } from \"webviz-core/src/util/binaryObjects\";\nimport {\n  POSE_MARKER_SCALE,\n  LINED_CONVEX_HULL_RENDERING_SETTING,\n  MARKER_ARRAY_DATATYPES,\n  $TF_STATIC,\n  $TF,\n  VISUALIZATION_MSGS$WEBVIZ_MARKER,\n  VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY,\n  VISUALIZATION_MSGS$MARKER,\n  VISUALIZATION_MSGS$MARKER_ARRAY,\n  GEOMETRY_MSGS$POSE_STAMPED,\n  NAV_MSGS$PATH,\n  NAV_MSGS$OCCUPANCY_GRID,\n  SENSOR_MSGS$POINT_CLOUD_2,\n  SENSOR_MSGS$LASER_SCAN,\n  GEOMETRY_MSGS$POLYGON_STAMPED,\n  WEBVIZ_ICON_MSGS$WEBVIZ_3D_ICON_ARRAY,\n  MARKER_MSG_TYPES,\n  RADAR_POINT_CLOUD,\n  WRAPPED_POINT_CLOUD,\n} from \"webviz-core/src/util/globalConstants\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\nimport { emptyPose } from \"webviz-core/src/util/Pose\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\nimport { fromSec } from \"webviz-core/src/util/time\";\n\nexport type TopicSettingsCollection = {\n  [topicOrNamespaceKey: string]: any,\n};\n\n// builds a syntehtic arrow marker from a geometry_msgs/PoseStamped\n// these pose sizes were manually configured in rviz; for now we hard-code them here\nexport const buildSyntheticArrowMarker = (\n  { topic, message }: Message,\n  pose: Pose,\n  getSyntheticArrowMarkerColor: (string) => Color\n) => ({\n  type: 103,\n  pose,\n  scale: POSE_MARKER_SCALE,\n  color: getSyntheticArrowMarkerColor(topic),\n  interactionData: { topic, originalMessage: message },\n});\n\n// TODO(JP): looks like we might not actually use these fields in the new topic picker?\nexport type ErrorDetails = {| frameIds: Set<string>, namespaces: Set<string> |};\n\nexport type SceneErrors = {\n  topicsMissingFrameIds: Map<string, ErrorDetails>,\n  topicsMissingTransforms: Map<string, ErrorDetails>,\n  topicsWithBadFrameIds: Map<string, ErrorDetails>,\n  topicsWithError: Map<string, string>,\n  rootTransformID: string,\n};\n\ntype SceneErrorTopics = {\n  topicsWithBadFrameIds: Set<string>,\n};\n\nexport type SelectedNamespacesByTopic = { [topicName: string]: string[] };\n// constructs a scene containing all objects to be rendered\n// by consuming visualization topics from frames\n\ntype MarkerMatchersByTopic = { [string]: Array<MarkerMatcher> };\n\nconst missingTransformMessage = (\n  rootTransformId: string,\n  error: ErrorDetails,\n  transforms: Transforms,\n  skipTransform: ?SkipTransformSpec\n): string => {\n  if (skipTransform != null && error.frameIds.has(skipTransform.frameId)) {\n    return `missing transform. Is ${skipTransform.sourceTopic} present?`;\n  }\n  if (transforms.empty) {\n    return `missing transform. Is ${$TF} or ${$TF_STATIC} present?`;\n  }\n  const frameIds = [...error.frameIds].sort().join(\",\");\n  const s = error.frameIds.size === 1 ? \"\" : \"s\"; // for plural\n  return `missing transforms to root frame ${rootTransformId} from frame${s} ${frameIds}.`;\n};\n\nexport function getSceneErrorsByTopic(\n  sceneErrors: SceneErrors,\n  transforms: Transforms,\n  skipTransform: ?SkipTransformSpec\n): { [topicName: string]: string[] } {\n  const res = {};\n  const addError = (topic, message) => {\n    if (!res[topic]) {\n      res[topic] = [];\n    }\n    res[topic].push(message);\n  };\n  // generic errors\n  for (const [topic, message] of sceneErrors.topicsWithError) {\n    addError(topic, message);\n  }\n  // errors related to missing frame ids and transform ids\n  sceneErrors.topicsMissingTransforms.forEach((err, topic) => {\n    addError(topic, missingTransformMessage(sceneErrors.rootTransformID, err, transforms, skipTransform));\n  });\n  sceneErrors.topicsMissingFrameIds.forEach((_err, topic) => {\n    addError(topic, \"missing frame id\");\n  });\n  return res;\n}\n\n// Only display one non-lifetime message at a time, so we filter to the last one.\nexport function filterOutSupersededMessages(messages: any, datatype: string) {\n  // Later messages take precedence over earlier messages, so iterate from latest to earliest to\n  // find the last one that matters.\n  const reversedMessages = messages.slice().reverse();\n  if (MARKER_ARRAY_DATATYPES.includes(datatype)) {\n    // Many marker arrays begin with a command to \"delete all markers on this topic\". If we see\n    // this, we can ignore any earlier messages on the topic.\n    const earliestMessageToKeepIndex = reversedMessages.findIndex(({ message }) => {\n      const markers = getField(message, \"markers\") ?? getField(message, \"allMarkers\");\n      return getField(getIndex(markers, 0), \"action\") === 3;\n    });\n    if (earliestMessageToKeepIndex !== -1) {\n      return reversedMessages.slice(0, earliestMessageToKeepIndex + 1).reverse();\n    }\n    return messages;\n  }\n  const filteredMessages = [];\n  let hasSeenNonLifetimeMessage = false;\n  for (const message of reversedMessages) {\n    const hasLifetime = !!getField(message.message, \"lifetime\");\n    if (hasLifetime) {\n      // Show all messages that have a lifetime.\n      filteredMessages.unshift(message);\n    } else if (!hasSeenNonLifetimeMessage) {\n      // Only show the last non-lifetime message.\n      filteredMessages.unshift(message);\n      hasSeenNonLifetimeMessage = true;\n    }\n  }\n  return filteredMessages;\n}\n\n// https://stackoverflow.com/a/59084440/4543751\nexport function parseStringTemplate(str: string, obj: any): string {\n  const parts = str.split(/\\$\\{(?!\\d)[\\w]*\\}/);\n  const args = str.match(/[^{}]+(?=})/g) || [];\n  const parameters = args.map((argument) => obj[argument] || (obj[argument] === undefined ? \"\" : obj[argument]));\n  // $FlowFixMe raw type is string[] which is correct.\n  return String.raw({ raw: parts }, ...parameters);\n}\n\nexport default class SceneBuilder implements MarkerProvider {\n  topicsByName: { [topicName: string]: Topic } = {};\n  markers: Marker[] = [];\n  transforms: Transforms;\n  rootTransformID: string;\n  selectionState: any = {};\n  frame: Frame;\n  _structuralDatatypes: StructuralDatatypes = {};\n  // TODO(JP): Get rid of these two different variables `errors` and `errorsByTopic` which we\n  // have to keep in sync.\n  errors: SceneErrors = {\n    rootTransformID: \"\",\n    topicsMissingFrameIds: new Map(),\n    topicsMissingTransforms: new Map(),\n    topicsWithBadFrameIds: new Map(),\n    topicsWithError: new Map(),\n  };\n  errorsByTopic: { [topicName: string]: string[] } = {};\n  reportedErrorTopics: SceneErrorTopics = {\n    topicsWithBadFrameIds: new Set(),\n  };\n  maps = [];\n  flattenedZHeightPose: ?Pose = null;\n  scene = {};\n  collectors: { [string]: MessageCollector } = {};\n  _clock: Time;\n  _playerId: ?string = null;\n  _settingsByKey: TopicSettingsCollection = {};\n  _onForceUpdate: ?() => void = null;\n\n  // When not-empty, fade any markers that don't match\n  _highlightMarkerMatchersByTopic: MarkerMatchersByTopic = {};\n\n  // When not-empty, override the color of matching markers\n  _colorOverrideMarkerMatchersByTopic: MarkerMatchersByTopic = {};\n\n  _hooks: ThreeDimensionalVizHooks;\n\n  allNamespaces: Namespace[] = [];\n  // TODO(Audrey): remove enabledNamespaces once we release topic groups\n  enabledNamespaces: Namespace[] = [];\n  selectedNamespacesByTopic: ?{ [topicName: string]: Set<string> };\n  flatten: boolean = false;\n  _minZ: number = Number.MAX_SAFE_INTEGER;\n\n  // list of topics that need to be rerendered because the frame has new values\n  // or because a prop affecting its rendering was changed\n  topicsToRender: Set<string> = new Set();\n\n  // stored message arrays allowing used to re-render topics even when the latest\n  // frame does not not contain that topic\n  lastSeenMessages: { [string]: Message[] } = {};\n\n  resetMinZ() {\n    this._minZ = Number.MAX_SAFE_INTEGER;\n  }\n\n  updateMinZ(z: number) {\n    this._minZ = Math.min(this._minZ, z);\n  }\n\n  constructor(hooks: ThreeDimensionalVizHooks) {\n    this._hooks = hooks;\n  }\n\n  setTransforms = (transforms: Transforms, rootTransformID: string) => {\n    this.transforms = transforms;\n    this.rootTransformID = rootTransformID;\n    this.errors.rootTransformID = rootTransformID;\n  };\n\n  setStructuralDatatypes(datatypes: StructuralDatatypes) {\n    this._structuralDatatypes = datatypes;\n  }\n\n  clear() {\n    for (const topicName of Object.keys(this.topicsByName)) {\n      const collector = this.collectors[topicName];\n      if (collector) {\n        collector.flush();\n      }\n    }\n  }\n\n  setPlayerId(playerId: string) {\n    if (this._playerId !== playerId) {\n      this.reportedErrorTopics.topicsWithBadFrameIds.clear();\n      this.errors = {\n        rootTransformID: \"\",\n        topicsMissingFrameIds: new Map(),\n        topicsMissingTransforms: new Map(),\n        topicsWithBadFrameIds: new Map(),\n        topicsWithError: new Map(),\n      };\n      this._updateErrorsByTopic();\n    }\n    this._playerId = playerId;\n  }\n\n  setSettingsByKey(settings: TopicSettingsCollection) {\n    this._settingsByKey = settings;\n  }\n\n  // set the topics the scene builder should consume from each frame\n  setTopics(topics: Topic[]) {\n    const topicsToFlush = Object.keys(this.topicsByName).filter(\n      (topicName) => !topics.find((other) => other.name === topicName)\n    );\n    // Sort the topics by name so the render order is consistent.\n    this.topicsByName = keyBy(topics.slice().sort(naturalSort(\"name\")), \"name\");\n    // IMPORTANT: when topics change, we also need to reset the frame so that\n    // setFrame gets called correctly to set the topicsToRender and lastSeenMessages\n    this.frame = {};\n    // Delete message collectors we don't need anymore\n    topicsToFlush.forEach((topicName) => {\n      const collector = this.collectors[topicName];\n      if (collector) {\n        collector.flush();\n        delete this.collectors[topicName];\n      }\n    });\n  }\n\n  setFrame(frame: Frame) {\n    if (this.frame === frame) {\n      return;\n    }\n    this.frame = frame;\n    for (const topicName of Object.keys(this.topicsByName)) {\n      if (topicName in frame) {\n        this.topicsToRender.add(topicName);\n      }\n    }\n\n    // Note we save even topics that are not rendered since they may be used by non-rendered topics\n    Object.assign(this.lastSeenMessages, frame);\n  }\n\n  setFlattenMarkers(_flatten: boolean): void {\n    this.flatten = _flatten;\n  }\n\n  setEnabledNamespaces(namespaces: Namespace[]) {\n    this.enabledNamespaces = namespaces;\n  }\n\n  setSelectedNamespacesByTopic(selectedNamespacesByTopic: SelectedNamespacesByTopic) {\n    // We need to update topicsToRender here so changes to the selected namespaces will appear on the next render()\n    Object.keys(selectedNamespacesByTopic).forEach((topicName) => {\n      const newNamespaces = selectedNamespacesByTopic[topicName];\n      const previousNamespaces = [...(this.selectedNamespacesByTopic?.[topicName] || [])];\n      if (xor(newNamespaces, previousNamespaces).length > 0) {\n        this._markTopicToRender(topicName);\n      }\n    });\n    this.selectedNamespacesByTopic = mapValues(selectedNamespacesByTopic, (namespaces) => new Set(namespaces));\n  }\n\n  setGlobalVariables = ({ globalVariables }: { globalVariables: GlobalVariables }) => {\n    const { getSelectionState, getTopicsToRender } = this._hooks;\n    const prevSelectionState = this.selectionState;\n    this.selectionState = getSelectionState(globalVariables);\n\n    // Because setSelectedNamespacesByTopic is called before setGlobalVariables,\n    // we need to add the topics here instead of overwriting them.\n    const updatedTopics = getTopicsToRender(prevSelectionState, this.selectionState);\n    updatedTopics.forEach((topicName) => this._markTopicToRender(topicName));\n  };\n\n  setHighlightedMatchers(markerMatchers: Array<MarkerMatcher>) {\n    const markerMatchersByTopic = groupBy<string, MarkerMatcher>(markerMatchers, ({ topic }) => topic);\n    this._addTopicsToRenderForMarkerMatchers(this._highlightMarkerMatchersByTopic, markerMatchers);\n    this._highlightMarkerMatchersByTopic = markerMatchersByTopic;\n  }\n\n  setColorOverrideMatchers(markerMatchers: Array<MarkerMatcher>) {\n    const markerMatchersByTopic = groupBy<string, MarkerMatcher>(markerMatchers, ({ topic }) => topic);\n    this._addTopicsToRenderForMarkerMatchers(this._colorOverrideMarkerMatchersByTopic, markerMatchers);\n    this._colorOverrideMarkerMatchersByTopic = markerMatchersByTopic;\n  }\n\n  _addTopicsToRenderForMarkerMatchers(\n    previousMarkerMatchersByTopic: MarkerMatchersByTopic,\n    newMarkerMatchers: Array<MarkerMatcher>\n  ) {\n    const matchersBefore = flatten(Object.keys(previousMarkerMatchersByTopic)).flatMap(\n      (topic) => previousMarkerMatchersByTopic[topic]\n    );\n    // If any of the matchers have changed, we need to rerender all of the topics\n    if (!shallowequal(matchersBefore, newMarkerMatchers)) {\n      Object.keys(this.topicsByName).forEach((name) => this._markTopicToRender(name));\n    }\n  }\n\n  _markTopicToRender(topicName: string) {\n    if (this.topicsByName[topicName]) {\n      this.topicsToRender.add(topicName);\n    }\n  }\n\n  hasErrors() {\n    const { topicsMissingFrameIds, topicsMissingTransforms, topicsWithBadFrameIds, topicsWithError } = this.errors;\n    return (\n      topicsMissingFrameIds.size !== 0 ||\n      topicsMissingTransforms.size !== 0 ||\n      topicsWithBadFrameIds.size !== 0 ||\n      topicsWithError.size !== 0\n    );\n  }\n\n  setOnForceUpdate(callback: () => void) {\n    this._onForceUpdate = callback;\n  }\n\n  _addError(map: Map<string, ErrorDetails>, topic: string): ErrorDetails {\n    let values = map.get(topic);\n    if (!values) {\n      values = { namespaces: new Set(), frameIds: new Set() };\n      map.set(topic, values);\n    }\n    this._updateErrorsByTopic();\n    return values;\n  }\n\n  setTopicError = (topic: string, message: string) => {\n    this.errors.topicsWithError.set(topic, message);\n    this._updateErrorsByTopic();\n  };\n\n  // Update the field anytime the errors change in order to generate a new object to trigger TopicTree to rerender.\n  _updateErrorsByTopic() {\n    const errorsByTopic = getSceneErrorsByTopic(this.errors, this.transforms, this._hooks.skipTransformFrame);\n    if (!isEqual(this.errorsByTopic, errorsByTopic)) {\n      this.errorsByTopic = errorsByTopic;\n      if (this._onForceUpdate) {\n        this._onForceUpdate();\n      }\n    }\n  }\n\n  // keep a unique set of all seen namespaces\n  _consumeNamespace(topic: string, name: string) {\n    if (some(this.allNamespaces, (ns) => ns.topic === topic && ns.name === name)) {\n      return;\n    }\n    this.allNamespaces = this.allNamespaces.concat([{ topic, name }]);\n    if (this._onForceUpdate) {\n      this._onForceUpdate();\n    }\n  }\n\n  // Only public for tests.\n  namespaceIsEnabled(topic: string, name: string) {\n    if (this.selectedNamespacesByTopic) {\n      // enable all namespaces under a topic if it's not already set\n      return (\n        (this.selectedNamespacesByTopic[topic] && this.selectedNamespacesByTopic[topic].has(name)) ||\n        this.selectedNamespacesByTopic[topic] == null\n      );\n    }\n    return some(this.enabledNamespaces, (ns) => ns.topic === topic && ns.name === name);\n  }\n\n  _reportBadFrameId(topic: string) {\n    if (!this.reportedErrorTopics.topicsWithBadFrameIds.has(topic)) {\n      this.reportedErrorTopics.topicsWithBadFrameIds.add(topic);\n      sendNotification(\n        `Topic ${topic} has bad frame`,\n        \"Non-root transforms may be out of sync, since webviz uses the latest transform message instead of the one matching header.stamp\",\n        \"user\",\n        \"warn\"\n      );\n    }\n  }\n\n  _transformMarkerPose = (\n    topic: string,\n    marker: BinaryMarker | BinaryIconMarker | BinaryInstancedMarker\n  ): ?MutablePose => {\n    const frame_id = marker.header().frame_id();\n\n    if (!frame_id) {\n      const error = this._addError(this.errors.topicsMissingFrameIds, topic);\n      error.namespaces.add(marker.ns());\n      return null;\n    }\n\n    if (frame_id === this.rootTransformID) {\n      // Transforming is a bit expensive, and this (no transformation necessary) is the common-case\n      // Need to deep-parse because worldview expects fully-parsed JS objects\n      return deepParse(marker.pose());\n    }\n\n    // frame_id !== this.rootTransformID.\n    // We continue to render these, though they may be inaccurate\n    this._reportBadFrameId(topic);\n    const badFrameError = this._addError(this.errors.topicsWithBadFrameIds, topic);\n    const namespace = marker.ns();\n    badFrameError.namespaces.add(namespace);\n    badFrameError.frameIds.add(frame_id);\n\n    const pose = this.transforms.apply(emptyPose(), deepParse(marker.pose()), frame_id, this.rootTransformID);\n    if (!pose) {\n      const topicMissingError = this._addError(this.errors.topicsMissingTransforms, topic);\n      topicMissingError.namespaces.add(namespace);\n      topicMissingError.frameIds.add(frame_id);\n    }\n    return pose;\n  };\n\n  _consumeMarkerArray = (topic: string, message: any): void => {\n    for (const marker of message.markers()) {\n      this._consumeMarker(topic, marker);\n    }\n  };\n\n  _consumeMarker(topic: string, message: BinaryMarker | BinaryIconMarker | BinaryInstancedMarker): void {\n    const namespace = message.ns();\n    if (namespace) {\n      // Consume namespaces even if the message is later discarded\n      // Otherwise, the namespace won't be shown as available.\n      this._consumeNamespace(topic, namespace);\n      if (!this.namespaceIsEnabled(topic, namespace)) {\n        return;\n      }\n    }\n\n    // Marker names are used to identify previously rendered markers for \"deletes\" and over-writing\n    // \"adds\".\n    // In each topic, the namespace (`ns`) and identifier (`id`) uniquely identify the marker.\n    // See https://github.com/ros-visualization/rviz/blob/4b6c0f4/src/rviz/default_plugin/markers/marker_base.h#L56\n    // and https://github.com/ros-visualization/rviz/blob/4b6c0f4/src/rviz/default_plugin/marker_display.cpp#L422\n    const name = `${topic}/${namespace}/${message.id()}`;\n    switch (message.action()) {\n      case 0: // add\n        break;\n      case 1: // deprecated in ros\n        this.setTopicError(topic, \"Marker.action=1 is deprecated\");\n        return;\n      case 2: // delete\n        this.collectors[topic].deleteMarker(name);\n        return;\n      case 3:\n        this.collectors[topic].deleteAll();\n        return;\n      default:\n        this.setTopicError(topic, `Unsupported action type: ${message.action()}`);\n        return;\n    }\n\n    const pose = this._transformMarkerPose(topic, message);\n    if (!pose) {\n      return;\n    }\n\n    const points = message.points();\n    const { position } = pose;\n\n    let minZ = Number.MAX_SAFE_INTEGER;\n\n    const parsedPoints = [];\n    // if the marker has points, deep-parse them and adjust minZ (Constructed markers sometimes\n    // don't have points.)\n    if (points && points.length()) {\n      for (const point of points) {\n        const z = point.z();\n        minZ = Math.min(minZ, z);\n        this.updateMinZ(z + position.z);\n        parsedPoints.push({ x: point.x(), y: point.y(), z });\n      }\n    } else {\n      // otherwise just adjust by the pose\n      minZ = Math.min(minZ, position.z);\n      this.updateMinZ(position.z);\n    }\n\n    // if the minimum z value of any point (or the pose) is exactly 0\n    // then assume this marker can be flattened\n    if (minZ === 0 && this.flatten && this.flattenedZHeightPose) {\n      position.z = this.flattenedZHeightPose.position.z;\n    }\n\n    // HACK(jacob): rather than hard-coding this, we should\n    //  (a) produce this visualization dynamically from a non-marker topic\n    //  (b) fix translucency so it looks correct (harder)\n    const color = this._hooks.getMarkerColor(topic, deepParse(message.color()));\n\n    // Allow topic settings to override marker color (see MarkerSettingsEditor.js)\n    const { overrideColor, iconTextTemplate } =\n      this._settingsByKey[`ns:${topic}:${namespace}`] || this._settingsByKey[`t:${topic}`] || {};\n\n    // Check for matching colorOverrideMarkerMatchers for this topic\n    const colorOverrideMarkerMatchers = this._colorOverrideMarkerMatchersByTopic[topic] || [];\n    const matchingMatcher = colorOverrideMarkerMatchers.find(({ checks = [] }) =>\n      checks.every(({ markerKeyPath = [], value }) => {\n        // Get the item at the key path\n        const markerValue = markerKeyPath.reduce((item: any, key) => item?.[key] && item[key](), (message: any));\n        return value === markerValue;\n      })\n    );\n    let matchingOverrideColor = overrideColor;\n    if (matchingMatcher) {\n      matchingOverrideColor = matchingMatcher.color;\n    }\n\n    // Set later in renderMarkers so it be applied to markers generated in _consumeNonMarkerMessage\n    const highlighted = false;\n    const interactionData = {\n      topic,\n      highlighted,\n      originalMessage: message,\n    };\n    const lifetime = message.lifetime();\n    // This \"marker-ish\" thing is an unholy union of many drawable types...\n    const marker: any = {\n      type: message.type(),\n      scale: deepParse(message.scale()),\n      // Missing lifetimes are badly inferred during tests. Hopefully not needed for long.\n      lifetime: lifetime ? deepParse(lifetime) : null,\n      pose,\n      interactionData,\n      color: matchingOverrideColor || color,\n      colors: matchingOverrideColor ? [] : deepParse(message.colors()),\n      points: parsedPoints,\n      // These fields are probably unused, but Flow asks for them.\n      // TODO(useBinaryTranslation): Loosen the flow-type here?\n      id: message.id(),\n      ns: message.ns(),\n      header: deepParse(message.header()),\n      action: message.action(),\n    };\n    // Marker fields\n    if (message.text != null) {\n      marker.text = message.text();\n    }\n    // Icon fields\n    if (marker.type === MARKER_MSG_TYPES.OVERLAY_ICON) {\n      // icon_type can be specified in root level or inside metadata.\n      if (message.icon_type != null) {\n        marker.icon_type = message.icon_type();\n      }\n      if (message.metadata != null) {\n        // Downstream code relies on icon_type and icon_types fields from metadata :-(\n        // TODO(steel): Fix up icon types, do not put metadata on drawables.\n        marker.metadata = message.metadata();\n        if (iconTextTemplate) {\n          // Replace the text field with parsed icon text. Only replace when the marker type is overlayIcon.\n          marker.text = parseStringTemplate(iconTextTemplate, marker.metadata);\n        }\n      }\n    }\n\n    // InstancedLineList fields. Check some fields, some fixtures do not include them all.\n    if (message.metadataByIndex) {\n      marker.poses = message.poses && message.poses();\n      marker.metadataByIndex = message.metadataByIndex();\n      marker.closed = message.closed && message.closed();\n    }\n    this.collectors[topic].addMarker(marker, name);\n  }\n\n  _consumeOccupancyGrid = (topic: string, message: NavMsgs$OccupancyGrid): void => {\n    const { frame_id } = message.header;\n\n    if (!frame_id) {\n      this._addError(this.errors.topicsMissingFrameIds, topic);\n      return;\n    }\n\n    if (frame_id !== this.rootTransformID) {\n      this._reportBadFrameId(topic);\n      const error = this._addError(this.errors.topicsWithBadFrameIds, topic);\n      error.frameIds.add(frame_id);\n    }\n\n    let pose = emptyPose();\n    pose = this.transforms.apply(pose, pose, frame_id, this.rootTransformID);\n    if (!pose) {\n      const error = this._addError(this.errors.topicsMissingTransforms, topic);\n      error.frameIds.add(frame_id);\n      return;\n    }\n\n    const type = 101;\n    const name = `${topic}/${type}`;\n\n    // set ogrid texture & alpha based on current rviz settings\n    // in the future these will be customizable via the UI\n    const [alpha, map] = this._hooks.getOccupancyGridValues(topic);\n\n    const mappedMessage = {\n      ...message,\n      alpha,\n      map,\n      type,\n      name,\n      pose,\n      interactionData: { topic, originalMessage: message },\n    };\n\n    // if we neeed to flatten the ogrid clone the position and change the z to match the flattenedZHeightPose\n    if (mappedMessage.info.origin.position.z === 0 && this.flattenedZHeightPose && this.flatten) {\n      const originalInfo = mappedMessage.info;\n      const originalPosition = originalInfo.origin.position;\n      mappedMessage.info = {\n        ...originalInfo,\n        origin: {\n          ...originalInfo.origin,\n          position: { ...originalPosition, z: this.flattenedZHeightPose.position.z },\n        },\n      };\n    }\n    this.collectors[topic].addNonMarker(topic, mappedMessage);\n  };\n\n  _consumeNonMarkerMessage = (topic: string, drawData: StampedMessage, type: number, originalMessage: ?any): void => {\n    const sourcePose = emptyPose();\n    const pose = this.transforms.apply(sourcePose, sourcePose, drawData.header.frame_id, this.rootTransformID);\n    if (!pose) {\n      const error = this._addError(this.errors.topicsMissingTransforms, topic);\n      error.frameIds.add(drawData.header.frame_id);\n      return;\n    }\n\n    const { overrideColor } = this._settingsByKey[`t:${topic}`] || {};\n    const mappedMessage = {\n      ...drawData,\n      ...(overrideColor ? { color: overrideColor } : undefined),\n      type,\n      pose,\n      interactionData: { topic, originalMessage: originalMessage ?? drawData },\n    };\n\n    // If a decay time is available, we assign a lifetime to this message\n    // Do not automatically assign a 0 (zero) decay time since that translates\n    // to an infinite lifetime. But do allow for 0 values based on user preferences.\n    const decayTimeInSec = this._settingsByKey[`t:${topic}`]?.decayTime;\n    const lifetime = decayTimeInSec ? fromSec(decayTimeInSec) : undefined;\n    this.collectors[topic].addNonMarker(topic, mappedMessage, lifetime);\n  };\n\n  setCurrentTime = (currentTime: { sec: number, nsec: number }) => {\n    this.resetMinZ();\n\n    this._clock = currentTime;\n    // set the new clock value in all existing collectors\n    // including those for topics not included in this frame,\n    // so each can expire markers if they need to\n    for (const key in this.collectors) {\n      const collector = this.collectors[key];\n      collector.setClock(this._clock);\n    }\n  };\n\n  // extracts renderable markers from the ros frame\n  render() {\n    this.flattenedZHeightPose = this._hooks.getFlattenedPose(this.frame) || this.flattenedZHeightPose;\n\n    if (this.flattenedZHeightPose && this.flattenedZHeightPose.position) {\n      this.updateMinZ(this.flattenedZHeightPose.position.z);\n    }\n    for (const topic of this.topicsToRender) {\n      try {\n        this._consumeTopic(topic);\n      } catch (error) {\n        this.setTopicError(topic, error.toString());\n      }\n    }\n    this.topicsToRender.clear();\n  }\n\n  _consumeMessage = (topic: string, datatype: string, msg: BobjectMessage): void => {\n    const { message } = msg;\n    switch (datatype) {\n      case VISUALIZATION_MSGS$WEBVIZ_MARKER:\n      case VISUALIZATION_MSGS$MARKER:\n        this._consumeMarker(topic, cast<BinaryMarker>(message));\n        break;\n      case WEBVIZ_ICON_MSGS$WEBVIZ_3D_ICON_ARRAY:\n      case VISUALIZATION_MSGS$WEBVIZ_MARKER_ARRAY:\n      case VISUALIZATION_MSGS$MARKER_ARRAY:\n        this._consumeMarkerArray(topic, message);\n        break;\n      case GEOMETRY_MSGS$POSE_STAMPED: {\n        // make synthetic arrow marker from the stamped pose\n        const pose = deepParse(cast<BinaryPoseStamped>(msg.message).pose());\n        this.collectors[topic].addNonMarker(\n          topic,\n          buildSyntheticArrowMarker(msg, pose, this._hooks.getSyntheticArrowMarkerColor)\n        );\n        break;\n      }\n      case NAV_MSGS$OCCUPANCY_GRID:\n        // flatten btn: set empty z values to be at the same level as the flattenedZHeightPose\n        this._consumeOccupancyGrid(topic, deepParse(message));\n        break;\n      case NAV_MSGS$PATH: {\n        const pathStamped = cast<BinaryPath>(message);\n        if (pathStamped.poses().length() === 0) {\n          break;\n        }\n        const newMessage = {\n          header: deepParse(pathStamped.header()),\n          // Could convert to using arrow for pose later if needed.\n          points: pathStamped\n            .poses()\n            .toArray()\n            .map((pose) => deepParse(pose.pose().position())),\n          closed: false,\n          scale: { x: 0.2 },\n          color: { r: 1, g: 0, b: 0, a: 1 },\n        };\n        this._consumeNonMarkerMessage(topic, newMessage, MARKER_MSG_TYPES.LINE_STRIP, message);\n        break;\n      }\n      case SENSOR_MSGS$POINT_CLOUD_2:\n        this._consumeNonMarkerMessage(topic, deepParse(message), 102);\n        break;\n      case SENSOR_MSGS$LASER_SCAN:\n        this._consumeNonMarkerMessage(topic, deepParse(message), 104);\n        break;\n      case GEOMETRY_MSGS$POLYGON_STAMPED: {\n        // convert Polygon to a line strip\n        const polygonStamped = cast<BinaryPolygonStamped>(message);\n        const polygon = polygonStamped.polygon();\n        if (polygon.points().length() === 0) {\n          break;\n        }\n        const newMessage = {\n          header: deepParse(polygonStamped.header()),\n          points: deepParse(polygon.points()),\n          closed: true,\n          scale: { x: 0.2 },\n          color: { r: 0, g: 1, b: 0, a: 1 },\n        };\n        this._consumeNonMarkerMessage(topic, newMessage, MARKER_MSG_TYPES.LINE_STRIP, message);\n        break;\n      }\n      default: {\n        const structuralDatatype = this._structuralDatatypes[datatype];\n        if (structuralDatatype === RADAR_POINT_CLOUD) {\n          this._consumeNonMarkerMessage(topic, deepParse(message), 106);\n          break;\n        }\n        if (structuralDatatype === WRAPPED_POINT_CLOUD) {\n          this._consumeNonMarkerMessage(topic, deepParse(cast<WrappedPointCloud>(message).cloud()), 102, message);\n          break;\n        }\n        const { flattenedZHeightPose, collectors, errors, lastSeenMessages, selectionState } = this;\n        this._hooks.consumeBobject(\n          topic,\n          datatype,\n          msg,\n          {\n            consumeMarkerArray: this._consumeMarkerArray,\n            consumeNonMarkerMessage: this._consumeNonMarkerMessage,\n            consumeOccupancyGrid: this._consumeOccupancyGrid,\n          },\n          { flattenedZHeightPose, collectors, errors, lastSeenMessages, selectionState }\n        );\n      }\n    }\n  };\n\n  _consumeTopic = (topic: string) => {\n    const messages = this.frame[topic] || this.lastSeenMessages[topic];\n    if (!messages) {\n      return;\n    }\n\n    this.errors.topicsMissingFrameIds.delete(topic);\n    this.errors.topicsMissingTransforms.delete(topic);\n    this.errors.topicsWithBadFrameIds.delete(topic);\n    this.errors.topicsWithError.delete(topic);\n    this.collectors[topic] = this.collectors[topic] || new MessageCollector();\n    this.collectors[topic].setClock(this._clock);\n    this.collectors[topic].flush();\n\n    const datatype = this.topicsByName[topic].datatype;\n    // If topic has a decayTime set, markers with no lifetime will get one\n    // later on, so we don't need to filter them. Note: A decayTime of zero is\n    // defined as an infinite lifetime\n    const decayTime = this._settingsByKey[`t:${topic}`]?.decayTime;\n    const filteredMessages = decayTime === undefined ? filterOutSupersededMessages(messages, datatype) : messages;\n    for (const message of filteredMessages) {\n      this._consumeMessage(topic, datatype, message);\n    }\n  };\n\n  getScene(): Scene {\n    return {\n      minZ: this._minZ,\n      flattenedZHeightPose: this.flattenedZHeightPose,\n    };\n  }\n\n  renderMarkers(add: MarkerCollector) {\n    for (const topic of objectValues(this.topicsByName)) {\n      const collector = this.collectors[topic.name];\n      if (!collector) {\n        continue;\n      }\n      const topicMarkers = collector.getMessages();\n      for (const message of topicMarkers) {\n        const marker: any = message;\n        if (marker.ns) {\n          if (!this.namespaceIsEnabled(topic.name, marker.ns)) {\n            continue;\n          }\n        }\n\n        // Highlight if marker matches any of this topic's highlightMarkerMatchers; dim other markers\n        if (Object.keys(this._highlightMarkerMatchersByTopic).length > 0) {\n          const markerMatches = (this._highlightMarkerMatchersByTopic[topic.name] || []).some(({ checks = [] }) =>\n            checks.every(({ markerKeyPath, value }) => {\n              const markerValue = _.get(message, markerKeyPath);\n              return value === markerValue;\n            })\n          );\n          marker.interactionData.highlighted = markerMatches;\n        }\n\n        // TODO(bmc): once we support more topic settings\n        // flesh this out to be more marker type agnostic\n        const settings = this._settingsByKey[`t:${topic.name}`];\n        if (settings) {\n          marker.settings = settings;\n        }\n        this._addMarkerToCollector(add, topic, marker);\n      }\n    }\n  }\n\n  _addMarkerToCollector(add: MarkerCollector, topic: Topic, originalMarker: any) {\n    let marker = originalMarker;\n    switch (marker.type) {\n      case 1:\n      case 2:\n      case 3:\n        marker = { ...marker, points: undefined };\n        break;\n      case 4:\n        marker = { ...marker, primitive: \"line strip\" };\n        break;\n      case 6:\n        marker = { ...marker, primitive: \"lines\" };\n        break;\n    }\n\n    // allow topic settings to override renderable marker command (see MarkerSettingsEditor.js)\n    const { overrideCommand } = this._settingsByKey[`t:${topic.name}`] || {};\n\n    // prettier-ignore\n    switch (marker.type) {\n      case 0: return add.arrow(marker);\n      case 1: return add.cube(marker);\n      case 2: return add.sphere(marker);\n      case 3: return add.cylinder(marker);\n      case 4:\n        if (overrideCommand === LINED_CONVEX_HULL_RENDERING_SETTING) {\n          return add.linedConvexHull(marker);\n        }\n        return add.lineStrip(marker);\n      case 5:\n        if (overrideCommand === LINED_CONVEX_HULL_RENDERING_SETTING) {\n          return add.linedConvexHull(marker);\n        }\n        return add.lineList(marker);\n      case 6: return add.cubeList(marker);\n      case 7: return add.sphereList(marker);\n      case 8: return add.points(marker);\n      case 9: return add.text(marker);\n      // mesh resource not supported\n      case 11: return add.triangleList(marker);\n      case 101: return add.grid(marker);\n      case 102: return add.pointcloud(marker);\n      case 103: return add.poseMarker(marker);\n      case 104: return add.laserScan(marker);\n      case 106: return add.radarPointCluster(marker);\n      case 107: return add.filledPolygon(marker);\n      case 108: return add.instancedLineList(marker);\n      case 109: return add.overlayIcon(marker)\n      default: {\n        if (!this._hooks.addMarkerToCollector(add, marker)) {\n          this.setTopicError(topic.name, `Unsupported marker type: ${marker.type}`);\n        }\n      }\n    }\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./ImageCanvas.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./ImageCanvas.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./ImageCanvas.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Point, CameraInfo } from \"webviz-core/src/types/Messages\";\n\nconst DISTORTION_STATE = {\n  NONE: \"NONE\",\n  CALIBRATED: \"CALIBRATED\",\n};\n\ntype DistortionState = $Values<typeof DISTORTION_STATE>;\n\n// Essentially a copy of ROSPinholeCameraModel\n// but only the relevant methods, i.e.\n// fromCameraInfo() and unrectifyPoint()\n// http://docs.ros.org/diamondback/api/image_geometry/html/c++/pinhole__camera__model_8cpp_source.html\nexport default class PinholeCameraModel {\n  _distortionState: DistortionState = DISTORTION_STATE.NONE;\n  D: $ReadOnlyArray<number> = [];\n  K: $ReadOnlyArray<number> = [];\n  P: $ReadOnlyArray<number> = [];\n  R: $ReadOnlyArray<number> = [];\n\n  // Mostly copied from `fromCameraInfo`\n  // http://docs.ros.org/diamondback/api/image_geometry/html/c++/pinhole__camera__model_8cpp_source.html#l00062\n  constructor(info: CameraInfo) {\n    const { binning_x, binning_y, roi, distortion_model, D, K, P, R } = info;\n\n    if (distortion_model === \"\") {\n      // Allow CameraInfo with no model to indicate no distortion\n      this._distortionState = DISTORTION_STATE.NONE;\n      return;\n    }\n\n    // Binning = 0 is considered the same as binning = 1 (no binning).\n    const binningX = binning_x ? binning_x : 1;\n    const binningY = binning_y ? binning_y : 1;\n\n    const adjustBinning = binningX > 1 || binningY > 1;\n    const adjustRoi = roi.x_offset !== 0 || roi.y_offset !== 0;\n\n    if (adjustBinning || adjustRoi) {\n      throw new Error(\n        \"Failed to initialize camera model: unable to handle adjusted binning and adjusted roi camera models.\"\n      );\n    }\n\n    // See comments about Tx = 0, Ty = 0 in\n    // http://docs.ros.org/melodic/api/sensor_msgs/html/msg/CameraInfo.html\n    if (P[3] !== 0 || P[7] !== 0) {\n      throw new Error(\n        \"Failed to initialize camera model: projection matrix implies non monocular camera - cannot handle at this time.\"\n      );\n    }\n\n    // Figure out how to handle the distortion\n    if (distortion_model === \"plumb_bob\" || distortion_model === \"rational_polynomial\") {\n      this._distortionState = D[0] === 0.0 ? DISTORTION_STATE.NONE : DISTORTION_STATE.CALIBRATED;\n    } else {\n      throw new Error(\n        \"Failed to initialize camera model: distortion_model is unknown, only plumb_bob and rational_polynomial are supported.\"\n      );\n    }\n    this.D = D;\n    this.P = P;\n    this.R = R;\n    this.K = K;\n  }\n\n  unrectifyPoint({ x: rectX, y: rectY }: Point): { x: number, y: number } {\n    if (this._distortionState === DISTORTION_STATE.NONE) {\n      return { x: rectX, y: rectY };\n    }\n\n    const { P, R, D, K } = this;\n    const fx = P[0];\n    const fy = P[5];\n    const cx = P[2];\n    const cy = P[6];\n    const tx = P[3];\n    const ty = P[7];\n\n    // Formulae from docs for cv::initUndistortRectifyMap,\n    // http://opencv.willowgarage.com/documentation/cpp/camera_calibration_and_3d_reconstruction.html\n\n    // x <- (u - c'x) / f'x\n    // y <- (v - c'y) / f'y\n    // c'x, f'x, etc. (primed) come from \"new camera matrix\" P[0:3, 0:3].\n    const x1 = (rectX - cx - tx) / fx;\n    const y1 = (rectY - cy - ty) / fy;\n    // [X Y W]^T <- R^-1 * [x y 1]^T\n    const X = R[0] * x1 + R[1] * y1 + R[2];\n    const Y = R[3] * x1 + R[4] * y1 + R[5];\n    const W = R[6] * x1 + R[7] * y1 + R[8];\n    const xp = X / W;\n    const yp = Y / W;\n\n    // x'' <- x'(1+k1*r^2+k2*r^4+k3*r^6) + 2p1*x'*y' + p2(r^2+2x'^2)\n    // y'' <- y'(1+k1*r^2+k2*r^4+k3*r^6) + p1(r^2+2y'^2) + 2p2*x'*y'\n    // where r^2 = x'^2 + y'^2\n    const r2 = xp * xp + yp * yp;\n    const r4 = r2 * r2;\n    const r6 = r4 * r2;\n    const a1 = 2 * xp * yp;\n    const k1 = D[0];\n    const k2 = D[1];\n    const p1 = D[2];\n    const p2 = D[3];\n    const k3 = D[4];\n    let barrel_correction = 1 + k1 * r2 + k2 * r4 + k3 * r6;\n    if (D.length === 8) {\n      barrel_correction /= 1.0 + D[5] * r2 + D[6] * r4 + D[7] * r6;\n    }\n    const xpp = xp * barrel_correction + p1 * a1 + p2 * (r2 + 2 * (xp * xp));\n    const ypp = yp * barrel_correction + p1 * (r2 + 2 * (yp * yp)) + p2 * a1;\n\n    // map_x(u,v) <- x''fx + cx\n    // map_y(u,v) <- y''fy + cy\n    // cx, fx, etc. come from original camera matrix K.\n    return { x: xpp * K[0] + K[2], y: ypp * K[4] + K[5] };\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { lib_filename, lib_es6_dts } from \"./lib\";\nimport {\n  DEPRECATED__ros_lib_dts,\n  DEPRECATED__ros_lib_filename,\n} from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/DEPRECATED_ros\";\nimport {\n  ros_lib_filename,\n  ros_lib_dts,\n} from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/ros\";\nimport userUtilities from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils\";\nimport { DEFAULT_WEBVIZ_NODE_PREFIX } from \"webviz-core/src/util/globalConstants\";\n\nexport type NodeProjectFile = {\n  fileName: string,\n  filePath: string,\n  sourceCode: string,\n};\n\nexport type NodeProjectConfig = {\n  defaultLibFileName: string,\n  declarations: NodeProjectFile[],\n  utilityFiles: NodeProjectFile[],\n};\n\nconst utilityFiles: NodeProjectFile[] = userUtilities.map((utility) => ({\n  ...utility,\n  filePath: `${DEFAULT_WEBVIZ_NODE_PREFIX}${utility.fileName}`,\n}));\n\nexport function getNodeProjectConfig() {\n  // TODO load these from .ts files rather than string consts\n  const declarations = [];\n  declarations.push({\n    fileName: lib_filename,\n    filePath: lib_filename,\n    sourceCode: lib_es6_dts,\n  });\n  declarations.push({\n    fileName: DEPRECATED__ros_lib_filename,\n    filePath: `/node_modules/${DEPRECATED__ros_lib_filename}`,\n    sourceCode: DEPRECATED__ros_lib_dts,\n  });\n\n  return {\n    defaultLibFileName: lib_filename,\n    rosLib: {\n      fileName: ros_lib_filename,\n      filePath: `/node_modules/${ros_lib_filename}`,\n      sourceCode: ros_lib_dts, // Default value that is overridden.\n    },\n    declarations,\n    utilityFiles,\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport const KNOWN_LOG_LEVELS: Array<number> = [1, 2, 4, 8, 16];\n\n// map a numeric level to a string\nexport default function LevelToString(level: number): string {\n  switch (level) {\n    case 1:\n      return \"DEBUG\";\n    case 2:\n      return \"INFO\";\n    case 4:\n      return \"WARN\";\n    case 8:\n      return \"ERROR\";\n    case 16:\n      return \"FATAL\";\n    default:\n      return \"?????\";\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./LogMessage.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./LogMessage.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./LogMessage.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport hoistNonReactStatics from \"hoist-non-react-statics\";\nimport { omit, debounce, isEqual } from \"lodash\";\nimport React, { useCallback, useMemo, useState, useRef } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { type CameraState } from \"regl-worldview\";\n\nimport { FrameCompatibilityDEPRECATED } from \"./FrameCompatibility\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport Layout from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport type { ColorOverrideBySourceIdxByVariable } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport type { TopicSettingsCollection } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder\";\nimport {\n  useTransformedCameraState,\n  getNewCameraStateOnFollowChange,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport { type TopicDisplayMode } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicViewModeSelector\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport useTransformsNear from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms/useTransformsNear\";\nimport type { Frame, Topic } from \"webviz-core/src/players/types\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\n\n// The amount of time to wait before dispatching the saveConfig action to save the cameraState into the layout\nexport const CAMERA_STATE_UPDATE_DEBOUNCE_DELAY_MS = 250;\n\nexport type ThreeDimensionalVizConfig = {\n  enableShortDisplayNames?: boolean,\n  autoTextBackgroundColor?: boolean,\n  cameraState: $Shape<CameraState>,\n  followTf?: string | false,\n  followOrientation?: boolean,\n  modifiedNamespaceTopics?: string[],\n  pinTopics: boolean,\n  diffModeEnabled: boolean,\n  topicDisplayMode?: TopicDisplayMode,\n  flattenMarkers?: boolean,\n  selectedPolygonEditFormat?: \"json\" | \"yaml\",\n  showCrosshair?: boolean,\n\n  expandedKeys: string[],\n  checkedKeys: string[],\n  settingsByKey: TopicSettingsCollection,\n  autoSyncCameraState?: boolean,\n  colorOverrideBySourceIdxByVariable?: ColorOverrideBySourceIdxByVariable,\n  disableAutoOpenClickedObject?: boolean,\n  // The message path syntax path to the static URDF transforms.\n  // Currently set in the config but not editable in any UI.\n  staticTransformPath?: string,\n  sphericalRangeScale?: number,\n  searchText?: string,\n};\nexport type Save3DConfig = SaveConfig<ThreeDimensionalVizConfig>;\n\nexport type Props = {\n  cleared?: boolean,\n  config: ThreeDimensionalVizConfig,\n  frame: Frame,\n  saveConfig: Save3DConfig,\n  setSubscriptions: (subscriptions: string[]) => void,\n  topics: Topic[],\n  transforms?: Transforms, // Provided in one story\n};\n\nconst DEFAULT_TIME = { sec: 0, nsec: 0 };\n\nconst BaseRenderer = (props: Props, ref) => {\n  const {\n    cleared,\n    config,\n    frame,\n    saveConfig,\n    setSubscriptions,\n    topics,\n    config: { autoSyncCameraState, followOrientation, followTf },\n  } = props;\n  const { updatePanelConfig } = React.useContext(PanelContext) || {};\n\n  const { currentTime, isPlaying } = useMessagePipeline(\n    useCallback(\n      ({ playerState: { activeData } }) => ({\n        currentTime: (activeData && activeData.currentTime) || DEFAULT_TIME,\n        isPlaying: !!(activeData && activeData.isPlaying),\n      }),\n      []\n    )\n  );\n\n  // We use useState to store the cameraState instead of using config directly in order to\n  // speed up the pan/rotate performance of the 3D panel. This allows us to update the cameraState\n  // immediately instead of setting the new cameraState by dispatching a saveConfig.\n  // eslint-disable-next-line prefer-const\n  let [configCameraState, setConfigCameraState] = useState(config.cameraState);\n  if (useChangeDetector([config.cameraState], false) && !isEqual(config.cameraState, configCameraState)) {\n    // Sometimes camera state updates come by the slow path. Use the config value if that happens,\n    // because _other_ config values might be updated at the same time, and we don't want to render\n    // inconsistent local state.\n    configCameraState = config.cameraState;\n    setConfigCameraState(config.cameraState);\n  }\n\n  const transformElements = useTransformsNear(currentTime, config.staticTransformPath);\n  const calculatedTransforms = useMemo(() => new Transforms(transformElements), [transformElements]);\n  const transforms = props.transforms ?? calculatedTransforms;\n  const { transformedCameraState, targetPose } = useTransformedCameraState({\n    configCameraState,\n    followTf,\n    followOrientation,\n    transforms,\n  });\n\n  const onSetSubscriptions = useCallback((subscriptions: string[]) => {\n    setSubscriptions([\n      ...getGlobalHooks().perPanelHooks().ThreeDimensionalViz.additionalSubscriptions,\n      ...subscriptions,\n    ]);\n  }, [setSubscriptions]);\n\n  // use callbackInputsRef to make sure the input changes don't trigger `onFollowChange` or `onAlignXYAxis` to change\n  const callbackInputsRef = useRef({\n    transformedCameraState,\n    configCameraState,\n    targetPose,\n    configFollowOrientation: config.followOrientation,\n    configFollowTf: config.followTf,\n  });\n  callbackInputsRef.current = {\n    transformedCameraState,\n    configCameraState,\n    targetPose,\n    configFollowOrientation: config.followOrientation,\n    configFollowTf: config.followTf,\n  };\n  const onFollowChange = useCallback((newFollowTf?: string | false, newFollowOrientation?: boolean) => {\n    const {\n      configCameraState: prevCameraState,\n      configFollowOrientation: prevFollowOrientation,\n      configFollowTf: prevFollowTf,\n      targetPose: prevTargetPose,\n    } = callbackInputsRef.current;\n    const newCameraState = getNewCameraStateOnFollowChange({\n      prevCameraState,\n      prevTargetPose,\n      prevFollowTf,\n      prevFollowOrientation,\n      newFollowTf,\n      newFollowOrientation,\n    });\n    saveConfig({ followTf: newFollowTf, followOrientation: newFollowOrientation, cameraState: newCameraState });\n  }, [saveConfig]);\n\n  const onAlignXYAxis = useCallback(\n    () =>\n      saveConfig({\n        followOrientation: false,\n        cameraState: {\n          ...omit(callbackInputsRef.current.transformedCameraState, [\"target\", \"targetOrientation\"]),\n          thetaOffset: 0,\n        },\n      }),\n    [saveConfig]\n  );\n\n  const saveCameraState = useCallback((newCameraStateObj) => saveConfig({ cameraState: newCameraStateObj }), [\n    saveConfig,\n  ]);\n  const saveCameraStateDebounced = useMemo(() => debounce(saveCameraState, CAMERA_STATE_UPDATE_DEBOUNCE_DELAY_MS), [\n    saveCameraState,\n  ]);\n\n  const onCameraStateChange = useCallback((newCameraState) => {\n    const newCurrentCameraState = omit(newCameraState, [\"target\", \"targetOrientation\"]);\n    setConfigCameraState(newCurrentCameraState);\n\n    // If autoSyncCameraState is enabled, we can't wait for the debounce and need to call updatePanelConfig right away\n    if (autoSyncCameraState) {\n      updatePanelConfig(\"3D Panel\", (oldConfig) => ({ ...oldConfig, cameraState: newCurrentCameraState }));\n    } else {\n      saveCameraStateDebounced(newCurrentCameraState);\n    }\n  }, [autoSyncCameraState, saveCameraStateDebounced, updatePanelConfig]);\n\n  // useImperativeHandle so consumer component (e.g.Follow stories) can call onFollowChange directly.\n  React.useImperativeHandle(ref, (): any => ({ onFollowChange }));\n\n  return (\n    <Layout\n      cameraState={transformedCameraState}\n      config={config}\n      cleared={cleared}\n      currentTime={currentTime}\n      followOrientation={!!followOrientation}\n      followTf={followTf}\n      frame={frame}\n      isPlaying={isPlaying}\n      onAlignXYAxis={onAlignXYAxis}\n      onCameraStateChange={onCameraStateChange}\n      onFollowChange={onFollowChange}\n      saveConfig={saveConfig}\n      topics={topics}\n      targetPose={targetPose}\n      transforms={transforms}\n      setSubscriptions={onSetSubscriptions}\n    />\n  );\n};\n\nBaseRenderer.displayName = \"ThreeDimensionalViz\";\nBaseRenderer.panelType = \"3D Panel\";\nBaseRenderer.defaultConfig = getGlobalHooks().perPanelHooks().ThreeDimensionalViz.defaultConfig;\nBaseRenderer.shortcuts = [\n  {\n    description: \"Toggle between 2D and 3D mode\",\n    keys: [\"3\"],\n  },\n  {\n    description: \"Move the camera forward / left / backward / right\",\n    keys: [\"w\", \"a\", \"s\", \"d\"],\n  },\n  {\n    description: \"Zoom in and out\",\n    keys: [\"z\", \"x\"],\n  },\n  {\n    description: \"Open topic tree\",\n    keys: [\"t\"],\n  },\n  {\n    description: \"Hold ctrl key and click on the canvas to start drawing polygons\",\n    keys: [\"ctrl\"],\n  },\n  {\n    description: \"Move the camera position parallel to the ground\",\n    keys: [\"left\", \"drag\"],\n  },\n  {\n    description: \"Pan and rotate the camera\",\n    keys: [\"right\", \"drag\"],\n  },\n];\n\nexport const Renderer = hoistNonReactStatics(React.forwardRef<Props, typeof BaseRenderer>(BaseRenderer), BaseRenderer);\n\nexport default hot(Panel<ThreeDimensionalVizConfig>(FrameCompatibilityDEPRECATED(Renderer, [])));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport PencilIcon from \"@mdi/svg/svg/pencil.svg\";\nimport * as React from \"react\";\nimport { PolygonBuilder, Polygon } from \"regl-worldview\";\n\nimport Polygons from \"./Polygons\";\nimport ExpandingToolbar, { ToolGroup } from \"webviz-core/src/components/ExpandingToolbar\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { EDIT_FORMAT, type EditFormat } from \"webviz-core/src/components/ValidatedInput\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\nexport const POLYGON_TAB_TYPE = \"Polygons\";\nexport type DrawingTabType = typeof POLYGON_TAB_TYPE;\nexport type Point2D = {| x: number, y: number |};\ntype Props = {\n  onSetPolygons: (polygons: Polygon[]) => void,\n  polygonBuilder: PolygonBuilder,\n  selectedPolygonEditFormat: EditFormat,\n  onSetDrawingTabType: (?DrawingTabType) => void,\n  defaultSelectedTab?: DrawingTabType, // for UI testing\n};\n\n// add more drawing shapes later, e.g. Grid, Axes, Crosshairs\nfunction DrawingTools({\n  defaultSelectedTab,\n  onSetDrawingTabType,\n  onSetPolygons,\n  polygonBuilder,\n  selectedPolygonEditFormat,\n}: Props) {\n  const [selectedTab, setSelectedTab] = React.useState<?DrawingTabType>(defaultSelectedTab);\n\n  return (\n    <ExpandingToolbar\n      tooltip=\"Drawing tools\"\n      icon={\n        <Icon style={{ color: selectedTab ? colors.accent : \"white\" }}>\n          <PencilIcon />\n        </Icon>\n      }\n      className={styles.buttons}\n      selectedTab={selectedTab}\n      onSelectTab={(newSelectedTab) => {\n        onSetDrawingTabType(newSelectedTab);\n        setSelectedTab(newSelectedTab);\n      }}>\n      <ToolGroup name={POLYGON_TAB_TYPE}>\n        <Polygons\n          onSetPolygons={onSetPolygons}\n          polygonBuilder={polygonBuilder}\n          selectedPolygonEditFormat={selectedPolygonEditFormat}\n        />\n      </ToolGroup>\n    </ExpandingToolbar>\n  );\n}\n\nDrawingTools.defaultProps = {\n  selectedPolygonEditFormat: EDIT_FORMAT.YAML,\n};\n\nexport default React.memo<Props>(DrawingTools);\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport yaml from \"js-yaml/dist/js-yaml\";\n\nexport default {\n  parse<T>(str: string): T {\n    return yaml.safeLoad(str);\n  },\n  stringify(obj: any, options: any = {}): string {\n    // do not quote 'y' and 'yes' for older yaml versions\n    return yaml\n      .safeDump(obj, { noCompatMode: true, ...options })\n      .replace(/^- - /gm, \"\\n- - \")\n      .trim();\n  },\n};\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { groupBy, flatten } from \"lodash\";\n\nimport type { RenderResult } from \"./types\";\nimport signal, { type Signal } from \"webviz-core/shared/signal\";\nimport type { Frame } from \"webviz-core/src/players/types\";\nimport { BobjectRpcSender, BobjectRpcReceiver } from \"webviz-core/src/util/binaryObjects/BobjectRpc\";\nimport Rpc from \"webviz-core/src/util/Rpc\";\n\ntype Args = $ReadOnly<{\n  [arg: string]: any,\n  frame: Frame,\n  worldContextValue: { [k: string]: any },\n}>;\n\nexport class LayoutWorkerDataSender {\n  _rpc: Rpc;\n  _bobjectSender: BobjectRpcSender;\n  _previousArgs: ?Args = null;\n\n  // Synchronization philosophy: We allow multiple concurrent renders hoping React will be smart\n  // about merging state updates and smoothing things out. We serialize data-sending, though,\n  // because\n  //  - Later data-sends are more authoritative than earlier ones, and\n  //  - Our state-sending isn't reentrant.\n  // We only keep one queued send.\n  _currentlySending: boolean = false;\n  _queuedSendSignal: ?Signal<void>;\n\n  constructor(rpc: Rpc) {\n    this._rpc = rpc;\n    this._bobjectSender = new BobjectRpcSender(rpc);\n  }\n  async renderFrame(args: Args): Promise<boolean> {\n    // Returns whether this render request is sent to the worker (true), if it gets evicted from\n    // our serial send-queue (false).\n    if (this._currentlySending) {\n      const maybeOldQueuedSignal = this._queuedSendSignal;\n      const newSendSignal = (this._queuedSendSignal = signal());\n      if (maybeOldQueuedSignal != null) {\n        // Old request gets superseded by this one.\n        maybeOldQueuedSignal.resolve();\n      }\n      await newSendSignal;\n      if (this._queuedSendSignal !== newSendSignal) {\n        // This request gets superseded by a newer one.\n        return false;\n      }\n      // Ready to send.\n    }\n    this._currentlySending = true;\n    const framesDiffer = this._previousArgs?.frame !== args.frame;\n    let bobjects = [];\n    if (framesDiffer) {\n      bobjects = flatten(Object.keys(args.frame).map((topic) => args.frame[topic]));\n    }\n    const nonFrameData = {};\n    Object.keys(args)\n      .filter((k) => k !== \"frame\" && k !== \"worldContextValue\")\n      .forEach((key) => {\n        if (args[key] !== this._previousArgs?.[key]) {\n          nonFrameData[key] = args[key];\n        }\n      });\n    // WorldContext is grouped together, but it's large and its elements are updated independently,\n    // so diffing its contents one layer deeper makes sense from a performance standpoint.\n    if (args.worldContextValue !== this._previousArgs?.worldContextValue) {\n      const contextToSend = {};\n      Object.keys(args.worldContextValue).forEach((key) => {\n        if (args.worldContextValue[key] !== this._previousArgs?.worldContextValue[key]) {\n          contextToSend[key] = args.worldContextValue[key];\n        }\n      });\n      nonFrameData.worldContextValue = contextToSend;\n    }\n    await this._bobjectSender.send<void>(\"$$startFrame\", bobjects, { nonFrameData, framesDiffer });\n    this._previousArgs = args;\n    this._currentlySending = false;\n    if (this._queuedSendSignal) {\n      this._queuedSendSignal.resolve();\n    }\n    return true;\n  }\n}\n\nexport class LayoutWorkerDataReceiver {\n  _rpc: Rpc;\n  _bobjectReceiver: BobjectRpcReceiver;\n  _nextArgs: Args = { frame: {}, worldContextValue: {} };\n  constructor(rpc: Rpc, renderFn: (Args) => Promise<RenderResult>) {\n    this._rpc = rpc;\n    this._bobjectReceiver = new BobjectRpcReceiver(rpc);\n    this._bobjectReceiver.receive(\"$$startFrame\", \"bobject\", async (messages, { framesDiffer, nonFrameData }) => {\n      // Leave worldContextValue identity unchanged if it is null.\n      const worldContextValue = nonFrameData.worldContextValue\n        ? { ...this._nextArgs.worldContextValue, ...nonFrameData.worldContextValue }\n        : this._nextArgs.worldContextValue;\n      const nextArgs = (this._nextArgs = {\n        ...this._nextArgs,\n        ...nonFrameData,\n        worldContextValue,\n        frame: framesDiffer ? groupBy(messages, \"topic\") : this._nextArgs.frame ?? [],\n      });\n      setImmediate(() => {\n        renderFn(nextArgs).then(({ searchTextMatches }) =>\n          rpc.send<void>(\"finishFrame\", {\n            frameIndex: nextArgs.frameIndex,\n            frameIsEmpty: nextArgs.frame.empty,\n            searchTextMatches,\n          })\n        );\n      });\n    });\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowDownIcon from \"@mdi/svg/svg/chevron-down.svg\";\nimport ArrowUpIcon from \"@mdi/svg/svg/chevron-up.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport SearchIcon from \"@mdi/svg/svg/magnify.svg\";\nimport { vec3 } from \"gl-matrix\";\nimport { isEqual, range } from \"lodash\";\nimport memoizeOne from \"memoize-one\";\nimport React, { useState, useRef, useCallback } from \"react\";\nimport { type CameraState, cameraStateSelectors } from \"regl-worldview\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { useStringWithInlinedGlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport { type WorldSearchTextProps } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/searchTextUtils\";\nimport type { TextMarker, Color } from \"webviz-core/src/types/Messages\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\n// $FlowFixMe - Can't figure this one out.\nexport type GLTextMarker = TextMarker & {\n  highlightedIndices?: number[],\n  highlightColor?: Color,\n};\n\nexport type SearchTextProps = {|\n  ...WorldSearchTextProps,\n  toggleSearchTextOpen: (bool: boolean) => void,\n  setSearchText: (searchText: string) => void,\n  setSelectedMatchIndex: (index: number) => void,\n  searchInputRef: {| current: ?HTMLInputElement |},\n|};\n\nexport const getHighlightedIndices = (text?: string, searchText: string): number[] => {\n  const highlightedIndicesSet = new Set();\n  let match;\n  let startingIndex = 0;\n  const lowerCaseSearchText = searchText.toLowerCase();\n  const lowerCaseText = text ? text.toLowerCase() : \"\";\n  while ((match = lowerCaseText.indexOf(lowerCaseSearchText, startingIndex)) !== -1) {\n    range(match, match + searchText.length).forEach((index) => {\n      highlightedIndicesSet.add(index);\n    });\n    startingIndex = match + 1;\n  }\n\n  const highlightedIndices = Array.from(highlightedIndicesSet);\n  return highlightedIndices;\n};\n\nexport const useSearchText = ({\n  initialSearchText,\n  onSearchTextChanged,\n}: {\n  initialSearchText?: string,\n  onSearchTextChanged?: (string) => void,\n}): SearchTextProps => {\n  const initialSearchTextRef = useRef(initialSearchText || \"\");\n  const [searchTextOpen, setSearchTextOpen] = useState<boolean>(!!initialSearchTextRef.current);\n  const [searchText, setSearchText] = useState<string>(initialSearchTextRef.current);\n  const [searchTextMatches, setSearchTextMatches] = useState<GLTextMarker[]>([]);\n  const [selectedMatchIndex, setSelectedMatchIndex] = useState(0);\n  const searchInputRef = useRef<?HTMLInputElement>(null);\n\n  // Perform string interpolation on any global variables in the searchText\n  const searchTextWithInlinedVariables = useStringWithInlinedGlobalVariables(searchText);\n\n  const updateSearchText = useCallback((text) => {\n    if (onSearchTextChanged) {\n      onSearchTextChanged(text);\n    }\n    setSearchText(text);\n  }, [onSearchTextChanged]);\n\n  const toggleSearchTextOpen = useCallback((open) => {\n    setSearchTextOpen(open);\n    if (!open) {\n      updateSearchText(\"\");\n    }\n  }, [updateSearchText]);\n\n  return {\n    searchTextOpen,\n    toggleSearchTextOpen,\n    searchTextWithInlinedVariables,\n    setSearchText: updateSearchText,\n    searchText,\n    setSearchTextMatches,\n    searchTextMatches,\n    selectedMatchIndex,\n    setSelectedMatchIndex,\n    searchInputRef,\n  };\n};\n\n// Exported for tests.\nexport class SearchCameraHandler {\n  _previousMatch: ?GLTextMarker = undefined;\n\n  focusOnSearch = memoizeOne(\n    (\n      cameraState: CameraState,\n      onCameraStateChange: (CameraState) => void,\n      rootTf: ?string,\n      transforms: Transforms,\n      searchTextOpen: boolean,\n      currentMatch: ?GLTextMarker\n    ) => {\n      const hasCurrentMatchChanged = !isEqual(currentMatch, this._previousMatch);\n      this._previousMatch = currentMatch;\n      if (!currentMatch || !searchTextOpen || !rootTf || !hasCurrentMatchChanged) {\n        return;\n      }\n\n      const { header, pose } = currentMatch;\n\n      const output = transforms.apply(\n        { position: { x: 0, y: 0, z: 0 }, orientation: { x: 0, y: 0, z: 0, w: 0 } },\n        pose,\n        header.frame_id,\n        rootTf\n      );\n      if (!output) {\n        return;\n      }\n      const {\n        position: { x, y, z },\n      } = output;\n\n      const targetHeading = cameraStateSelectors.targetHeading(cameraState);\n      const targetOffset = [0, 0, 0];\n      vec3.rotateZ(targetOffset, vec3.subtract(targetOffset, [x, y, z], cameraState.target), [0, 0, 0], targetHeading);\n      onCameraStateChange({ ...cameraState, targetOffset });\n    }\n  );\n}\n\nconst SearchText = React.memo<SearchTextProps>(\n  ({\n    searchTextOpen,\n    toggleSearchTextOpen,\n    searchText,\n    setSearchText,\n    searchInputRef,\n    setSelectedMatchIndex,\n    selectedMatchIndex,\n    searchTextMatches,\n  }: SearchTextProps) => {\n    const iterateCurrentIndex = useCallback((iterator: number) => {\n      const newIndex = selectedMatchIndex + iterator;\n      if (newIndex >= searchTextMatches.length) {\n        setSelectedMatchIndex(0);\n      } else if (newIndex < 0) {\n        setSelectedMatchIndex(searchTextMatches.length - 1);\n      } else {\n        setSelectedMatchIndex(newIndex);\n      }\n    }, [searchTextMatches, selectedMatchIndex, setSelectedMatchIndex]);\n\n    React.useEffect(() => {\n      if (!searchTextMatches.length) {\n        setSelectedMatchIndex(0);\n      }\n    }, [searchTextMatches.length, setSelectedMatchIndex]);\n\n    if (!searchTextOpen) {\n      return (\n        <Button onClick={() => toggleSearchTextOpen(!searchTextOpen)}>\n          <Icon style={{ color: colors.LIGHT }} tooltip=\"search text markers\">\n            <SearchIcon />\n          </Icon>\n        </Button>\n      );\n    }\n\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          flexDirection: \"row\",\n          padding: \"0 4px\",\n          height: \"36px\" /* Hack to match the heights of the other toolbar components */,\n        }}>\n        <div style={{ backgroundColor: \"#1A191F\", padding: \"0px 4px 0px 8px\", borderRadius: \"4px\" }}>\n          <Icon medium style={{ color: colors.LIGHT }}>\n            <SearchIcon />\n          </Icon>\n          <input\n            autoFocus\n            ref={searchInputRef}\n            type=\"text\"\n            placeholder=\"Find in scene\"\n            spellCheck={false}\n            value={searchText}\n            style={{ backgroundColor: \"transparent\" }}\n            onChange={(e) => setSearchText(e.target.value)}\n            onKeyDown={(e: KeyboardEvent) => {\n              if (e.key !== \"Enter\") {\n                return;\n              }\n              if (e.shiftKey) {\n                iterateCurrentIndex(-1);\n                return;\n              }\n              iterateCurrentIndex(1);\n            }}\n          />\n          <span style={{ color: colors.TEXT_MUTED, width: \"50px\", display: \"inline-block\" }}>\n            {searchTextMatches.length > 0 ? selectedMatchIndex + 1 : \"0\"} of {searchTextMatches.length}\n          </span>\n        </div>\n        <Icon medium onClick={() => iterateCurrentIndex(-1)} style={{ color: colors.LIGHT }}>\n          <ArrowUpIcon />\n        </Icon>\n        <Icon medium onClick={() => iterateCurrentIndex(1)} style={{ color: colors.LIGHT }}>\n          <ArrowDownIcon />\n        </Icon>\n        <Icon onClick={() => toggleSearchTextOpen(false)} tooltip=\"[esc]\" medium style={{ color: colors.LIGHT }}>\n          <CloseIcon />\n        </Icon>\n      </div>\n    );\n  }\n);\n\nexport default SearchText;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport type { Color } from \"regl-worldview\";\n\nimport { type TopicSettingsEditorProps } from \".\";\nimport ColorPickerForTopicSettings from \"./ColorPickerForTopicSettings\";\nimport { SLabel, SDescription } from \"./common\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport TextField from \"webviz-core/src/components/TextField\";\nimport { type Icon3dMarkersMessage } from \"webviz-core/src/types/Messages\";\n\ntype IconTextTemplateEditProps = {|\n  iconTextTemplate: string,\n  onFieldChange: (name: string, value: any) => void,\n|};\ntype MarkerSettings = {|\n  overrideColor?: ?Color,\n  iconTextTemplate?: ?string,\n|};\n\nexport function IconTextTemplateEdit({ iconTextTemplate, onFieldChange }: IconTextTemplateEditProps) {\n  return (\n    <>\n      <TextField\n        label=\"Icon text template\"\n        value={iconTextTemplate}\n        onChange={(newValue: string) => onFieldChange(\"iconTextTemplate\", newValue)}\n        placeholder=\"e.g. `${id} (${confidence})`\"\n      />\n      <SDescription>Use the template string and metadata fields to configure the icon text.</SDescription>\n    </>\n  );\n}\n\nexport default function IconMarkerSettingsEditor(\n  props: TopicSettingsEditorProps<Icon3dMarkersMessage, MarkerSettings>\n) {\n  const { settings = {}, onFieldChange } = props;\n  return (\n    <Flex col>\n      <SLabel>Color</SLabel>\n      <SDescription>\n        Overrides <code>color</code>/<code>colors</code> for all markers on this topic.\n      </SDescription>\n      <ColorPickerForTopicSettings\n        color={settings.overrideColor}\n        onChange={(newColor) => onFieldChange(\"overrideColor\", newColor)}\n      />\n      <IconTextTemplateEdit iconTextTemplate={settings.iconTextTemplate || \"\"} onFieldChange={onFieldChange} />\n    </Flex>\n  );\n}\n\nIconMarkerSettingsEditor.canEditNamespaceOverrideColor = true;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport Option from \"./Option\";\nimport Select from \"./Select\";\n\nexport { Select, Option };\nexport default Select;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport TextHighlight from \"./TextHighlight\";\nimport TextMiddleTruncate from \"./TextMiddleTruncate\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\n\n// Extra text length to make sure text such as `1000 visible topics` don't get truncated.\nconst DEFAULT_END_TEXT_LENGTH = 22;\n\nexport const STopicNameDisplay = styled.div`\n  display: inline-block;\n`;\n\nexport const SDisplayName = styled.div`\n  font-size: 13px;\n  line-height: 1.4;\n  margin-right: 4px;\n  word-break: break-word;\n  /* disallow selection to prevent shift + click from accidentally select */\n  user-select: none;\n  width: 100%;\n`;\n\nexport const SName = styled.div`\n  /* disallow selection to prevent shift + click from accidentally select */\n  user-select: none;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\nconst SWrapper = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\ntype Props = {|\n  // Additional element to show in non xs view when not searching. Currently only used for showing visible topic count.\n  additionalElem?: React.Node,\n  displayName: string,\n  isXSWidth: boolean,\n  maxWidth: number,\n  topicName: string,\n  searchText?: string,\n  style?: { [attr: string]: string | number },\n  tooltips?: React.Node[],\n|};\n\nexport default function NodeName({\n  additionalElem,\n  displayName,\n  isXSWidth,\n  maxWidth,\n  topicName,\n  searchText,\n  style = {},\n  tooltips,\n}: Props) {\n  let targetStr = displayName || topicName;\n\n  if (searchText) {\n    let topicNameToShow = topicName;\n    const prefixedTopicName = `${$WEBVIZ_SOURCE_2}${topicName}`;\n\n    // Show feature topic if base topicName does not include searchText and it's still a match.\n    if (topicName && !topicName.includes(searchText) && prefixedTopicName.includes(searchText)) {\n      topicNameToShow = prefixedTopicName;\n      targetStr = topicNameToShow;\n    }\n\n    if (displayName && topicName && displayName !== topicName) {\n      targetStr = `${displayName} (${topicNameToShow})`;\n    }\n  }\n  const xsWidthElem =\n    isXSWidth &&\n    (tooltips ? (\n      <Tooltip contents={tooltips} placement=\"top\">\n        <SName>{targetStr}</SName>\n      </Tooltip>\n    ) : (\n      <SName>{targetStr}</SName>\n    ));\n\n  const textTruncateElem = (\n    <TextMiddleTruncate\n      text={targetStr}\n      endTextLength={topicName ? topicName.split(\"/\").pop().length + 1 : DEFAULT_END_TEXT_LENGTH}\n      tooltips={tooltips}\n    />\n  );\n  return (\n    <STopicNameDisplay style={style}>\n      <SDisplayName style={{ maxWidth }}>\n        {searchText ? (\n          <TextHighlight targetStr={targetStr} searchText={searchText} />\n        ) : (\n          <>\n            {isXSWidth ? (\n              xsWidthElem\n            ) : (\n              <>\n                {additionalElem ? (\n                  <SWrapper style={{ width: maxWidth }}>\n                    {textTruncateElem}\n                    {additionalElem}\n                  </SWrapper>\n                ) : (\n                  textTruncateElem\n                )}\n              </>\n            )}\n          </>\n        )}\n      </SDisplayName>\n    </STopicNameDisplay>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowCollapseIcon from \"@mdi/svg/svg/arrow-collapse.svg\";\nimport DownArrow from \"@mdi/svg/svg/arrow-down.svg\";\nimport ArrowExpandIcon from \"@mdi/svg/svg/arrow-expand.svg\";\nimport UpArrow from \"@mdi/svg/svg/arrow-up.svg\";\nimport ChevronDownIcon from \"@mdi/svg/svg/chevron-down.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport FilterIcon from \"@mdi/svg/svg/filter.svg\";\nimport FormatFillIcon from \"@mdi/svg/svg/format-color-fill.svg\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { useTable, usePagination, useSortBy, useBlockLayout, useResizeColumns, useFilters } from \"react-table\";\nimport { type RosMsgField, type Time } from \"rosbag\";\nimport shallowequal from \"shallowequal\";\nimport styled from \"styled-components\";\n\nimport helpContent from \"./index.help.md\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { rosPrimitives } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport type { RosPath, MessagePathStructureItem } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport {\n  messagePathStructures,\n  traverseStructure,\n} from \"webviz-core/src/components/MessagePathSyntax/messagePathsForDatatype\";\nimport parseRosPath from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport { useCachedGetMessagePathDataItems } from \"webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport { useDataSourceInfo, useMessagesByTopic } from \"webviz-core/src/PanelAPI\";\nimport { ColumnDropdown, ConditionaFormatsInput } from \"webviz-core/src/panels/Table/TableSettings\";\nimport type {\n  Config,\n  TableInstance,\n  PaginationProps,\n  PaginationState,\n  ColumnOptions,\n  UpdateConfig,\n  CellProps,\n  ColumnInstance,\n  Row,\n  ColumnConfig,\n  ColumnConfigKey,\n  ConditionalFormat,\n  ColumnFilter,\n} from \"webviz-core/src/panels/Table/types\";\nimport {\n  getFormattedColor,\n  getLastAccessor,\n  stripLastAccessor,\n  sortTimestamps,\n  filterColumn,\n  COMPARATOR_LIST,\n} from \"webviz-core/src/panels/Table/utils\";\nimport { type Topic } from \"webviz-core/src/players/types\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { isComplex, primitiveList } from \"webviz-core/src/util/binaryObjects/messageDefinitionUtils\";\nimport { createSelectableContext, useChangeDetector, useContextSelector } from \"webviz-core/src/util/hooks\";\nimport { enumValuesByDatatypeAndField, type EnumMap } from \"webviz-core/src/util/selectors\";\nimport { ROBOTO_MONO, colors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport { rosTimeToUrlTime, DEFAULT_ZERO_TIME, isTimeInRangeInclusive } from \"webviz-core/src/util/time\";\nimport { toolsColorScheme } from \"webviz-core/src/util/toolsColorScheme\";\n\nconst STable = styled.div`\n  border: none;\n  width: 100%;\n  font-size: 12px;\n  display: inline-block;\n`;\n\nconst STableRow = styled.div`\n  border-bottom: ${({ removeBorder }) => (removeBorder ? \"none\" : `1px solid ${colors.DARK3}`)};\n  &:hover {\n    background-color: ${colors.DARK1};\n  }\n`;\n\nconst STableHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n  background-color: ${toolsColorScheme.base.dark};\n  border-left: none;\n  border-right: none;\n  text-align: left;\n  padding: 4px 0 4px 8px;\n  position: relative;\n  height: 22px;\n  vertical-align: middle;\n\n  &:hover {\n    background-color: ${colors.DARK4};\n  }\n`;\n\nconst STableHeaderDropdown = styled.div`\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n\n  & > .dropdown-icon {\n    visibility: hidden;\n  }\n\n  &:hover {\n    & > .dropdown-icon {\n      visibility: visible;\n    }\n  }\n`;\n\nconst SCell = styled.span`\n  padding: 4px 0 4px 8px;\n  display: block;\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  border-bottom: ${({ addBorder }) => (addBorder ? `1px solid ${colors.DARK3}` : \"none\")};\n  flex-basis: 100%;\n  box-sizing: border-box;\n`;\n\nconst SPrimitiveCell = styled(SCell)`\n  font-family: ${({ useRoboto }: { useRoboto: boolean }) => (useRoboto ? ROBOTO_MONO : \"inherit\")};\n`;\n\nconst SInnerArray = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  span:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst STableContainer = styled.div`\n  overflow: auto;\n`;\n\nconst SNavigation = styled.div`\n  margin: 4px 0 0;\n\n  button,\n  select {\n    padding: 4px 8px;\n  }\n`;\n\nconst STableHeaderBorder = styled.div`\n  position: absolute;\n  right: 0;\n  top: 4px;\n  bottom: 4px;\n  width: 10px;\n  &:after {\n    content: \"\";\n    position: absolute;\n    top: 0px;\n    bottom: 0px;\n    right: 0px;\n    width: 2px;\n    opacity: 0.25;\n    background-color: ${colors.TEXT_MUTED};\n  }\n\n  &:hover::after {\n    background-color: ${colors.BLUE};\n  }\n`;\n\nexport const SHeaderDropdownItem = styled.div`\n  padding: 8px 16px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n\n  .menu-item {\n    margin-right: 4px;\n  }\n\n  &:hover {\n    background-color: ${colors.DARK5};\n  }\n`;\n\nconst SFilterInput = styled(SHeaderDropdownItem)`\n  cursor: inherit;\n  display: flex;\n  align-items: center;\n  position: relative;\n  padding: 8px 16px;\n\n  input {\n    width: 100%;\n  }\n\n  & > .clear-filter {\n    visibility: hidden;\n    position: absolute;\n    right: 16px;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n\n  &:hover {\n    & > .clear-filter {\n      visibility: visible;\n    }\n  }\n`;\n\nconst mapValues = (obj: { [columnId: string]: any }, key) => {\n  const result = [];\n  for (const columnId in obj) {\n    result.push({ id: columnId, [key]: obj[columnId] });\n  }\n  return result;\n};\n\ntype TableContextProps = {|\n  setHideColumn: (columnId: string, hidden: boolean) => void,\n  setExpandColumn: (columnId: string, isExpanded: boolean) => void,\n  setColumnFilter: (columnId: string, columnFilter: ColumnFilter) => void,\n  setColumnWidth: (columnId: string, width: number) => void,\n  updateConditionalFormats: (columnId: string, conditionalFormats: ConditionalFormat[]) => void,\n|};\n\nexport const TableContext = React.createContext<TableContextProps>({\n  setHideColumn: () => {},\n  setExpandColumn: () => {},\n  setColumnFilter: () => {},\n  setColumnWidth: () => {},\n  updateConditionalFormats: () => {},\n});\n\nexport const ConfigContext = createSelectableContext<Config>();\n\nexport const useColumnConfigValue = <T: ColumnConfigKey>(columnId: string, key: T): ?$ElementType<ColumnConfig, T> => {\n  return useContextSelector(\n    ConfigContext,\n    React.useCallback((config) => {\n      if (config.columnConfigs?.[columnId]?.[key]) {\n        // $FlowFixMe -- Flow confusing this return value with BAILOUTTOKEN\n        return config.columnConfigs?.[columnId]?.[key];\n      }\n    }, [columnId, key])\n  );\n};\n\nconst useColumnConfigFilterMap = (property: ColumnConfigKey) => {\n  return useContextSelector<Config, string[]>(\n    ConfigContext,\n    React.useCallback((config) => {\n      const result: string[] = [];\n      for (const key in config?.columnConfigs || {}) {\n        const columnConfig = config?.columnConfigs?.[key];\n        if (columnConfig && columnConfig.hasOwnProperty(property)) {\n          if (columnConfig[property]) {\n            result.push(key);\n          }\n        }\n      }\n      return result;\n    }, [property]),\n    { memoResolver: shallowequal }\n  );\n};\n\nconst useColumnConfigFilterReduce = <T: ColumnConfigKey>(\n  property: ColumnConfigKey,\n  filterTruthy?: boolean\n): { [key: string]: $ElementType<ColumnConfig, T> } => {\n  return useContextSelector(\n    ConfigContext,\n    React.useCallback((config) => {\n      const result = {};\n      for (const key in config?.columnConfigs || {}) {\n        const columnConfig = config?.columnConfigs?.[key];\n        if (columnConfig && columnConfig.hasOwnProperty(property)) {\n          if (filterTruthy && columnConfig[property]) {\n            result[key] = columnConfig[property];\n          } else if (!filterTruthy) {\n            result[key] = columnConfig[property];\n          }\n        }\n      }\n      return result;\n    }, [filterTruthy, property]),\n    { memoResolver: shallowequal }\n  );\n};\n\nfunction updateColumnConfigWrapper<T: ColumnConfigKey>(\n  updateConfig: UpdateConfig,\n  columnId: string,\n  key: ColumnConfigKey,\n  value: $ElementType<ColumnConfig, T>\n) {\n  updateConfig((config) => ({\n    ...config,\n    columnConfigs: {\n      ...config.columnConfigs,\n      [columnId]: {\n        ...config.columnConfigs?.[columnId],\n        [key]: value,\n      },\n    },\n  }));\n}\n\nexport const DEFAULT_FILTER = { comparator: \"==\", value: \"\" };\ntype PrimitiveCellProps = {|\n  columnId: string,\n  value: any,\n  type: string,\n  enumValue?: ?string,\n  isNestedArray?: boolean,\n|};\n\nconst TimeCell = ({\n  value,\n  color,\n  isNestedArray,\n}: {\n  value: Time,\n  type: \"time\" | \"duration\",\n  color: ?string,\n  isNestedArray: ?boolean,\n}) => {\n  const renderedValue = rosTimeToUrlTime(value);\n  const { seekPlayback, startTime, endTime } = useMessagePipeline(\n    React.useCallback((state) => {\n      const { activeData } = state.playerState;\n      return {\n        seekPlayback: state.seekPlayback,\n        startTime: (activeData && activeData.startTime) || DEFAULT_ZERO_TIME,\n        endTime: (activeData && activeData.endTime) || DEFAULT_ZERO_TIME,\n      };\n    }, [])\n  );\n\n  const isWithinRange = isTimeInRangeInclusive(value, startTime, endTime);\n\n  return (\n    <SPrimitiveCell\n      onClick={() => isWithinRange && seekPlayback(value)}\n      style={{\n        color,\n        cursor: isWithinRange ? \"pointer\" : \"inherit\",\n        textDecoration: isWithinRange ? \"underline\" : \"inherit\",\n      }}\n      addBorder={isNestedArray}\n      useRoboto>\n      <Tooltip\n        contents={isWithinRange ? \"Seek to time\" : \"Cannot seek. Time not within range of current bag.\"}\n        delay={1000}\n        placement={\"left\"}>\n        <span>{renderedValue}</span>\n      </Tooltip>\n    </SPrimitiveCell>\n  );\n};\n\nconst PrimitiveCell = ({ value, type, enumValue, isNestedArray, columnId }: PrimitiveCellProps) => {\n  const conditionalFormats = useColumnConfigValue<\"conditionalFormats\">(columnId, \"conditionalFormats\");\n  let renderedValue = value;\n  if (enumValue) {\n    renderedValue = `${enumValue} (${value})`;\n  }\n\n  const color = conditionalFormats && getFormattedColor(renderedValue, conditionalFormats);\n  if (type === \"time\" || type === \"duration\") {\n    return <TimeCell type={type} color={color} value={value} isNestedArray={isNestedArray} />;\n  }\n\n  return (\n    <SPrimitiveCell\n      style={{ color }}\n      addBorder={isNestedArray}\n      useRoboto={typeof renderedValue === \"number\" || type === \"time\" || type === \"duration\" || enumValue}>\n      <Tooltip contents={renderedValue} delay={1000} placement={\"left\"}>\n        <span>{`${renderedValue}`}</span>\n      </Tooltip>\n    </SPrimitiveCell>\n  );\n};\n\nconst ComplexCell = ({ columnId, disableExpansion }: {| columnId: string, disableExpansion?: boolean |}) => {\n  const { setExpandColumn } = React.useContext(TableContext);\n\n  const expandColumn = React.useCallback(() => {\n    if (disableExpansion) {\n      return;\n    }\n    setExpandColumn(columnId, true);\n  }, [columnId, disableExpansion, setExpandColumn]);\n\n  return (\n    <Tooltip contents={!disableExpansion ? \"Expand column\" : \"Cannot expand nested submessages\"} delay={1000}>\n      <span\n        style={{\n          cursor: !disableExpansion ? \"pointer\" : \"not-allowed\",\n          display: \"block\",\n          width: \"100%\",\n          height: \"100%\",\n        }}\n        onClick={expandColumn}>\n        {\"...\"}\n      </span>\n    </Tooltip>\n  );\n};\n\ntype HeaderCellProps = {|\n  column: any,\n  updateConfig: UpdateConfig,\n  rosMsgField: ?RosMsgField,\n  tableAccessorPath: string,\n  setHideColumn: (columnId: string, hidden: boolean) => void,\n  toggleExpandColumn: (columnId: string, isExpanded: boolean) => void,\n  setColumnFilter: (columnId: string, columnFilter: ColumnFilter) => void,\n  setColumnWidth: (columnId: string, width: number) => void,\n|};\n\nfunction getColumnsFromDatatype(\n  datatype: string,\n  fields: RosMsgField[],\n  accessorPath: string,\n  columnWidths: { [key: string]: ?number },\n  enumMap: EnumMap,\n  expandedColumns: string[],\n  datatypes: RosDatatypes,\n  parentField: ?RosMsgField = null\n): ColumnOptions[] {\n  const columns = fields\n    // \"*webviz_enum\" fields are added by rosbagjs for constants, so there's no\n    // reason to show them in the UI.\n    .filter((field) => !field.name.endsWith(\"webviz_enum\"))\n    .map((field) => {\n      const { name: accessor } = field;\n      // NOTE: react-table mutates `column.id`, so it's best not rely on it. They\n      // do set `column.originalId` but it's not a guranteed property.\n      const columnId = accessorPath ? `${accessorPath}.${accessor}` : accessor;\n      const lastAccessor = getLastAccessor(columnId);\n      const isComplexType = isComplex(field.type);\n      const isExpanded = expandedColumns.includes(columnId);\n\n      const Cell = ({ value }: CellProps<ColumnInstance, Row>) => {\n        if (parentField?.isArray) {\n          if (rosPrimitives.includes(field.type)) {\n            return (\n              <SInnerArray>\n                {value.map((obj, i) => {\n                  const innerValue = obj[field.name];\n                  return (\n                    <PrimitiveCell\n                      columnId={columnId}\n                      value={innerValue}\n                      type={field.type}\n                      enumValue={enumMap?.[datatype]?.[lastAccessor]?.[innerValue]}\n                      isNestedArray\n                      key={i}\n                    />\n                  );\n                })}\n              </SInnerArray>\n            );\n          }\n          // TODO(troy): Allow for successive nesting.\n          return <ComplexCell columnId={columnId} disableExpansion />;\n        }\n\n        if (rosPrimitives.includes(field.type) && field.isArray) {\n          return (\n            <SInnerArray>\n              {value.map((innerValue, i) => {\n                return <PrimitiveCell columnId={columnId} value={innerValue} type={field.type} isNestedArray key={i} />;\n              })}\n            </SInnerArray>\n          );\n        }\n\n        if (isComplexType) {\n          return <ComplexCell columnId={columnId} />;\n        }\n\n        return (\n          <PrimitiveCell\n            columnId={columnId}\n            value={value}\n            type={field.type}\n            enumValue={enumMap?.[datatype]?.[lastAccessor]?.[value]}\n          />\n        );\n      };\n\n      const HeaderCell = ({ column }: HeaderCellProps) => {\n        const { setExpandColumn, setHideColumn, setColumnFilter, setColumnWidth } = React.useContext(TableContext);\n        if (useChangeDetector([column.isResizing], false) && !column.isResizing) {\n          setColumnWidth(columnId, column.width);\n        }\n\n        const isColumnExpanded = useColumnConfigValue<\"isExpanded\">(columnId, \"isExpanded\");\n        const filter = useColumnConfigValue<\"filter\">(columnId, \"filter\") || DEFAULT_FILTER;\n        const conditionalFormats = useColumnConfigValue<\"conditionalFormats\">(columnId, \"conditionalFormats\") || [];\n\n        const setFilterValueCallback = React.useCallback((e) => {\n          setColumnFilter(columnId, { ...filter, value: e.target.value });\n        }, [filter, setColumnFilter]);\n\n        const setFilterValueComparator = React.useCallback((newComparator) => {\n          setColumnFilter(columnId, { ...filter, comparator: newComparator });\n        }, [filter, setColumnFilter]);\n\n        const renderedHeader = getLastAccessor(columnId);\n\n        return (\n          <Flex>\n            <Dropdown\n              dataTest={`column-header-dropdown-${columnId}`}\n              style={{ width: \"100%\" }}\n              menuStyle={{ minWidth: \"150px\" }}\n              toggleComponent={\n                <STableHeaderDropdown>\n                  <Tooltip contents={renderedHeader} delay={1000}>\n                    <span>{renderedHeader}</span>\n                  </Tooltip>\n                  {column.isSorted ? <Icon>{column.isSortedDesc ? <DownArrow /> : <UpArrow />}</Icon> : null}\n                  {column.filterValue ? (\n                    <Icon>\n                      <FilterIcon />\n                    </Icon>\n                  ) : null}\n                  {!!conditionalFormats.length && (\n                    <Icon>\n                      <FormatFillIcon />\n                    </Icon>\n                  )}\n                  <Icon className=\"dropdown-icon\">\n                    <ChevronDownIcon />\n                  </Icon>\n                </STableHeaderDropdown>\n              }>\n              {!isComplexType && !parentField?.isArray ? (\n                <>\n                  <SFilterInput>\n                    <div style={{ color: colors.TEXT_MUTED, whiteSpace: \"nowrap\" }}>if value</div>\n                    <Dropdown\n                      value={filter.comparator}\n                      key={\"filter-comparator\"}\n                      noPortal\n                      onChange={setFilterValueComparator}>\n                      {COMPARATOR_LIST.map((comparator) => (\n                        <option value={comparator} key={comparator}>\n                          {comparator}\n                        </option>\n                      ))}\n                    </Dropdown>\n                    <input placeholder=\"filter\" value={filter.value} onChange={setFilterValueCallback} />\n                    {column?.filterValue?.value && (\n                      <Icon\n                        onClick={() => setColumnFilter(columnId, { ...filter, value: \"\" })}\n                        className=\"clear-filter\"\n                        tooltip=\"Clear filter\">\n                        <CloseIcon />\n                      </Icon>\n                    )}\n                  </SFilterInput>\n                  <SHeaderDropdownItem data-test={\"sort-column\"} {...column.getSortByToggleProps()}>\n                    <Tooltip contents={\"To multi-sort, hold shift and click.\"} delay={500}>\n                      <Flex style={{ alignItems: \"center\" }}>\n                        <Icon className=\"menu-item\">\n                          {column.isSorted ? column.isSortedDesc ? <CloseIcon /> : <DownArrow /> : <UpArrow />}\n                        </Icon>\n                        Sort {column.isSorted ? (column.isSortedDesc ? \"(clear)\" : \"(desc)\") : \"(asc)\"}\n                      </Flex>\n                    </Tooltip>\n                  </SHeaderDropdownItem>\n                </>\n              ) : (\n                !parentField?.isArray && (\n                  <SHeaderDropdownItem\n                    data-test={\"toggle-expand-column\"}\n                    onClick={() => {\n                      setExpandColumn(columnId, !isColumnExpanded);\n                    }}\n                    key={\"toggle-expand\"}>\n                    <Icon className=\"menu-item\">{isColumnExpanded ? <ArrowCollapseIcon /> : <ArrowExpandIcon />}</Icon>\n                    {isColumnExpanded ? \"Collapse\" : \"Expand\"} column\n                  </SHeaderDropdownItem>\n                )\n              )}\n              <SHeaderDropdownItem\n                data-test={\"hide-column\"}\n                onClick={() => {\n                  setHideColumn(columnId, true);\n                }}\n                key={\"hide\"}>\n                <Icon className=\"menu-item\">\n                  <CloseIcon />\n                </Icon>\n                Hide column\n              </SHeaderDropdownItem>\n              {!isComplexType && <ConditionaFormatsInput columnId={columnId} />}\n            </Dropdown>\n          </Flex>\n        );\n      };\n\n      const subColumns =\n        isComplexType && isExpanded\n          ? getColumnsFromDatatype(\n              field.type,\n              datatypes[field.type].fields.filter(({ isConstant }) => !isConstant),\n              columnId,\n              columnWidths,\n              enumMap,\n              expandedColumns,\n              datatypes,\n              field\n            )\n          : undefined;\n\n      const columnAccessor = !parentField?.isArray ? columnId : stripLastAccessor(columnId);\n      const columnOptions: ColumnOptions = {\n        Header: HeaderCell,\n        accessor: columnAccessor,\n        id: columnId,\n        minWidth: 30,\n        width: columnWidths?.[columnId] ?? 100,\n        Cell: isExpanded ? undefined : Cell,\n        columns: subColumns,\n        filter: filterColumn.bind(null, field.type, columnId),\n      };\n\n      if (field.type === \"time\" || field.type === \"duration\") {\n        columnOptions.sortType = sortTimestamps;\n      }\n\n      return columnOptions;\n    });\n\n  return columns;\n}\n\nconst Table = React.memo(\n  ({\n    msg,\n    accessorPath,\n    updateConfig,\n    msgDatatype,\n    enumMap,\n  }: {|\n    msg: mixed,\n    accessorPath: string,\n    updateConfig: UpdateConfig,\n    msgDatatype: string,\n    enumMap: EnumMap,\n  |}) => {\n    const { datatypes } = useDataSourceInfo();\n\n    const hiddenColumns = useColumnConfigFilterMap(\"hidden\");\n    const expandedColumns = useColumnConfigFilterMap(\"isExpanded\");\n\n    const initialFilters = useColumnConfigFilterReduce(\"filter\");\n    const initialSortBy = useColumnConfigFilterReduce<\"sortDesc\">(\"sortDesc\");\n    const columnWidths = useColumnConfigFilterReduce<\"width\">(\"width\", true);\n\n    const fields = React.useMemo(\n      () => (datatypes[msgDatatype] ? datatypes[msgDatatype].fields.filter(({ isConstant }) => !isConstant) : []),\n      [datatypes, msgDatatype]\n    );\n\n    const columns = React.useMemo(\n      () =>\n        getColumnsFromDatatype(msgDatatype, fields, accessorPath, columnWidths, enumMap, expandedColumns, datatypes),\n      [msgDatatype, fields, accessorPath, columnWidths, enumMap, expandedColumns, datatypes]\n    );\n\n    const data = React.useMemo(() => (Array.isArray(msg) ? msg : [msg]), [msg]);\n\n    const tableInstance: TableInstance<PaginationProps, PaginationState> = useTable(\n      {\n        columns,\n        data,\n        initialState: {\n          pageSize: 30,\n          sortBy: mapValues(initialSortBy, \"desc\"),\n          hiddenColumns,\n          filters: mapValues(initialFilters, \"value\"),\n        },\n      },\n      useFilters,\n      useSortBy,\n      useResizeColumns,\n      useBlockLayout,\n      usePagination\n    );\n\n    const updateColumnConfig = React.useCallback((...args) => updateColumnConfigWrapper(updateConfig, ...args), [\n      updateConfig,\n    ]);\n\n    // $FlowFixMe: useSortBy above adds the sortBy prop, but flow doesn't know.\n    const { sortBy }: { sortBy: SortBy[] } = tableInstance.state;\n    if (useChangeDetector([sortBy], false)) {\n      sortBy.forEach((sort) => {\n        updateColumnConfig(sort.id, \"sortDesc\", sort.desc);\n      });\n    }\n\n    if (primitiveList.has(msgDatatype)) {\n      return (\n        <EmptyState>Cannot render primitive values in a table. Try using the Raw Messages panel instead.</EmptyState>\n      );\n    }\n\n    const {\n      getTableProps,\n      getTableBodyProps,\n      headerGroups,\n      page,\n      prepareRow,\n      canPreviousPage,\n      canNextPage,\n      pageOptions,\n      pageCount,\n      gotoPage,\n      nextPage,\n      previousPage,\n      setPageSize,\n      toggleHideColumn,\n      setFilter,\n      allColumns,\n      toggleHideAllColumns: rcToggleHideAllColumns,\n      state: { pageIndex, pageSize },\n    } = tableInstance;\n\n    const setHideColumn = React.useCallback((columnId: string, hidden?: boolean) => {\n      toggleHideColumn(columnId, hidden);\n      updateColumnConfig(columnId, \"hidden\", hidden);\n    }, [toggleHideColumn, updateColumnConfig]);\n\n    const setExpandColumn = React.useCallback((columnId: string, isExpanded: boolean) => {\n      updateColumnConfig(columnId, \"isExpanded\", isExpanded);\n    }, [updateColumnConfig]);\n\n    const setColumnFilter = React.useCallback((columnId: string, filter: ColumnFilter) => {\n      setFilter(columnId, filter);\n      updateColumnConfig(columnId, \"filter\", filter);\n    }, [setFilter, updateColumnConfig]);\n\n    const setColumnWidth = React.useCallback((columnId: string, width: number) => {\n      updateColumnConfig(columnId, \"width\", width);\n    }, [updateColumnConfig]);\n\n    const toggleAllColumns = React.useCallback((hidden: boolean) => {\n      rcToggleHideAllColumns(hidden);\n      updateConfig((config) => {\n        const ids = allColumns.map(({ id }) => id);\n        const columnConfigs = { ...config.columnConfigs };\n        ids.forEach((id) => {\n          columnConfigs[id] = {\n            ...columnConfigs[id],\n            hidden,\n          };\n        });\n        return {\n          ...config,\n          columnConfigs,\n        };\n      });\n    }, [allColumns, rcToggleHideAllColumns, updateConfig]);\n\n    const updateConditionalFormats = React.useCallback((columnId: string, conditionalFormats: ConditionalFormat[]) => {\n      updateColumnConfig(columnId, \"conditionalFormats\", conditionalFormats);\n    }, [updateColumnConfig]);\n\n    return (\n      <>\n        <TableContext.Provider\n          value={{\n            setHideColumn,\n            setExpandColumn,\n            setColumnFilter,\n            setColumnWidth,\n            updateConditionalFormats,\n          }}>\n          <STable className=\"table\" {...getTableProps()}>\n            <ColumnDropdown\n              columns={allColumns}\n              updateConfig={updateConfig}\n              setHideColumn={setHideColumn}\n              toggleAllColumns={toggleAllColumns}\n            />\n            <div className=\"thead\">\n              {headerGroups.map((headerGroup, i) => {\n                return (\n                  <STableRow removeBorder className=\"tr\" key={i} {...headerGroup.getHeaderGroupProps()}>\n                    {headerGroup.headers.map((column) => {\n                      return (\n                        <STableHeader className=\"th\" key={column.id} {...column.getHeaderProps()}>\n                          {column.render(\"Header\")}\n                          <STableHeaderBorder {...column.getResizerProps()} />\n                        </STableHeader>\n                      );\n                    })}\n                  </STableRow>\n                );\n              })}\n            </div>\n            <div className=\"tbody\" {...getTableBodyProps()}>\n              {page.map((row) => {\n                prepareRow(row);\n                return (\n                  <STableRow {...row.getRowProps()} key={row.index} index={row.index}>\n                    {row.cells.map((cell, i) => {\n                      return (\n                        <div className=\"td\" key={i} {...cell.getCellProps()}>\n                          {cell.render(\"Cell\")}\n                        </div>\n                      );\n                    })}\n                  </STableRow>\n                );\n              })}\n            </div>\n          </STable>\n          <SNavigation>\n            <button onClick={() => gotoPage(0)} disabled={!canPreviousPage}>\n              {\"<<\"}\n            </button>{\" \"}\n            <button onClick={() => previousPage()} disabled={!canPreviousPage}>\n              {\"<\"}\n            </button>{\" \"}\n            <span>\n              Page{\" \"}\n              <strong>\n                {pageIndex + 1} of {pageOptions.length}\n              </strong>{\" \"}\n            </span>\n            <button onClick={() => nextPage()} disabled={!canNextPage}>\n              {\">\"}\n            </button>{\" \"}\n            <button onClick={() => gotoPage(pageCount - 1)} disabled={!canNextPage}>\n              {\">>\"}\n            </button>{\" \"}\n            <select\n              value={pageSize}\n              onChange={(e) => {\n                setPageSize(Number(e.target.value));\n              }}>\n              {[10, 20, 30, 40, 50].map((size) => (\n                <option key={size} value={size}>\n                  Show {size}\n                </option>\n              ))}\n            </select>\n          </SNavigation>\n        </TableContext.Provider>\n      </>\n    );\n  }\n);\n\ntype Props = { config: Config, saveConfig: SaveConfig<Config> };\nfunction TablePanel({ config, saveConfig }: Props) {\n  const { topicPath } = config;\n  const onTopicPathChange = React.useCallback((newTopicPath: string) => {\n    // We don't want any config settings persisting for completely different topics.\n    saveConfig({ topicPath: newTopicPath, columnConfigs: {} });\n  }, [saveConfig]);\n\n  const { topics, datatypes } = useDataSourceInfo();\n\n  const topicRosPath: ?RosPath = React.useMemo(() => parseRosPath(topicPath), [topicPath]);\n  const topic: ?Topic = React.useMemo(\n    () => topicRosPath && topics.find(({ name }) => name === topicRosPath.topicName),\n    [topicRosPath, topics]\n  );\n\n  const topicName = topicRosPath?.topicName || \"\";\n\n  const rootStructureItem: ?MessagePathStructureItem = React.useMemo(() => {\n    if (!topic || !topicRosPath) {\n      return;\n    }\n    return traverseStructure(messagePathStructures(datatypes)[topic.datatype], topicRosPath.messagePath).structureItem;\n  }, [datatypes, topic, topicRosPath]);\n\n  const msgs = useMessagesByTopic({ topics: [topicName], historySize: 1 })[topicName];\n  const cachedGetMessagePathDataItems = useCachedGetMessagePathDataItems([topicPath]);\n  const cachedMessages = msgs.length ? cachedGetMessagePathDataItems(topicPath, msgs[0]) : [];\n\n  // Ref keeps identity of updateConfig stable, and lets unaffected cells avoid rerendering on\n  // unrelated config changes.\n  const configRef = React.useRef(config);\n  configRef.current = config;\n  const updateConfig = React.useCallback((updater: (Config) => Config) => {\n    saveConfig(updater(configRef.current));\n  }, [saveConfig]);\n\n  const msgDatatype: ?string = React.useMemo(() => {\n    if (!rootStructureItem) {\n      return null;\n    }\n    switch (rootStructureItem.structureType) {\n      case \"message\":\n        return rootStructureItem.datatype;\n      case \"array\":\n        if (rootStructureItem.next.structureType === \"primitive\") {\n          return rootStructureItem.next.primitiveType;\n        }\n        return rootStructureItem.next.datatype;\n      case \"primitive\":\n        return rootStructureItem.primitiveType;\n      default:\n        return null;\n    }\n  }, [rootStructureItem]);\n\n  const enumMap = React.useMemo(() => {\n    return enumValuesByDatatypeAndField(datatypes);\n  }, [datatypes]);\n\n  return (\n    <ConfigContext.Provider value={config}>\n      <Flex col clip style={{ position: \"relative\" }}>\n        <Flex col style={{ flexGrow: \"unset\" }}>\n          <PanelToolbar\n            helpContent={helpContent}\n            additionalIcons={\n              <TopicToRenderMenu\n                topicToRender={topicName}\n                onChange={(_topic) => {\n                  // Maintain the path syntax so switching between base and feature topics is easy for users\n                  const path = topicPath.match(/\\.(.+)/);\n                  const newTopicPath = path && path[1] ? `${_topic}.${path[1]}` : _topic;\n                  saveConfig({ topicPath: newTopicPath });\n                }}\n                topics={topics}\n                singleTopicDatatype={topic?.datatype}\n                defaultTopicToRender={\"\"}\n              />\n            }>\n            <Flex row style={{ width: \"100%\", lineHeight: \"20px\", marginLeft: \"16px\" }}>\n              <MessagePathInput\n                index={0}\n                path={topicPath}\n                onChange={onTopicPathChange}\n                inputStyle={{ height: \"100%\" }}\n              />\n            </Flex>\n          </PanelToolbar>\n        </Flex>\n        {!topicPath && <EmptyState>No topic selected</EmptyState>}\n        {topicPath && !cachedMessages?.length && <EmptyState>Waiting for next message</EmptyState>}\n        {topicPath && cachedMessages && !!cachedMessages?.length && msgDatatype && (\n          <STableContainer>\n            <Table\n              msg={cachedMessages.length > 1 ? cachedMessages.map(({ value }) => value) : cachedMessages[0].value}\n              msgDatatype={msgDatatype}\n              accessorPath={\"\"}\n              updateConfig={updateConfig}\n              enumMap={enumMap}\n            />\n          </STableContainer>\n        )}\n      </Flex>\n    </ConfigContext.Provider>\n  );\n}\n\nTablePanel.panelType = \"Table\";\nTablePanel.defaultConfig = {\n  topicPath: \"\",\n};\n\nexport default hot(Panel<Config>(TablePanel));\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport _ from \"lodash\";\nimport { TimeUtil } from \"rosbag\";\n\nimport type { ConditionalFormat, ColumnFilter } from \"webviz-core/src/panels/Table/types\";\nimport { isNumberType } from \"webviz-core/src/util/binaryObjects/messageDefinitionUtils\";\nimport { rosTimeToUrlTime } from \"webviz-core/src/util/time\";\n\nexport const getLastAccessor = (accessorPath: string) => {\n  const splitPath = accessorPath.split(\".\");\n  // Filter any empty strings\n  return splitPath.filter(Boolean).pop();\n};\n\nexport const stripLastAccessor = (accessorPath: string) => {\n  const splitPath = accessorPath.split(\".\").filter(Boolean);\n  return splitPath.slice(0, splitPath.length - 1).join(\".\");\n};\n\nexport const sortTimestamps = (rowA: any, rowB: any, columnId: string) => {\n  const timeA = rowA?.values?.[columnId];\n  const timeB = rowB?.values?.[columnId];\n  if (!timeA || !timeB) {\n    return 0;\n  }\n\n  return TimeUtil.compare(timeA, timeB);\n};\n\nexport const COMPARATOR_LIST = [\"<\", \">\", \"==\", \"!=\", \">=\", \"<=\", \"~\"];\n\nconst COMPARATOR_FUNCTIONS = {\n  \"<\": (x, y) => x < y,\n  \">\": (x, y) => x > y,\n  \"==\": (x, y) => x === y,\n  \"!=\": (x, y) => x !== y,\n  \">=\": (x, y) => x >= y,\n  \"<=\": (x, y) => x <= y,\n  \"~\": (x, y) => {\n    if (typeof y !== \"string\" || typeof x !== \"string\") {\n      throw new Error(\"Cannot use a non-string to do substring matching.\");\n    }\n    return new RegExp(y).test(x);\n  },\n};\n\n// Exported for testing.\nexport const evaluateCondition = (value: any, comparator: string, primitive: string | number | boolean) => {\n  try {\n    return COMPARATOR_FUNCTIONS[comparator](value, primitive);\n  } catch (e) {\n    // TODO(troy): Surface this error case to users.\n    return null;\n  }\n};\n\nexport const filterColumn = (\n  fieldType: string,\n  columnId: string,\n  rows: any,\n  _columnIds: string[],\n  columnFilter: ColumnFilter\n) => {\n  if (!columnFilter.value) {\n    return rows;\n  }\n\n  const isNumberColumn = isNumberType(fieldType);\n  const isBooleanColumn = fieldType === \"bool\";\n\n  return rows.filter((row) => {\n    const value = _.get(row.values, columnId);\n    const formattedValue = fieldType === \"time\" || fieldType === \"duration\" ? rosTimeToUrlTime(value) : value;\n    const filterValue = isNumberColumn\n      ? Number(columnFilter.value)\n      : isBooleanColumn\n      ? columnFilter.value === \"true\"\n      : columnFilter.value;\n    return evaluateCondition(formattedValue, columnFilter.comparator, filterValue);\n  });\n};\n\nexport const getFormattedColor = (value: any, conditionalFormats: ?(ConditionalFormat[])): string => {\n  if (!conditionalFormats) {\n    return \"\";\n  }\n  for (const conditionalFormat of conditionalFormats) {\n    const { comparator, color, primitive } = conditionalFormat;\n    if (evaluateCondition(value, comparator, primitive)) {\n      return color;\n    }\n  }\n  return \"\";\n};\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { vec3 } from \"gl-matrix\";\nimport React, { type Node } from \"react\";\nimport {\n  Arrows,\n  pointToVec3,\n  vec3ToPoint,\n  orientationToVec4,\n  type Arrow,\n  type CommonCommandProps,\n} from \"regl-worldview\";\n\nimport CarModel from \"./CarModel\";\n\nexport type Scaling = $ReadOnly<{| x: number, y: number |}>;\n\nexport type Props = {\n  children: Arrow[],\n  ...CommonCommandProps,\n};\n\nexport default React.memo<Props>(function PoseMarkers({ children, layerIndex }: Props): Node[] {\n  const models = [];\n  const arrowMarkers = [];\n  children.forEach((marker, i) => {\n    const { pose, settings, interactionData } = marker;\n\n    switch (settings?.modelType) {\n      case \"car-model\": {\n        models.push(\n          <CarModel layerIndex={layerIndex} key={i}>\n            {{ pose, alpha: settings.alpha || 1, interactionData }}\n          </CarModel>\n        );\n        break;\n      }\n      case \"arrow\":\n      default: {\n        if (settings && settings.overrideColor) {\n          marker = { ...marker, color: settings.overrideColor };\n        }\n\n        if (settings && settings.size) {\n          marker = {\n            ...marker,\n            scale: {\n              x: settings.size.shaftWidth || marker.scale.x,\n              y: settings.size.headWidth || marker.scale.y,\n              z: settings.size.headLength || marker.scale.z,\n            },\n          };\n        }\n\n        const pos = pointToVec3(marker.pose.position);\n        const orientation = orientationToVec4(marker.pose.orientation);\n        const dir = vec3.transformQuat([0, 0, 0], [1, 0, 0], orientation);\n        // the total length of the arrow is 4.7, we move the tail backwards by 0.88 (prev implementation)\n        const tipPoint = vec3.scaleAndAdd([0, 0, 0], pos, dir, 3.82);\n        const tailPoint = vec3.scaleAndAdd([0, 0, 0], pos, dir, -0.88);\n        arrowMarkers.push({ ...marker, points: [vec3ToPoint(tailPoint), vec3ToPoint(tipPoint)] });\n\n        break;\n      }\n    }\n  });\n\n  return [\n    ...models,\n    <Arrows layerIndex={layerIndex} key=\"arrows\">\n      {arrowMarkers}\n    </Arrows>,\n  ];\n});\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport tinycolor from \"tinycolor2\";\n\nimport type { OccupancyGridMessage } from \"webviz-core/src/types/Messages\";\n\nexport const COLORS = {\n  BLACK: tinycolor(\"black\"),\n  RED: tinycolor(\"red\"),\n  PINK: tinycolor(\"pink\"),\n  LIME: tinycolor(\"lime\"),\n  CYAN: tinycolor(\"cyan\"),\n  WHITE: tinycolor(\"white\"),\n  AQUA: tinycolor(\"aqua\"),\n  BLUE: tinycolor(\"blue\"),\n  ORANGE: tinycolor(\"orange\"),\n  MAGENTA: tinycolor(\"magenta\"),\n  YELLOW: tinycolor(\"yellow\"),\n  GRAY: tinycolor(\"darkgray\"), // gray and darkgray are named reversed for some reason\n  DARKGRAY: tinycolor(\"gray\"), // gray and darkgray are named reversed for some reason\n  PURPLE: tinycolor(\"purple\"),\n};\n\nexport function setRgba(buffer: Uint8Array, index: number, color: tinycolor) {\n  const rgba255 = color.toRgb();\n  rgba255.a *= 255;\n  buffer[index] = rgba255.r;\n  buffer[index + 1] = rgba255.g;\n  buffer[index + 2] = rgba255.b;\n  buffer[index + 3] = rgba255.a;\n}\n\nexport const defaultMapPalette = (() => {\n  const buff = new Uint8Array(256 * 4);\n\n  // standard gray map palette values\n  for (let i = 0; i <= 100; i++) {\n    const t = 1 - i / 100;\n    const idx = i * 4;\n    setRgba(buff, idx, tinycolor.fromRatio({ r: t, g: t, b: t }));\n  }\n\n  // illegal positive values in green\n  for (let i = 101; i <= 127; i++) {\n    const idx = i * 4;\n    setRgba(buff, idx, tinycolor(\"lime\"));\n  }\n\n  // illegal negative (char) values\n  for (let i = 128; i <= 248; i++) {\n    const idx = i * 4;\n    const t = (i - 128) / (254 - 128);\n    setRgba(buff, idx, tinycolor.fromRatio({ r: t, g: 0.2, b: 0.6, a: Math.max(1 - t, 0.2) }));\n  }\n\n  // legal negative values\n  setRgba(buff, 255 * 4, COLORS.GRAY.setAlpha(0.5)); // -1 UNKNOWN\n  setRgba(buff, 254 * 4, COLORS.ORANGE.setAlpha(0.5)); // -2 UNDRIVEABLE\n  setRgba(buff, 253 * 4, COLORS.CYAN.setAlpha(0.5)); // -3 SIDEWALK\n  setRgba(buff, 252 * 4, COLORS.YELLOW.setAlpha(0.5)); // -4 UNOBSERVED\n  setRgba(buff, 101 * 4, COLORS.PURPLE.setAlpha(0.5)); // 101 UNOCCUPIED_NULL\n  setRgba(buff, 110 * 4, COLORS.PINK.setAlpha(0.5)); // 110 TRACKED_UNKNOWN_TO_UNOCCUPIED\n  setRgba(buff, 111 * 4, COLORS.LIME.setAlpha(0.5)); // 111 TRACKED_OCCUPIED_TO_UNOCCUPIED\n  setRgba(buff, 112 * 4, COLORS.AQUA.setAlpha(0.5)); // 112 TRACKED_OCCUPIED_TO_UNKNOWN\n\n  return buff;\n})();\n\n// convert a number array to a typed array\n// passing a typed array to regl is orders of magnitude\n// faster than passing a number[] and letting regl do the conversion\nfunction toTypedArray(data: $ReadOnlyArray<number> | Int8Array): Uint8Array {\n  if (data instanceof Int8Array) {\n    return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n  }\n  const result = new Uint8Array(data.length);\n  for (let i = 0; i < data.length; i++) {\n    result[i] = data[i];\n  }\n  return result;\n}\n\nclass TextureCacheEntry {\n  marker: OccupancyGridMessage;\n  texture: any;\n  // regl context\n  regl: any;\n\n  constructor(regl: any, marker: OccupancyGridMessage) {\n    this.marker = marker;\n    this.regl = regl;\n    const { info, data } = marker;\n\n    this.texture = regl.texture({\n      format: \"alpha\",\n      mipmap: false,\n      data: toTypedArray(data),\n      width: info.width,\n      height: info.height,\n    });\n  }\n\n  // get the texture for a marker\n  // if the marker is not the same reference\n  // generate a new texture, otherwise keep the old one\n  // uploading new texture data to the gpu is something\n  // you only want to do when required - it takes several milliseconds\n  getTexture(marker: OccupancyGridMessage) {\n    if (this.marker === marker) {\n      return this.texture;\n    }\n    this.marker = marker;\n    const { info, data } = marker;\n    this.texture = this.texture({\n      format: \"alpha\",\n      mipmap: false,\n      data: toTypedArray(data),\n      width: info.width,\n      height: info.height,\n    });\n    return this.texture;\n  }\n}\n\nexport class TextureCache {\n  store: { [string]: TextureCacheEntry } = {};\n  // regl context\n  regl: any;\n\n  constructor(regl: any) {\n    this.regl = regl;\n  }\n\n  // returns a regl texture for a given marker\n  get(marker: OccupancyGridMessage) {\n    const { name } = marker;\n    const item = this.store[name];\n    if (!item) {\n      // if the item is missing initialize a new entry\n      const entry = new TextureCacheEntry(this.regl, marker);\n      this.store[name] = entry;\n      return entry.texture;\n    }\n    return item.getTexture(marker);\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport {\n  getFieldOffsetsAndReaders,\n  createPositionBuffer,\n  createColorBuffer,\n  getVertexCount,\n  getVertexValue,\n} from \"./buffers\";\nimport { type PointCloudMarker, DEFAULT_FLAT_COLOR, type ColorMode } from \"./types\";\n\n// Decode a marker and generate position and color buffers for rendering\n// The resulting marker should be memoized for better performance\nexport function decodeMarker(marker: PointCloudMarker, sphericalRangeScale?: number) {\n  const { fields = [], settings = {}, point_step: stride, width, height, hitmapColors, data } = marker;\n  const offsetsAndReaders = getFieldOffsetsAndReaders(fields);\n  const { rgb: { offset: rgbOffset } = {} } = offsetsAndReaders;\n\n  // Calculate the number of points in the cloud.\n  // Do not use data.length, since it doesn't work with sparse point clouds.\n  const pointCount = width * height;\n\n  const colorMode: ColorMode = settings.colorMode\n    ? settings.colorMode\n    : rgbOffset != null\n    ? { mode: \"rgb\" }\n    : { mode: \"flat\", flatColor: DEFAULT_FLAT_COLOR };\n\n  const isHitmap = !!hitmapColors;\n\n  const positionBuffer = createPositionBuffer({\n    data,\n    fields: offsetsAndReaders,\n    pointCount,\n    stride,\n    sphericalRangeScale,\n  });\n\n  // If hitmapColors are provided, we don't need a colorBuffer\n  // This check will also avoid computing min/max values on CPU\n  // since they're not needed for hitmap.\n  const colorBuffer = isHitmap\n    ? null\n    : createColorBuffer({\n        data,\n        fields: offsetsAndReaders,\n        colorMode,\n        pointCount,\n        stride,\n      });\n\n  let minColorValue: number = Number.POSITIVE_INFINITY;\n  let maxColorValue: number = Number.NEGATIVE_INFINITY;\n\n  // For some color modes, we need to compute min/max values for the selected color field\n  // Unfortunately, we cannot do this in GPU and we need to traverse the color array to\n  // fetch the required values.\n  // These calculations can be ignored if we're rendering to the hitmap\n  if (colorBuffer && !isHitmap && (colorMode.mode === \"gradient\" || colorMode.mode === \"rainbow\")) {\n    let hasMinValue = false;\n    if (colorMode.minValue != null) {\n      hasMinValue = true;\n      minColorValue = colorMode.minValue;\n    }\n    let hasMaxValue = false;\n    if (colorMode.maxValue != null) {\n      hasMaxValue = true;\n      maxColorValue = colorMode.maxValue;\n    }\n    // It's possible for colorMode to provide min/max values (which may be different than\n    // the actual min/max values in the color buffer).\n    if (!hasMinValue || !hasMaxValue) {\n      for (let i = 0; i < getVertexCount(colorBuffer); i++) {\n        const pos = getVertexValue(positionBuffer, i);\n        if (Number.isNaN(pos)) {\n          // if the position is NaN then don't count this point\n          // this is to support non-dense point clouds\n          // https://answers.ros.org/question/234455/pointcloud2-and-pointfield/\n          continue;\n        }\n        const value = getVertexValue(colorBuffer, i);\n        if (!Number.isNaN(value)) {\n          if (!hasMinValue && value < minColorValue) {\n            minColorValue = value;\n          }\n          if (!hasMaxValue && value > maxColorValue) {\n            maxColorValue = value;\n          }\n        }\n      }\n    }\n  }\n\n  return {\n    ...marker,\n    // Make sure settings are always available\n    settings: {\n      ...settings,\n      colorMode,\n    },\n    pointCount,\n    positionBuffer,\n    colorBuffer,\n    minColorValue,\n    maxColorValue,\n    hitmapColors,\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport overwriteFetch from \"./overwriteFetch\";\nimport Rpc from \"./Rpc\";\nimport { initializeLogEvent } from \"webviz-core/src/util/logEvent\";\nimport { setNotificationHandler, type DetailsType, type NotificationType } from \"webviz-core/src/util/sendNotification\";\nimport type { NotificationSeverity } from \"webviz-core/src/util/sendNotification\";\n\nexport function setupSendReportNotificationHandler(rpc: Rpc) {\n  setNotificationHandler(\n    (message: string, details: DetailsType, type: NotificationType, severity: NotificationSeverity) => {\n      if (!(details instanceof Error || typeof details === \"string\")) {\n        console.warn(\"Invalid Error type\");\n        details = JSON.stringify(details) || \"<<unknown error>>\";\n      }\n      rpc.send(\"sendNotification\", {\n        message,\n        details: details instanceof Error ? details.toString() : details,\n        type,\n        severity,\n      });\n    }\n  );\n}\n\nexport function setupLogEventHandler(rpc: Rpc) {\n  initializeLogEvent({\n    logEventAction: (...params) => {\n      rpc.send(\"logEvent\", { type: \"logEventAction\", params });\n    },\n    logEventPerformance: (...params) => {\n      rpc.send(\"logEvent\", { type: \"logEventPerformance\", params });\n    },\n    logEventNavigation: (...params) => {\n      rpc.send(\"logEvent\", { type: \"logEventNavigation\", params });\n    },\n    logEventError: (...params) => {\n      rpc.send(\"logEvent\", { type: \"logEventError\", params });\n    },\n  });\n}\n\nexport function setupWorker(rpc: Rpc) {\n  if (process.env.NODE_ENV !== \"test\") {\n    setupSendReportNotificationHandler(rpc);\n    setupLogEventHandler(rpc);\n    overwriteFetch();\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { useCleanup, useEventListener } from \"@cruise-automation/hooks\";\nimport ClipboardOutlineIcon from \"@mdi/svg/svg/clipboard-outline.svg\";\nimport clamp from \"lodash/clamp\";\nimport React, { useState, useEffect, useRef, useMemo, useCallback } from \"react\";\nimport { type Time } from \"rosbag\";\nimport styled from \"styled-components\";\nimport uuid from \"uuid\";\n\nimport AudioToolbar from \"./AudioToolbar\";\nimport { type ProcessedAudioData } from \"./index\";\nimport { generateAudioBuffersFromSample, calculateWaveformData, drawWaveform, bufferToFileBlob } from \"./utils\";\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport HoverBar, { SBar } from \"webviz-core/src/components/HoverBar\";\nimport { useSetHoverValue, useClearHoverValue } from \"webviz-core/src/components/HoverBar/context\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport { downloadFiles } from \"webviz-core/src/util\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { hexToRgbString } from \"webviz-core/src/util/colorUtils\";\nimport { formatTimeRaw } from \"webviz-core/src/util/formatTime\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport { subtractTimes, toSec } from \"webviz-core/src/util/time\";\n\nconst POINT_WIDTH = 3;\nconst CHANNEL_HEIGHT = 80;\nconst BAR_HEIGHT = 36;\nconst CANVAS_MARGIN = 16;\n\nconst TIMESTAMP_OPTIONS = [\n  {\n    label: \"header.stamp\",\n    value: false,\n  },\n  {\n    label: \"receive time\",\n    value: true,\n  },\n];\nconst CHANNEL_HOVER_BG = hexToRgbString(colors.RED2, 0.1);\n\nconst DEFAULT_WAVE_CONFIG = {\n  color: hexToRgbString(colors.LIGHT1, 0.2),\n  playedColor: hexToRgbString(colors.LIGHT1, 0.5),\n  missingDataColor: colors.DARK2,\n  activeChannelColor: colors.RED2,\n  activeChannelPlayedColor: colors.RED,\n  markerColor: colors.BLUE,\n  pointWidth: POINT_WIDTH,\n  heightScaleFactor: 4,\n  multiChannelHeightScaleFactor: 12, // scale more so the stacked waveforms don't look flat\n};\n\nconst SPEED_SELECT_OPTIONS = [\n  { value: 0.1, label: \"0.1x\" },\n  { value: 0.2, label: \"0.2x\" },\n  { value: 0.5, label: \"0.5x\" },\n  { value: 1, label: \"1x\" },\n  // { value: -1, label: \"Sync (bagPlaybackSpeed)x\" }, // TODO[Audrey]: add  sync support\n];\n\nconst SAudioPlayer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%;\n  width: 100%;\n  position: relative;\n`;\n\nconst SCanvasWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  margin-left: ${CANVAS_MARGIN}px;\n  margin-right: ${CANVAS_MARGIN}px;\n`;\nconst SBarWrapper = styled.div`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: ${BAR_HEIGHT};\n`;\n\nconst STimestampWrapper = styled.div`\n  position: absolute;\n  right: 0;\n  bottom: 32px;\n  display: flex;\n  cursor: pointer;\n  width: 284px;\n`;\n\nconst SDropdown = styled.div`\n  width: 132px;\n  button {\n    background: transparent;\n  }\n`;\nconst SCopyTimestamp = styled.div`\n  display: flex;\n  align-items: center;\n  .icon {\n    visibility: hidden;\n  }\n  :hover {\n    .icon {\n      visibility: visible;\n    }\n  }\n`;\n\nconst SChannelHover = styled.div`\n  width: 100%;\n  position: absolute;\n  cursor: pointer;\n  :hover {\n    background: ${CHANNEL_HOVER_BG};\n  }\n`;\n\nexport type Config = {|\n  volume: number,\n  playbackRate: number,\n  // user can select any supported audio channels to view and play\n  selectedChannel: number,\n  showAllChannels: boolean,\n  topicToRender: ?string,\n|};\n\ntype Props = {\n  ...ProcessedAudioData,\n  width: number,\n  height: number,\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n};\n\nfunction AudioPlayerBase({\n  channelCount,\n  height,\n  messageTimestamps,\n  samples,\n  samplingRate,\n  saveConfig,\n  width,\n  config: { volume = 1, playbackRate = 1, selectedChannel: selectedChannelAlt = 0, showAllChannels = false },\n}: Props) {\n  const hoverBar = useRef<?HTMLElement>();\n  const [hoverComponentId] = useState<string>(uuid.v4());\n  const {\n    globalSeek,\n    globalStartTime,\n    globalEndTime,\n    globalCurrentTime,\n    globalLastSeekTime,\n    globalIsPlaying,\n  } = useMessagePipeline(\n    useCallback(\n      ({ seekPlayback, playerState: { activeData } }) => ({\n        globalSeek: seekPlayback,\n        globalStartTime: activeData && activeData.startTime,\n        globalEndTime: activeData && activeData.endTime,\n        globalCurrentTime: activeData && activeData.currentTime,\n        globalIsPlaying: activeData && activeData.isPlaying,\n        globalLastSeekTime: activeData && activeData.lastSeekTime,\n      }),\n      []\n    )\n  );\n\n  const [audioContext] = useState(() => new (window.AudioContext || window.webkitAudioContext)());\n  // automatically close audioContext when the component unmounts\n  useCleanup(() => audioContext.close());\n\n  const [gainNode] = useState(() => audioContext.createGain()); // for volume control\n  // use useRef for states that are getting updated during canvas drawing cycle\n  const sourceRef = useRef<?AudioBufferSourceNode>();\n  const currentPositionRef = useRef(0); // current played time relative to the whole audio buffer duration\n  const startTimeRef = useRef(0); // audioContext.currentTime at which the audio started to play\n  const canvasRef = useRef<?HTMLCanvasElement>();\n  const timestampDivRef = useRef<?HTMLDivElement>();\n  const [showReceiveTimestamp, setShowReceiveTimestamp] = useState(false);\n\n  // Using isPlayingState and isPlayingRef to track isPlaying state separately for react and\n  // requestAnimationFrame updates. We could essentially use one state 'isPlayState' + 'useEffect',\n  // but source.onended is called on every pause which made it hard to track the currentTime of the player\n  const isPlayingRef = useRef<boolean>(false); // track the playing state of the audio, for updating canvas\n  const [isPlayingState, setIsPlayingState] = useState<boolean>(false); // for triggering AudioToolBar change\n\n  const channelOptions = useMemo(\n    () => new Array(channelCount).fill().map((_, idx) => ({ value: idx, label: `${idx}` })),\n    [channelCount]\n  );\n\n  // make sure selectedChannel is in the range\n  const selectedChannel = clamp(selectedChannelAlt, 0, channelCount - 1);\n\n  // only update audio buffer when inputs change\n  const buffers = useMemo(\n    () => generateAudioBuffersFromSample(samples, selectedChannel, showAllChannels, audioContext, samplingRate),\n    [samples, selectedChannel, showAllChannels, audioContext, samplingRate]\n  );\n  // the audio buffer that's being played/selected\n  const activeBuffer = showAllChannels ? buffers[selectedChannel] : buffers[0];\n  const totalSecs = activeBuffer.duration;\n\n  const callbackInputsRef = useRef({ currentTime: audioContext.currentTime });\n  callbackInputsRef.current = { currentTime: audioContext.currentTime };\n\n  const getCurrentTimestamp = useCallback((playedRatio: number): ?Time => {\n    const timestampIndex = Math.floor(messageTimestamps.length * playedRatio);\n    const currentMsgTimestamp = messageTimestamps[timestampIndex];\n    if (!currentMsgTimestamp) {\n      return;\n    }\n    return showReceiveTimestamp ? currentMsgTimestamp.receiveTime : currentMsgTimestamp.headerStamp;\n  }, [messageTimestamps, showReceiveTimestamp]);\n\n  const updateTimestampText = useCallback((ratio: number) => {\n    // generate current timestamp for copying\n    const currentTimeStamp = getCurrentTimestamp(ratio);\n    const timestampDiv = timestampDivRef.current;\n    if (timestampDiv && currentTimeStamp) {\n      timestampDiv.innerHTML = formatTimeRaw(currentTimeStamp);\n    }\n  }, [getCurrentTimestamp]);\n\n  const updateCanvas = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n    const playedRatio = currentPositionRef.current / totalSecs;\n    updateTimestampText(playedRatio);\n    const bounds = buffers.map((buffer) => calculateWaveformData(buffer, canvas.width, POINT_WIDTH));\n    drawWaveform(bounds, canvas, DEFAULT_WAVE_CONFIG, playedRatio, selectedChannel);\n  }, [totalSecs, updateTimestampText, buffers, selectedChannel]);\n\n  const timestampOnChange = useCallback(() => {\n    setShowReceiveTimestamp((showReceive) => !showReceive);\n    updateCanvas();\n  }, [updateCanvas]);\n\n  function pause() {\n    if (sourceRef.current) {\n      sourceRef.current.stop(0);\n      sourceRef.current = null;\n    }\n\n    setIsPlayingState(false);\n    isPlayingRef.current = false;\n    currentPositionRef.current = audioContext.currentTime - startTimeRef.current;\n  }\n\n  function stop() {\n    pause();\n    currentPositionRef.current = 0;\n  }\n\n  // to be called to update canvas continuously during the audio play\n  function tick() {\n    const canvas = canvasRef.current;\n    if (!isPlayingRef.current || !canvas) {\n      return;\n    }\n    const newPosition = (audioContext.currentTime - startTimeRef.current) * playbackRate;\n    currentPositionRef.current = newPosition;\n    if (newPosition > totalSecs) {\n      // stop playing when reached the end or over\n      stop();\n      updateCanvas();\n      return;\n    }\n    updateCanvas();\n    requestAnimationFrame(tick);\n  }\n\n  function play() {\n    if (isPlayingRef.current) {\n      pause();\n      return;\n    }\n    // only set the new state once\n    if (!isPlayingState) {\n      setIsPlayingState(true);\n    }\n    const source = audioContext.createBufferSource();\n    source.onended = () => setIsPlayingState(false);\n    sourceRef.current = source;\n    source.buffer = activeBuffer;\n    source.playbackRate.value = playbackRate;\n    source.connect(gainNode);\n    gainNode.connect(audioContext.destination);\n    source.start(audioContext.currentTime, currentPositionRef.current);\n    isPlayingRef.current = true;\n    startTimeRef.current = audioContext.currentTime - currentPositionRef.current;\n    requestAnimationFrame(tick);\n  }\n\n  function onDownloadAudio() {\n    if (showAllChannels) {\n      downloadFiles(\n        buffers.map((buffer, idx) => {\n          return {\n            blob: bufferToFileBlob(buffer),\n            fileName: `audio_channel_${idx}`,\n          };\n        })\n      );\n    } else {\n      downloadFiles([{ blob: bufferToFileBlob(activeBuffer), fileName: \"audio\" }]);\n    }\n  }\n\n  // redraw the waveform when the audio buffer, width or height changes\n  useEffect(\n    () => {\n      updateCanvas();\n    },\n    // eslint-disable-next-line  react-hooks/exhaustive-deps\n    [activeBuffer, width, height]\n  );\n  // reset the gainNode value when the volume changes\n  useEffect(() => {\n    gainNode.gain.setValueAtTime(volume, callbackInputsRef.current.currentTime);\n  }, [gainNode.gain, volume]);\n\n  const [draggingStart, setDraggingStart] = useState(null);\n  const canvasHeight = buffers.length > 1 ? CHANNEL_HEIGHT * buffers.length : height - BAR_HEIGHT;\n  const canvasWidth = width - CANVAS_MARGIN * 2;\n\n  useEventListener(\n    window,\n    \"mousemove\",\n    !!draggingStart,\n    (ev: MouseEvent) => {\n      const canvas = canvasRef.current;\n      if (!draggingStart || !canvas) {\n        return;\n      }\n      const delta = ev.clientX - draggingStart.clientX;\n      const deltaPosition = (delta / canvasWidth) * totalSecs;\n      const newPosition = clamp(draggingStart.value + deltaPosition, 0, totalSecs);\n      currentPositionRef.current = newPosition;\n      updateCanvas();\n    },\n    [canvasWidth, totalSecs]\n  );\n\n  useEventListener(\n    window,\n    \"mouseup\",\n    !!draggingStart,\n    (_event: MouseEvent) => {\n      setDraggingStart(null);\n    },\n    []\n  );\n\n  const setHoverValue = useSetHoverValue();\n  const onMouseMove = useCallback((ev) => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n    ev.preventDefault();\n    // move the currentPosition to the clicked position and update canvas\n    const rect = canvas.getBoundingClientRect();\n    const left = ev.clientX - rect.left;\n    // Keep the ratio within 1 since it's possible to go over the audio wave as we usually round up global playback time.\n    const hoveredRatio = clamp(left / canvasWidth, 0, 1);\n    // Only draw the timestamp on hover when not playing.\n    if (!isPlayingRef.current) {\n      updateTimestampText(hoveredRatio);\n    }\n    const timeInSecFromStart = totalSecs * hoveredRatio;\n    setHoverValue({ componentId: hoverComponentId, type: \"PLAYBACK_SECONDS\", value: timeInSecFromStart });\n  }, [canvasWidth, setHoverValue, hoverComponentId, totalSecs, updateTimestampText]);\n\n  const clearHoverValue = useClearHoverValue();\n  const onMouseLeave = useCallback((ev) => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n    ev.preventDefault();\n    clearHoverValue(hoverComponentId);\n    // Reset the timestamp text.\n    const playedRatio = currentPositionRef.current / totalSecs;\n    updateTimestampText(playedRatio);\n  }, [clearHoverValue, hoverComponentId, totalSecs, updateTimestampText]);\n  const scaleBounds = useMemo(\n    () => ({\n      // HoverBar takes a ref to avoid rerendering (and avoid needing to rerender) when the bounds\n      // change in charts that scroll at playback speed.\n      current: [\n        {\n          id: hoverComponentId,\n          min: 0,\n          max: totalSecs,\n          axes: \"xAxes\",\n          minAlongAxis: 0,\n          maxAlongAxis: canvasWidth,\n        },\n        {\n          id: hoverComponentId,\n          min: 0,\n          max: canvasHeight,\n          axes: \"yAxes\",\n          minAlongAxis: 0,\n          maxAlongAxis: canvasHeight,\n        },\n      ],\n    }),\n    [canvasHeight, canvasWidth, hoverComponentId, totalSecs]\n  );\n\n  const globalSeekChanged = useChangeDetector([globalLastSeekTime], false);\n  // Update the audio played position to the new global played position if the user paused global playback and is seeking globally.\n  if (globalSeekChanged) {\n    const canvas = canvasRef.current;\n    if (!globalIsPlaying && globalStartTime && globalEndTime && globalCurrentTime && canvas) {\n      const totalGlobalSecs = toSec(subtractTimes(globalEndTime, globalStartTime));\n      const globalPlayedRatio = toSec(subtractTimes(globalCurrentTime, globalStartTime)) / totalGlobalSecs;\n      currentPositionRef.current = globalPlayedRatio * totalGlobalSecs;\n      updateCanvas();\n    }\n  }\n\n  return (\n    <>\n      <SCanvasWrapper\n        style={{ height: height - BAR_HEIGHT }}\n        onMouseMove={onMouseMove}\n        onMouseLeave={onMouseLeave}\n        onMouseDown={(ev) => {\n          const canvas = canvasRef.current;\n          if (!canvas) {\n            return;\n          }\n          ev.preventDefault();\n          pause();\n          // move the currentPosition to the clicked position and update canvas\n          const rect = canvas.getBoundingClientRect();\n          const left = ev.clientX - rect.left;\n          const clickedWidthRatio = left / canvasWidth;\n          const currentTimeStamp = getCurrentTimestamp(clickedWidthRatio);\n          if (currentTimeStamp) {\n            globalSeek(currentTimeStamp);\n          }\n\n          currentPositionRef.current = clickedWidthRatio * totalSecs;\n          // No need to redraw if the user just sought globally since the global seek already triggered another redraw.\n          if (!globalSeekChanged) {\n            updateCanvas();\n          }\n          setDraggingStart({\n            value: currentPositionRef.current,\n            clientX: ev.clientX,\n          });\n          if (showAllChannels) {\n            const top = ev.clientY - rect.top;\n            const clickedHeightRatio = top / canvasHeight;\n            const newSelectedChannel = Math.floor(channelCount * clickedHeightRatio);\n            if (newSelectedChannel !== selectedChannel) {\n              saveConfig({ selectedChannel: newSelectedChannel });\n            }\n          }\n        }}>\n        {buffers.length > 1 &&\n          channelOptions.map(({ value }) => (\n            <SChannelHover key={value} style={{ top: value * CHANNEL_HEIGHT, height: CHANNEL_HEIGHT }} />\n          ))}\n        <canvas width={canvasWidth} height={canvasHeight} ref={canvasRef} />\n        <HoverBar componentId={hoverComponentId} isTimestampScale scaleBounds={scaleBounds}>\n          <SBar xAxisIsPlaybackTime ref={hoverBar} />\n        </HoverBar>\n      </SCanvasWrapper>\n      <SBarWrapper>\n        <STimestampWrapper>\n          <SDropdown>\n            <Dropdown\n              position=\"right\"\n              value={showReceiveTimestamp}\n              text={showReceiveTimestamp ? \"receive time\" : \"header.stamp\"}\n              onChange={timestampOnChange}>\n              {TIMESTAMP_OPTIONS.map(({ label, value }) => (\n                <option value={value} key={label}>\n                  {label}\n                </option>\n              ))}\n            </Dropdown>\n          </SDropdown>\n          <SCopyTimestamp\n            onClick={() => timestampDivRef.current && clipboard.copy(timestampDivRef.current.textContent)}>\n            <div ref={timestampDivRef} />\n            <Icon fade style={{ margin: \"0 8px\", verticalAlign: \"middle\" }} tooltip=\"Copy time to clipboard\">\n              <ClipboardOutlineIcon />\n            </Icon>\n          </SCopyTimestamp>\n        </STimestampWrapper>\n        <AudioToolbar\n          chanelOptions={channelOptions}\n          onPlaybackRateChange={(newPlaybackRate) => saveConfig({ playbackRate: newPlaybackRate })}\n          onSelectedChannelChange={(newSelectedChannel) => {\n            // updateCanvas is in different cycle from react update, we could recreate the buffer\n            // before the next updateCanvas or stop now and wait for the next react update which will\n            // automatically create a new buffer\n            stop();\n            saveConfig({ selectedChannel: newSelectedChannel });\n          }}\n          onTogglePlay={play}\n          onToggleShowAllChannels={() => saveConfig({ showAllChannels: !showAllChannels })}\n          onVolumeChange={(newVolume) => saveConfig({ volume: newVolume })}\n          playbackRate={playbackRate}\n          selectedChannel={selectedChannel}\n          showAllChannels={showAllChannels}\n          speedSelectOptions={SPEED_SELECT_OPTIONS}\n          volume={volume}\n          isPlaying={isPlayingState}\n          downloadTooltip={showAllChannels ? `Download all the audio channels` : `Download audio`}\n          onDownloadAudio={onDownloadAudio}\n        />\n      </SBarWrapper>\n    </>\n  );\n}\n\nexport default function AudioPlayer(props: $Diff<Props, { width: number, height: number }>) {\n  return (\n    <SAudioPlayer>\n      <Dimensions>{({ width, height }) => <AudioPlayerBase {...props} width={width} height={height} />}</Dimensions>\n    </SAudioPlayer>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport DownloadIcon from \"@mdi/svg/svg/download.svg\";\nimport PauseIcon from \"@mdi/svg/svg/pause.svg\";\nimport PlayIcon from \"@mdi/svg/svg/play.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport VolumeControl from \"./VolumeControl\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\n\nconst SBar = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nconst SPlayButton = styled.button`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: transparent;\n`;\n\nconst SSpeedWrapper = styled.div`\n  width: 64;\n  button {\n    background: transparent;\n  }\n`;\n\nconst STransparentDropdownBtn = styled.div`\n  button {\n    background: transparent;\n  }\n`;\n\nconst MIN_VOLUME = 0;\nconst MAX_VOLUME = 4;\nconst VOLUME_CHANGE_STEP = 0.1;\n\ntype Option = {\n  label: string,\n  value: number,\n};\n\ntype Props = {\n  chanelOptions: Option[],\n  downloadTooltip: string,\n  isPlaying: boolean,\n  onDownloadAudio: () => void,\n  onPlaybackRateChange: (number) => void,\n  onSelectedChannelChange: (number) => void,\n  onTogglePlay: () => void,\n  onToggleShowAllChannels: () => void,\n  onVolumeChange: (number) => void,\n  playbackRate: number,\n  selectedChannel: number,\n  showAllChannels: boolean,\n  speedSelectOptions: Option[],\n  volume: number,\n};\n\nexport default function AudioToolbar({\n  chanelOptions,\n  downloadTooltip,\n  isPlaying,\n  onDownloadAudio,\n  onPlaybackRateChange,\n  onSelectedChannelChange,\n  onTogglePlay,\n  onToggleShowAllChannels,\n  onVolumeChange,\n  playbackRate,\n  selectedChannel,\n  showAllChannels,\n  speedSelectOptions,\n  volume,\n}: Props) {\n  return (\n    <SBar>\n      <SPlayButton onClick={onTogglePlay}>\n        <Icon medium>{isPlaying ? <PauseIcon /> : <PlayIcon />}</Icon>\n      </SPlayButton>\n      <SSpeedWrapper>\n        <Dropdown position=\"right\" value={playbackRate} text={`${playbackRate}x`} onChange={onPlaybackRateChange}>\n          {speedSelectOptions.map(({ label, value }) => (\n            <option value={value} key={value}>\n              {label}\n            </option>\n          ))}\n        </Dropdown>\n      </SSpeedWrapper>\n      <VolumeControl\n        rootStyle={{ width: 144, margin: \"0 8px\" }}\n        value={volume}\n        onChange={onVolumeChange}\n        min={MIN_VOLUME}\n        max={MAX_VOLUME}\n        step={VOLUME_CHANGE_STEP}\n      />\n      <STransparentDropdownBtn>\n        <Dropdown\n          position=\"right\"\n          value={selectedChannel}\n          text={`channel: ${selectedChannel}`}\n          onChange={onSelectedChannelChange}>\n          {chanelOptions.map(({ label, value }) => (\n            <option value={value} key={value}>\n              {label}\n            </option>\n          ))}\n        </Dropdown>\n      </STransparentDropdownBtn>\n      <Item\n        icon={showAllChannels ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n        onClick={onToggleShowAllChannels}>\n        show all channels\n      </Item>\n      <Icon fade medium clickable tooltip={downloadTooltip} onClick={onDownloadAudio}>\n        <DownloadIcon />\n      </Icon>\n    </SBar>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport VolumeHigh from \"@mdi/svg/svg/volume-high.svg\";\nimport VolumeLow from \"@mdi/svg/svg/volume-low.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { hexToRgbString } from \"webviz-core/src/util/colorUtils\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst light60 = hexToRgbString(colors.LIGHT1, 0.6);\n\nconst SWrapper = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nconst SliderInput = styled.input.attrs({ type: \"range\" })`\n  width: 100%;\n  appearance: none;\n  background: transparent;\n  &:focus {\n    outline: 0;\n    background: transparent;\n  }\n  &::-webkit-slider-thumb {\n    appearance: none;\n    height: 16px;\n    width: 16px;\n    border-radius: 8px;\n    background: ${colors.LIGHT1};\n    margin-top: -4px;\n    cursor: pointer;\n    &:hover {\n      opacity: 0.9;\n    }\n  }\n  &::-webkit-slider-runnable-track {\n    width: 100%;\n    background: ${light60};\n    height: 6px;\n    border-radius: 3px;\n    cursor: pointer;\n  }\n`;\n\ntype Props = {\n  onChange: (number) => void,\n  value: number,\n  min?: number,\n  max?: number,\n  step?: number,\n  rootStyle?: { [string]: number | string },\n  iconStyle?: { [string]: number | string },\n};\n\nexport default function VolumeControl({\n  onChange,\n  min = 0,\n  max = 1,\n  step = 0.1,\n  value,\n  rootStyle = {},\n  iconStyle = {\n    fill: light60,\n    width: 24,\n    height: 24,\n  },\n  ...rest\n}: Props) {\n  return (\n    <SWrapper style={rootStyle}>\n      <VolumeLow {...iconStyle} />\n      <Tooltip contents={`volume: ${value}`} placement=\"top\">\n        <div>\n          <SliderInput\n            min={min}\n            max={max}\n            step={step}\n            value={value}\n            {...rest}\n            onChange={(e) => onChange(+e.target.value)}\n          />\n        </div>\n      </Tooltip>\n      <VolumeHigh {...iconStyle} />\n    </SWrapper>\n  );\n}\n","module.exports = \"# Audio\\n\\nThe Audio panel provides the audio data visualization and replay. You can:\\n\\n- replay the audio from different channels in different speed\\n- check `show all channels` option and inspect the waveform of all the audio channels\\n- double-click to select the active audio channel when all channels are displayed\\n- hover over the right bottom corner and click to copy the ROS timestamp\\n\"","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Panel.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Panel.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Panel.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-Panel-module-32r84--root{z-index:1;background-color:#08080a;position:relative}.packages-webviz-core-src-components-Panel-module-32r84--root:after{content:\\\"\\\";top:0px;left:0px;right:0px;bottom:0px;opacity:0;border:1px solid #248eff;position:absolute;pointer-events:none;-webkit-transition:opacity .125s ease-out;-o-transition:opacity .125s ease-out;transition:opacity .125s ease-out;z-index:100000}.packages-webviz-core-src-components-Panel-module-32r84--root.packages-webviz-core-src-components-Panel-module-s44hx--selected:after{opacity:1;-webkit-transition:opacity .05s ease-out;-o-transition:opacity .05s ease-out;transition:opacity .05s ease-out}.packages-webviz-core-src-components-Panel-module-4c19m--rootFullScreen{position:fixed;z-index:100;border:4px solid rgba(110,81,238,.3);top:40px;left:0;right:0;bottom:60px}.packages-webviz-core-src-components-Panel-module-psm4f--notClickable{position:fixed;z-index:100;top:0;left:0;right:0;height:40px;opacity:0;cursor:not-allowed}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection{cursor:pointer;position:absolute;top:0;left:0;right:0;bottom:0;z-index:100000;display:none;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-align:end;align-items:flex-end;font-size:14px;padding-top:24px}.packages-webviz-core-src-components-Panel-module-32r84--root:hover>.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay,.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay.hoverForScreenshot,.packages-webviz-core-src-components-Panel-module-32r84--root:hover>.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay.hoverForScreenshot,.packages-webviz-core-src-components-Panel-module-32r84--root:hover>.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection.hoverForScreenshot{background-color:#2d2d33;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay div,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay div,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection div{width:100%;padding:6px 0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay svg,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay svg,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection svg{margin-right:4px;width:24px;height:24px;fill:#fff}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay button,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection button{width:72px;height:72px;margin:4px;-ms-flex:none;flex:none;font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;background:rgba(110,81,238,.5)}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button svg,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay button svg,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection button svg{margin:0 0 6px}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button:not(.disabled):hover,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay button:not(.disabled):hover,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection button:not(.disabled):hover{background:rgba(110,81,238,.8)}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay p,.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay p,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection p{font-size:12px;color:rgba(247,247,243,.3)}.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection{padding:10px}.packages-webviz-core-src-components-Panel-module-32r84--root:hover .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection,.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection.hoverForScreenshot{background-color:#2d2d33}.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button{width:145px;height:40px;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen{position:fixed;top:75px;right:8px;z-index:102;opacity:1;background-color:#242429;display:none}.packages-webviz-core-src-components-Panel-module-32r84--root:hover .packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen{display:block}.packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen.hoverForScreenshot{display:block}.packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen svg{width:16px;height:16px;fill:#fff;float:left}.packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen span{float:right;padding-left:3px}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/Panel.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/variables.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAGA,8DACE,UACA,yBACA,iBAAA,CAEA,oEACE,WACA,QACA,SACA,UACA,WACA,UACA,yBACA,kBACA,oBACA,0CAAA,qCAAA,kCACA,cAAA,CAGF,qIACE,UACA,yCAAA,oCAAA,gCAAA,CAIJ,wEACE,eACA,YACA,qCACA,SACA,OACA,QACA,WClCsB,CDqCxB,sEACE,eACA,YACA,MACA,OACA,QACA,YACA,UACA,kBAAA,CAGF,qOAGE,eACA,kBACA,MACA,OACA,QACA,SACA,eACA,aAYA,0BAAA,sBACA,oBAAA,2BACA,mBAAA,qBACA,eACA,gBAAA,CAdA,+sBAGE,yBACA,oBAAA,aACA,sBAAA,mBACA,qBAAA,uBACA,mBAAA,cAAA,CASF,iPACE,WACA,cACA,oBAAA,aACA,sBAAA,mBACA,qBAAA,uBACA,mBAAA,cAAA,CAGF,iPACE,iBACA,WACA,YACA,SAAA,CAGF,0PACE,WACA,YACA,WACA,cAAA,UACA,eACA,oBAAA,aACA,0BAAA,sBACA,sBAAA,mBACA,qBAAA,uBACA,8BAAA,CACA,sQACE,cAAA,CAGF,yTACE,8BAAA,CAIJ,2OACE,eACA,0BErGS,CFyGb,6EACE,YAAA,CAEA,iPAGE,wBAAA,CAIJ,kFACE,YACA,YACA,oBAAA,aACA,uBAAA,mBACA,sBAAA,6BAAA,CAGF,wEACE,eACA,SACA,UACA,YACA,UACA,yBACA,YAAA,CACA,4IACE,aAAA,CAEF,2FACE,aAAA,CAEF,4EACE,WACA,YACA,UACA,UAAA,CAEF,6EACE,YACA,gBAAA,CAAA\",\"file\":\"Panel.module.scss\",\"sourcesContent\":[\"@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/variables.scss\\\";\\n\\n.root {\\n  z-index: 1;\\n  background-color: $dark;\\n  position: relative;\\n\\n  &:after {\\n    content: \\\"\\\";\\n    top: 0px;\\n    left: 0px;\\n    right: 0px;\\n    bottom: 0px;\\n    opacity: 0;\\n    border: 1px solid $accent;\\n    position: absolute;\\n    pointer-events: none;\\n    transition: opacity 0.125s ease-out;\\n    z-index: 100000; // highest level within panel\\n  }\\n\\n  &.selected:after {\\n    opacity: 1;\\n    transition: opacity 0.05s ease-out;\\n  }\\n}\\n\\n.rootFullScreen {\\n  position: fixed;\\n  z-index: 100;\\n  border: 4px solid rgba(110, 81, 238, 0.3);\\n  top: $topBarHeight;\\n  left: 0;\\n  right: 0;\\n  bottom: $playbackControlHeight;\\n}\\n\\n.notClickable {\\n  position: fixed;\\n  z-index: 100;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  height: $topBarHeight;\\n  opacity: 0;\\n  cursor: not-allowed;\\n}\\n\\n.tabActionsOverlay,\\n.quickActionsOverlay,\\n.prohibitedSelection {\\n  cursor: pointer;\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  z-index: 100000; // highest level within panel\\n  display: none;\\n\\n  .root:hover > &,\\n  // for screenshot tests\\n  &:global(.hoverForScreenshot) {\\n    background-color: rgba(45, 45, 51, 1);\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    flex-wrap: wrap;\\n  }\\n\\n  flex-direction: column;\\n  justify-content: flex-start;\\n  align-items: flex-end;\\n  font-size: 14px;\\n  padding-top: 24px;\\n\\n  div {\\n    width: 100%;\\n    padding: 6px 0;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    flex-wrap: wrap;\\n  }\\n\\n  svg {\\n    margin-right: 4px;\\n    width: 24px;\\n    height: 24px;\\n    fill: white;\\n  }\\n\\n  button {\\n    width: 72px;\\n    height: 72px;\\n    margin: 4px;\\n    flex: none;\\n    font-size: 14px;\\n    display: flex;\\n    flex-direction: column;\\n    align-items: center;\\n    justify-content: center;\\n    background: rgba(110, 81, 238, 0.5);\\n    svg {\\n      margin: 0 0 6px;\\n    }\\n\\n    &:not(:global(.disabled)):hover {\\n      background: rgba(110, 81, 238, 0.8);\\n    }\\n  }\\n\\n  p {\\n    font-size: 12px;\\n    color: $text-muted;\\n  }\\n}\\n\\n.prohibitedSelection {\\n  padding: 10px;\\n\\n  .root:hover &,\\n  // for screenshot tests\\n  &:global(.hoverForScreenshot) {\\n    background-color: rgba(45, 45, 51, 1);\\n  }\\n}\\n\\n.tabActionsOverlay button {\\n  width: 145px;\\n  height: 40px;\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n}\\n\\n.exitFullScreen {\\n  position: fixed;\\n  top: 75px;\\n  right: 8px;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: $dark3;\\n  display: none;\\n  .root:hover & {\\n    display: block;\\n  }\\n  &:global(.hoverForScreenshot) {\\n    display: block;\\n  }\\n  svg {\\n    width: 16px;\\n    height: 16px;\\n    fill: white;\\n    float: left;\\n  }\\n  span {\\n    float: right;\\n    padding-left: 3px;\\n  }\\n}\\n\",\"$topBarHeight: 40px;\\n$playbackControlHeight: 60px;\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"root\": \"packages-webviz-core-src-components-Panel-module-32r84--root\",\n\t\"selected\": \"packages-webviz-core-src-components-Panel-module-s44hx--selected\",\n\t\"rootFullScreen\": \"packages-webviz-core-src-components-Panel-module-4c19m--rootFullScreen\",\n\t\"notClickable\": \"packages-webviz-core-src-components-Panel-module-psm4f--notClickable\",\n\t\"tabActionsOverlay\": \"packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay\",\n\t\"quickActionsOverlay\": \"packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay\",\n\t\"prohibitedSelection\": \"packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection\",\n\t\"exitFullScreen\": \"packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen\"\n};","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useRef, useEffect } from \"react\";\nimport styled from \"styled-components\";\n\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst CANVAS_HEIGHT = 5;\nconst LOADED_COLOR = colors.RED;\nconst UNLOADED_COLOR = colors.GRAY;\n\ntype Props = {\n  blockLoadingStates: boolean[],\n  canvasWidth: number,\n};\n\nconst SProgressWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: ${CANVAS_HEIGHT}px;\n  width: 100%;\n  position: relative;\n`;\n\nfunction BlockLoadingProgressBase({ canvasWidth, blockLoadingStates }: Props) {\n  const canvasRef = useRef<?HTMLCanvasElement>(undefined);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || blockLoadingStates.length === 0) {\n      return;\n    }\n    // Update canvas based on blockLoadingStates.\n    const ctx = canvas.getContext(\"2d\");\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    const rectWidth = canvasWidth / blockLoadingStates.length;\n    let rangeStartIdx = 0;\n    blockLoadingStates.forEach((loadingState, idx) => {\n      if (blockLoadingStates[rangeStartIdx] !== loadingState) {\n        // Loading state changed, draw all the previous blocks.\n        ctx.fillStyle = !loadingState ? LOADED_COLOR : UNLOADED_COLOR;\n        ctx.beginPath();\n        ctx.rect(rectWidth * rangeStartIdx, 0, (idx - rangeStartIdx) * rectWidth, CANVAS_HEIGHT);\n        ctx.fill();\n        rangeStartIdx = idx;\n      }\n      // Reached the end and draw the last part.\n      if (idx === blockLoadingStates.length - 1) {\n        ctx.fillStyle = loadingState ? LOADED_COLOR : UNLOADED_COLOR;\n        ctx.beginPath();\n        ctx.rect(rectWidth * rangeStartIdx, 0, (idx - rangeStartIdx + 1) * rectWidth, CANVAS_HEIGHT);\n        ctx.fill();\n      }\n    });\n  }, [blockLoadingStates, canvasWidth]);\n\n  return <canvas width={canvasWidth} height={CANVAS_HEIGHT} ref={canvasRef} />;\n}\n\nexport default function BlockLoadingProgress(props: $Diff<Props, { canvasWidth: number }>) {\n  return (\n    <SProgressWrapper>\n      <Dimensions>{({ width }) => <BlockLoadingProgressBase {...props} canvasWidth={width} />}</Dimensions>\n    </SProgressWrapper>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { sortBy } from \"lodash\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport DiagnosticStatus from \"./DiagnosticStatus\";\nimport helpContent from \"./DiagnosticStatusPanel.help.md\";\nimport useDiagnostics, { type DiagnosticAutocompleteEntry } from \"./useDiagnostics\";\nimport { getDisplayName, trimHardwareId } from \"./util\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { $DIAGNOSTICS } from \"webviz-core/src/util/globalConstants\";\n\nexport type Config = {\n  selectedHardwareId?: ?string,\n  selectedName?: ?string,\n  splitFraction?: number,\n  topicToRender: string,\n  collapsedSections: { name: string, section: string }[],\n};\n\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n  topics: Topic[],\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n};\n// component to display a single diagnostic status from list\nfunction DiagnosticStatusPanel({ config, saveConfig, topics, openSiblingPanel }: Props) {\n  const onSelect = React.useCallback((\n    value: string,\n    entry: DiagnosticAutocompleteEntry,\n    autocomplete: Autocomplete\n  ) => {\n    const hasNewHardwareId = config.selectedHardwareId !== entry.hardware_id;\n    const hasNewName = config.selectedName !== entry.name;\n    saveConfig({\n      selectedHardwareId: entry.hardware_id,\n      selectedName: entry.name,\n      collapsedSections: hasNewHardwareId || hasNewName ? [] : config.collapsedSections,\n    });\n    autocomplete.blur();\n  }, [config, saveConfig]);\n\n  const { selectedHardwareId, selectedName, splitFraction, topicToRender, collapsedSections = [] } = config;\n  const topicToRenderMenu = React.useMemo(\n    () => (\n      <TopicToRenderMenu\n        topicToRender={topicToRender}\n        onChange={(newTopicToRender) => saveConfig({ topicToRender: newTopicToRender })}\n        topics={topics}\n        singleTopicDatatype={\"diagnostic_msgs/DiagnosticArray\"}\n        defaultTopicToRender={$DIAGNOSTICS}\n      />\n    ),\n    [topics, topicToRender, saveConfig]\n  );\n\n  const selectedDisplayName =\n    selectedHardwareId != null ? getDisplayName(selectedHardwareId, selectedName || \"\") : null;\n  const buffer = useDiagnostics(topicToRender);\n  let selectedItem; // selected by name+hardware_id\n  let selectedItems; // [selectedItem], or all diagnostics with selectedHardwareId if no name is selected\n  if (selectedHardwareId != null) {\n    const items = [];\n    const diagnosticsByName = buffer.diagnosticsByNameByTrimmedHardwareId.get(trimHardwareId(selectedHardwareId));\n    if (diagnosticsByName != null) {\n      for (const diagnostic of diagnosticsByName.values()) {\n        if (selectedName == null || selectedName === diagnostic.status.name) {\n          items.push(diagnostic);\n          if (selectedName != null) {\n            selectedItem = diagnostic;\n          }\n        }\n      }\n    }\n    selectedItems = items;\n  }\n  return (\n    <Flex scroll scrollX col>\n      <PanelToolbar floating helpContent={helpContent} additionalIcons={topicToRenderMenu}>\n        <Autocomplete\n          placeholder={selectedDisplayName ?? \"Select a diagnostic\"}\n          items={buffer.sortedAutocompleteEntries}\n          getItemText={(entry) => entry.displayName}\n          getItemValue={(entry) => entry.id}\n          onSelect={onSelect}\n          selectedItem={selectedItem}\n          inputStyle={{ height: \"100%\" }}\n        />\n      </PanelToolbar>\n      {selectedItems && selectedItems.length ? (\n        <Flex col scroll>\n          {sortBy(selectedItems, ({ status }) => status.name.toLowerCase()).map((item) => (\n            <DiagnosticStatus\n              key={item.id}\n              info={item}\n              splitFraction={splitFraction}\n              onChangeSplitFraction={(newSplitFraction) => saveConfig({ splitFraction: newSplitFraction })}\n              topicToRender={topicToRender}\n              openSiblingPanel={openSiblingPanel}\n              saveConfig={saveConfig}\n              collapsedSections={collapsedSections}\n            />\n          ))}\n        </Flex>\n      ) : selectedDisplayName ? (\n        <EmptyState>\n          Waiting for diagnostics from <br />\n          <br />\n          <code>{selectedDisplayName}</code>\n        </EmptyState>\n      ) : (\n        <EmptyState>No diagnostic node selected</EmptyState>\n      )}\n    </Flex>\n  );\n}\nDiagnosticStatusPanel.panelType = \"DiagnosticStatusPanel\";\nDiagnosticStatusPanel.defaultConfig = ({ topicToRender: $DIAGNOSTICS, collapsedSections: [] }: Config);\n\nexport default hot(Panel<Config>(DiagnosticStatusPanel));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ChartLineVariantIcon from \"@mdi/svg/svg/chart-line-variant.svg\";\nimport DotsHorizontalIcon from \"@mdi/svg/svg/dots-horizontal.svg\";\nimport ChevronDownIcon from \"@mdi/svg/svg/unfold-less-horizontal.svg\";\nimport ChevronUpIcon from \"@mdi/svg/svg/unfold-more-horizontal.svg\";\nimport cx from \"classnames\";\nimport { clamp } from \"lodash\";\nimport * as React from \"react\";\nimport { createSelector } from \"reselect\";\nimport sanitizeHtml from \"sanitize-html\";\nimport styled from \"styled-components\";\n\nimport style from \"./DiagnosticStatus.module.scss\";\nimport { LEVEL_NAMES, type DiagnosticInfo, type KeyValue, type DiagnosticStatusMessage } from \"./util\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport type { Config } from \"webviz-core/src/panels/diagnostics/DiagnosticStatusPanel\";\nimport { openSiblingPlotPanel } from \"webviz-core/src/panels/Plot\";\nimport { openSiblingStateTransitionsPanel } from \"webviz-core/src/panels/StateTransitions\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\n\nconst MIN_SPLIT_FRACTION = 0.1;\n\ntype Props = {|\n  info: DiagnosticInfo,\n  splitFraction: number,\n  onChangeSplitFraction: ?(number) => void,\n  topicToRender: string,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n  collapsedSections: { name: string, section: string }[],\n  saveConfig: ($Shape<Config>) => void,\n|};\n\nconst ResizeHandle = styled.div.attrs(({ splitFraction }) => ({\n  style: { left: `${100 * splitFraction}%` },\n}))`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 12px;\n  margin-left: -6px;\n  cursor: col-resize;\n  :hover,\n  :active,\n  :focus {\n    outline: none;\n    ::after {\n      content: \"\";\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 6px;\n      margin-left: -2px;\n      width: 4px;\n      background-color: ${colors.divider};\n    }\n  }\n`;\n\nconst KeyValueTable = styled.table`\n  table-layout: fixed;\n  width: 100%;\n  line-height: 1.3em;\n  white-space: pre-line;\n  overflow-wrap: break-word;\n  text-align: left;\n  tr:nth-child(odd) {\n    background-color: #222;\n  }\n  td {\n    border: none;\n    padding: 1px 3px;\n  }\n  /* nested table styles */\n  table {\n    th {\n      font-weight: bold;\n    }\n  }\n`;\n\ntype FormattedKeyValue = {|\n  key: string,\n  keyHtml: ?{ __html: string },\n  value: string,\n  valueHtml: ?{ __html: string },\n|};\n\nconst allowedTags = [\n  // this comment forces the array onto multiple lines :)\n  \"b\",\n  \"br\",\n  \"center\",\n  \"code\",\n  \"em\",\n  \"font\",\n  \"i\",\n  \"strong\",\n  \"table\",\n  \"td\",\n  \"th\",\n  \"tr\",\n  \"tt\",\n  \"u\",\n];\n\nfunction sanitize(value: string): { __html: string } {\n  return {\n    __html: sanitizeHtml(value, {\n      allowedTags,\n      allowedAttributes: {\n        font: [\"color\", \"size\"],\n        td: [\"colspan\"],\n        th: [\"colspan\"],\n      },\n    }),\n  };\n}\n\n// preliminary check to avoid expensive operations when there is no html\nconst HAS_ANY_HTML = new RegExp(`<(${allowedTags.join(\"|\")})`);\n\nconst getFormattedKeyValues = createSelector(\n  (message: DiagnosticStatusMessage) => message,\n  (message: DiagnosticStatusMessage): FormattedKeyValue[] => {\n    return (message.values || []).map(({ key, value }: KeyValue) => {\n      return {\n        key,\n        keyHtml: HAS_ANY_HTML.test(key) ? sanitize(key) : undefined,\n        value,\n        valueHtml: HAS_ANY_HTML.test(value) ? sanitize(value) : undefined,\n      };\n    });\n  }\n);\n\n// component to display a single diagnostic status\nclass DiagnosticStatus extends React.Component<Props, *> {\n  _tableRef = React.createRef<HTMLTableElement>();\n\n  static defaultProps = {\n    splitFraction: 0.5,\n  };\n\n  _onClickSection(sectionObj: { name: string, section: string }) {\n    const { collapsedSections, saveConfig } = this.props;\n    const clickedSelectionIsCollapsed = collapsedSections.find(\n      ({ name, section }) => name === sectionObj.name && section === sectionObj.section\n    );\n    if (clickedSelectionIsCollapsed) {\n      saveConfig({\n        collapsedSections: collapsedSections.filter(\n          ({ name, section }) => name !== sectionObj.name || section !== sectionObj.section\n        ),\n      });\n    } else {\n      saveConfig({ collapsedSections: [...collapsedSections, sectionObj] });\n    }\n  }\n\n  _resizeMouseDown = (event: SyntheticMouseEvent<Element>) => {\n    event.preventDefault();\n    window.addEventListener(\"mousemove\", this._resizeMouseMove);\n    window.addEventListener(\"mouseup\", this._resizeMouseUp);\n  };\n\n  _resizeMouseUp = () => {\n    window.removeEventListener(\"mousemove\", this._resizeMouseMove);\n  };\n\n  _resizeMouseMove = (event: SyntheticMouseEvent<Element>) => {\n    const {\n      _tableRef,\n      props: { onChangeSplitFraction },\n    } = this;\n\n    if (!_tableRef.current || !onChangeSplitFraction) {\n      return;\n    }\n\n    const { left, right } = _tableRef.current.getBoundingClientRect();\n    const splitFraction = clamp((event.clientX - left) / (right - left), MIN_SPLIT_FRACTION, 1 - MIN_SPLIT_FRACTION);\n    onChangeSplitFraction(splitFraction);\n  };\n\n  componentWillUnmount() {\n    window.removeEventListener(\"mousemove\", this._resizeMouseMove);\n    window.removeEventListener(\"mouseup\", this._resizeMouseUp);\n  }\n\n  _renderKeyValueCell(cls: string, html: ?{ __html: string }, str: string, openPlotPanelIconElem?: React.Node) {\n    if (html) {\n      return <td className={style.valueCell} dangerouslySetInnerHTML={html} />;\n    }\n    return (\n      <td className={style.valueCell}>\n        {str || \"\\xa0\"}\n        {openPlotPanelIconElem}\n      </td>\n    );\n  }\n\n  _renderKeyValueSections = (): React.Node => {\n    const { info, topicToRender, openSiblingPanel, collapsedSections } = this.props;\n    const formattedKeyVals: FormattedKeyValue[] = getFormattedKeyValues(info.status);\n    let inCollapsedSection = false;\n    let ellipsisShown = false;\n    return formattedKeyVals.map(({ key, value, keyHtml, valueHtml }, idx) => {\n      const keyIsSection = !value && (key.startsWith(\"==\") || key.startsWith(\"--\"));\n      const valIsSection = !key && (value.startsWith(\"==\") || value.startsWith(\"--\"));\n      if (keyIsSection || valIsSection) {\n        const sectionObj = { name: info.status.name, section: `${key}${value}` };\n        inCollapsedSection = collapsedSections.find(\n          ({ name, section }) => name === sectionObj.name && section === sectionObj.section\n        );\n        ellipsisShown = false;\n        return (\n          <tr key={idx} className={style.section} onClick={() => this._onClickSection(sectionObj)}>\n            <th colSpan={2}>\n              {key}\n              {value}\n            </th>\n          </tr>\n        );\n      } else if (inCollapsedSection) {\n        if (ellipsisShown) {\n          return null;\n        }\n        ellipsisShown = true;\n        return (\n          <tr key={idx}>\n            <td colSpan={2} className={style.collapsedSection}>\n              &hellip;\n            </td>\n          </tr>\n        );\n      }\n      // We need both `hardware_id` and `name`; one of them is not enough. That's also how we identify\n      // what to show in this very panel; see `selectedHardwareId` AND `selectedName` in the config.\n      const valuePath = `${topicToRender}.status[:]{hardware_id==\"${info.status.hardware_id}\"}{name==\"${\n        info.status.name\n      }\"}.values[:]{key==\"${key}\"}.value`;\n      let openPlotPanelIconElem = null;\n      if (value && value.length > 0) {\n        openPlotPanelIconElem = !isNaN(Number(value)) ? (\n          <Icon\n            fade\n            dataTest=\"open-plot-icon\"\n            className={style.plotIcon}\n            onClick={() => openSiblingPlotPanel(openSiblingPanel, valuePath)}\n            tooltip=\"Line chart\">\n            <ChartLineVariantIcon />\n          </Icon>\n        ) : (\n          <Icon\n            fade\n            className={style.stateTransitionsIcon}\n            onClick={() => openSiblingStateTransitionsPanel(openSiblingPanel, valuePath)}\n            tooltip=\"State Transitions\">\n            <DotsHorizontalIcon />\n          </Icon>\n        );\n      }\n      return (\n        <tr key={idx} className={style.row}>\n          {this._renderKeyValueCell(style.keyCell, keyHtml, key)}\n          {this._renderKeyValueCell(style.valueCell, valueHtml, value, openPlotPanelIconElem)}\n        </tr>\n      );\n    });\n  };\n\n  _getSectionsCollapsedForCurrentName = (): { name: string, section: string }[] => {\n    const { collapsedSections, info } = this.props;\n    return collapsedSections.filter(({ name }) => name === info.status.name);\n  };\n\n  _getSectionsThatCanBeCollapsed = (): FormattedKeyValue[] => {\n    const { info } = this.props;\n    const formattedKeyVals = getFormattedKeyValues(info.status);\n    return formattedKeyVals.filter(({ key, value }) => {\n      const keyIsSection = !value && (key.startsWith(\"==\") || key.startsWith(\"--\"));\n      const valIsSection = !key && (value.startsWith(\"==\") || value.startsWith(\"--\"));\n      return keyIsSection || valIsSection;\n    });\n  };\n\n  _toggleSections = () => {\n    const { saveConfig, collapsedSections, info } = this.props;\n    const newSectionsForCurrentName = this._getSectionsCollapsedForCurrentName().length\n      ? []\n      : this._getSectionsThatCanBeCollapsed().map(({ key, value }) => ({\n          name: info.status.name,\n          section: `${key}${value}`,\n        }));\n    const otherSections = collapsedSections.filter(({ name }) => name !== info.status.name);\n    saveConfig({ collapsedSections: newSectionsForCurrentName.concat(otherSections) });\n  };\n\n  render() {\n    const {\n      info: { status, displayName },\n      splitFraction,\n      openSiblingPanel,\n      topicToRender,\n    } = this.props;\n    const statusClass = style[`status-${LEVEL_NAMES[status.level] || \"unknown\"}`];\n\n    return (\n      <div>\n        <ResizeHandle data-test-resizehandle splitFraction={splitFraction} onMouseDown={this._resizeMouseDown} />\n        <KeyValueTable ref={this._tableRef}>\n          <tbody>\n            {/* Use a dummy row to fix the column widths */}\n            <tr style={{ height: 0 }}>\n              <td style={{ padding: 0, width: `${100 * splitFraction}%`, borderRight: \"none\" }} />\n              <td style={{ padding: 0, borderLeft: \"none\" }} />\n            </tr>\n            <tr className={cx(style.section, statusClass)}>\n              <Tooltip\n                placement=\"bottom\"\n                contents={\n                  <div>\n                    Hardware ID: <code>{status.hardware_id}</code>\n                    <br />\n                    Name: <code>{status.name}</code>\n                  </div>\n                }>\n                <th data-test=\"DiagnosticStatus-display-name\" colSpan={2}>\n                  {displayName}\n                </th>\n              </Tooltip>\n            </tr>\n            <tr className={cx(style.row, statusClass)}>\n              <td colSpan={2}>\n                <Flex style={{ justifyContent: \"space-between\" }}>\n                  <div>\n                    {status.message}{\" \"}\n                    <Icon\n                      fade\n                      className={style.stateTransitionsIcon}\n                      onClick={() =>\n                        openSiblingStateTransitionsPanel(\n                          openSiblingPanel,\n                          `${topicToRender}.status[:]{hardware_id==\"${status.hardware_id}\"}{name==\"${\n                            status.name\n                          }\"}.message`\n                        )\n                      }\n                      tooltip=\"State Transitions\">\n                      <DotsHorizontalIcon />\n                    </Icon>\n                  </div>\n                  {this._getSectionsThatCanBeCollapsed().length ? (\n                    <div style={{ color: \"white\", cursor: \"pointer\" }} onClick={this._toggleSections}>\n                      <Icon\n                        medium\n                        fade\n                        style={{ padding: 4 }}\n                        tooltip={this._getSectionsCollapsedForCurrentName().length ? \"Expand all\" : \"Collapse all\"}>\n                        {this._getSectionsCollapsedForCurrentName().length ? <ChevronUpIcon /> : <ChevronDownIcon />}\n                      </Icon>\n                    </div>\n                  ) : null}\n                </Flex>\n              </td>\n            </tr>\n            {this._renderKeyValueSections()}\n          </tbody>\n        </KeyValueTable>\n      </div>\n    );\n  }\n}\n\nexport default DiagnosticStatus;\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./DiagnosticStatus.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./DiagnosticStatus.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./DiagnosticStatus.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3f8jg--name{font-weight:bold}tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th{color:#29bee7;text-align:center;font-size:1.2em;padding:4px;cursor:pointer;border:none}tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-8eud5--status-ok.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-8eud5--status-ok td{color:#05d27d}tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-24pnd--status-warn.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-24pnd--status-warn td{color:#ccb862}tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-321rk--status-error.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-321rk--status-error td{color:#ff7c96}tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4zzfk--status-stale.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4zzfk--status-stale td{color:rgba(247,247,243,.3)}tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3tyzc--status-unknown.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3tyzc--status-unknown td{color:#ff7c96}.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3cmpn--keyCell{padding-right:5px}td.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4mnj9--collapsedSection{text-align:center;color:#ff7c96}.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon,.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon{color:#fff;margin-left:4px;visibility:hidden}tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2dcvn--row:hover .packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon,tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2dcvn--row:hover .packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon{visibility:visible}.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon>svg{vertical-align:-1px}.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon>svg{vertical-align:-2px}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA,iFACE,gBAAA,CAGF,yFACE,cACA,kBACA,gBACA,YACA,eACA,WAAA,CAIA,yQAEE,aCMI,CDFN,6QAEE,aCOK,CDHP,+QAEE,aCEE,CDEJ,+QAEE,0BC5BS,CDgCX,mRAEE,aCVE,CDcN,oFACE,iBAAA,CAGF,+FACE,kBACA,aCpBI,CDuBN,sLAEE,WACA,gBACA,iBAAA,CAEA,sWACE,kBAAA,CAIJ,yFACE,mBAAA,CAGF,qGACE,mBAAA,CAAA\",\"file\":\"DiagnosticStatus.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.name {\\n  font-weight: bold;\\n}\\n\\ntr.section th {\\n  color: $highlight;\\n  text-align: center;\\n  font-size: 1.2em;\\n  padding: 4px;\\n  cursor: pointer;\\n  border: none;\\n}\\n\\ntr.status-ok {\\n  &.section th,\\n  td {\\n    color: $green;\\n  }\\n}\\ntr.status-warn {\\n  &.section th,\\n  td {\\n    color: $orange;\\n  }\\n}\\ntr.status-error {\\n  &.section th,\\n  td {\\n    color: $red;\\n  }\\n}\\ntr.status-stale {\\n  &.section th,\\n  td {\\n    color: $text-muted;\\n  }\\n}\\ntr.status-unknown {\\n  &.section th,\\n  td {\\n    color: $red;\\n  }\\n}\\n\\n.keyCell {\\n  padding-right: 5px;\\n}\\n\\ntd.collapsedSection {\\n  text-align: center;\\n  color: $red;\\n}\\n\\n.plotIcon,\\n.stateTransitionsIcon {\\n  color: white;\\n  margin-left: 4px;\\n  visibility: hidden;\\n\\n  tr.row:hover & {\\n    visibility: visible;\\n  }\\n}\\n\\n.plotIcon > svg {\\n  vertical-align: -1px;\\n}\\n\\n.stateTransitionsIcon > svg {\\n  vertical-align: -2px;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"name\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3f8jg--name\",\n\t\"section\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section\",\n\t\"status-ok\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-8eud5--status-ok\",\n\t\"status-warn\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-24pnd--status-warn\",\n\t\"status-error\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-321rk--status-error\",\n\t\"status-stale\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4zzfk--status-stale\",\n\t\"status-unknown\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3tyzc--status-unknown\",\n\t\"keyCell\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3cmpn--keyCell\",\n\t\"collapsedSection\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4mnj9--collapsedSection\",\n\t\"plotIcon\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon\",\n\t\"stateTransitionsIcon\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon\",\n\t\"row\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2dcvn--row\"\n};","module.exports = \"# Plot\\n\\nPlots arbitrary values from topics, similar to [rqt_plot](http://wiki.ros.org/rqt_plot).\\n\\nThe values plotted are specified through Webviz's [message path syntax](/help/message-path-syntax).\\n\\nIn the options menu, you can set a minimum and maximum Y-value. By default, the plot will use those bounds unless the data you're looking at extends above the max Y-value or below the min Y-value; in those cases it will automatically expand. If you want to disable this behavior and force the plot to use the exact minimum and maximum Y-values entered, you can \\\"lock\\\" the y-axis in the options menu as well.\\n\\nThere are 2 possible values for the x-axis - by the message's timestamp or by the message values' respective array indices.\\n\\n## Timestamp as X-Axis\\n\\nWhen you select to plot against a timestamp x-axis (default), you can specify whether the timestamp is taken from either the time the message was received, or the `message.header.stamp` field of the topic, in the dropdown displayed next to each line topic. All Plot panels' timestamped x-axes are kept in sync for easy comparison.\\n\\nWhen you select multiple values (by using a slice) the plot turns into a scatter plot at each timestamp tick.\\n\\nYou can also enter an arbitrary number, which will add a horizontal line at that y-value.\\n\\nTo take the derivative of a value (change per second), use the special `.@derivative` modifier. This does not work with scatter plots (when using slices).\\n\\nTo plot the length of an array, use the `.@length` modifier at the end of the queried array.\\n\\nTo switch the sign of a value, use the special `.@negative` modifier at the end of the topic path syntax. The following math functions are also available: `.@abs`, `.@acos`, `.@asin`, `.@atan`, `.@ceil`, `.@cos`, `.@log`, `.@log1p`, `.@log2`, `.@log10`, `.@round`, `.@sign`, `.@sin`, `.@sqrt`, `.@tan`, and `.@trunc`. See the [Javascript Math documentation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math) for details on each one. Unit conversions `@rad2deg`, `@kph2mph`, `@mps2mph` and other orders/combinations are also available.\\n\\n## Array Index as X-Axis\\n\\nIn the legend, you can change the x-axis from being the messages' timestamps to their values' array indices. In this mode, adding message path `/some_topic.some_array` as a new line in the plot will chart that array's values against their indices. For example, if `/some_topic.some_array` contained the values `[5, 10, 15]`, the resulting points on the chart would be `[0, 5]`, `[1, 10]`, and `[2, 15]`.\\n\\nThis mode always plots just the data from the latest tick.\\n\\n## Message Data as X-Axis\\n\\nIn the legend, set the x-axis mode to a \\\"msg path\\\" option to specify a path to the data to use for the plot's x-coordinates. For example, you could plot a line for `/some_topic.y`, with the x axis set to `/some_topic.x`.\\n\\nTo plot data from just the most recent tick, use the \\\"msg path (current)\\\" setting. To plot data from _all_ matching messages, use the \\\"msg path (accumulated)\\\" setting.\\n\\n## User Interactions\\n\\nYou can zoom by scrolling, and pan by dragging. Double-click to reset.\\n\\nBy default, scrolling will zoom horizontally only. To zoom vertically, hold the `v` key while scrolling. To zoom both horizontally and vertically at the same time, hold the `b` key while scrolling.\\n\\nSome \\\"default zoom level\\\" settings are available in the panel settings menu. The y-axis limits can be given fixed values for any plot type. For plots where the x-axis represents the message timestamp, you can have the plot \\\"follow\\\" playback by specifying the plot's \\\"viewport\\\" (i.e. width in seconds).\\n\"","// Generated automatically by nearley, version unknown\n// http://github.com/Hardmath123/nearley\n(function () {\nfunction id(x) { return x[0]; }\nvar grammar = {\n    Lexer: undefined,\n    ParserRules: [\n    {\"name\": \"main$ebnf$1\", \"symbols\": [\"messagePath\"], \"postprocess\": id},\n    {\"name\": \"main$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"main$ebnf$2\", \"symbols\": [\"modifier\"], \"postprocess\": id},\n    {\"name\": \"main$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"main\", \"symbols\": [\"topicName\", \"main$ebnf$1\", \"main$ebnf$2\"], \"postprocess\": (d) => ({ topicName: d[0], messagePath: d[1] || [], modifier: d[2] })},\n    {\"name\": \"id$ebnf$1\", \"symbols\": [/[a-zA-Z0-9_]/]},\n    {\"name\": \"id$ebnf$1\", \"symbols\": [\"id$ebnf$1\", /[a-zA-Z0-9_]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"id\", \"symbols\": [\"id$ebnf$1\"], \"postprocess\": (d) => d[0].join(\"\")},\n    {\"name\": \"integer$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"integer$ebnf$1\", \"symbols\": [\"integer$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"integer\", \"symbols\": [\"integer$ebnf$1\"], \"postprocess\": (d) => ({ value: parseInt(d[0].join(\"\")), repr: d[0].join(\"\") })},\n    {\"name\": \"integer$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"integer$ebnf$2\", \"symbols\": [\"integer$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"integer\", \"symbols\": [{\"literal\":\"-\"}, \"integer$ebnf$2\"], \"postprocess\": (d) => ({ value: -parseInt(d[1].join(\"\")), repr: `-${d[1].join(\"\")}` })},\n    {\"name\": \"string$ebnf$1\", \"symbols\": []},\n    {\"name\": \"string$ebnf$1\", \"symbols\": [\"string$ebnf$1\", /[^']/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"string\", \"symbols\": [{\"literal\":\"'\"}, \"string$ebnf$1\", {\"literal\":\"'\"}], \"postprocess\": (d) => ({ value: d[1].join(\"\"), repr: `'${d[1].join(\"\")}'` })},\n    {\"name\": \"string$ebnf$2\", \"symbols\": []},\n    {\"name\": \"string$ebnf$2\", \"symbols\": [\"string$ebnf$2\", /[^\"]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"string\", \"symbols\": [{\"literal\":\"\\\"\"}, \"string$ebnf$2\", {\"literal\":\"\\\"\"}], \"postprocess\": (d) => ({ value: d[1].join(\"\"), repr: `\"${d[1].join(\"\")}\"` })},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [\"id\"], \"postprocess\": id},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"variable\", \"symbols\": [{\"literal\":\"$\"}, \"variable$ebnf$1\"], \"postprocess\": (d, loc) => ({ value: {variableName: d[1] || \"\", startLoc: loc }, repr: `$${d[1] || \"\"}` })},\n    {\"name\": \"value\", \"symbols\": [\"integer\"], \"postprocess\": (d) => d[0]},\n    {\"name\": \"value\", \"symbols\": [\"string\"], \"postprocess\": (d) => d[0]},\n    {\"name\": \"value$string$1\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"r\"}, {\"literal\":\"u\"}, {\"literal\":\"e\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"value\", \"symbols\": [\"value$string$1\"], \"postprocess\": (d) => ({ value: true, repr: \"true\" })},\n    {\"name\": \"value$string$2\", \"symbols\": [{\"literal\":\"f\"}, {\"literal\":\"a\"}, {\"literal\":\"l\"}, {\"literal\":\"s\"}, {\"literal\":\"e\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"value\", \"symbols\": [\"value$string$2\"], \"postprocess\": (d) => ({ value: false, repr: \"false\" })},\n    {\"name\": \"value\", \"symbols\": [\"variable\"], \"postprocess\": (d) => d[0]},\n    {\"name\": \"topicName$ebnf$1\", \"symbols\": [\"slashID\"]},\n    {\"name\": \"topicName$ebnf$1\", \"symbols\": [\"topicName$ebnf$1\", \"slashID\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"topicName\", \"symbols\": [\"topicName$ebnf$1\"], \"postprocess\": (d) => d[0].join(\"\")},\n    {\"name\": \"slashID$ebnf$1\", \"symbols\": [\"id\"], \"postprocess\": id},\n    {\"name\": \"slashID$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"slashID\", \"symbols\": [{\"literal\":\"/\"}, \"slashID$ebnf$1\"], \"postprocess\": (d) => d.join(\"\")},\n    {\"name\": \"messagePath$ebnf$1\", \"symbols\": []},\n    {\"name\": \"messagePath$ebnf$1\", \"symbols\": [\"messagePath$ebnf$1\", \"messagePathElement\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"messagePath$ebnf$2\", \"symbols\": [{\"literal\":\".\"}], \"postprocess\": id},\n    {\"name\": \"messagePath$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"messagePath\", \"symbols\": [\"messagePath$ebnf$1\", \"messagePath$ebnf$2\"], \"postprocess\": (d) => d[0].reduce((acc, arr) => acc.concat(arr), []).concat(d[1] ? [{ type: \"name\", name: \"\" }] : [])},\n    {\"name\": \"messagePathElement$ebnf$1\", \"symbols\": [\"slice\"], \"postprocess\": id},\n    {\"name\": \"messagePathElement$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"messagePathElement$ebnf$2\", \"symbols\": [\"filter\"], \"postprocess\": id},\n    {\"name\": \"messagePathElement$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"messagePathElement\", \"symbols\": [{\"literal\":\".\"}, \"name\", \"messagePathElement$ebnf$1\", \"messagePathElement$ebnf$2\"], \"postprocess\": (d) => [d[1], d[2], d[3]].filter(x => x !== null)},\n    {\"name\": \"messagePathElement\", \"symbols\": [\"filter\"], \"postprocess\": id},\n    {\"name\": \"name\", \"symbols\": [\"id\"], \"postprocess\": (d) => ({ type: \"name\", name: d[0] })},\n    {\"name\": \"sliceVal\", \"symbols\": [\"integer\"], \"postprocess\": (d) => (d[0].value)},\n    {\"name\": \"sliceVal\", \"symbols\": [\"variable\"], \"postprocess\": (d) => (d[0].value)},\n    {\"name\": \"slice\", \"symbols\": [{\"literal\":\"[\"}, \"sliceVal\", {\"literal\":\"]\"}], \"postprocess\": (d) => ({ type: \"slice\", start: d[1], end: d[1] })},\n    {\"name\": \"slice$ebnf$1\", \"symbols\": [\"sliceVal\"], \"postprocess\": id},\n    {\"name\": \"slice$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"slice$ebnf$2\", \"symbols\": [\"sliceVal\"], \"postprocess\": id},\n    {\"name\": \"slice$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"slice\", \"symbols\": [{\"literal\":\"[\"}, \"slice$ebnf$1\", {\"literal\":\":\"}, \"slice$ebnf$2\", {\"literal\":\"]\"}], \"postprocess\": (d) => ({ type: \"slice\", start: d[1] === null ? 0 : d[1], end: d[3] === null ? Infinity : d[3] })},\n    {\"name\": \"simplePath$ebnf$1\", \"symbols\": []},\n    {\"name\": \"simplePath$ebnf$1$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"id\"]},\n    {\"name\": \"simplePath$ebnf$1\", \"symbols\": [\"simplePath$ebnf$1\", \"simplePath$ebnf$1$subexpression$1\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"simplePath\", \"symbols\": [\"id\", \"simplePath$ebnf$1\"], \"postprocess\": (d) => [d[0]].concat(d[1].map((d) => d[1]))},\n    {\"name\": \"filter$ebnf$1\", \"symbols\": [\"simplePath\"], \"postprocess\": id},\n    {\"name\": \"filter$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"filter\", \"symbols\": [{\"literal\":\"{\"}, \"filter$ebnf$1\", {\"literal\":\"}\"}], \"postprocess\": \n        (d, loc) => ({\n          type: \"filter\",\n          path: d[1] || [],\n          value: undefined,\n          nameLoc: loc+1,\n          valueLoc: loc+1,\n          repr: (d[1] || []).join(\".\"),\n        })\n                    },\n    {\"name\": \"filter$ebnf$2\", \"symbols\": [\"simplePath\"], \"postprocess\": id},\n    {\"name\": \"filter$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"filter$string$1\", \"symbols\": [{\"literal\":\"=\"}, {\"literal\":\"=\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"filter\", \"symbols\": [{\"literal\":\"{\"}, \"filter$ebnf$2\", \"filter$string$1\", \"value\", {\"literal\":\"}\"}], \"postprocess\": \n        (d, loc) => ({\n          type: \"filter\",\n          path: d[1] || [],\n          value: d[3].value,\n          nameLoc: loc+1,\n          valueLoc: loc+1+(d[1] || []).join(\".\").length+d[2].length,\n          repr: `${(d[1] || []).join(\".\")}==${d[3].repr}`,\n        })\n                    },\n    {\"name\": \"modifier$string$1\", \"symbols\": [{\"literal\":\".\"}, {\"literal\":\"@\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"modifier$ebnf$1\", \"symbols\": [\"id\"], \"postprocess\": id},\n    {\"name\": \"modifier$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"modifier\", \"symbols\": [\"modifier$string$1\", \"modifier$ebnf$1\"], \"postprocess\": (d) => d[1] || \"\"}\n]\n  , ParserStart: \"main\"\n}\nif (typeof module !== 'undefined'&& typeof module.exports !== 'undefined') {\n   module.exports = grammar;\n} else {\n   window.grammar = grammar;\n}\n})();\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport flatten from \"lodash/flatten\";\nimport React, { memo, useMemo } from \"react\";\nimport { Time } from \"rosbag\";\nimport uuid from \"uuid\";\n\nimport type { PlotXAxisVal } from \"./index\";\nimport styles from \"./PlotChart.module.scss\";\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport TimeBasedChart, { type ChartDefaultView } from \"webviz-core/src/components/TimeBasedChart\";\nimport { type TimeBasedChartTooltipData, type TooltipItem } from \"webviz-core/src/components/TimeBasedChart/utils\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport {\n  type PlotPath,\n  type BasePlotPath,\n  isReferenceLinePlotPathType,\n} from \"webviz-core/src/panels/Plot/internalTypes\";\nimport { derivative, applyToDataOrTooltips, mathFunctions } from \"webviz-core/src/panels/Plot/transformPlotRange\";\nimport { deepParse, isBobject } from \"webviz-core/src/util/binaryObjects\";\nimport { format } from \"webviz-core/src/util/formatTime\";\nimport { lightColor, lineColors } from \"webviz-core/src/util/plotColors\";\nimport { isTime, subtractTimes, toSec, formatTimeRaw } from \"webviz-core/src/util/time\";\n\nexport type PlotChartPoint = {|\n  x: number,\n  y: number,\n|};\n\nexport type DataSet = {|\n  borderColor: string,\n  borderWidth: number,\n  data: Array<PlotChartPoint>,\n  fill: boolean,\n  key: string,\n  label: string,\n  pointBackgroundColor: string,\n  pointBorderColor: string,\n  pointHoverRadius: number,\n  pointRadius: number,\n  showLine: boolean,\n|};\n\nexport type PlotDataByPath = {\n  [path: string]: $ReadOnlyArray<$ReadOnlyArray<TooltipItem>>,\n};\n\nconst Y_AXIS_ID = \"Y_AXIS_ID\";\n\nconst isCustomScale = (xAxisVal: PlotXAxisVal): boolean => xAxisVal === \"custom\" || xAxisVal === \"currentCustom\";\n\nfunction getXForPoint(\n  xAxisVal: PlotXAxisVal,\n  timestamp: number,\n  innerIdx: number,\n  xAxisRanges: ?$ReadOnlyArray<$ReadOnlyArray<TooltipItem>>,\n  xItem: ?TooltipItem,\n  xAxisPath: ?BasePlotPath\n): number {\n  if (isCustomScale(xAxisVal) && xAxisPath) {\n    if (isReferenceLinePlotPathType(xAxisPath)) {\n      return Number.parseFloat(xAxisPath.value);\n    }\n    if (xAxisRanges) {\n      if (!xItem) {\n        return NaN;\n      }\n      // It is possible that values are still bobjects at this point. Parse if needed.\n      const maybeBobject = xItem.queriedData[innerIdx]?.value;\n      const value = maybeBobject && isBobject(maybeBobject) ? deepParse(maybeBobject) : maybeBobject;\n      return isTime(value) ? toSec((value: any)) : Number(value);\n    }\n  }\n  return xAxisVal === \"timestamp\" ? timestamp : innerIdx;\n}\n\nconst scaleOptions = {\n  fixedYAxisWidth: 48,\n  yAxisTicks: \"hideFirstAndLast\",\n};\n\nfunction getPointsAndTooltipsForMessagePathItem(\n  yItem: TooltipItem,\n  xItem: ?TooltipItem,\n  startTime: Time,\n  timestampMethod,\n  path: string,\n  xAxisVal: PlotXAxisVal,\n  xAxisPath?: BasePlotPath,\n  xAxisRanges: ?$ReadOnlyArray<$ReadOnlyArray<TooltipItem>>,\n  datasetKey: string\n): { points: PlotChartPoint[], tooltips: TimeBasedChartTooltipData[], hasMismatchedData: boolean } {\n  const points = [];\n  const tooltips = [];\n  const timestamp = timestampMethod === \"headerStamp\" ? yItem.headerStamp : yItem.receiveTime;\n  if (!timestamp) {\n    return { points, tooltips, hasMismatchedData: false };\n  }\n  const elapsedTime = toSec(subtractTimes(timestamp, startTime));\n  for (const [innerIdx, { value: maybeBobject, path: queriedPath, constantName }] of yItem.queriedData.entries()) {\n    // It is possible that values are still bobjects at this point. Parse if needed.\n    const value = isBobject(maybeBobject) ? deepParse(maybeBobject) : maybeBobject;\n    if (typeof value === \"number\" || typeof value === \"boolean\" || typeof value === \"string\") {\n      const valueNum = Number(value);\n      if (!isNaN(valueNum)) {\n        const x = getXForPoint(xAxisVal, elapsedTime, innerIdx, xAxisRanges, xItem, xAxisPath);\n        const y = valueNum;\n        const tooltip = { x, y, datasetKey, item: yItem, path: queriedPath, value, constantName, startTime };\n        points.push({ x, y });\n        tooltips.push(tooltip);\n      }\n    } else if (isTime(value)) {\n      // $FlowFixMe - %checks on isTime can't convince Flow that the object is actually a Time. Related: https://github.com/facebook/flow/issues/3614\n      const timeValue = (value: Time);\n      const x = getXForPoint(xAxisVal, elapsedTime, innerIdx, xAxisRanges, xItem, xAxisPath);\n      const y = toSec(timeValue);\n      const tooltip = {\n        x,\n        y,\n        datasetKey,\n        item: yItem,\n        path: queriedPath,\n        value: `${format(timeValue)} (${formatTimeRaw(timeValue)})`,\n        constantName,\n        startTime,\n      };\n      points.push({ x, y });\n      tooltips.push(tooltip);\n    } else if (path.endsWith(\".@length\") && typeof (value: any)?.length === \"number\") {\n      const valueNum: number = Number((value: any)?.length);\n      if (!isNaN(valueNum)) {\n        const x = getXForPoint(xAxisVal, elapsedTime, innerIdx, xAxisRanges, xItem, xAxisPath);\n        const y = valueNum;\n        const tooltip: TimeBasedChartTooltipData = {\n          x,\n          y,\n          datasetKey,\n          item: yItem,\n          path: queriedPath,\n          value: valueNum,\n          constantName,\n          startTime,\n        };\n        points.push({ x, y });\n        tooltips.push(tooltip);\n      }\n    }\n  }\n  const hasMismatchedData =\n    isCustomScale(xAxisVal) && (!xItem || yItem.queriedData.length !== xItem.queriedData.length);\n  return { points, tooltips, hasMismatchedData };\n}\n\nfunction getDatasetAndTooltipsFromMessagePlotPath(\n  path: PlotPath,\n  yAxisRanges: $ReadOnlyArray<$ReadOnlyArray<TooltipItem>>,\n  index: number,\n  startTime: Time,\n  xAxisVal: PlotXAxisVal,\n  xAxisRanges: ?$ReadOnlyArray<$ReadOnlyArray<TooltipItem>>,\n  xAxisPath?: BasePlotPath\n): { dataset: DataSet, tooltips: TimeBasedChartTooltipData[], hasMismatchedData: boolean, path: string } {\n  let showLine = true;\n  const datasetKey = index.toString();\n\n  let hasMismatchedData =\n    isCustomScale(xAxisVal) &&\n    xAxisRanges != null &&\n    (yAxisRanges.length !== xAxisRanges.length ||\n      xAxisRanges.every((range, rangeIndex) => range.length !== yAxisRanges[rangeIndex].length));\n  let rangesOfTooltips: TimeBasedChartTooltipData[][] = [];\n  let rangesOfPoints: PlotChartPoint[][] = [];\n  for (const [rangeIdx, range] of yAxisRanges.entries()) {\n    const xRange: ?$ReadOnlyArray<TooltipItem> = xAxisRanges?.[rangeIdx];\n    const rangeTooltips = [];\n    const rangePoints = [];\n    for (const [outerIdx, item] of range.entries()) {\n      const xItem: ?TooltipItem = xRange?.[outerIdx];\n      const {\n        points: itemPoints,\n        tooltips: itemTooltips,\n        hasMismatchedData: itemHasMistmatchedData,\n      } = getPointsAndTooltipsForMessagePathItem(\n        item,\n        xItem,\n        startTime,\n        path.timestampMethod,\n        path.value,\n        xAxisVal,\n        xAxisPath,\n        xAxisRanges,\n        datasetKey\n      );\n      for (const point of itemPoints) {\n        rangePoints.push(point);\n      }\n      for (const tooltip of itemTooltips) {\n        rangeTooltips.push(tooltip);\n      }\n      hasMismatchedData = hasMismatchedData || itemHasMistmatchedData;\n      // If we have added more than one point for this message, make it a scatter plot.\n      if (item.queriedData.length > 1 && xAxisVal !== \"index\") {\n        showLine = false;\n      }\n    }\n    rangesOfTooltips.push(rangeTooltips);\n    rangesOfPoints.push(rangePoints);\n  }\n\n  if (path.value.endsWith(\".@derivative\")) {\n    if (showLine) {\n      const newRangesOfTooltips = [];\n      const newRangesOfPoints = [];\n      for (const [rangeIdx, rangePoints] of rangesOfPoints.entries()) {\n        const rangeTooltips = rangesOfTooltips[rangeIdx];\n        const { points, tooltips } = derivative(rangePoints, rangeTooltips);\n        newRangesOfTooltips.push(tooltips);\n        newRangesOfPoints.push(points);\n      }\n      rangesOfPoints = newRangesOfPoints;\n      rangesOfTooltips = newRangesOfTooltips;\n    } else {\n      // If we have a scatter plot, we can't take the derivative, so instead show nothing\n      // (nothing is better than incorrect data).\n      rangesOfPoints = [];\n      rangesOfTooltips = [];\n    }\n  }\n  for (const funcName of Object.keys(mathFunctions)) {\n    if (path.value.endsWith(`.@${funcName}`)) {\n      rangesOfPoints = rangesOfPoints.map((points) => applyToDataOrTooltips(points, mathFunctions[funcName]));\n      rangesOfTooltips = rangesOfTooltips.map((tooltips) => applyToDataOrTooltips(tooltips, mathFunctions[funcName]));\n      break;\n    }\n  }\n\n  // Put gaps between ranges.\n  rangesOfPoints.forEach((rangePoints, i) => {\n    if (i !== rangesOfPoints.length - 1) {\n      // NaN points are not displayed, and result in a break in the line. A note: After this point\n      // there may be fewer tooltips than points, which we rely on above. We should do this last.\n      rangePoints.push({ x: NaN, y: NaN });\n    }\n  });\n\n  const dataset = {\n    borderColor: lineColors[index % lineColors.length],\n    label: path.value || uuid.v4(),\n    key: datasetKey,\n    showLine,\n    fill: false,\n    borderWidth: 1,\n    pointRadius: 1.5,\n    pointHoverRadius: 3,\n    pointBackgroundColor: lightColor(lineColors[index % lineColors.length]),\n    pointBorderColor: \"transparent\",\n    data: flatten(rangesOfPoints),\n  };\n  return {\n    dataset,\n    tooltips: flatten(rangesOfTooltips),\n    hasMismatchedData,\n    path: path.value,\n  };\n}\n\n// A \"reference line\" plot path is a numeric value. It creates a horizontal line on the plot at the specified value.\nfunction getAnnotationFromReferenceLine(path: PlotPath, index: number) {\n  return {\n    type: \"line\",\n    drawTime: \"beforeDatasetsDraw\",\n    scaleID: Y_AXIS_ID,\n    label: path.value,\n    borderColor: lineColors[index % lineColors.length],\n    borderDash: [5, 5],\n    borderWidth: 1,\n    mode: \"horizontal\",\n    value: Number.parseFloat(path.value),\n  };\n}\n\nexport function getDatasetsAndTooltips(\n  paths: PlotPath[],\n  itemsByPath: PlotDataByPath,\n  startTime: Time,\n  xAxisVal: PlotXAxisVal,\n  xAxisPath?: BasePlotPath\n): { datasets: DataSet[], tooltips: TimeBasedChartTooltipData[], pathsWithMismatchedDataLengths: string[] } {\n  const datasetsAndTooltips = filterMap(paths, (path: PlotPath, index: number) => {\n    const yRanges = itemsByPath[path.value];\n    const xRanges = xAxisPath && itemsByPath[xAxisPath.value];\n    if (!path.enabled) {\n      return null;\n    } else if (!isReferenceLinePlotPathType(path)) {\n      return getDatasetAndTooltipsFromMessagePlotPath(path, yRanges, index, startTime, xAxisVal, xRanges, xAxisPath);\n    }\n    return null;\n  });\n\n  return {\n    datasets: datasetsAndTooltips.map(({ dataset }) => dataset),\n    tooltips: flatten(datasetsAndTooltips.map(({ tooltips }) => tooltips)),\n    pathsWithMismatchedDataLengths: datasetsAndTooltips\n      .filter(({ hasMismatchedData }) => hasMismatchedData)\n      .map(({ path }) => path),\n  };\n}\n\nfunction getAnnotations(paths: PlotPath[]) {\n  return filterMap(paths, (path: PlotPath, index: number) => {\n    if (!path.enabled) {\n      return null;\n    } else if (isReferenceLinePlotPathType(path)) {\n      return getAnnotationFromReferenceLine(path, index);\n    }\n    return null;\n  });\n}\n\ntype PlotChartProps = {|\n  paths: PlotPath[],\n  minYValue: number,\n  maxYValue: number,\n  saveCurrentView: (minY: number, maxY: number, width: ?number) => void,\n  datasets: DataSet[],\n  tooltips: TimeBasedChartTooltipData[],\n  xAxisVal: PlotXAxisVal,\n  currentTime?: ?number,\n  defaultView: ChartDefaultView,\n  onClick?: ?(SyntheticMouseEvent<HTMLCanvasElement>, any, { [scaleId: string]: number }) => void,\n|};\nexport default memo<PlotChartProps>(function PlotChart(props: PlotChartProps) {\n  const {\n    paths,\n    currentTime,\n    defaultView,\n    minYValue,\n    maxYValue,\n    saveCurrentView,\n    datasets,\n    onClick,\n    tooltips,\n    xAxisVal,\n  } = props;\n  const annotations = useMemo(() => getAnnotations(paths), [paths]);\n  const data = useMemo(() => ({ datasets }), [datasets]);\n  const yAxes = useMemo(() => {\n    const min = isNaN(minYValue) ? undefined : minYValue;\n    const max = isNaN(maxYValue) ? undefined : maxYValue;\n    return [\n      {\n        id: Y_AXIS_ID,\n        ticks: {\n          min,\n          max,\n          precision: 3,\n        },\n        gridLines: {\n          color: \"rgba(255, 255, 255, 0.2)\",\n          zeroLineColor: \"rgba(255, 255, 255, 0.2)\",\n        },\n      },\n    ];\n  }, [maxYValue, minYValue]);\n\n  const chartRenderPath = useExperimentalFeature(\"useGLChartInPlotPanel\") ? \"webgl\" : \"chartjs\";\n\n  return (\n    <div className={styles.root}>\n      <Dimensions>\n        {({ width, height }) => (\n          <TimeBasedChart\n            // Force a redraw every time the x-axis value changes.\n            key={xAxisVal}\n            isSynced\n            zoom\n            width={width}\n            height={height}\n            data={data}\n            tooltips={tooltips}\n            annotations={annotations}\n            type=\"scatter\"\n            yAxes={yAxes}\n            saveCurrentView={saveCurrentView}\n            xAxisIsPlaybackTime={xAxisVal === \"timestamp\"}\n            scaleOptions={scaleOptions}\n            currentTime={currentTime}\n            defaultView={defaultView}\n            onClick={onClick}\n            renderPath={chartRenderPath}\n          />\n        )}\n      </Dimensions>\n    </div>\n  );\n});\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotChart.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotChart.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotChart.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Plot-PlotChart-module-2gjxk--root{width:100%;-ms-flex-positive:1;flex-grow:1;overflow:hidden}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotChart.module.scss\"],\"names\":[],\"mappings\":\"AASA,mEACE,WACA,oBAAA,YACA,eAAA,CAAA\",\"file\":\"PlotChart.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.root {\\n  width: 100%;\\n  flex-grow: 1;\\n  overflow: hidden;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"root\": \"packages-webviz-core-src-panels-Plot-PlotChart-module-2gjxk--root\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport styles from \"./TimeBasedChartTooltip.module.scss\";\nimport type { TimeBasedChartTooltipData } from \"./utils\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { formatTime } from \"webviz-core/src/util/formatTime\";\nimport { subtractTimes, toSec, formatTimeRaw } from \"webviz-core/src/util/time\";\n\ntype Props = {|\n  children: React.Element<any>,\n  tooltip: TimeBasedChartTooltipData,\n|};\nexport default class TimeBasedChartTooltip extends React.PureComponent<Props> {\n  render() {\n    const { tooltip } = this.props;\n    const value = typeof tooltip.value === \"string\" ? tooltip.value : JSON.stringify(tooltip.value);\n    const { receiveTime, headerStamp } = tooltip.item;\n    const content = (\n      <div className={styles.root}>\n        <div>\n          <span className={styles.title}>Value:&nbsp;</span>\n          {tooltip.constantName ? `${tooltip.constantName} (${value})` : value}\n        </div>\n        <div>\n          <span className={styles.title}>Path:&nbsp;</span>\n          {tooltip.path}\n        </div>\n        {tooltip.source != null && (\n          <div>\n            <span className={styles.title}>Source:&nbsp;</span>\n            {tooltip.source}\n          </div>\n        )}\n        {receiveTime && headerStamp && (\n          <table>\n            <tbody>\n              <tr>\n                <th />\n                {receiveTime && <th>receive time</th>}\n                {headerStamp && <th>header.stamp</th>}\n              </tr>\n              <tr>\n                <th>ROS</th>\n                {receiveTime && <td>{formatTimeRaw(receiveTime)}</td>}\n                {headerStamp && <td>{formatTimeRaw(headerStamp)}</td>}\n              </tr>\n              <tr>\n                <th>Time</th>\n                {receiveTime && <td>{formatTime(receiveTime)}</td>}\n                {headerStamp && <td>{formatTime(headerStamp)}</td>}\n              </tr>\n              <tr>\n                <th>Elapsed</th>\n                {receiveTime && <td>{toSec(subtractTimes(receiveTime, tooltip.startTime)).toFixed(9)} sec</td>}\n                {headerStamp && <td>{toSec(subtractTimes(headerStamp, tooltip.startTime)).toFixed(9)} sec</td>}\n              </tr>\n            </tbody>\n          </table>\n        )}\n      </div>\n    );\n\n    return (\n      <Tooltip defaultShown placement=\"top\" contents={content}>\n        {this.props.children}\n      </Tooltip>\n    );\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./TimeBasedChartTooltip.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./TimeBasedChartTooltip.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./TimeBasedChartTooltip.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root{font-family:\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace;font-size:11px;line-height:1.4;max-width:350px;overflow-wrap:break-word}.packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root th,.packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root td{border:none}.packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root th{color:#1a1a1f}.packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root th:first-child{text-align:left}.packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-3tnu1--title{color:#1a1a1f}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AASA,6FCwEE,4EDtEA,eACA,gBACA,gBACA,wBAAA,CAEA,gMAEE,WAAA,CAGF,gGACE,aEqBI,CFnBJ,4GACE,eAAA,CAKN,8FACE,aEYM,CAAA\",\"file\":\"TimeBasedChartTooltip.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.root {\\n  @include monospace;\\n  font-size: 11px;\\n  line-height: 1.4;\\n  max-width: 350px;\\n  overflow-wrap: break-word;\\n\\n  th,\\n  td {\\n    border: none;\\n  }\\n\\n  th {\\n    color: $dark2;\\n\\n    &:first-child {\\n      text-align: left;\\n    }\\n  }\\n}\\n\\n.title {\\n  color: $dark2;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"root\": \"packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root\",\n\t\"title\": \"packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-3tnu1--title\"\n};","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Mat4 } from \"gl-matrix\";\n\nimport type { Bounds } from \"./types\";\nimport { type GLContextType } from \"webviz-core/src/components/GLCanvas/GLContext\";\nimport { createShaderProgram, createBuffer, checkErrors } from \"webviz-core/src/components/GLCanvas/utils\";\n\nexport default function gridRenderer(ctx: GLContextType) {\n  const { gl } = ctx;\n\n  const program = createShaderProgram(\n    ctx,\n    `\n      precision highp float;\n\n      in vec2 position;\n\n      uniform mat4 proj;\n      uniform mat4 padding;\n\n      void main() {\n        gl_Position = padding * proj * vec4(position, 0, 1);\n      }\n    `,\n    `\n      precision highp float;\n\n      out vec4 outColor;\n\n      void main() {\n        outColor = vec4(1, 1, 1, 1);\n      }\n    `\n  );\n\n  // Buffer has a static size, but content is dynamic so we create it only once\n  // it has to be \"big enough\" for storing all posible vertices. It can be resized\n  // but we should do it only when necessary.\n  // TODO: resize buffers when needed.\n  const positionBuffer = createBuffer(ctx, new Float32Array(5000));\n\n  const positionAttribLocation = gl.getAttribLocation(program, \"position\");\n  const projUniformLocation = gl.getUniformLocation(program, \"proj\");\n  const paddingUniformLocation = gl.getUniformLocation(program, \"padding\");\n\n  const vao = gl.createVertexArray();\n  gl.bindVertexArray(vao);\n  gl.enableVertexAttribArray(positionAttribLocation);\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n  gl.vertexAttribPointer(positionAttribLocation, 2, gl.FLOAT, false, 0, 0);\n\n  const error = checkErrors(ctx);\n  if (error) {\n    console.warn(\"Error creating grid renderer:\", error);\n    return;\n  }\n\n  let primitiveCount = 0;\n  let prevBounds;\n\n  return ({ proj, bounds, padding }: { proj: Mat4, bounds: Bounds, padding: Mat4 }) => {\n    if (bounds !== prevBounds) {\n      const minX = bounds.x.min;\n      const maxX = bounds.x.max;\n      const minY = bounds.y.min;\n      const maxY = bounds.y.max;\n\n      const positions = [];\n      const xStep = (maxX - minX) / 5;\n      for (let x = minX; x <= maxX; x += xStep) {\n        positions.push(...[x, maxY, x, minY]);\n      }\n\n      const yStep = (maxY - minY) / 5;\n      for (let y = minY; y <= maxY; y += yStep) {\n        positions.push(...[minX, y, maxX, y]);\n      }\n\n      primitiveCount = positions.length / 2;\n      if (primitiveCount > 0) {\n        // Update position buffer data\n        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(positions));\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n      }\n    }\n\n    prevBounds = bounds;\n\n    if (primitiveCount === 0) {\n      return;\n    }\n\n    // Render\n    gl.useProgram(program);\n    gl.uniformMatrix4fv(projUniformLocation, true, proj);\n    gl.uniformMatrix4fv(paddingUniformLocation, true, padding);\n    gl.bindVertexArray(vao);\n    gl.drawArrays(gl.LINES, 0, primitiveCount);\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type GLContextType } from \"webviz-core/src/components/GLCanvas/GLContext\";\nimport { createShaderProgram, createBuffer, checkErrors } from \"webviz-core/src/components/GLCanvas/utils\";\n\nexport default function lineRenderer(ctx: GLContextType) {\n  const { gl } = ctx;\n\n  const program = createShaderProgram(\n    ctx,\n    `\n      precision highp float;\n\n      in vec2 inPosition;\n\n      uniform mat4 proj;\n      uniform mat4 padding;\n\n      void main() {\n        gl_Position = padding * proj * vec4(inPosition, 0, 1);\n      }\n    `,\n    `\n      precision highp float;\n\n      out vec4 outColor;\n\n      void main() {\n        outColor = vec4(0, 1, 1, 1);\n      }\n    `\n  );\n\n  // Buffer has a static size, but content is dynamic so we create it only once\n  // it has to be \"big enough\" for storing all posible vertices. It can be resized\n  // but we should do it only when necessary.\n  // TODO: resize buffers when needed.\n  const positionBuffer = createBuffer(ctx, new Float32Array(10000));\n\n  const positionAttribLocation = gl.getAttribLocation(program, \"inPosition\");\n  const projUniformLocation = gl.getUniformLocation(program, \"proj\");\n  const paddingUniformLocation = gl.getUniformLocation(program, \"padding\");\n\n  const vao = gl.createVertexArray();\n  gl.bindVertexArray(vao);\n  gl.enableVertexAttribArray(positionAttribLocation);\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n  gl.vertexAttribPointer(positionAttribLocation, 2, gl.FLOAT, false, 0, 0);\n\n  const error = checkErrors(ctx);\n  if (error) {\n    console.warn(\"Error creating point renderer:\", error);\n    return;\n  }\n\n  let primitiveCount = 0;\n  let prevData;\n\n  return ({ data, proj, padding }: any) => {\n    const { datasets } = data;\n\n    if (data !== prevData) {\n      const positions = [];\n      datasets.forEach((dataset) => {\n        if (!dataset.showLine) {\n          return;\n        }\n        dataset.data.forEach((datum) => {\n          const { x, y } = datum;\n          positions.push(x);\n          positions.push(y);\n        });\n        positions.push(NaN);\n        positions.push(NaN);\n      });\n\n      primitiveCount = positions.length / 2;\n      if (primitiveCount > 0) {\n        // Update position buffer data\n        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(positions));\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n      }\n\n      prevData = data;\n    }\n\n    if (primitiveCount === 0) {\n      return;\n    }\n\n    // Render\n    gl.useProgram(program);\n    gl.uniformMatrix4fv(projUniformLocation, true, proj);\n    gl.uniformMatrix4fv(paddingUniformLocation, true, padding);\n    gl.bindVertexArray(vao);\n    gl.lineWidth(20);\n    gl.drawArrays(gl.LINE_STRIP, 0, primitiveCount);\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type GLContextType } from \"webviz-core/src/components/GLCanvas/GLContext\";\nimport { createShaderProgram, createBuffer, checkErrors } from \"webviz-core/src/components/GLCanvas/utils\";\n\nexport default function pointRenderer(ctx: GLContextType) {\n  const { gl } = ctx;\n\n  const program = createShaderProgram(\n    ctx,\n    `\n      precision highp float;\n\n      in vec2 inPosition;\n\n      uniform mat4 proj;\n      uniform mat4 padding;\n\n      void main() {\n        gl_PointSize = 5.0;\n        gl_Position = padding * proj * vec4(inPosition, 0, 1);\n      }\n    `,\n    `\n      precision highp float;\n\n      out vec4 outColor;\n\n      void main() {\n        // Render points as circles\n        vec3 normal;\n        normal.xy = gl_PointCoord * 2.0 - 1.0;\n        float r2 = dot(normal.xy, normal.xy);\n        if (r2 > 1.0) {\n          discard;\n        }\n\n        outColor = vec4(0, 1, 0, 1);\n      }\n    `\n  );\n\n  // Buffer has a static size, but content is dynamic so we create it only once\n  // it has to be \"big enough\" for storing all posible vertices. It can be resized\n  // but we should do it only when necessary.\n  // TODO: resize buffers when needed.\n  const positionBuffer = createBuffer(ctx, new Float32Array(10000));\n\n  const positionAttribLocation = gl.getAttribLocation(program, \"inPosition\");\n  const projUniformLocation = gl.getUniformLocation(program, \"proj\");\n  const paddingUniformLocation = gl.getUniformLocation(program, \"padding\");\n\n  const vao = gl.createVertexArray();\n  gl.bindVertexArray(vao);\n  gl.enableVertexAttribArray(positionAttribLocation);\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n  gl.vertexAttribPointer(positionAttribLocation, 2, gl.FLOAT, false, 0, 0);\n\n  const error = checkErrors(ctx);\n  if (error) {\n    console.warn(\"Error creating point renderer:\", error);\n    return;\n  }\n\n  let primitiveCount = 0;\n  let prevData;\n\n  return ({ data, proj, padding }: any) => {\n    const { datasets } = data;\n\n    if (data !== prevData) {\n      const positions = [];\n      datasets.forEach((dataset) => {\n        if (!dataset.pointBackgroundColor) {\n          return;\n        }\n        dataset.data.forEach((datum) => {\n          const { x, y } = datum;\n          positions.push(x);\n          positions.push(y);\n        });\n      });\n\n      primitiveCount = positions.length / 2;\n\n      if (primitiveCount > 0) {\n        // Update position buffer data\n        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(positions));\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n      }\n\n      prevData = data;\n    }\n\n    if (primitiveCount === 0) {\n      return;\n    }\n\n    // Render\n    gl.useProgram(program);\n    gl.uniformMatrix4fv(projUniformLocation, true, proj);\n    gl.uniformMatrix4fv(paddingUniformLocation, true, padding);\n    gl.bindVertexArray(vao);\n    gl.drawArrays(gl.POINTS, 0, primitiveCount);\n  };\n}\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"ChartJSWorker.worker.js?70a07f79336c82f68bac\");\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type Rpc from \"webviz-core/src/util/Rpc\";\n\nclass FakeRpc {\n  proxiedWorker: FakeRpc;\n  handlers: { [string]: (any) => any } = {};\n\n  async send<TResult>(topic: string, data: any, _transfer?: any[]): Promise<TResult> {\n    return this.proxiedWorker.handlers[topic](data);\n  }\n\n  async receive<T, TOut>(topic: string, handler: (T) => TOut) {\n    if (this.handlers[topic]) {\n      throw new Error(`Cannot call receive twice for topic: ${topic}`);\n    }\n    this.handlers[topic] = handler;\n  }\n}\n\nexport function getFakeRpcs() {\n  const workerRpc = new FakeRpc();\n  const mainThreadRpc = new FakeRpc();\n  workerRpc.proxiedWorker = mainThreadRpc;\n  mainThreadRpc.proxiedWorker = workerRpc;\n  return { workerRpc, mainThreadRpc };\n}\n\nexport type RpcLike = Rpc | FakeRpc;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport React from \"react\";\n\nimport { PLOT_DASHED_STYLE, PLOT_DOT_DASHED_STYLE } from \"webviz-core/src/components/TimeBasedChart/constants\";\n\n// This type describes our use, but chart.js supports many more properties if we want them:\n// https://www.chartjs.org/docs/latest/charts/line.html#dataset-properties\ntype Dataset = $ReadOnly<{ label: string, color?: string, borderDash?: $ReadOnlyArray<number> }>;\n\ntype Props = {\n  canToggleLines?: boolean,\n  datasets: $ReadOnlyArray<Dataset>,\n  linesToHide: ?{ [string]: boolean },\n  toggleLine: (datasetId: string | typeof undefined, lineToHide: string) => void,\n  datasetId?: string,\n};\n\nconst checkboxStyle = { height: 12, marginBottom: -2 };\n\nexport default class TimeBasedChartLegend extends React.PureComponent<Props> {\n  _toggleLine = (label: string) => () => {\n    const { datasetId, toggleLine } = this.props;\n    toggleLine(datasetId, label);\n  };\n\n  render() {\n    const { canToggleLines } = this.props;\n    const linesToHide = this.props.linesToHide || {};\n    return (\n      <div>\n        {this.props.datasets.map((dataset, i) => {\n          const { label, color, borderDash } = dataset;\n          let pointSvg;\n          if (borderDash === PLOT_DOT_DASHED_STYLE) {\n            pointSvg = (\n              <svg width=\"11\" height=\"10\">\n                <line\n                  stroke={color}\n                  strokeWidth=\"2\"\n                  strokeDasharray={PLOT_DOT_DASHED_STYLE.join(\", \")}\n                  x1=\"0\"\n                  x2=\"18\"\n                  y1=\"6\"\n                  y2=\"6\"\n                />\n              </svg>\n            );\n          } else if (borderDash === PLOT_DASHED_STYLE) {\n            pointSvg = <span style={{ fontSize: \"12px\", fontWeight: \"bold\" }}>- -</span>;\n          } else {\n            pointSvg = <span style={{ fontSize: \"12px\", fontWeight: \"bold\" }}></span>;\n          }\n          const CheckboxComponent = linesToHide[label] ? CheckboxBlankOutlineIcon : CheckboxMarkedIcon;\n          return (\n            <div key={i} style={{ color, fill: \"white\", whiteSpace: \"nowrap\" }}>\n              {canToggleLines && <CheckboxComponent style={checkboxStyle} onClick={this._toggleLine(label)} />}\n              {pointSvg} <span style={{ fontSize: \"10px\" }}>{label}</span>\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport const PLOT_DASHED_STYLE = [5, 5];\nexport const PLOT_DOT_DASHED_STYLE = [3, 2, 1, 2];\n","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\", {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"file\":\"mixins.module.scss\",\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type TimeBasedChartTooltipData } from \"webviz-core/src/components/TimeBasedChart/utils\";\nimport type { PlotChartPoint } from \"webviz-core/src/panels/Plot/PlotChart\";\nimport {\n  METERS_PER_SECOND_TO_KILOMETERS_PER_HOUR,\n  METERS_PER_SECOND_TO_MILES_PER_HOUR,\n  MILES_PER_HOUR_TO_METERS_PER_SECOND,\n  MILES_PER_HOUR_TO_KILOMETERS_PER_HOUR,\n} from \"webviz-core/src/util/globalConstants\";\n\nexport function derivative(\n  data: PlotChartPoint[],\n  tooltips: TimeBasedChartTooltipData[]\n): { points: PlotChartPoint[], tooltips: TimeBasedChartTooltipData[] } {\n  const points = [];\n  const newTooltips = [];\n  for (let i = 1; i < data.length; i++) {\n    const secondsDifference = data[i].x - data[i - 1].x;\n    const value = (data[i].y - data[i - 1].y) / secondsDifference;\n    const previousTooltip = tooltips[i];\n    const point: PlotChartPoint = { x: data[i].x, y: value };\n    const tooltip = {\n      x: point.x,\n      y: point.y,\n      item: previousTooltip.item,\n      path: `${previousTooltip.path}.@derivative`,\n      datasetKey: previousTooltip.datasetKey,\n      value,\n      constantName: undefined,\n      startTime: previousTooltip.startTime,\n    };\n    newTooltips.push(tooltip);\n    points.push(point);\n  }\n  return { points, tooltips: newTooltips };\n}\n\nexport const mathFunctions = {\n  abs: Math.abs,\n  acos: Math.acos,\n  asin: Math.asin,\n  atan: Math.atan,\n  ceil: Math.ceil,\n  cos: Math.cos,\n  log: Math.log,\n  log1p: Math.log1p,\n  log2: Math.log2,\n  log10: Math.log10,\n  round: Math.round,\n  sign: Math.sign,\n  sin: Math.sin,\n  sqrt: Math.sqrt,\n  tan: Math.tan,\n  trunc: Math.trunc,\n  negative: (value: number) => -value,\n  deg2rad: (degrees: number) => degrees * (Math.PI / 180),\n  rad2deg: (radians: number) => radians * (180 / Math.PI),\n  mps2kph: (metersPerSecond: number) => metersPerSecond * METERS_PER_SECOND_TO_KILOMETERS_PER_HOUR,\n  kph2mps: (kmPerHour: number) => kmPerHour / METERS_PER_SECOND_TO_KILOMETERS_PER_HOUR,\n  mps2mph: (metersPerSecond: number) => metersPerSecond * METERS_PER_SECOND_TO_MILES_PER_HOUR,\n  mph2mps: (milesPerHour: number) => milesPerHour * MILES_PER_HOUR_TO_METERS_PER_SECOND,\n  mph2kph: (milesPerHour: number) => milesPerHour * MILES_PER_HOUR_TO_KILOMETERS_PER_HOUR,\n  kph2mph: (kmPerHour: number) => kmPerHour / MILES_PER_HOUR_TO_KILOMETERS_PER_HOUR,\n};\n\n// Apply a function to the y-value of the data or tooltips passed in.\nexport function applyToDataOrTooltips<T>(dataOrTooltips: T[], func: (number) => number): T[] {\n  return dataOrTooltips.map((item) => {\n    // $FlowFixMe\n    let y: number | string = item.y;\n    const numericYValue: number = Number(y);\n    // Only apply the function if the Y value is a valid number.\n    if (!isNaN(numericYValue)) {\n      y = func(numericYValue);\n    }\n    return { ...item, y };\n  });\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport AlertCircleIcon from \"@mdi/svg/svg/alert-circle.svg\";\nimport MenuIcon from \"@mdi/svg/svg/menu.svg\";\nimport cx from \"classnames\";\nimport { last } from \"lodash\";\nimport React, { useCallback, useMemo } from \"react\";\n\nimport { plotableRosTypes, type PlotConfig, type PlotXAxisVal } from \"./index\";\nimport styles from \"./PlotLegend.module.scss\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport {\n  type PlotPath,\n  type BasePlotPath,\n  isReferenceLinePlotPathType,\n} from \"webviz-core/src/panels/Plot/internalTypes\";\nimport { lineColors } from \"webviz-core/src/util/plotColors\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\n\ntype PlotLegendProps = {|\n  paths: PlotPath[],\n  saveConfig: ($Shape<PlotConfig>) => void,\n  showLegend: boolean,\n  xAxisVal: PlotXAxisVal,\n  xAxisPath?: BasePlotPath,\n  pathsWithMismatchedDataLengths: string[],\n|};\n\nconst shortXAxisLabel = (path: PlotXAxisVal): string => {\n  switch (path) {\n    case \"custom\":\n      return \"path (accum)\";\n    case \"index\":\n      return \"index\";\n    case \"currentCustom\":\n      return \"path (current)\";\n    case \"timestamp\":\n      return \"timestamp\";\n    default:\n      (path: empty); // Assert the switch is exhaustive\n      throw new Error(\"Satisfy flow\");\n  }\n};\n\nexport default function PlotLegend(props: PlotLegendProps) {\n  const { paths, saveConfig, showLegend, xAxisVal, xAxisPath, pathsWithMismatchedDataLengths } = props;\n  const lastPath = last(paths);\n\n  const onInputChange = useCallback((value: string, index: ?number) => {\n    if (index == null) {\n      throw new Error(\"index not set\");\n    }\n    const newPaths = paths.slice();\n    newPaths[index] = { ...newPaths[index], value: value.trim() };\n    saveConfig({ paths: newPaths });\n  }, [paths, saveConfig]);\n\n  const onInputTimestampMethodChange = useCallback((value: TimestampMethod, index: ?number) => {\n    if (index == null) {\n      throw new Error(\"index not set\");\n    }\n    const newPaths = paths.slice();\n    newPaths[index] = { ...newPaths[index], timestampMethod: value };\n    saveConfig({ paths: newPaths });\n  }, [paths, saveConfig]);\n\n  const { toggleToHideLegend, toggleToShowLegend } = useMemo(\n    () => ({\n      toggleToHideLegend: () => saveConfig({ showLegend: false }),\n      toggleToShowLegend: () => saveConfig({ showLegend: true }),\n    }),\n    [saveConfig]\n  );\n\n  if (!showLegend) {\n    return (\n      <div className={styles.root}>\n        <Icon className={styles.legendToggle} onClick={toggleToShowLegend}>\n          <MenuIcon />\n        </Icon>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.root}>\n      <Icon className={styles.legendToggle} onClick={toggleToHideLegend}>\n        <MenuIcon />\n      </Icon>\n      <div className={styles.item}>\n        x:\n        <div className={styles.itemIconContainer} style={{ width: \"auto\", lineHeight: \"normal\", zIndex: 2 }}>\n          <Dropdown\n            dataTest=\"plot-legend-x-axis-menu\"\n            value={xAxisVal}\n            text={shortXAxisLabel(xAxisVal)}\n            btnStyle={{ backgroundColor: \"transparent\", padding: 3 }}\n            onChange={(newXAxisVal) => saveConfig({ xAxisVal: newXAxisVal })}\n            noPortal>\n            <span value=\"timestamp\">timestamp</span>\n            <span value=\"index\">index</span>\n            <span value=\"currentCustom\">msg path (current)</span>\n            <span value=\"custom\">msg path (accumulated)</span>\n          </Dropdown>\n        </div>\n        <div\n          className={cx({\n            [styles.itemInput]: true,\n            [styles.itemInputDisabled]: !xAxisPath?.enabled,\n          })}>\n          {xAxisVal === \"custom\" || xAxisVal === \"currentCustom\" ? (\n            <MessagePathInput\n              path={xAxisPath?.value || \"/\"}\n              onChange={(newXAxisPath) =>\n                saveConfig({ xAxisPath: { value: newXAxisPath, enabled: xAxisPath ? xAxisPath.enabled : true } })\n              }\n              validTypes={plotableRosTypes}\n              placeholder=\"Enter a topic name or a number\"\n              disableAutocomplete={xAxisPath && isReferenceLinePlotPathType(xAxisPath)}\n              autoSize\n            />\n          ) : null}\n        </div>\n      </div>\n      {paths.map((path: PlotPath, index: number) => {\n        const isReferenceLinePlotPath = isReferenceLinePlotPathType(path);\n        let timestampMethod;\n        // Only allow chosing the timestamp method if it is applicable (not a reference line) and there is at least\n        // one character typed.\n        if (!isReferenceLinePlotPath && path.value.length > 0) {\n          timestampMethod = path.timestampMethod;\n        }\n        const hasMismatchedDataLength = pathsWithMismatchedDataLengths.includes(path.value);\n\n        return (\n          <React.Fragment key={index}>\n            <div className={styles.item}>\n              y:\n              <div\n                className={styles.itemIconContainer}\n                style={{ zIndex: 1 }}\n                onClick={() => {\n                  const newPaths = paths.slice();\n                  newPaths[index] = { ...newPaths[index], enabled: !newPaths[index].enabled };\n                  saveConfig({ paths: newPaths });\n                }}>\n                <div\n                  className={styles.itemIcon}\n                  style={{ color: path.enabled ? lineColors[index % lineColors.length] : \"#777\" }}\n                />\n              </div>\n              <div\n                className={cx({\n                  [styles.itemInput]: true,\n                  [styles.itemInputDisabled]: !path.enabled,\n                })}>\n                <MessagePathInput\n                  path={path.value}\n                  onChange={onInputChange}\n                  onTimestampMethodChange={onInputTimestampMethodChange}\n                  validTypes={plotableRosTypes}\n                  placeholder=\"Enter a topic name or a number\"\n                  index={index}\n                  autoSize\n                  disableAutocomplete={isReferenceLinePlotPath}\n                  {...(xAxisVal === \"timestamp\" ? { timestampMethod } : null)}\n                />\n                {hasMismatchedDataLength && (\n                  <Icon\n                    style={{ color: colors.RED }}\n                    clickable={false}\n                    small\n                    tooltipProps={{ placement: \"top\" }}\n                    tooltip=\"Mismatch in the number of elements in x-axis and y-axis messages\">\n                    <AlertCircleIcon />\n                  </Icon>\n                )}\n              </div>\n              <div\n                className={styles.itemRemove}\n                onClick={() => {\n                  const newPaths = paths.slice();\n                  newPaths.splice(index, 1);\n                  saveConfig({ paths: newPaths });\n                }}>\n                \n              </div>\n            </div>\n          </React.Fragment>\n        );\n      })}\n      <div\n        className={styles.addLine}\n        onClick={() =>\n          saveConfig({\n            paths: [\n              ...paths,\n              {\n                value: \"\",\n                enabled: true,\n                // For convenience, default to the `timestampMethod` of the last path.\n                timestampMethod: lastPath ? lastPath.timestampMethod : \"receiveTime\",\n              },\n            ],\n          })\n        }>\n        + add line\n      </div>\n    </div>\n  );\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotLegend.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotLegend.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotLegend.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root{position:absolute;left:65px;top:25px;background:rgba(36,36,41,.7);color:#eee;max-width:calc(100% - 65px - 25px)}.packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root:hover{background:rgba(36,36,41,.7)}.packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine{display:none;content:\\\"+ add line\\\";position:absolute;background:rgba(36,36,41,.7);left:0;right:0;bottom:0;-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);padding:6px;cursor:pointer;text-align:center}.packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine:hover{background:#37373f}.packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root:hover .packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine{display:block}.packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item{display:-ms-flexbox;display:flex;padding:0 5px;height:20px;line-height:20px;position:relative}.packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item:hover{background:#37373f}.packages-webviz-core-src-panels-Plot-PlotLegend-module-3zckg--itemIconContainer{display:inline-block;width:22px;height:20px;line-height:0;cursor:pointer;-ms-flex-negative:0;flex-shrink:0}.packages-webviz-core-src-panels-Plot-PlotLegend-module-3zckg--itemIconContainer:hover{background:#4d4d57}.packages-webviz-core-src-panels-Plot-PlotLegend-module-4k2d2--itemIcon{display:inline-block;width:15px;border-bottom:2px solid currentColor;height:0px;vertical-align:middle;position:relative;top:calc(50% - 1px)}.packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle{visibility:hidden;padding:6px;cursor:pointer;position:absolute;top:0;left:-30px;height:25px;border-radius:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:#37373f}.packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle:hover{background:#37373f}.mosaic-window:hover .packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle{visibility:initial}.packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove{visibility:hidden;padding:0 6px;cursor:pointer;position:absolute;right:-21px;background:transparent;height:20px;line-height:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove:hover{background:#37373f}.packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item:hover .packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove{visibility:initial}.packages-webviz-core-src-panels-Plot-PlotLegend-module-22dxt--itemInput{overflow:hidden;width:100%;display:-ms-flexbox;display:flex}.packages-webviz-core-src-panels-Plot-PlotLegend-module-3fhwe--itemInputDisabled input{text-decoration:line-through}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotLegend.module.scss\"],\"names\":[],\"mappings\":\"AAaA,oEAEE,kBACA,UACA,SACA,6BACA,WACA,kCAAA,CAEA,0EACE,4BAfqB,CAmBzB,uEACE,aACA,qBACA,kBACA,6BACA,OACA,QACA,SACA,mCAAA,+BAAA,2BACA,YACA,eACA,iBAAA,CAEA,6EACE,kBAhC4B,CAmC9B,iJACE,aAAA,CAIJ,oEACE,oBAAA,aACA,cACA,YACA,iBACA,iBAAA,CAEA,0EACE,kBAhD4B,CAoDhC,iFACE,qBACA,WACA,YACA,cACA,eACA,oBAAA,aAAA,CAEA,uFACE,kBA5D8B,CAgElC,wEACE,qBACA,WACA,qCACA,WACA,sBACA,kBACA,mBAAA,CAGF,4EACE,kBACA,YACA,eACA,kBACA,MACA,WACA,YACA,kBACA,yBAAA,sBAAA,qBAAA,iBACA,kBArF8B,CAuF9B,kFACE,kBAxF4B,CA2F9B,iGACE,kBAAA,CAIJ,0EACE,kBACA,cACA,eACA,kBACA,YACA,uBACA,YACA,iBACA,yBAAA,sBAAA,qBAAA,gBAAA,CAEA,gFACE,kBA5G4B,CA+G9B,oJACE,kBAAA,CAIJ,yEACE,gBACA,WACA,oBAAA,YAAA,CAKF,uFACE,4BAAA,CAAA\",\"file\":\"PlotLegend.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n$legend-highlight-color: rgba($dark3, 0.7);\\n$legend-highlight-color-bright: lighten(rgba($legend-highlight-color, 1), 8%);\\n$legend-highlight-color-brighter: lighten(rgba($legend-highlight-color, 1), 17%);\\n$legend-item-height: 20px;\\n\\n.root {\\n  $legend-root-left: 65px;\\n  position: absolute;\\n  left: $legend-root-left;\\n  top: 25px;\\n  background: $legend-highlight-color;\\n  color: #eee;\\n  max-width: calc(100% - #{$legend-root-left} - 25px); // Leave some space at the end for the \\\"X\\\".\\n\\n  &:hover {\\n    background: $legend-highlight-color;\\n  }\\n}\\n\\n.addLine {\\n  display: none;\\n  content: \\\"+ add line\\\";\\n  position: absolute;\\n  background: $legend-highlight-color;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  transform: translateY(100%);\\n  padding: 6px;\\n  cursor: pointer;\\n  text-align: center;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n\\n  .root:hover & {\\n    display: block;\\n  }\\n}\\n\\n.item {\\n  display: flex;\\n  padding: 0 5px;\\n  height: $legend-item-height;\\n  line-height: $legend-item-height;\\n  position: relative;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n}\\n\\n.itemIconContainer {\\n  display: inline-block;\\n  width: 22px;\\n  height: $legend-item-height;\\n  line-height: 0;\\n  cursor: pointer;\\n  flex-shrink: 0;\\n\\n  &:hover {\\n    background: $legend-highlight-color-brighter;\\n  }\\n}\\n\\n.itemIcon {\\n  display: inline-block;\\n  width: 15px;\\n  border-bottom: 2px solid currentColor;\\n  height: 0px;\\n  vertical-align: middle;\\n  position: relative;\\n  top: calc(50% - 1px);\\n}\\n\\n.legendToggle {\\n  visibility: hidden;\\n  padding: 6px;\\n  cursor: pointer;\\n  position: absolute;\\n  top: 0;\\n  left: -30px;\\n  height: 25px;\\n  border-radius: 5px;\\n  user-select: none;\\n  background: $legend-highlight-color-bright;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n\\n  :global(.mosaic-window):hover & {\\n    visibility: initial;\\n  }\\n}\\n\\n.itemRemove {\\n  visibility: hidden;\\n  padding: 0 6px;\\n  cursor: pointer;\\n  position: absolute;\\n  right: -21px;\\n  background: transparent;\\n  height: $legend-item-height;\\n  line-height: $legend-item-height;\\n  user-select: none;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n\\n  .item:hover & {\\n    visibility: initial;\\n  }\\n}\\n\\n.itemInput {\\n  overflow: hidden;\\n  width: 100%;\\n  display: flex;\\n}\\n\\n// <input> is several levels deeper, and there's not too much chance\\n// of leaking stuff here, so not using `>`.\\n.itemInputDisabled input {\\n  text-decoration: line-through;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"root\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root\",\n\t\"addLine\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine\",\n\t\"item\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item\",\n\t\"itemIconContainer\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-3zckg--itemIconContainer\",\n\t\"itemIcon\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-4k2d2--itemIcon\",\n\t\"legendToggle\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle\",\n\t\"itemRemove\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove\",\n\t\"itemInput\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-22dxt--itemInput\",\n\t\"itemInputDisabled\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-3fhwe--itemInputDisabled\"\n};","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./MessagePathInput.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./MessagePathInput.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./MessagePathInput.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3verb--timestampMethodDropdownContainer{-ms-flex-negative:100;flex-shrink:100;min-width:20px;white-space:nowrap}.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown{cursor:pointer;padding-left:2px;color:rgba(247,247,243,.3)}.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3v61x--timestampMethodDropdownError{color:#ff7c96}.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown:hover{color:rgba(247,247,243,.77)}.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3nvnu--timestampItemError{color:#ff7c96}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA,uHACE,sBAAA,gBACA,eACA,kBAAA,CAGF,8GACE,eACA,iBACA,0BCHW,CDKX,gOACE,aCkBE,CDfJ,oHACE,2BCZU,CDgBd,yGACE,aCSI,CAAA\",\"file\":\"MessagePathInput.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.timestampMethodDropdownContainer {\\n  flex-shrink: 100;\\n  min-width: 20px;\\n  white-space: nowrap;\\n}\\n\\n.timestampMethodDropdown {\\n  cursor: pointer;\\n  padding-left: 2px;\\n  color: $text-muted;\\n\\n  &.timestampMethodDropdownError {\\n    color: $red;\\n  }\\n\\n  &:hover {\\n    color: $text-normal;\\n  }\\n}\\n\\n.timestampItemError {\\n  color: $red;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"timestampMethodDropdownContainer\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3verb--timestampMethodDropdownContainer\",\n\t\"timestampMethodDropdown\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown\",\n\t\"timestampMethodDropdownError\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3v61x--timestampMethodDropdownError\",\n\t\"timestampItemError\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3nvnu--timestampItemError\"\n};","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Autocomplete.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Autocomplete.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Autocomplete.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-Autocomplete-module-4nh6c--root{border-radius:3px;border-top-left-radius:0;-webkit-box-shadow:0 2px 12px rgba(0,0,0,.1);box-shadow:0 2px 12px rgba(0,0,0,.1);position:fixed;overflow:auto;background:#242429;z-index:1;margin-left:-6px}.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input{-ms-flex-positive:1;flex-grow:1;margin:0;padding:0;background:transparent !important;color:inherit;border-radius:0}.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input::-webkit-input-placeholder{color:rgba(247,247,243,.3)}.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input:-ms-input-placeholder{color:rgba(247,247,243,.3)}.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input::-ms-input-placeholder{color:rgba(247,247,243,.3)}.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input::placeholder{color:rgba(247,247,243,.3)}.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input.packages-webviz-core-src-components-Autocomplete-module-4pjf2--placeholder{color:rgba(247,247,243,.3)}.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input.packages-webviz-core-src-components-Autocomplete-module-ucccr--inputError{color:#ff7c96}.packages-webviz-core-src-components-Autocomplete-module-2jjcu--autocompleteItem{padding:6px;cursor:pointer;min-height:24px;line-height:14px;overflow-wrap:break-word;color:rgba(247,247,243,.77)}.packages-webviz-core-src-components-Autocomplete-module-teqbe--selected{background-color:#36363d}.packages-webviz-core-src-components-Autocomplete-module-3m69w--highlighted{background-color:#2d2d33}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/Autocomplete.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAUA,qEACE,kBACA,yBACA,6CAAA,qCACA,eACA,cACA,mBACA,UACA,gBAAA,CAGF,sEACE,oBAAA,YACA,SACA,UACA,kCACA,cACA,eAAA,CAEA,iGACE,0BChBS,CDeX,4FACE,0BChBS,CDeX,6FACE,0BChBS,CDeX,mFACE,0BChBS,CDoBX,iJACE,0BCrBS,CDwBX,gJACE,aCDE,CDKN,iFACE,YACA,eACA,gBACA,iBACA,yBACA,2BCrCY,CDwCd,yEACE,wBCPM,CDSR,4EACE,wBCXM,CDcR\",\"file\":\"Autocomplete.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n$row-height: 24px;\\n\\n.root {\\n  border-radius: 3px;\\n  border-top-left-radius: 0;\\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\\n  position: fixed;\\n  overflow: auto;\\n  background: $dark3;\\n  z-index: 1;\\n  margin-left: -6px;\\n}\\n\\n.input {\\n  flex-grow: 1;\\n  margin: 0;\\n  padding: 0;\\n  background: transparent !important;\\n  color: inherit;\\n  border-radius: 0;\\n\\n  &::placeholder {\\n    color: $text-muted;\\n  }\\n\\n  // Add this because the placeholder selector doesn't seem well supported by screenshots.\\n  &.placeholder {\\n    color: $text-muted;\\n  }\\n\\n  &.inputError {\\n    color: $red;\\n  }\\n}\\n\\n.autocompleteItem {\\n  padding: 6px;\\n  cursor: pointer;\\n  min-height: $row-height;\\n  line-height: $row-height - 10px;\\n  overflow-wrap: break-word;\\n  color: $text-normal;\\n}\\n\\n.selected {\\n  background-color: $dark5;\\n}\\n.highlighted {\\n  background-color: $dark4;\\n}\\n\\n:export {\\n  rowHeight: $row-height / 1px;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"rowHeight\": \"24\",\n\t\"root\": \"packages-webviz-core-src-components-Autocomplete-module-4nh6c--root\",\n\t\"input\": \"packages-webviz-core-src-components-Autocomplete-module-4p3nz--input\",\n\t\"placeholder\": \"packages-webviz-core-src-components-Autocomplete-module-4pjf2--placeholder\",\n\t\"inputError\": \"packages-webviz-core-src-components-Autocomplete-module-ucccr--inputError\",\n\t\"autocompleteItem\": \"packages-webviz-core-src-components-Autocomplete-module-2jjcu--autocompleteItem\",\n\t\"selected\": \"packages-webviz-core-src-components-Autocomplete-module-teqbe--selected\",\n\t\"highlighted\": \"packages-webviz-core-src-components-Autocomplete-module-3m69w--highlighted\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport cx from \"classnames\";\nimport React, { memo, useMemo } from \"react\";\nimport styled from \"styled-components\";\n\nimport styles from \"./PlotMenu.module.scss\";\nimport { PanelToolbarInput } from \"webviz-core/shared/panelToolbarStyles\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport { type TimeBasedChartTooltipData } from \"webviz-core/src/components/TimeBasedChart/utils\";\nimport type { PlotConfig, PlotXAxisVal } from \"webviz-core/src/panels/Plot\";\nimport { type DataSet, type PlotChartPoint } from \"webviz-core/src/panels/Plot/PlotChart\";\nimport { downloadFiles } from \"webviz-core/src/util\";\nimport { formatTimeRaw } from \"webviz-core/src/util/time\";\n\nconst SLabel = styled.div`\n  flex-grow: 1;\n`;\n\nconst SFlexRow = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n`;\n\nconst SButton = styled.button`\n  width: calc(100% - 0.2em);\n`;\n\nfunction isValidInput(value: string) {\n  return value === \"\" || !isNaN(parseFloat(value));\n}\n\nfunction isValidWidth(value: string) {\n  return value === \"\" || parseFloat(value) > 0;\n}\n\nfunction formatData(\n  data: PlotChartPoint,\n  dataIndex: number,\n  label: string,\n  datasetKey: string,\n  tooltips: TimeBasedChartTooltipData[]\n) {\n  const { x, y } = data;\n  const tooltip = tooltips.find((_tooltip) => _tooltip.datasetKey === datasetKey);\n  if (!tooltip) {\n    throw new Error(\"Cannot find tooltip for dataset: this should never happen\");\n  }\n  const { receiveTime, headerStamp } = tooltip.item;\n  const receiveTimeFloat = formatTimeRaw(receiveTime);\n  const stampTime = headerStamp ? formatTimeRaw(headerStamp) : \"\";\n  return [x, receiveTimeFloat, stampTime, label, y];\n}\n\nconst xAxisCsvColumnName = (xAxisVal: PlotXAxisVal): string =>\n  ({\n    timestamp: \"elapsed time\",\n    index: \"index\",\n    custom: \"x value\",\n    currentCustom: \"x value\",\n  }[xAxisVal]);\n\nexport function getCSVData(datasets: DataSet[], tooltips: TimeBasedChartTooltipData[], xAxisVal: PlotXAxisVal): string {\n  const headLine = [xAxisCsvColumnName(xAxisVal), \"receive time\", \"header.stamp\", \"topic\", \"value\"];\n  const combinedLines = [];\n  combinedLines.push(headLine);\n  datasets.forEach((dataset) => {\n    dataset.data.forEach((data, dataIndex) => {\n      combinedLines.push(formatData(data, dataIndex, dataset.label, dataset.key, tooltips));\n    });\n  });\n  return combinedLines.join(\"\\n\");\n}\n\nfunction downloadCsvFile(datasets: DataSet[], tooltips: TimeBasedChartTooltipData[], xAxisVal: PlotXAxisVal) {\n  const csv = getCSVData(datasets, tooltips, xAxisVal);\n  const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\n  downloadFiles([{ blob, fileName: `plot_data_export.csv` }]);\n}\n\ntype Props = {|\n  displayWidth: string,\n  minYValue: string,\n  maxYValue: string,\n  saveConfig: ($Shape<PlotConfig>) => void,\n  setMinMax: ($Shape<PlotConfig>) => void,\n  setWidth: ($Shape<PlotConfig>) => void,\n  getDatasets: () => DataSet[],\n  getTooltips: () => TimeBasedChartTooltipData[],\n  xAxisVal: PlotXAxisVal,\n|};\n\nexport default memo<Props>(function PlotMenu({\n  displayWidth,\n  minYValue,\n  maxYValue,\n  saveConfig,\n  setMinMax,\n  setWidth,\n  xAxisVal,\n  getDatasets,\n  getTooltips,\n}: Props) {\n  return useMemo(() => {\n    const followWidthItem =\n      xAxisVal === \"timestamp\" ? (\n        <>\n          <Item onClick={() => saveConfig({ followingViewWidth: \"\" })} tooltip=\"Plot width in sec\">\n            <SFlexRow>\n              <SLabel>X range</SLabel>\n              <PanelToolbarInput\n                type=\"number\"\n                className={cx(styles.input, { [styles.inputError]: !isValidWidth(displayWidth) })}\n                value={displayWidth}\n                onChange={({ target: { value } }) => {\n                  const isZero = parseFloat(value) === 0;\n                  saveConfig({ followingViewWidth: isZero ? \"\" : value });\n                }}\n                min=\"0\"\n                onClick={(event) => event.stopPropagation()}\n                placeholder=\"auto\"\n              />\n            </SFlexRow>\n          </Item>\n          <Item>\n            <SButton onClick={setWidth}>Set to current view</SButton>\n          </Item>\n        </>\n      ) : null;\n    return (\n      <>\n        <Item\n          onClick={() => {\n            downloadCsvFile(getDatasets(), getTooltips(), xAxisVal);\n          }}>\n          Download plot data (csv)\n        </Item>\n        <hr />\n        <Item isHeader>Zoom extents</Item>\n        <Item onClick={() => saveConfig({ maxYValue: maxYValue === \"\" ? \"10\" : \"\" })} tooltip=\"Maximum y-axis value\">\n          <SFlexRow>\n            <SLabel>Y max</SLabel>\n            <PanelToolbarInput\n              type=\"number\"\n              className={cx(styles.input, { [styles.inputError]: !isValidInput(maxYValue) })}\n              value={maxYValue}\n              onChange={(event) => {\n                saveConfig({ maxYValue: event.target.value });\n              }}\n              onClick={(event) => event.stopPropagation()}\n              placeholder=\"auto\"\n            />\n          </SFlexRow>\n        </Item>\n        <Item onClick={() => saveConfig({ minYValue: minYValue === \"\" ? \"-10\" : \"\" })} tooltip=\"Minimum y-axis value\">\n          <SFlexRow>\n            <SLabel>Y min</SLabel>\n            <PanelToolbarInput\n              type=\"number\"\n              className={cx(styles.input, { [styles.inputError]: !isValidInput(minYValue) })}\n              value={minYValue}\n              onChange={(event) => {\n                saveConfig({ minYValue: event.target.value });\n              }}\n              onClick={(event) => event.stopPropagation()}\n              placeholder=\"auto\"\n            />\n          </SFlexRow>\n        </Item>\n        <Item>\n          <SButton onClick={setMinMax}>Set to current view</SButton>\n        </Item>\n        {followWidthItem}\n      </>\n    );\n  }, [xAxisVal, displayWidth, setWidth, maxYValue, minYValue, setMinMax, saveConfig, getDatasets, getTooltips]);\n});\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotMenu.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotMenu.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./PlotMenu.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Plot-PlotMenu-module-9hz5y--input{width:70px;height:28px;margin-top:-4px;margin-bottom:-4px}.packages-webviz-core-src-panels-Plot-PlotMenu-module-2hqz8--inputError{color:#ff7c96}.packages-webviz-core-src-panels-Plot-PlotMenu-module-427rj--lockItem{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between}.packages-webviz-core-src-panels-Plot-PlotMenu-module-264qh--lockIcon{fill:currentColor}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Plot/PlotMenu.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA,mEACE,WACA,YACA,gBACA,kBAAA,CAGF,wEACE,aCsBI,CDnBN,sEACE,oBAAA,aACA,sBAAA,mBACA,sBAAA,6BAAA,CAGF,sEACE,iBAAA,CAAA\",\"file\":\"PlotMenu.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.input {\\n  width: 70px;\\n  height: 28px;\\n  margin-top: -4px;\\n  margin-bottom: -4px;\\n}\\n\\n.inputError {\\n  color: $red;\\n}\\n\\n.lockItem {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n}\\n\\n.lockIcon {\\n  fill: currentColor;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"input\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-9hz5y--input\",\n\t\"inputError\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-2hqz8--inputError\",\n\t\"lockItem\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-427rj--lockItem\",\n\t\"lockIcon\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-264qh--lockIcon\"\n};","module.exports = \"# State Transitions\\n\\nShows when values change. Can be used for any primitive value, but is most useful for \\\"enums\\\" (even though ROS does not have that as a formal concept). If you put constants in your ROS message definition, those constant names will be shown. You can only have one \\\"enum\\\" per message definition, otherwise we don't know which constant name to show (if there are multiple matches).\\n\\nThe values plotted are specified through Webviz's [message path syntax](/help/message-path-syntax).\\n\\nYou can zoom by scrolling, and pan by dragging. Double-click to reset.\\n\\nColors are hard-coded for the default paths. If you use a different path, you get some default colors. Please contact the Webviz team if you want more custom colors.\\n\"","module.exports = \"# Diagnostics - Detail\\n\\nDisplays diagnostics data for a given diagnostic name/hardware_id.  Select a diagnostic from the dropdown and the values will be displayed and updated in the panel below.\\n\\nDiagnostic keys and values support rich formatting with some basic HTML tags, such as `<b>`, `<i>`, `<u>`, `<tt>`, `<table>`, and more.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport PinIcon from \"@mdi/svg/svg/pin.svg\";\nimport cx from \"classnames\";\nimport { compact } from \"lodash\";\nimport * as React from \"react\"; // eslint-disable-line import/no-duplicates\nimport { hot } from \"react-hot-loader/root\";\nimport { List, AutoSizer } from \"react-virtualized\";\n\nimport type { Config as DiagnosticStatusConfig } from \"./DiagnosticStatusPanel\";\nimport helpContent from \"./DiagnosticSummary.help.md\";\nimport styles from \"./DiagnosticSummary.module.scss\";\nimport { LEVELS, type DiagnosticId, type DiagnosticInfo, getDiagnosticsByLevel, getSortedDiagnostics } from \"./util\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { Item } from \"webviz-core/src/components/Menu\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport useDiagnostics, { type DiagnosticsBuffer } from \"webviz-core/src/panels/diagnostics/useDiagnostics\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { $DIAGNOSTICS } from \"webviz-core/src/util/globalConstants\";\nimport toggle from \"webviz-core/src/util/toggle\";\n\nconst LevelClasses = {\n  [LEVELS.OK]: styles.ok,\n  [LEVELS.WARN]: styles.warn,\n  [LEVELS.ERROR]: styles.error,\n  [LEVELS.STALE]: styles.stale,\n};\n\ntype NodeRowProps = {\n  info: DiagnosticInfo,\n  isPinned: boolean,\n  onClick: (info: DiagnosticInfo) => void,\n  onClickPin: (info: DiagnosticInfo) => void,\n};\nclass NodeRow extends React.PureComponent<NodeRowProps> {\n  onClick = () => {\n    const { info, onClick } = this.props;\n    onClick(info);\n  };\n  onClickPin = () => {\n    const { info, onClickPin } = this.props;\n    onClickPin(info);\n  };\n\n  render() {\n    const { info, isPinned } = this.props;\n\n    return (\n      <div\n        className={cx(LevelClasses[info.status.level], styles.nodeRow)}\n        onClick={this.onClick}\n        data-test-diagnostic-row>\n        <Icon fade={!isPinned} onClick={this.onClickPin} className={cx(styles.pinIcon, { [styles.pinned]: isPinned })}>\n          <PinIcon />\n        </Icon>\n        <span>{info.displayName}</span> &ndash; <span className={styles.message}>{info.status.message}</span>\n      </div>\n    );\n  }\n}\n\ntype Config = {| pinnedIds: DiagnosticId[], topicToRender: string, hardwareIdFilter: string, sortByLevel?: boolean |};\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n  topics: Topic[],\n};\n\nfunction DiagnosticSummary({ config, saveConfig, openSiblingPanel, topics }: Props) {\n  const { hardwareIdFilter, topicToRender, sortByLevel = true } = config;\n\n  const hardwareFilter = React.useMemo(\n    () => (\n      <input\n        style={{ width: \"100%\", padding: \"0\", background: \"transparent\", opacity: \"0.5\" }}\n        value={hardwareIdFilter}\n        placeholder={\"Filter hardware id\"}\n        onChange={(e) => saveConfig({ hardwareIdFilter: e.target.value })}\n      />\n    ),\n    [hardwareIdFilter, saveConfig]\n  );\n\n  const topicToRenderMenu = React.useMemo(\n    () => (\n      <TopicToRenderMenu\n        topicToRender={topicToRender}\n        onChange={(newTopicToRender) => saveConfig({ topicToRender: newTopicToRender })}\n        topics={topics}\n        singleTopicDatatype={\"diagnostic_msgs/DiagnosticArray\"}\n        defaultTopicToRender={$DIAGNOSTICS}\n      />\n    ),\n    [topicToRender, topics, saveConfig]\n  );\n\n  const menuContent = React.useMemo(\n    () => (\n      <Item\n        icon={sortByLevel ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n        onClick={() => saveConfig({ sortByLevel: !sortByLevel })}>\n        Sort by level\n      </Item>\n    ),\n    [saveConfig, sortByLevel]\n  );\n\n  const buffer = useDiagnostics(topicToRender);\n\n  return (\n    <Flex col className={styles.panel}>\n      <PanelToolbar helpContent={helpContent} additionalIcons={topicToRenderMenu} menuContent={menuContent}>\n        {hardwareFilter}\n      </PanelToolbar>\n      <Flex col>\n        {buffer.diagnosticsByNameByTrimmedHardwareId.size === 0 ? (\n          <EmptyState>\n            Waiting for <code>{topicToRender}</code> messages\n          </EmptyState>\n        ) : (\n          <SummaryPanelContents\n            openSiblingPanel={openSiblingPanel}\n            saveConfig={saveConfig}\n            topics={topics}\n            config={config}\n            buffer={buffer}\n          />\n        )}\n      </Flex>\n    </Flex>\n  );\n}\n\nfunction SummaryPanelContents({\n  buffer,\n  saveConfig,\n  openSiblingPanel,\n  config,\n}: {\n  ...Props,\n  buffer: DiagnosticsBuffer,\n}) {\n  const { hardwareIdFilter, pinnedIds, topicToRender, sortByLevel = true } = config;\n\n  const togglePinned = React.useCallback((info: DiagnosticInfo) => {\n    saveConfig({ pinnedIds: toggle(config.pinnedIds, info.id) });\n  }, [saveConfig, config.pinnedIds]);\n\n  const showDetails = React.useCallback((info: DiagnosticInfo) => {\n    openSiblingPanel(\n      \"DiagnosticStatusPanel\",\n      () =>\n        ({\n          selectedHardwareId: info.status.hardware_id,\n          selectedName: info.status.name,\n          topicToRender,\n          collapsedSections: [],\n        }: DiagnosticStatusConfig)\n    );\n  }, [openSiblingPanel, topicToRender]);\n\n  const renderRow = ({ item, style, key }) => {\n    return (\n      <div key={key} style={style}>\n        <NodeRow\n          info={item}\n          isPinned={pinnedIds.indexOf(item.id) !== -1}\n          onClick={showDetails}\n          onClickPin={togglePinned}\n        />\n      </div>\n    );\n  };\n\n  const pinnedNodes = filterMap(pinnedIds, (id) => {\n    const [_, trimmedHardwareId, name] = id.split(\"|\");\n    const diagnosticsByName = buffer.diagnosticsByNameByTrimmedHardwareId.get(trimmedHardwareId);\n    if (diagnosticsByName == null) {\n      return;\n    }\n    return diagnosticsByName.get(name);\n  });\n\n  const nodesByLevel = getDiagnosticsByLevel(buffer);\n  const sortedNodes = sortByLevel\n    ? [].concat(\n        ...[LEVELS.STALE, LEVELS.ERROR, LEVELS.WARN, LEVELS.OK].map((level) =>\n          getSortedDiagnostics(nodesByLevel[level], hardwareIdFilter, pinnedIds)\n        )\n      )\n    : getSortedDiagnostics(\n        [].concat(...[LEVELS.STALE, LEVELS.ERROR, LEVELS.WARN, LEVELS.OK].map((level) => nodesByLevel[level])),\n        hardwareIdFilter,\n        pinnedIds\n      );\n\n  const nodes: DiagnosticInfo[] = [...compact(pinnedNodes), ...sortedNodes];\n  return !nodes.length ? null : (\n    <AutoSizer>\n      {({ height, width }) => (\n        <List\n          width={width}\n          height={height}\n          style={{ outline: \"none\" }}\n          rowHeight={25}\n          rowRenderer={(rowProps) => renderRow({ ...rowProps, item: nodes[rowProps.index] })}\n          rowCount={nodes.length}\n          overscanRowCount={10}\n        />\n      )}\n    </AutoSizer>\n  );\n}\n\nDiagnosticSummary.panelType = \"DiagnosticSummary\";\nDiagnosticSummary.defaultConfig = { ...getGlobalHooks().perPanelHooks().DiagnosticSummary.defaultConfig };\n\nexport default hot(Panel<Config>(DiagnosticSummary));\n","module.exports = \"# Diagnostics - Summary\\n\\nDisplays the status of all the nodes it has seen in groups from:\\n\\n- Pinned nodes\\n- Stale\\n- Error\\n- Warn\\n- Ok\\n\\nYou can pin a specific node you are interested in by clicking the pin icon next to it (appears on hover).\\n\\nYou can also click a key to see it show up in the Runtime Monitor Details Panel.\\n\\nEntries can be filtered by a fuzzy (subsequence) match against hardware\\\\_id and name. When a filter string is used, entries are ordered by the how early the filter characters appear in the matched label.\\n\"","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./DiagnosticSummary.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./DiagnosticSummary.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./DiagnosticSummary.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow{text-decoration:none;padding:8px 16px;cursor:pointer;color:rgba(247,247,243,.77);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow:hover{color:#fff;background-color:#36363d}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon{margin-right:4px}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon svg{font-size:16px;position:relative;top:-1px}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2w6bg--panel{background-color:#08080a}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-3x32j--ok .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message{color:#05d27d}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-42j44--warn .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message{color:#ccb862}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2jahw--error .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message{color:#ff7c96}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-w8nc9--stale .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message{color:rgba(247,247,243,.3)}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon{margin-left:4px;vertical-align:middle;visibility:hidden}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-4pagz--pinned,.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow:hover .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon{visibility:visible}.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow{padding:0;line-height:24px;overflow:hidden;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.module.scss\"],\"names\":[],\"mappings\":\"AAoCA,qFACE,qBACA,iBACA,eACA,4BACA,yBAAA,sBAAA,qBAAA,iBACA,oBAAA,aACA,sBAAA,kBAAA,CAuBF,2FAEE,WACA,wBCvBM,CDsCR,qFACE,gBAAA,CACA,yFACE,eACA,kBACA,QAAA,CAIJ,AEpFA,mFACE,wBDgCK,CC9BP,qKACE,aDiBM,CCfR,uKACE,aDqBO,CCnBT,wKACE,aDmBI,CCjBN,wKACE,0BDRW,CCWb,qFAEE,gBACA,sBACA,iBAAA,CACA,wVAEE,kBAAA,CAIJ,qFAEE,UACA,iBAEA,gBACA,mBACA,0BAAA,sBAAA,CAAA\",\"file\":\"DiagnosticSummary.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.panel {\\n  background-color: $dark;\\n}\\n.ok .message {\\n  color: $green;\\n}\\n.warn .message {\\n  color: $orange;\\n}\\n.error .message {\\n  color: $red;\\n}\\n.stale .message {\\n  color: $text-muted;\\n}\\n\\n.pinIcon {\\n  @extend %list-item-icon;\\n  margin-left: 4px;\\n  vertical-align: middle;\\n  visibility: hidden;\\n  &.pinned,\\n  .nodeRow:hover & {\\n    visibility: visible;\\n  }\\n}\\n\\n.nodeRow {\\n  @extend %menu-item;\\n  padding: 0;\\n  line-height: 24px;\\n\\n  overflow: hidden;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"nodeRow\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow\",\n\t\"pinIcon\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon\",\n\t\"panel\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2w6bg--panel\",\n\t\"ok\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-3x32j--ok\",\n\t\"message\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message\",\n\t\"warn\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-42j44--warn\",\n\t\"error\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2jahw--error\",\n\t\"stale\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-w8nc9--stale\",\n\t\"pinned\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-4pagz--pinned\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { type Node } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport helpContent from \"./index.help.md\";\nimport GlobalVariablesTable from \"webviz-core/src/components/GlobalVariablesTable\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\n\nconst SGlobalVariablesPanel = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nfunction GlobalVariables(): Node {\n  return (\n    <SGlobalVariablesPanel>\n      <PanelToolbar helpContent={helpContent} floating />\n      <GlobalVariablesTable />\n    </SGlobalVariablesPanel>\n  );\n}\n\nGlobalVariables.panelType = \"Global\";\nGlobalVariables.defaultConfig = {};\n\nexport default hot(Panel<{}>(GlobalVariables));\n","module.exports = \"# Global Variables\\n\\nAllows you to read and set global variables for any panel that uses the [message path syntax](/help/message-path-syntax) (e.g. Plot, State Transitions, Raw Messages, etc.).\\n\\nFor example, instead of having to change a particular object ID that you want to see visualizations for across panels, you can:\\n\\n- Set a `$my_object_id` variable in the Global Variables panel.\\n- Type `/my_objects.objects[:]{id==$my_object_id}.some_field` in your Plot Panel to plot a particular field in your specified object\\n- Type `/my_objects.objects[:]{id==$my_object_id}` in your Raw Messages Panel to see all the info for your specified object\\n\\nFor numeric global variable values, use the up and down arrow keys to increment and decrement the values, respectively.\\n\"","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport DotsVerticalIcon from \"@mdi/svg/svg/dots-vertical.svg\";\nimport { partition, pick, union, without } from \"lodash\";\nimport React, { type Node, useEffect, useMemo, useCallback, useRef, useState } from \"react\";\nimport styled, { css, keyframes } from \"styled-components\";\n\nimport { usePreviousValue } from \"../util/hooks\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { JSONInput } from \"webviz-core/src/components/input/JSONInput\";\nimport { ValidatedResizingInput } from \"webviz-core/src/components/input/ValidatedResizingInput\";\nimport Menu, { Item } from \"webviz-core/src/components/Menu\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport useGlobalVariables, { type GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { memoizedGetLinkedGlobalVariablesKeyByName } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/interactionUtils\";\nimport useLinkedGlobalVariables from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport { colors as sharedColors } from \"webviz-core/src/util/sharedStyleConstants\";\n\n// The minimum amount of time to wait between showing the global variable update animation again\nexport const ANIMATION_RESET_DELAY_MS = 3000;\n\n// Returns an keyframe object that animates between two styles \"highlight twice then return to normal\"\nexport const makeFlashAnimation = (initialCssProps: any, highlightCssProps: any) => {\n  return css`\n    ${keyframes`\n      0%, 20%, 100% {\n        ${initialCssProps}\n      }\n      10%, 30%, 80% {\n        ${highlightCssProps}\n      }\n    `}\n  `;\n};\n\nconst SGlobalVariablesTable = styled.div`\n  display: flex;\n  flex-direction: column;\n  white-space: nowrap;\n  color: ${sharedColors.LIGHT};\n\n  table {\n    width: calc(100% + 1px);\n  }\n\n  thead {\n    user-select: none;\n    border-bottom: 1px solid ${sharedColors.BORDER_LIGHT};\n  }\n\n  th,\n  td {\n    padding: 0px 16px;\n    line-height: 100%;\n    border: none;\n  }\n\n  tr:first-child th {\n    padding: 8px 16px;\n    border: none;\n    text-align: left;\n    color: rgba(255, 255, 255, 0.6);\n    min-width: 120px;\n  }\n\n  td {\n    input {\n      background: none !important;\n      color: inherit;\n      width: 100%;\n      padding-left: 0;\n      padding-right: 0;\n      min-width: 40px;\n    }\n    &:last-child {\n      color: rgba(255, 255, 255, 0.6);\n    }\n  }\n`;\n\nconst SIconWrapper = styled.span`\n  display: inline-block;\n  cursor: pointer;\n  padding: 0;\n  color: ${sharedColors.LIGHT};\n\n  svg {\n    opacity: ${({ isOpen }) => (isOpen ? 1 : undefined)};\n  }\n`;\n\nconst SLinkedTopicsSpan = styled.span`\n  overflow: hidden;\n  text-overflow: ellipsis;\n  direction: rtl;\n  max-width: 240px;\n  margin-left: -5px;\n`;\n\nconst FlashRowAnimation = makeFlashAnimation(\n  css`\n    background: transparent;\n  `,\n  css`\n    background: ${sharedColors.HIGHLIGHT_MUTED};\n  `\n);\n\nconst AnimationDuration = 3;\nconst SAnimatedRow = styled.tr`\n  background: transparent;\n  animation: ${({ animate, skipAnimation }) => (animate && !skipAnimation ? FlashRowAnimation : \"none\")}\n    ${AnimationDuration}s ease-in-out;\n  animation-iteration-count: 1;\n  animation-fill-mode: forwards;\n  border-bottom: 1px solid ${sharedColors.BORDER_LIGHT};\n`;\n\nexport function isActiveElementEditable() {\n  const activeEl = document.activeElement;\n  return activeEl && (activeEl.isContentEditable || activeEl.tagName === \"INPUT\" || activeEl.tagName === \"TEXTAREA\");\n}\n\nconst changeGlobalKey = (newKey, oldKey, globalVariables, idx, overwriteGlobalVariables) => {\n  const keys = Object.keys(globalVariables);\n  overwriteGlobalVariables({\n    ...pick(globalVariables, keys.slice(0, idx)),\n    [newKey]: globalVariables[oldKey],\n    ...pick(globalVariables, keys.slice(idx + 1)),\n  });\n};\n\nfunction LinkedGlobalVariableRow({ name }: { name: string }): Node {\n  const [isOpen, setIsOpen] = useState<boolean>(false);\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n  const { linkedGlobalVariables, setLinkedGlobalVariables } = useLinkedGlobalVariables();\n\n  const linkedTopicPaths = useMemo(\n    () =>\n      linkedGlobalVariables\n        .filter((variable) => variable.name === name)\n        .map(({ topic, markerKeyPath }) => [topic, ...markerKeyPath].join(\".\")),\n    [linkedGlobalVariables, name]\n  );\n\n  const unlink = useCallback((path) => {\n    setLinkedGlobalVariables(\n      linkedGlobalVariables.filter(\n        ({ name: varName, topic, markerKeyPath }) => !(varName === name && [topic, ...markerKeyPath].join(\".\") === path)\n      )\n    );\n  }, [linkedGlobalVariables, name, setLinkedGlobalVariables]);\n\n  const unlinkAndDelete = useCallback(() => {\n    const newLinkedGlobalVariables = linkedGlobalVariables.filter(({ name: varName }) => varName !== name);\n    setLinkedGlobalVariables(newLinkedGlobalVariables);\n    setGlobalVariables({ [name]: undefined });\n  }, [linkedGlobalVariables, name, setGlobalVariables, setLinkedGlobalVariables]);\n\n  return (\n    <>\n      <td>${name}</td>\n      <td width=\"100%\">\n        <JSONInput\n          value={JSON.stringify(globalVariables[name] ?? \"\")}\n          onChange={(newVal) => setGlobalVariables({ [name]: newVal })}\n        />\n      </td>\n      <td>\n        <Flex center style={{ justifyContent: \"space-between\" }}>\n          <Flex style={{ marginRight: 16 }}>\n            {linkedTopicPaths.length > 1 && <span>({linkedTopicPaths.length})</span>}\n\n            <Tooltip\n              contents={\n                linkedTopicPaths.length ? (\n                  <>\n                    <div style={{ fontWeight: \"bold\", opacity: 0.4 }}>\n                      {linkedTopicPaths.length} LINKED TOPIC{linkedTopicPaths.length > 1 ? \"S\" : \"\"}\n                    </div>\n                    {linkedTopicPaths.map((path) => (\n                      <div key={path} style={{ paddingTop: \"5px\" }}>\n                        {path}\n                      </div>\n                    ))}\n                  </>\n                ) : null\n              }>\n              <SLinkedTopicsSpan>\n                {linkedTopicPaths.length ? <bdi>{linkedTopicPaths.join(\", \")}</bdi> : \"--\"}\n              </SLinkedTopicsSpan>\n            </Tooltip>\n          </Flex>\n          <ChildToggle isOpen={isOpen} onToggle={() => setIsOpen(!isOpen)} position=\"below\">\n            <SIconWrapper isOpen={isOpen}>\n              <Icon small dataTest={`unlink-${name}`}>\n                <DotsVerticalIcon />\n              </Icon>\n            </SIconWrapper>\n            <Menu style={{ padding: \"4px 0px\" }}>\n              {linkedTopicPaths.map((path) => (\n                <Item dataTest=\"unlink-path\" key={path} onClick={() => unlink(path)}>\n                  Remove <span style={{ color: sharedColors.LIGHT, opacity: 1 }}>{path}</span>\n                </Item>\n              ))}\n              <Item onClick={unlinkAndDelete}>Delete global variable</Item>\n            </Menu>\n          </ChildToggle>\n        </Flex>\n      </td>\n    </>\n  );\n}\n\nfunction GlobalVariablesTable(): Node {\n  const { globalVariables, setGlobalVariables, overwriteGlobalVariables } = useGlobalVariables();\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  const globalVariableNames = Object.keys(globalVariables);\n  const linkedGlobalVariablesKeyByName = memoizedGetLinkedGlobalVariablesKeyByName(linkedGlobalVariables);\n  const [linked, unlinked] = partition(globalVariableNames, (name) => !!linkedGlobalVariablesKeyByName[name]);\n\n  // Don't run the animation when the Table first renders\n  const skipAnimation = useRef<boolean>(true);\n  useEffect(() => {\n    const timeoutId = setTimeout(() => (skipAnimation.current = false), ANIMATION_RESET_DELAY_MS);\n    return () => clearTimeout(timeoutId);\n  }, []);\n\n  const previousGlobalVariables = usePreviousValue(globalVariables);\n  const previousGlobalVariablesRef = useRef<?GlobalVariables>(previousGlobalVariables);\n  previousGlobalVariablesRef.current = previousGlobalVariables;\n\n  const [changedVariables, setChangedVariables] = useState<string[]>([]);\n  useEffect(() => {\n    if (skipAnimation.current || isActiveElementEditable()) {\n      return;\n    }\n    const newChangedVariables = union(\n      Object.keys(globalVariables),\n      Object.keys(previousGlobalVariablesRef.current || {})\n    ).filter((name) => {\n      const previousValue = previousGlobalVariablesRef.current?.[name];\n      return previousValue !== globalVariables[name];\n    });\n\n    setChangedVariables(newChangedVariables);\n    const timerId = setTimeout(() => setChangedVariables([]), ANIMATION_RESET_DELAY_MS);\n    return () => clearTimeout(timerId);\n  }, [globalVariables, skipAnimation]);\n\n  return (\n    <SGlobalVariablesTable>\n      <table>\n        <thead>\n          <tr>\n            <th>Global variable</th>\n            <th>Value</th>\n            <th>Topic(s)</th>\n          </tr>\n        </thead>\n        <tbody>\n          {linked.map((name, idx) => (\n            <SAnimatedRow\n              key={`linked-${idx}`}\n              skipAnimation={skipAnimation.current}\n              animate={changedVariables.includes(name)}>\n              <LinkedGlobalVariableRow name={name} changedVariables={changedVariables} />\n            </SAnimatedRow>\n          ))}\n          {unlinked.map((name, idx) => (\n            <SAnimatedRow\n              key={`unlinked-${idx}`}\n              skipAnimation={skipAnimation}\n              animate={changedVariables.includes(name)}>\n              <td data-test=\"global-variable-key\">\n                <ValidatedResizingInput\n                  value={name}\n                  dataTest={`global-variable-key-input-${name}`}\n                  onChange={(newKey) =>\n                    changeGlobalKey(newKey, name, globalVariables, linked.length + idx, overwriteGlobalVariables)\n                  }\n                  invalidInputs={without(globalVariableNames, name).concat(\"\")}\n                />\n              </td>\n              <td width=\"100%\">\n                <JSONInput\n                  dataTest={`global-variable-value-input-${JSON.stringify(globalVariables[name] ?? \"\")}`}\n                  value={JSON.stringify(globalVariables[name] ?? \"\")}\n                  onChange={(newVal) => setGlobalVariables({ [name]: newVal })}\n                />\n              </td>\n              <td width=\"100%\">\n                <Flex center style={{ justifyContent: \"space-between\" }}>\n                  --\n                  <SIconWrapper onClick={() => setGlobalVariables({ [name]: undefined })}>\n                    <Icon small>\n                      <CloseIcon />\n                    </Icon>\n                  </SIconWrapper>\n                </Flex>\n              </td>\n            </SAnimatedRow>\n          ))}\n        </tbody>\n      </table>\n      <Flex style={{ margin: \"20px 16px 16px\", justifyContent: \"flex-end\" }}>\n        <button\n          disabled={globalVariables[\"\"] != null}\n          onClick={() => setGlobalVariables({ \"\": \"\" })}\n          data-test=\"add-variable-btn\">\n          Add variable\n        </button>\n      </Flex>\n    </SGlobalVariablesTable>\n  );\n}\n\nexport default GlobalVariablesTable;\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useRef, useState } from \"react\";\nimport ReactInputAutosize from \"react-input-autosize\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport function ValidatedResizingInput(props: {|\n  value: string,\n  onChange: (string) => void,\n  invalidInputs: string[],\n  dataTest?: string,\n|}) {\n  const [internalValue, setInternalValue] = useState<string>(props.value);\n  const lastPropsValue = useRef<string>(props.value);\n  if (lastPropsValue.current !== props.value) {\n    lastPropsValue.current = props.value;\n    setInternalValue(props.value);\n  }\n  return (\n    <ReactInputAutosize\n      style={{ color: !props.invalidInputs.includes(internalValue) ? \"white\" : colors.RED }}\n      value={`$${internalValue}`}\n      data-test={props.dataTest}\n      onChange={(event) => {\n        const value = event.target.value.slice(1);\n        setInternalValue(value);\n        if (!props.invalidInputs.includes(value)) {\n          props.onChange(value);\n        }\n      }}\n    />\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { type Node as ReactNode, useCallback, useMemo } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport GlobalVariableSlider from \"webviz-core/src/components/GlobalVariableSlider\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport type { SliderProps } from \"webviz-core/src/components/SliderWithTicks\";\nimport TextField from \"webviz-core/src/components/TextField\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\n\nexport type GlobalVariableSliderConfig = {\n  sliderProps: SliderProps,\n  globalVariableName: string,\n};\n\ntype Props = {\n  config: GlobalVariableSliderConfig,\n  saveConfig: ($Shape<GlobalVariableSliderConfig>) => void,\n};\n\ntype MenuProps = {\n  config: GlobalVariableSliderConfig,\n  updateConfig: (config: $Shape<GlobalVariableSliderConfig>) => void,\n};\n\n// Validation helper functions for the SliderSettingsMenu\nconst minMaxValidatorFn = (str) => (isNaN(parseFloat(str)) ? \"Must be valid number\" : null);\nconst stepValidatorFn = (str) => {\n  const result = minMaxValidatorFn(str);\n  if (result) {\n    return result;\n  }\n  const number = parseFloat(str);\n  if (number <= 0) {\n    return \"Must be >= 0\";\n  }\n  return null;\n};\n\nfunction SliderSettingsMenu(props: MenuProps) {\n  const { updateConfig, config } = props;\n  const { sliderProps, globalVariableName } = config;\n\n  const updateSliderProps = useCallback((partial: $Shape<SliderProps>) => {\n    updateConfig({\n      ...config,\n      sliderProps: { ...sliderProps, ...partial },\n    });\n  }, [config, sliderProps, updateConfig]);\n\n  const onChangeVariableName = useCallback(\n    (newGlobalVariableName) =>\n      updateConfig({\n        ...config,\n        globalVariableName: newGlobalVariableName,\n      }),\n    [config, updateConfig]\n  );\n\n  const onChangeMin = useCallback((min) => updateSliderProps({ min: parseFloat(min) }), [updateSliderProps]);\n  const onChangeMax = useCallback((max) => updateSliderProps({ max: parseFloat(max) }), [updateSliderProps]);\n  const onChangeStep = useCallback((step) => updateSliderProps({ step: parseFloat(step) }), [updateSliderProps]);\n  return (\n    <>\n      <Item>\n        <TextField\n          value={globalVariableName}\n          onChange={onChangeVariableName}\n          label=\"Global variable name\"\n          validateOnBlur\n        />\n      </Item>\n      <Item>\n        <TextField\n          value={`${sliderProps.min}`}\n          onChange={onChangeMin}\n          placeholder=\"Min\"\n          label=\"Min\"\n          validator={minMaxValidatorFn}\n        />\n      </Item>\n      <Item>\n        <TextField\n          value={`${sliderProps.max}`}\n          onChange={onChangeMax}\n          placeholder=\"Max\"\n          label=\"Max\"\n          validator={minMaxValidatorFn}\n        />\n      </Item>\n      <Item>\n        <TextField\n          value={`${sliderProps.step}`}\n          onChange={onChangeStep}\n          placeholder=\"Step\"\n          label=\"Step\"\n          validator={stepValidatorFn}\n        />\n      </Item>\n    </>\n  );\n}\n\nfunction GlobalVariableSliderPanel(props: Props): ReactNode {\n  const { config, saveConfig } = props;\n  const { sliderProps, globalVariableName } = config;\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n\n  const globalVariableValue = globalVariables[globalVariableName];\n  const saveSliderProps = useCallback((updatedConfig) => {\n    // If the name of the global variable changes, immediately set its value.\n    // Without this, the variable won't be set until the slider is moved.\n    if (updatedConfig.globalVariableName !== config.globalVariableName) {\n      setGlobalVariables({ [updatedConfig.globalVariableName]: globalVariableValue });\n    }\n    saveConfig(updatedConfig);\n  }, [config.globalVariableName, globalVariableValue, saveConfig, setGlobalVariables]);\n  const additionalOutput = useMemo(() => {\n    return getGlobalHooks()\n      .perPanelHooks()\n      .GlobalVariableSlider.getVariableSpecificOutput(globalVariableName, globalVariables);\n  }, [globalVariableName, globalVariables]);\n  const menuContent = useMemo(() => <SliderSettingsMenu config={config} updateConfig={saveSliderProps} />, [\n    config,\n    saveSliderProps,\n  ]);\n  return (\n    <div style={{ padding: \"25px 4px 4px\" }}>\n      <PanelToolbar floating menuContent={menuContent} />\n      <GlobalVariableSlider sliderProps={sliderProps} globalVariableName={globalVariableName} />\n      {additionalOutput}\n    </div>\n  );\n}\n\nGlobalVariableSliderPanel.panelType = \"GlobalVariableSliderPanel\";\nGlobalVariableSliderPanel.defaultConfig = {\n  sliderProps: { min: 0, max: 10, step: 1 },\n  globalVariableName: \"globalVariable\",\n};\n\nexport default hot(Panel<GlobalVariableSliderConfig>(GlobalVariableSliderPanel));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { type Node as ReactNode, useCallback } from \"react\";\n\nimport { SliderWithTicks } from \"webviz-core/src/components/SliderWithTicks\";\nimport type { SliderProps } from \"webviz-core/src/components/SliderWithTicks\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\n\ntype Props = {\n  sliderProps: SliderProps,\n  globalVariableName: string,\n};\n\n// A slider that controls the value of a global variable\nexport default function GlobalVariableSlider(props: Props): ReactNode {\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n  const globalVariableValue = globalVariables[props.globalVariableName];\n\n  const onChange = useCallback((newValue) => {\n    if (newValue !== globalVariableValue) {\n      setGlobalVariables({ [props.globalVariableName]: newValue });\n    }\n  }, [props.globalVariableName, globalVariableValue, setGlobalVariables]);\n  return <SliderWithTicks value={globalVariableValue} sliderProps={props.sliderProps} onChange={onChange} />;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { sumBy } from \"lodash\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport textWidth from \"text-width\";\n\nimport AutoSizingCanvas from \"webviz-core/src/components/AutoSizingCanvas\";\nimport Slider from \"webviz-core/src/components/Slider\";\nimport mixins from \"webviz-core/src/styles/mixins.module.scss\";\n\n// The minimum ratio between the width of the panel and the total width taken by the labels.\n// If the ratio drops below this value, (due to the width of the panel changing)\n// we will remove every other label until the ratio is back above this value.\nconst MINIMUM_LABEL_FREESPACE_RATIO = 2;\n\nconst TICK_FONT = { family: mixins.monospaceFont, size: 10 };\n\nconst SSliderContainer = styled.div`\n  height: 30px;\n  position: relative;\n  margin-bottom: 4px;\n`;\n\ntype MeasuredLabel = {\n  text: string,\n  tickWidth: number,\n  value: number,\n};\n\nexport type SliderProps = {\n  min: number,\n  max: number,\n  step: number,\n};\n\nexport function SliderWithTicks(props: { value: number, sliderProps: SliderProps, onChange: (number) => void }) {\n  const { value, sliderProps, onChange } = props;\n  return (\n    <SSliderContainer>\n      <AutoSizingCanvas draw={drawTicks(value, sliderProps)} />\n      <div style={{ position: \"absolute\", left: 0, top: 0, right: 0, bottom: 0 }}>\n        <Slider {...sliderProps} value={value} draggable onChange={onChange} />\n      </div>\n    </SSliderContainer>\n  );\n}\n\n// exported for tests\nexport function getNonOverlappingLabels(measuredLabels: MeasuredLabel[], width: number): MeasuredLabel[] {\n  let stepLabels: MeasuredLabel[] = measuredLabels;\n  do {\n    const totalWidth = sumBy(stepLabels, ({ tickWidth }) => tickWidth);\n    const freeSpaceRatio = width / totalWidth;\n    if (freeSpaceRatio >= MINIMUM_LABEL_FREESPACE_RATIO) {\n      break;\n    }\n    stepLabels = stepLabels.filter((_, i) => i % 2 === 0);\n  } while (stepLabels.length > 3);\n  return stepLabels;\n}\n\nfunction drawTicks(futureTime: number | null, sliderConfig: SliderProps) {\n  const { min, max, step } = sliderConfig;\n\n  // First, measure all the step labels' text widths.\n  // we do this outside the canvas context function so it can be cached.\n  const measuredLabels = [];\n\n  // Represents the number of gaps, not the number of ticks\n  const steps = Math.ceil((max - min) / step);\n  for (let i = 0; i <= steps; i++) {\n    const value = Math.min(min + (i / steps) * (max - min), max);\n    const text = value.toFixed(1);\n\n    const tickWidth = textWidth(text, TICK_FONT);\n    measuredLabels.push({\n      text,\n      value,\n      tickWidth,\n    });\n  }\n\n  return (ctx: CanvasRenderingContext2D, width: number, height: number) => {\n    // We don't want labels to overlap, so keep removing every other one until the\n    // ratio of textWidth to the totalWidth of the panel is above the threshold.\n    const stepLabels = getNonOverlappingLabels(measuredLabels, width);\n\n    // Clear the previous labels and draw the new ones\n    ctx.clearRect(0, 0, width, height);\n    stepLabels.forEach(({ text, tickWidth, value }, i) => {\n      const x = (i / (stepLabels.length - 1)) * width - tickWidth / 2;\n      const y = height / 2 + 2;\n\n      if (futureTime === value) {\n        ctx.font = `bold ${TICK_FONT.size}px ${TICK_FONT.family}`;\n        ctx.fillStyle = \"white\";\n      } else {\n        ctx.font = `${TICK_FONT.size}px ${TICK_FONT.family}`;\n        ctx.fillStyle = \"#666\";\n      }\n      ctx.fillText(text, x, y);\n    });\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport AlertCircleIcon from \"@mdi/svg/svg/alert-circle.svg\";\nimport { cloneDeep, uniq } from \"lodash\";\nimport React, { type Node as ReactNode, useMemo, useCallback } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport { useLatestMessageDataItem } from \"webviz-core/src/components/MessagePathSyntax/useLatestMessageDataItem\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TextField from \"webviz-core/src/components/TextField\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport helpContent from \"webviz-core/src/panels/GlobalVariableDropdown/index.help.md\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport type GlobalVariableDropdownConfig = {\n  topicPath: string,\n  globalVariableName: string,\n};\n\ntype Props = {\n  config: GlobalVariableDropdownConfig,\n  saveConfig: ($Shape<GlobalVariableDropdownConfig>) => void,\n};\n\nexport const defaultConfig = {\n  topicPath: \"\",\n  globalVariableName: \"globalVariable\",\n};\n\nfunction GlobalVariableDropdownPanel(props: Props): ReactNode {\n  const { config, saveConfig } = props;\n  const { topicPath, globalVariableName } = config;\n  const { globalVariables, setGlobalVariables, overwriteGlobalVariables } = useGlobalVariables();\n  const currentVal = globalVariables[globalVariableName];\n\n  const { onTopicPathChange, onVariableNameChange } = useMemo(\n    () => ({\n      onTopicPathChange: (newTopicPath: string) => {\n        saveConfig({ topicPath: newTopicPath });\n      },\n      onVariableNameChange: (newGlobalVariableName) => {\n        // If a global variable name is edited, immediately set its value and remove the old global variable.\n        // Otherwise, the variable won't be set until another dropdown option is selected.\n        if (newGlobalVariableName !== globalVariableName) {\n          const clonedGlobalVariables = cloneDeep(globalVariables);\n          delete clonedGlobalVariables[globalVariableName];\n          overwriteGlobalVariables({ ...clonedGlobalVariables, [newGlobalVariableName]: currentVal });\n        }\n        saveConfig({ globalVariableName: newGlobalVariableName });\n      },\n    }),\n    [globalVariableName, globalVariables, overwriteGlobalVariables, saveConfig, currentVal]\n  );\n\n  const onSelect = useCallback((newValue) => {\n    setGlobalVariables({ [globalVariableName]: newValue });\n  }, [globalVariableName, setGlobalVariables]);\n\n  const baseItem = useLatestMessageDataItem(topicPath, \"bobjects\");\n  const allDropdownOptions = uniq([...(baseItem?.queriedData || []).map(({ value }) => (value: any)), currentVal])\n    .filter((val) => val != null && typeof val !== \"object\")\n    .sort(naturalSort());\n\n  return (\n    <div>\n      <PanelToolbar helpContent={helpContent}>\n        <div style={{ width: \"100%\", lineHeight: \"20px\" }}>\n          <MessagePathInput index={0} path={topicPath} onChange={onTopicPathChange} inputStyle={{ height: \"100%\" }} />\n        </div>\n      </PanelToolbar>\n      <Flex center style={{ padding: \"10px\", justifyContent: \"flex-start\" }}>\n        <div>$</div>\n        <TextField value={globalVariableName} onChange={onVariableNameChange} validateOnBlur />\n\n        <div style={{ padding: \"0px 5px\" }}> = </div>\n\n        <Dropdown\n          dataTest=\"global-variable-dropdown-menu\"\n          value={currentVal}\n          text={`${currentVal == null ? \"-\" : `${currentVal}`}`}\n          btnStyle={{ minWidth: \"100px\", display: \"flex\", justifyContent: \"space-between\" }}\n          menuStyle={{ minWidth: \"100px\" }}\n          onChange={onSelect}>\n          {allDropdownOptions.map((value) => (\n            <option value={value} key={value}>\n              {`${value}`}\n            </option>\n          ))}\n        </Dropdown>\n        {!allDropdownOptions.length && (\n          <Icon\n            dataTest=\"global-variable-dropdown-menu-icon\"\n            small\n            tooltip={topicPath ? `Topic path must point to an array of primitives.` : \"No topic path entered.\"}\n            style={{ marginLeft: \"5px\", color: colors.RED1 }}>\n            <AlertCircleIcon />\n          </Icon>\n        )}\n      </Flex>\n    </div>\n  );\n}\n\nGlobalVariableDropdownPanel.panelType = \"GlobalVariableDropdownPanel\";\nGlobalVariableDropdownPanel.defaultConfig = defaultConfig;\n\nexport default hot(Panel<GlobalVariableDropdownConfig>(GlobalVariableDropdownPanel));\n","module.exports = \"# Global Variable Dropdown\\n\\nTakes a topic path to populate a dropdown menu. User can then specify a global variable that should be set to that dropdown menu's selected option.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport MenuDownIcon from \"@mdi/svg/svg/menu-down.svg\";\nimport WavesIcon from \"@mdi/svg/svg/waves.svg\";\nimport cx from \"classnames\";\nimport { uniq, keyBy, partition } from \"lodash\";\nimport React, { useMemo, useCallback, type Node } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport ImageCanvas from \"./ImageCanvas\";\nimport imageCanvasStyles from \"./ImageCanvas.module.scss\";\nimport helpContent from \"./index.help.md\";\nimport style from \"./index.module.scss\";\nimport { getCameraInfoTopic, getCameraNamespace, getRelatedMarkerTopics, getMarkerOptions, groupTopics } from \"./util\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport dropDownStyles from \"webviz-core/src/components/Dropdown/index.module.scss\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { Item, SubMenu } from \"webviz-core/src/components/Menu\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport IconTextMenu from \"webviz-core/src/panels/ImageView/IconTextMenu\";\nimport type { Message, TypedMessage } from \"webviz-core/src/players/types\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { CameraInfo } from \"webviz-core/src/types/Messages\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\nimport { deepParse, maybeGetBobjectHeaderStamp } from \"webviz-core/src/util/binaryObjects\";\nimport { WEBVIZ_ICON_MSGS$WEBVIZ_2D_ICON_ARRAY } from \"webviz-core/src/util/globalConstants\";\nimport { useShallowMemo, useDeepMemo } from \"webviz-core/src/util/hooks\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\nimport { getTopicsByTopicName } from \"webviz-core/src/util/selectors\";\nimport { colors as sharedColors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport { getSynchronizingReducers } from \"webviz-core/src/util/synchronizeMessages\";\nimport { formatTimeRaw } from \"webviz-core/src/util/time\";\nimport toggle from \"webviz-core/src/util/toggle\";\n\ntype DefaultConfig = {|\n  cameraTopic: string,\n  enabledMarkerTopics: string[],\n  customMarkerTopicOptions?: string[],\n  scale: number,\n  synchronize: boolean,\n  // Use template string to create icon text from the metadata fields of the icon msg.\n  iconTextTemplate?: string,\n|};\n\ntype ImageViewPanelHooks = {\n  defaultConfig: DefaultConfig,\n  imageMarkerDatatypes: string[],\n};\nconst DEFAULT_PANEL_HOOKS = { imageMarkerDatatypes: [] };\n\n// const IMAGE_ICON_MARKER_DATATYPES = [WEBVIZ_ICON_MSGS$WEBVIZ_2D_ICON_ARRAY];\nexport type Config = {|\n  ...DefaultConfig,\n  panelHooks?: ImageViewPanelHooks,\n  transformMarkers: boolean,\n  mode: \"fit\" | \"fill\" | \"other\" | null,\n  zoomPercentage: ?number,\n  offset: ?(number[]),\n  saveStoryConfig?: () => void,\n|};\n\nexport type SaveImagePanelConfig = SaveConfig<Config>;\n\ntype Props = {\n  config: Config,\n  saveConfig: SaveImagePanelConfig,\n};\n\nconst TopicTimestampSpan = styled.span`\n  padding: 0px 15px 0px 0px;\n  font-size: 10px;\n  font-style: italic;\n`;\n\nconst SEmptyStateWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  z-index: 200;\n  background: ${sharedColors.DARK};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst TopicTimestamp = ({ text, style: styleObj }: { text: string, style?: { [string]: string } }) =>\n  text === \"\" ? null : <TopicTimestampSpan style={styleObj}>{text}</TopicTimestampSpan>;\n\nconst BottomBar = ({ children, containsOpen }: { children?: Node, containsOpen: boolean }) => (\n  <div\n    className={cx(imageCanvasStyles[\"bottom-bar\"], {\n      [imageCanvasStyles.containsOpen]: inScreenshotTests ? true : containsOpen,\n    })}>\n    {children}\n  </div>\n);\n\nconst ToggleComponent = ({\n  text,\n  disabled = false,\n  dataTest,\n}: {\n  text: string,\n  disabled?: boolean,\n  dataTest?: string,\n}) => {\n  return (\n    <button style={{ maxWidth: \"100%\", padding: \"4px 8px\" }} className={cx({ disabled })} data-test={dataTest}>\n      <span className={dropDownStyles.title}>{text}</span>\n      <Icon style={{ marginLeft: 4 }}>\n        <MenuDownIcon style={{ width: 14, height: 14, opacity: 0.5 }} />\n      </Icon>\n    </button>\n  );\n};\n\n// Group image topics by the first component of their name\n\nfunction renderEmptyState(\n  cameraTopic: string,\n  markerTopics: string[],\n  shouldSynchronize: boolean,\n  messagesByTopic: { [topic: string]: Message[] }\n) {\n  return (\n    <SEmptyStateWrapper>\n      <EmptyState>\n        Waiting for images {markerTopics.length > 0 && \"and markers\"} on:\n        <br />\n        <br />\n        <ul>\n          <li>\n            <code>{cameraTopic}</code>\n          </li>\n          {markerTopics.sort().map((m) => (\n            <li key={m}>\n              <code>{m}</code>\n            </li>\n          ))}\n        </ul>\n        {shouldSynchronize && (\n          <>\n            <p>Synchronization is enabled, so all messages with `header.stamp`s must match exactly.</p>\n            <ul>\n              {Object.keys(messagesByTopic).map((topic) => (\n                <li key={topic}>\n                  <code>{topic}</code>:{\" \"}\n                  {messagesByTopic[topic] && messagesByTopic[topic].length\n                    ? messagesByTopic[topic]\n                        .map(({ message }) => {\n                          const stamp = maybeGetBobjectHeaderStamp(message);\n                          // In some cases, a user may have subscribed to a topic that does not include a header stamp.\n                          return stamp ? formatTimeRaw(stamp) : \"[ unknown ]\";\n                        })\n                        .join(\", \")\n                    : \"no messages\"}\n                </li>\n              ))}\n            </ul>\n          </>\n        )}\n      </EmptyState>\n    </SEmptyStateWrapper>\n  );\n}\n\nconst AddTopic = ({ onSelectTopic, topics }: { onSelectTopic: (string) => void, topics: string[] }) => {\n  return (\n    <div style={{ padding: \"8px 12px\", height: \"31px\" }}>\n      <Autocomplete\n        placeholder=\"Add topic\"\n        items={topics}\n        onSelect={onSelectTopic}\n        getItemValue={(s) => s}\n        getItemText={(s) => s}\n      />\n    </div>\n  );\n};\n\nconst NO_CUSTOM_OPTIONS = [];\n\nfunction ImageView(props: Props) {\n  const { config, saveConfig } = props;\n  const {\n    scale,\n    synchronize,\n    cameraTopic,\n    enabledMarkerTopics,\n    panelHooks,\n    transformMarkers,\n    customMarkerTopicOptions = NO_CUSTOM_OPTIONS,\n    iconTextTemplate,\n  } = config;\n  const { topics } = PanelAPI.useDataSourceInfo();\n  // For looking up datatype by topic name.\n  const topicsKeyByTopicName = useMemo(() => keyBy(topics, \"name\"), [topics]);\n  const isDemoMode = useExperimentalFeature(\"demoMode\");\n  const cameraTopicFullObject = useMemo(() => getTopicsByTopicName(topics)[cameraTopic], [cameraTopic, topics]);\n\n  // Namespaces represent marker topics based on the camera topic prefix (e.g. \"/camera_front_medium\")\n  const { allCameraNamespaces, imageTopicsByNamespace } = useMemo(() => {\n    const imageTopics = (topics ?? []).filter(({ datatype }) =>\n      [\"sensor_msgs/Image\", \"sensor_msgs/CompressedImage\"].includes(datatype)\n    );\n    const topicsByNamespace = groupTopics(imageTopics);\n    return { imageTopicsByNamespace: topicsByNamespace, allCameraNamespaces: [...topicsByNamespace.keys()] };\n  }, [topics]);\n\n  const { imageMarkerDatatypes } = panelHooks || getGlobalHooks().perPanelHooks().ImageView || DEFAULT_PANEL_HOOKS;\n\n  const combinedImageMarkerDataTypes = useMemo(() => [...imageMarkerDatatypes, WEBVIZ_ICON_MSGS$WEBVIZ_2D_ICON_ARRAY], [\n    imageMarkerDatatypes,\n  ]);\n  const defaultAvailableMarkerTopics = useMemo(\n    () => getMarkerOptions(cameraTopic, topics, allCameraNamespaces, combinedImageMarkerDataTypes),\n    [cameraTopic, topics, allCameraNamespaces, combinedImageMarkerDataTypes]\n  );\n  const availableAndEnabledMarkerTopics = useShallowMemo(\n    uniq([...defaultAvailableMarkerTopics, ...customMarkerTopicOptions, ...enabledMarkerTopics]).sort()\n  );\n  const onToggleMarkerName = useCallback((markerTopic: string) => {\n    saveConfig({ enabledMarkerTopics: toggle(enabledMarkerTopics, markerTopic) });\n  }, [saveConfig, enabledMarkerTopics]);\n\n  const onChangeCameraTopic = useCallback((newCameraTopic: string) => {\n    const newAvailableMarkerTopics = getMarkerOptions(\n      newCameraTopic,\n      topics,\n      allCameraNamespaces,\n      combinedImageMarkerDataTypes\n    );\n\n    const newEnabledMarkerTopics = getRelatedMarkerTopics(enabledMarkerTopics, newAvailableMarkerTopics);\n    saveConfig({\n      cameraTopic: newCameraTopic,\n      transformMarkers: getGlobalHooks()\n        .perPanelHooks()\n        .ImageView.canTransformMarkersByTopic(newCameraTopic),\n\n      enabledMarkerTopics: newEnabledMarkerTopics,\n    });\n  }, [topics, allCameraNamespaces, combinedImageMarkerDataTypes, enabledMarkerTopics, saveConfig]);\n\n  const onChangeScale = useCallback((newScale: number) => {\n    saveConfig({ scale: newScale });\n  }, [saveConfig]);\n\n  const onToggleSynchronize = useCallback(() => {\n    saveConfig({ synchronize: !synchronize });\n  }, [saveConfig, synchronize]);\n\n  const imageTopicDropdown = useMemo(() => {\n    const cameraNamespace = getCameraNamespace(cameraTopic);\n\n    if (!imageTopicsByNamespace || imageTopicsByNamespace.size === 0) {\n      return (\n        <Dropdown\n          toggleComponent={\n            <ToggleComponent dataTest={\"topics-dropdown\"} text={cameraTopic || \"no image topics yet\"} disabled />\n          }\n        />\n      );\n    }\n\n    const items = [...imageTopicsByNamespace.keys()].sort().map((group) => {\n      const imageTopics = imageTopicsByNamespace.get(group);\n      if (!imageTopics) {\n        return null;\n      } // satisfy flow\n      imageTopics.sort(naturalSort(\"name\"));\n\n      // place rectified topic above other imageTopics\n      return (\n        <SubMenu\n          direction=\"right\"\n          key={group}\n          text={group}\n          checked={group === cameraNamespace}\n          dataTest={group.substr(1)}>\n          {imageTopics.map((topic) => {\n            return (\n              <Item\n                key={topic.name}\n                value={topic.name}\n                checked={topic.name === cameraTopic}\n                onClick={() => onChangeCameraTopic(topic.name)}>\n                {topic.name}\n              </Item>\n            );\n          })}\n        </SubMenu>\n      );\n    });\n    return (\n      <Dropdown toggleComponent={<ToggleComponent dataTest={\"topics-dropdown\"} text={cameraTopic} />}>{items}</Dropdown>\n    );\n  }, [cameraTopic, imageTopicsByNamespace, onChangeCameraTopic]);\n\n  const cameraInfoTopic = getCameraInfoTopic(cameraTopic);\n  const cameraInfo: ?CameraInfo = PanelAPI.useMessageReducer({\n    topics: cameraInfoTopic ? [cameraInfoTopic] : [],\n    restore: useCallback((value) => value, []),\n    addMessage: useCallback((value, { message }: TypedMessage<CameraInfo>) => message, []),\n  });\n\n  const shouldSynchronize = synchronize && enabledMarkerTopics.length > 0;\n  const imageAndMarkerTopics = useDeepMemo([{ topic: cameraTopic, imageScale: scale }, ...enabledMarkerTopics]);\n\n  const { messagesByTopic: pendingSynchronizedMessages, synchronizedMessages } = PanelAPI.useMessageReducer({\n    topics: imageAndMarkerTopics,\n    ...useMemo(\n      () =>\n        getSynchronizingReducers(\n          imageAndMarkerTopics.map((request) => (typeof request === \"string\" ? request : request.topic))\n        ),\n      [imageAndMarkerTopics]\n    ),\n  });\n  const unsynchronizedMessages = PanelAPI.useMessageReducer({\n    topics: imageAndMarkerTopics,\n    restore: useCallback((previousValue) => previousValue ?? {}, []),\n    addBobjects: useCallback((oldState, newBobjects) => {\n      const newState = { ...oldState };\n      newBobjects.forEach((bobject) => {\n        newState[bobject.topic] = bobject;\n      });\n      return newState;\n    }, []),\n  });\n  const bobjectFrame = shouldSynchronize ? synchronizedMessages : unsynchronizedMessages;\n  // TODO(steel): Move the parsing into the worker.\n  const parsedFrame = useMemo(() => {\n    if (bobjectFrame == null) {\n      return bobjectFrame;\n    }\n    const ret = {};\n    Object.keys(bobjectFrame).forEach((topic) => {\n      const { message, receiveTime } = bobjectFrame[topic];\n      ret[topic] = { message: deepParse(message), topic, receiveTime };\n    });\n    return ret;\n  }, [bobjectFrame]);\n\n  const { iconMarkersToRender, nonIconMarkersToRender } = useMemo(() => {\n    const combinedMarkers: Message[] = filterMap(enabledMarkerTopics, (topic) => parsedFrame?.[topic]);\n    const [iconMarkers, nonIconMarkers] = partition(combinedMarkers, ({ topic }) => {\n      return topicsKeyByTopicName[topic].datatype === WEBVIZ_ICON_MSGS$WEBVIZ_2D_ICON_ARRAY;\n    });\n    return { iconMarkersToRender: iconMarkers, nonIconMarkersToRender: nonIconMarkers };\n  }, [enabledMarkerTopics, parsedFrame, topicsKeyByTopicName]);\n\n  // Timestamps are displayed for informational purposes in the markers menu\n  const renderedMarkerTimestamps = useMemo(() => {\n    const stamps = {};\n    for (const { topic, message } of nonIconMarkersToRender) {\n      // In some cases, a user may have subscribed to a topic that does not include a header stamp.\n      stamps[topic] = message?.header?.stamp ? formatTimeRaw(message.header.stamp) : \"[ not available ]\";\n    }\n    return stamps;\n  }, [nonIconMarkersToRender]);\n\n  const rawMarkerData = {\n    markers: nonIconMarkersToRender,\n    scale,\n    transformMarkers,\n    cameraInfo: nonIconMarkersToRender.length > 0 ? cameraInfo : null,\n  };\n\n  const addTopicsMenu = useMemo(\n    () => (\n      <AddTopic\n        topics={topics.map(({ name }) => name).filter((topic) => !availableAndEnabledMarkerTopics.includes(topic))}\n        onSelectTopic={(topic) =>\n          saveConfig({\n            enabledMarkerTopics: [...enabledMarkerTopics, topic],\n            customMarkerTopicOptions: [...customMarkerTopicOptions, topic],\n          })\n        }\n      />\n    ),\n    [topics, availableAndEnabledMarkerTopics, saveConfig, enabledMarkerTopics, customMarkerTopicOptions]\n  );\n\n  const markerDropdown = useMemo(() => {\n    const missingRequiredCameraInfo = scale !== 1 && !cameraInfo;\n    return (\n      <Dropdown\n        dataTest={\"markers-dropdown\"}\n        closeOnChange={false}\n        onChange={onToggleMarkerName}\n        value={enabledMarkerTopics}\n        text={availableAndEnabledMarkerTopics.length > 0 ? \"markers\" : \"no markers\"}\n        tooltip={\n          missingRequiredCameraInfo\n            ? \"camera_info is required when image resolution is set to less than 100%.\\nResolution can be changed in the panel settings.\"\n            : undefined\n        }\n        disabled={availableAndEnabledMarkerTopics.length === 0 || missingRequiredCameraInfo}>\n        {availableAndEnabledMarkerTopics.map((topic) => (\n          <Item\n            icon={enabledMarkerTopics.includes(topic) ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n            key={topic}\n            value={topic}\n            className={style.dropdownItem}>\n            <span style={{ display: \"inline-block\", marginRight: \"15px\" }}>{topic}</span>\n            <TopicTimestamp text={renderedMarkerTimestamps[topic] || \"\"} />\n            {customMarkerTopicOptions.includes(topic) && (\n              <Icon\n                style={{ position: \"absolute\", right: \"10px\" }}\n                onClick={() =>\n                  saveConfig({\n                    enabledMarkerTopics: enabledMarkerTopics.filter((topicOption) => topicOption !== topic),\n                    customMarkerTopicOptions: customMarkerTopicOptions.filter((topicOption) => topicOption !== topic),\n                  })\n                }>\n                <CloseIcon />\n              </Icon>\n            )}\n          </Item>\n        ))}\n        {addTopicsMenu}\n      </Dropdown>\n    );\n  }, [\n    addTopicsMenu,\n    availableAndEnabledMarkerTopics,\n    cameraInfo,\n    customMarkerTopicOptions,\n    enabledMarkerTopics,\n    onToggleMarkerName,\n    renderedMarkerTimestamps,\n    saveConfig,\n    scale,\n  ]);\n\n  const onIconTextChange = useCallback((newVal: string) => {\n    saveConfig({ iconTextTemplate: newVal });\n  }, [saveConfig]);\n\n  const menuContent = useMemo(\n    () => (\n      <>\n        <Item icon={synchronize ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />} onClick={onToggleSynchronize}>\n          <span>Synchronize images and markers</span>\n        </Item>\n        <IconTextMenu value={iconTextTemplate || \"\"} onChange={onIconTextChange} />\n\n        <hr />\n        <SubMenu direction=\"right\" text={`Image resolution: ${(scale * 100).toFixed()}%`}>\n          {[0.2, 0.5, 1].map((value) => {\n            return (\n              <Item key={value} value={value} checked={scale === value} onClick={() => onChangeScale(value)}>\n                {(value * 100).toFixed()}%\n              </Item>\n            );\n          })}\n        </SubMenu>\n      </>\n    ),\n    [synchronize, onToggleSynchronize, iconTextTemplate, onIconTextChange, scale, onChangeScale]\n  );\n\n  const imageMessage = parsedFrame?.[cameraTopic];\n  const lastImageMessageRef = React.useRef(imageMessage);\n  if (imageMessage) {\n    lastImageMessageRef.current = imageMessage;\n  }\n  // Keep the last image message, if it exists, to render on the ImageCanvas.\n  // Improve perf by hiding the ImageCanvas while seeking, instead of unmounting and remounting it.\n  const imageMessageToRender = imageMessage || lastImageMessageRef.current;\n\n  const { pauseFrame } = useMessagePipeline(\n    useCallback((messagePipeline) => ({ pauseFrame: messagePipeline.pauseFrame }), [])\n  );\n  const onStartRenderImage = useCallback(() => {\n    const resumeFrame = pauseFrame(\"ImageView\");\n    const onFinishRenderImage = () => {\n      resumeFrame();\n    };\n    return onFinishRenderImage;\n  }, [pauseFrame]);\n\n  const toolbar = useMemo(() => {\n    return (\n      <PanelToolbar floating helpContent={helpContent} menuContent={menuContent}>\n        <div className={style.controls}>\n          {imageTopicDropdown}\n          {markerDropdown}\n        </div>\n      </PanelToolbar>\n    );\n  }, [imageTopicDropdown, markerDropdown, menuContent]);\n\n  const renderBottomBar = () => {\n    return (\n      <ChildToggle.ContainsOpen>\n        {(containsOpen) => {\n          const canTransformMarkers = getGlobalHooks()\n            .perPanelHooks()\n            .ImageView.canTransformMarkersByTopic(cameraTopic);\n\n          const topicTimestamp = (\n            <TopicTimestamp\n              style={{ padding: \"8px 8px 0px 0px\" }}\n              text={imageMessage ? formatTimeRaw(imageMessage.message.header.stamp) : \"\"}\n            />\n          );\n\n          if (!canTransformMarkers) {\n            return <BottomBar containsOpen={containsOpen}>{topicTimestamp}</BottomBar>;\n          }\n\n          return (\n            <BottomBar containsOpen={containsOpen}>\n              {topicTimestamp}\n              <Icon\n                onClick={() => saveConfig({ transformMarkers: !transformMarkers })}\n                tooltip={\n                  transformMarkers\n                    ? \"Markers are being transformed by webviz based on the camera model. Click to turn it off.\"\n                    : `Markers can be transformed by webviz based on the camera model. Click to turn it on.`\n                }\n                fade\n                medium>\n                <WavesIcon style={{ color: transformMarkers ? colors.orange : colors.textBright }} />\n              </Icon>\n            </BottomBar>\n          );\n        }}\n      </ChildToggle.ContainsOpen>\n    );\n  };\n\n  const showEmptyState = !imageMessage || (shouldSynchronize && !parsedFrame);\n\n  return (\n    <Flex col clip>\n      {toolbar}\n      {/* If rendered, EmptyState will hide the always-present ImageCanvas */}\n      {showEmptyState &&\n        renderEmptyState(cameraTopic, enabledMarkerTopics, shouldSynchronize, pendingSynchronizedMessages)}\n      {/* Always render the ImageCanvas because it's expensive to unmount and start up. */}\n      {imageMessageToRender && (\n        <ImageCanvas\n          topic={cameraTopicFullObject}\n          image={imageMessageToRender}\n          rawMarkerData={rawMarkerData}\n          iconMarkers={iconMarkersToRender}\n          config={config}\n          saveConfig={saveConfig}\n          onStartRenderImage={onStartRenderImage}\n        />\n      )}\n      {!showEmptyState && !isDemoMode && renderBottomBar()}\n    </Flex>\n  );\n}\n\nImageView.panelType = \"ImageViewPanel\";\nImageView.defaultConfig = getGlobalHooks().perPanelHooks().ImageView.defaultConfig;\nImageView.shortcuts = [\n  { description: \"Zoom in\", keys: [\"=\"] },\n  { description: \"Zoom out\", keys: [\"-\"] },\n  { description: \"Zoom to percentage (10% - 100%)\", keys: [\"\", \"1|2|...|9|0\"] },\n];\nexport default hot(Panel<Config>(ImageView));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport MagnifyIcon from \"@mdi/svg/svg/magnify.svg\";\nimport cx from \"classnames\";\nimport isEqual from \"lodash/isEqual\";\nimport omit from \"lodash/omit\";\nimport panzoom from \"panzoom\";\nimport React from \"react\";\nimport OutsideClickHandler from \"react-outside-click-handler\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport shallowequal from \"shallowequal\";\nimport styled from \"styled-components\";\nimport uuid from \"uuid\";\n\nimport IconMarkers from \"./IconMarkers\";\nimport styles from \"./ImageCanvas.module.scss\";\nimport ImageCanvasWorker from \"./ImageCanvas.worker\";\nimport ImageCanvasRenderer from \"./ImageCanvasRenderer\";\nimport type { Config, SaveImagePanelConfig } from \"./index\";\nimport { checkOutOfBounds, type Dimensions } from \"./util\";\nimport ContextMenu from \"webviz-core/src/components/ContextMenu\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport Menu, { Item } from \"webviz-core/src/components/Menu\";\nimport type { Message, Topic, TypedMessage } from \"webviz-core/src/players/types\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { CameraInfo, Icon2dMarkersMessage } from \"webviz-core/src/types/Messages\";\nimport { downloadFiles } from \"webviz-core/src/util\";\nimport debouncePromise from \"webviz-core/src/util/debouncePromise\";\nimport Rpc, { createLinkedChannels } from \"webviz-core/src/util/Rpc\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\nimport supportsOffscreenCanvas from \"webviz-core/src/util/supportsOffscreenCanvas\";\nimport WebWorkerManager from \"webviz-core/src/util/WebWorkerManager\";\n\ntype OnFinishRenderImage = () => void;\ntype Props = {|\n  topic: ?Topic,\n  image: ?Message,\n  iconMarkers?: TypedMessage<Icon2dMarkersMessage>[],\n  rawMarkerData: {|\n    markers: Message[],\n    scale: number,\n    transformMarkers: boolean,\n    cameraInfo: ?CameraInfo,\n  |},\n  config: Config,\n  saveConfig: SaveImagePanelConfig,\n  onStartRenderImage: () => OnFinishRenderImage,\n  useMainThreadRenderingForTesting?: boolean,\n|};\n\ntype State = {|\n  error: ?Error,\n  openZoomChart: boolean,\n|};\n\nconst SErrorMessage = styled.div`\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  position: absolute;\n  align-items: center;\n  justify-content: center;\n  color: ${colors.red};\n`;\n\nconst MAX_ZOOM_PERCENTAGE = 1000;\nconst ZOOM_STEP = 5;\n\nconst webWorkerManager = new WebWorkerManager(ImageCanvasWorker, 1);\n\ntype CanvasRenderer = {|\n  type: \"mainThread\" | \"worker\",\n  // This is nullable because we destroy the worker whenever we unmount and recreate it if we remount.\n  rpc: ?Rpc,\n|};\n\nexport default class ImageCanvas extends React.Component<Props, State> {\n  _canvasRef = React.createRef<HTMLCanvasElement>();\n  _divRef = React.createRef<HTMLElement>();\n  _id: string;\n  _canvasRenderer: CanvasRenderer;\n  state = {\n    error: undefined,\n    openZoomChart: false,\n  };\n\n  constructor(props: Props) {\n    super(props);\n    this._id = uuid.v4();\n    // If we support offscreen canvas, use the ImageCanvasWorker because it improves performance by moving canvas\n    // operations off of the main thread. Allow an override for testing / stories.\n    const type = !supportsOffscreenCanvas() || props.useMainThreadRenderingForTesting ? \"mainThread\" : \"worker\";\n    this._canvasRenderer = { type, rpc: this._instantiateRpc(type) };\n  }\n\n  _instantiateRpc(type: \"mainThread\" | \"worker\") {\n    if (type === \"mainThread\") {\n      const { local, remote } = createLinkedChannels();\n      new ImageCanvasRenderer(new Rpc(remote));\n      return new Rpc(local);\n    }\n    return webWorkerManager.registerWorkerListener(this._id);\n  }\n\n  // Returns the existing RPC worker, or initializes one if it doesn't exist yet.\n  _getRpcWorker = (): Rpc => {\n    // Create the rpc if it's null. Only possible after unmount, probably not necessary...\n    return (this._canvasRenderer.rpc = this._canvasRenderer.rpc || this._instantiateRpc(this._canvasRenderer.type));\n  };\n\n  _setCanvasRef = (canvas: ?HTMLCanvasElement) => {\n    if (canvas) {\n      this.loadZoomFromConfig();\n      // $FlowFixMe This is a function that is not yet in Flow.\n      const transferableCanvas = this._canvasRenderer.type === \"worker\" ? canvas.transferControlToOffscreen() : canvas;\n      this._getRpcWorker().send<void>(\"initialize\", { id: this._id, canvas: transferableCanvas }, [transferableCanvas]);\n      this._canvasRef.current = canvas;\n    }\n  };\n\n  panZoomCanvas: any = null;\n  bitmapDimensions: Dimensions = { width: 0, height: 0 };\n\n  keepInBounds = (div: HTMLElement) => {\n    const { x, y, scale } = this.panZoomCanvas.getTransform();\n    if (isNaN(x) || isNaN(y)) {\n      sendNotification(\"Tried to keep canvas in bounds but encountered invalid transform values\", \"\", \"app\", \"warn\");\n      return;\n    }\n    // When zoom is 1, the percentage is fitPercentage\n    // (fitPercent * scale) / 100) is the zoomScale for now\n    const updatedPercentage = scale * 100;\n    const rect = div.getBoundingClientRect();\n    const { width, height } = rect;\n    const offset = checkOutOfBounds(\n      x,\n      y,\n      width,\n      height,\n      // calculate the true width and height of image right now\n      (this.bitmapDimensions.width * updatedPercentage) / 100,\n      (this.bitmapDimensions.height * updatedPercentage) / 100\n    );\n    this.props.saveConfig({ mode: \"other\", offset, zoomPercentage: updatedPercentage });\n    if (offset[0] !== x || offset[1] !== y) {\n      this.panZoomCanvas.moveTo(offset[0], offset[1]);\n    }\n  };\n\n  createPanZoom = () => {\n    const canvas = this._canvasRef.current;\n    const div = this._divRef.current;\n    if (canvas && div) {\n      this.panZoomCanvas = panzoom(canvas, {\n        maxZoom: MAX_ZOOM_PERCENTAGE / 100,\n        minZoom: 0,\n        zoomSpeed: 0.05,\n        smoothScroll: false,\n        filterKey(_e, _dx, _dy, _dz) {\n          // don't let panzoom handle keyboard event\n          // because zoom in and out has the wrong offset change\n          // left right up and down is different what we use in our daily life\n          return true;\n        },\n      });\n      this.panZoomCanvas.on(\"zoom\", (_e) => {\n        const { scale } = this.panZoomCanvas.getTransform();\n        const minPercent = this.fitPercent() * 0.8;\n        if (scale < minPercent / 100) {\n          this.goToTargetPercentage(minPercent);\n        }\n        this.keepInBounds(div);\n      });\n      this.panZoomCanvas.on(\"pan\", (_e) => this.keepInBounds(div));\n    }\n  };\n\n  getImageViewport = () => {\n    const div = this._divRef.current;\n\n    if (!div) {\n      throw new Error(\"Don't have div to get width and height\");\n    }\n    return { imageViewportWidth: div.offsetWidth, imageViewportHeight: div.offsetHeight };\n  };\n\n  moveToCenter = () => {\n    if (!this.panZoomCanvas) {\n      sendNotification(\"Tried to center when there is no panZoomCanvas\", \"\", \"app\", \"error\");\n      return;\n    }\n    const { width, height } = this.bitmapDimensions;\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    this.panZoomCanvas.moveTo(\n      (imageViewportWidth - (width * imageViewportHeight) / height) / 2,\n      (imageViewportHeight - (height * imageViewportWidth) / width) / 2\n    );\n  };\n\n  fitPercent = () => {\n    const { width, height } = this.bitmapDimensions;\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    return Math.min(imageViewportWidth / width, imageViewportHeight / height) * 100;\n  };\n\n  fillPercent = () => {\n    const { width, height } = this.bitmapDimensions;\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    return Math.max(imageViewportWidth / width, imageViewportHeight / height) * 100;\n  };\n\n  loadZoomFromConfig = () => {\n    if (this.panZoomCanvas) {\n      return;\n    }\n    this.createPanZoom();\n    this.applyPanZoom();\n  };\n\n  componentDidMount() {\n    this.renderCurrentImage();\n    document.addEventListener(\"visibilitychange\", this._onVisibilityChange);\n  }\n\n  _onVisibilityChange = () => {\n    // HACK: There is a Chrome bug that causes 2d canvas elements to get cleared when the page\n    // becomes hidden on certain hardware:\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=588434\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=591374\n    // We can hack around this by forcing a re-render when the page becomes visible again.\n    // Ideally we can find a global workaround but we're not sure there is one  can't just\n    // twiddle the width/height attribute of the canvas as suggested in one of the comments on\n    // a chrome bug; it seems like you really have to redraw the frame from scratch.\n    if (document.visibilityState === \"visible\") {\n      this.renderCurrentImage();\n    }\n  };\n\n  componentWillUnmount() {\n    const canvasRenderer = this._canvasRenderer;\n    if (canvasRenderer.type === \"worker\") {\n      // Unset the RPC worker so that we can destroy the worker if it's no longer necessary.\n      webWorkerManager.unregisterWorkerListener(this._id);\n    }\n    canvasRenderer.rpc = null;\n    document.removeEventListener(\"visibilitychange\", this._onVisibilityChange);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const imageChanged = !shallowequal(prevProps, this.props, (a, b, key) => {\n      if (key === \"rawMarkerData\") {\n        return shallowequal(a, b, (innerA, innerB, innerKey) => {\n          if (innerKey === \"markers\") {\n            return shallowequal(innerA, innerB);\n          } else if (innerKey === \"cameraInfo\") {\n            return isEqual(omit(innerA, \"header\"), omit(innerB, \"header\"));\n          }\n        });\n      }\n    });\n    if (imageChanged) {\n      this.renderCurrentImage();\n    }\n  }\n\n  downloadImage = () => {\n    const { topic, image } = this.props;\n    const canvas = this._canvasRef.current;\n\n    // satisfy flow\n    if (!canvas || !image || !topic) {\n      return;\n    }\n\n    // context: https://stackoverflow.com/questions/37135417/download-canvas-as-png-in-fabric-js-giving-network-error\n    // read the canvas data as an image (png)\n    canvas.toBlob((blob) => {\n      // name the image the same name as the topic\n      // note: the / characters in the file name will be replaced with _\n      // by the browser\n      // remove the leading / so the image name doesn't start with _\n      const topicName = topic.name.slice(1);\n      const stamp = image.message.header ? image.message.header.stamp : { sec: 0, nsec: 0 };\n      const fileName = `${topicName}-${stamp.sec}-${stamp.nsec}`;\n      downloadFiles([{ blob, fileName }]);\n    });\n  };\n\n  onCanvasRightClick = (e: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    e.stopPropagation();\n    e.preventDefault();\n    return ContextMenu.show(\n      e.clientX,\n      e.clientY,\n      <Menu>\n        <Item onClick={this.downloadImage}>Download Image</Item>\n      </Menu>\n    );\n  };\n\n  clickMagnify = () => {\n    this.setState((state) => ({ openZoomChart: !state.openZoomChart }));\n  };\n  onZoomFit = () => {\n    const fitPercent = this.fitPercent();\n    this.panZoomCanvas.zoomAbs(0, 0, fitPercent / 100);\n    this.moveToCenter();\n    this.props.saveConfig({ mode: \"fit\", zoomPercentage: fitPercent });\n  };\n\n  onZoomFill = () => {\n    const fillPercent = this.fillPercent();\n    this.panZoomCanvas.zoomAbs(0, 0, fillPercent / 100);\n    this.moveToCenter();\n    this.props.saveConfig({ mode: \"fill\", zoomPercentage: fillPercent });\n  };\n\n  goToTargetPercentage = (targetPercentage: number) => {\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    this.panZoomCanvas.zoomAbs(imageViewportWidth / 2, imageViewportHeight / 2, targetPercentage / 100);\n  };\n\n  onZoomMinus = () => {\n    const { zoomPercentage } = this.props.config;\n    const targetPercentage = Math.max((zoomPercentage || 100) - ZOOM_STEP, this.fitPercent() * 0.8);\n    this.goToTargetPercentage(targetPercentage);\n  };\n\n  onZoomPlus = () => {\n    const { zoomPercentage } = this.props.config;\n    const targetPercentage = Math.min((zoomPercentage || 100) + ZOOM_STEP, MAX_ZOOM_PERCENTAGE);\n    this.goToTargetPercentage(targetPercentage);\n  };\n\n  renderCurrentImage = debouncePromise(async () => {\n    const { image, topic, rawMarkerData, onStartRenderImage } = this.props;\n    if (!topic) {\n      return;\n    }\n\n    const onFinishImageRender = onStartRenderImage();\n    try {\n      const worker = this._getRpcWorker();\n      const dimensions = await worker.send<?Dimensions>(\"renderImage\", {\n        id: this._id,\n        imageMessage: image,\n        imageMessageDatatype: topic.datatype,\n        rawMarkerData,\n      });\n\n      if (dimensions) {\n        this.bitmapDimensions = dimensions;\n        this.loadZoomFromConfig();\n      }\n      if (this.state.error) {\n        this.setState({ error: undefined });\n      }\n    } catch (error) {\n      console.error(error);\n      sendNotification(`failed to decode image on ${image?.topic || \"\"}:`, \"\", \"user\", \"error\");\n      this.setState({ error });\n    } finally {\n      onFinishImageRender();\n    }\n  });\n\n  renderZoomChart = () => {\n    return this.state.openZoomChart ? (\n      <div className={styles.zoomChart} data-zoom-menu>\n        <div className={cx(styles.menuItem, styles.notInteractive)}>Use mousewheel or buttons to zoom</div>\n        <div className={cx(styles.menuItem, styles.borderBottom)}>\n          <button className={styles.round} onClick={this.onZoomMinus} data-panel-minus-zoom>\n            -\n          </button>\n          <span>{`${(this.props.config.zoomPercentage || 100).toFixed(1)}%`}</span>\n          <button className={styles.round} onClick={this.onZoomPlus} data-panel-add-zoom>\n            +\n          </button>\n        </div>\n        <Item className={styles.borderBottom} onClick={() => this.goToTargetPercentage(100)} dataTest={\"hundred-zoom\"}>\n          Zoom to 100%\n        </Item>\n        <Item className={styles.borderBottom} onClick={this.onZoomFit} dataTest={\"fit-zoom\"}>\n          Zoom to fit\n        </Item>\n        <Item onClick={this.onZoomFill} dataTest={\"fill-zoom\"}>\n          Zoom to fill\n        </Item>\n      </div>\n    ) : null;\n  };\n\n  applyPanZoom = () => {\n    if (!this.panZoomCanvas) {\n      return;\n    }\n\n    const { imageViewportHeight, imageViewportWidth } = this.getImageViewport();\n    if (!imageViewportHeight || !imageViewportWidth) {\n      // While dragging, the viewport may have zero height or width, which throws off the panZoomCanvas\n      return;\n    }\n\n    const { mode, zoomPercentage, offset } = this.props.config;\n    if (!mode || mode === \"fit\") {\n      this.onZoomFit();\n    } else if (mode === \"fill\") {\n      this.onZoomFill();\n    } else if (mode === \"other\") {\n      // Go to prevPercentage\n      this.goToTargetPercentage(zoomPercentage || 100);\n      this.panZoomCanvas.moveTo(offset ? offset[0] : 0, offset ? offset[1] : 0);\n    }\n  };\n\n  keyDownHandlers = {\n    \"=\": () => {\n      this.onZoomPlus();\n    },\n    \"-\": () => {\n      this.onZoomMinus();\n    },\n    \"1\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(10);\n      }\n    },\n    \"2\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(20);\n      }\n    },\n    \"3\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(30);\n      }\n    },\n    \"4\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(40);\n      }\n    },\n    \"5\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(50);\n      }\n    },\n    \"6\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(60);\n      }\n    },\n    \"7\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(70);\n      }\n    },\n    \"8\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(80);\n      }\n    },\n    \"9\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(90);\n      }\n    },\n    \"0\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(100);\n      }\n    },\n  };\n\n  _getIconMarkerWrapperStyle() {\n    // We need to apply the canvas scaling and position to the icon marker wrapper so the icons are\n    // properly positioned according to the scaled image.\n    const canvas = this._canvasRef.current;\n    if (!canvas || !this.panZoomCanvas) {\n      return {};\n    }\n    const { x, y, scale } = this.panZoomCanvas.getTransform();\n    return {\n      width: canvas.width * scale,\n      height: canvas.height * scale,\n      left: x,\n      top: y,\n    };\n  }\n\n  render() {\n    const {\n      config: { mode, zoomPercentage, offset, iconTextTemplate },\n      saveConfig,\n      iconMarkers,\n    } = this.props;\n    if (zoomPercentage && (zoomPercentage > MAX_ZOOM_PERCENTAGE || zoomPercentage < 0)) {\n      sendNotification(\n        `zoomPercentage for the image panel was ${zoomPercentage}, but must be between 0 and ${MAX_ZOOM_PERCENTAGE}. It has been reset to 100.`,\n        \"\",\n        \"user\",\n        \"warn\"\n      );\n      saveConfig({ zoomPercentage: 100 });\n    }\n    if (offset && offset.length !== 2) {\n      sendNotification(\n        `offset for the image panel was ${JSON.stringify(\n          offset\n        )}, but should be an array of length 2. It has been reset to [0, 0].`,\n        \"\",\n        \"user\",\n        \"warn\"\n      );\n      saveConfig({ offset: [0, 0] });\n    }\n\n    return (\n      <ReactResizeDetector handleWidth handleHeight onResize={this.applyPanZoom}>\n        <div className={styles.root} ref={this._divRef}>\n          <KeyListener keyDownHandlers={this.keyDownHandlers} />\n          <div style={{ position: \"relative\" }}>\n            {this.state.error && <SErrorMessage>Error: {this.state.error.message}</SErrorMessage>}\n            <canvas onContextMenu={this.onCanvasRightClick} ref={this._setCanvasRef} className={styles.canvas} />\n            {iconMarkers && iconMarkers.length > 0 && (\n              <IconMarkers\n                style={this._getIconMarkerWrapperStyle()}\n                zoomPercentage={zoomPercentage || 1}\n                iconMarkers={iconMarkers}\n                iconTextTemplate={iconTextTemplate}\n              />\n            )}\n          </div>\n          <OutsideClickHandler\n            onOutsideClick={() => {\n              this.setState({ openZoomChart: false });\n            }}>\n            {this.renderZoomChart()}\n            <button className={styles.magnify} onClick={this.clickMagnify} data-magnify-icon>\n              <MagnifyIcon />{\" \"}\n              {mode === \"other\" ? <span>{zoomPercentage ? `${zoomPercentage.toFixed(1)}%` : \"null\"}</span> : null}\n            </button>\n          </OutsideClickHandler>\n        </div>\n      </ReactResizeDetector>\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useState, useRef, useCallback } from \"react\";\nimport styled from \"styled-components\";\n\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport {\n  DEFAULT_TEXT_COLOR,\n  sendIconTypeDeprecatedNotification,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/commands/OverlayProjector\";\nimport { ICON_BY_TYPE } from \"webviz-core/src/panels/ThreeDimensionalViz/constants\";\nimport { BG_COLOR, SText } from \"webviz-core/src/panels/ThreeDimensionalViz/IconOverlay\";\nimport { SRow, SValue } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions\";\nimport ObjectDetails from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/ObjectDetails\";\nimport TopicLink from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/TopicLink\";\nimport useLinkedGlobalVariables from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport { parseStringTemplate } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/index\";\nimport { getUpdatedGlobalVariablesBySelectedObject } from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport type { TypedMessage } from \"webviz-core/src/players/types\";\nimport type { Icon2dMarkersMessage, Icon2dMarker } from \"webviz-core/src/types/Messages\";\nimport { colorToRgbaString } from \"webviz-core/src/util/colorUtils\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst ICON_WRAPPER_HEIGHT = 24;\nconst ICON_SIZE = 16;\n\nconst SIconMarker = styled.div`\n  border-radius: ${ICON_WRAPPER_HEIGHT / 2}px;\n  box-shadow: 0px 1px 8px rgba(0, 0, 0, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.075);\n  display: flex;\n  align-items: center;\n  background: ${BG_COLOR};\n  position: absolute;\n  cursor: pointer;\n  font-size: 12px;\n  padding: ${(ICON_WRAPPER_HEIGHT - ICON_SIZE) / 2}px;\n`;\nconst SInnerWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n`;\n\nconst SObjectDetailsWrapper = styled.div`\n  position: absolute;\n  padding: 12px;\n  background: ${colors.DARK};\n  font-size: 12px;\n  max-width: 288px;\n`;\n\ntype Props = {|\n  style: { [attr: string]: string | number },\n  iconMarkers: TypedMessage<Icon2dMarkersMessage>[],\n  iconTextTemplate: ?string,\n  zoomPercentage: number, // Use the zoomPercentage to calculate the icon position.\n|};\n\ntype ClickedObject = {|\n  left: number,\n  top: number,\n  object: $ReadOnly<{|\n    interactionData: $ReadOnly<{ topic: string, originalMessage: Icon2dMarker }>,\n  |}>,\n|};\nexport default function IconMarkers({ iconMarkers, iconTextTemplate, style, zoomPercentage }: Props) {\n  const [clickedObject, setClickedObject] = useState<?ClickedObject>();\n  const containerRef = useRef<?HTMLDivElement>();\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n\n  const { setGlobalVariables } = useGlobalVariables();\n\n  const unsetClickedObject = useCallback(() => setClickedObject(undefined), []);\n  const onClickObjectDetailsWrapper = useCallback((e: MouseEvent) => e.stopPropagation(), []);\n\n  return (\n    <div onClick={unsetClickedObject} ref={containerRef} style={{ ...style, position: \"absolute\" }}>\n      {iconMarkers.map(({ message, topic }) => {\n        return (\n          <SInnerWrapper key={topic}>\n            {message.markers.map((object, idx) => {\n              const {\n                position: { x, y },\n                icon_type,\n                metadata = {},\n              } = object;\n              let iconTypes = metadata.icon_types;\n              const iconType = icon_type || metadata.icon_type;\n              if (!iconTypes && iconType) {\n                sendIconTypeDeprecatedNotification();\n                iconTypes = [{ icon_type: iconType }];\n              }\n              if (!iconTypes) {\n                return null;\n              }\n\n              const text = object.text || (iconTextTemplate && parseStringTemplate(iconTextTemplate, metadata)) || \"\";\n              const textColor = object.outline_color || DEFAULT_TEXT_COLOR;\n\n              return (\n                <SIconMarker\n                  onClick={(ev: MouseEvent) => {\n                    ev.stopPropagation();\n                    if (!containerRef.current) {\n                      return;\n                    }\n                    const containerRect = containerRef.current.getBoundingClientRect();\n                    const left = ev.clientX - containerRect.left;\n                    const top = ev.clientY - containerRect.top;\n                    const originalMessage = object;\n\n                    if (\n                      clickedObject &&\n                      clickedObject.object.interactionData.originalMessage.id === originalMessage.id\n                    ) {\n                      // Unset the state when clicked the same object.\n                      setClickedObject(undefined);\n                      return;\n                    }\n                    setClickedObject({\n                      left,\n                      top,\n                      object: { interactionData: { topic, originalMessage } },\n                    });\n                    const newGlobalVariables = getUpdatedGlobalVariablesBySelectedObject(\n                      {\n                        instanceIndex: undefined,\n                        object: { ...object, interactionData: { topic, originalMessage } },\n                      },\n                      linkedGlobalVariables\n                    );\n                    if (newGlobalVariables) {\n                      setGlobalVariables(newGlobalVariables);\n                    }\n                  }}\n                  // Place the svg icon at the center of the specified position. Ok to let the text flow to right.\n                  style={{\n                    color: colorToRgbaString(textColor),\n                    borderRadius: ICON_WRAPPER_HEIGHT / 2,\n                    left: (x * zoomPercentage) / 100 - ICON_WRAPPER_HEIGHT / 2,\n                    top: (y * zoomPercentage) / 100 - ICON_WRAPPER_HEIGHT / 2,\n                  }}\n                  key={`${icon_type}_${idx}`}>\n                  {iconTypes.map((iconConfig, idx1) => {\n                    const SvgIcon = ICON_BY_TYPE[`${iconConfig.icon_type}`] || ICON_BY_TYPE.DEFAULT;\n                    let fill = colors.BLUE;\n                    if (iconConfig.color) {\n                      const { r, g, b, a } = iconConfig.color; // Use color to control the background color of the icon.\n                      fill = `rgba(${r * 255},${g * 255},${b * 255},${a})`;\n                    }\n                    return <SvgIcon key={`${icon_type}${idx1}`} width={ICON_SIZE} height={ICON_SIZE} fill={fill} />;\n                  })}\n                  {text && <SText>{text}</SText>}\n                </SIconMarker>\n              );\n            })}\n            {clickedObject && (\n              <SObjectDetailsWrapper\n                onClick={onClickObjectDetailsWrapper}\n                style={{\n                  left: clickedObject.left + ICON_WRAPPER_HEIGHT / 2,\n                  top: clickedObject.top + ICON_WRAPPER_HEIGHT / 2,\n                }}>\n                <SRow>\n                  <SValue>\n                    <TopicLink topic={clickedObject.object.interactionData.topic} />\n                  </SValue>\n                </SRow>\n                <ObjectDetails selectedObject={clickedObject.object.interactionData.originalMessage} />\n              </SObjectDetailsWrapper>\n            )}\n          </SInnerWrapper>\n        );\n      })}\n    </div>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LinkPlusIcon from \"@mdi/svg/svg/link-plus.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport GlobalVariableLink, { SPath, GlobalVariableName } from \"./GlobalVariableLink/index\";\nimport { SEmptyState } from \"./index\";\nimport { getPath } from \"./interactionUtils\";\nimport { type LinkedGlobalVariables } from \"./useLinkedGlobalVariables\";\nimport Icon from \"webviz-core/src/components/Icon\";\n\nconst STable = styled.table`\n  td {\n    padding: 0.3em;\n    border: none;\n    vertical-align: middle;\n  }\n`;\n\ntype Props = {\n  linkedGlobalVariables: LinkedGlobalVariables,\n};\n\nexport default function LinkedGlobalVariableList({ linkedGlobalVariables }: Props) {\n  if (linkedGlobalVariables.length === 0) {\n    return (\n      <SEmptyState>\n        Click the{\" \"}\n        <Icon style={{ display: \"inline\", verticalAlign: \"middle\", lineHeight: 1 }} clickable={false}>\n          <LinkPlusIcon />\n        </Icon>{\" \"}\n        icon in the Clicked object tab to link values with global variables.\n      </SEmptyState>\n    );\n  }\n  return (\n    <>\n      <SEmptyState>Clicking on objects from these topics will update the linked global variables.</SEmptyState>\n      <STable>\n        <tbody>\n          {linkedGlobalVariables.map((linkedGlobalVariable, index) => (\n            <tr key={index}>\n              <td>\n                <GlobalVariableLink\n                  linkedGlobalVariable={linkedGlobalVariable}\n                  unlinkTooltip={\n                    <span>\n                      Unlink <GlobalVariableName name={linkedGlobalVariable.name} />\n                    </span>\n                  }\n                />\n              </td>\n              <td style={{ wordBreak: \"break-all\" }}>\n                {linkedGlobalVariable.topic}.<SPath>{getPath(linkedGlobalVariable.markerKeyPath)}</SPath>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </STable>\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nconst SGlobalVariableName = styled.span`\n  color: #ccb862;\n  font-weight: bold;\n  max-width: 100px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  padding-left: ${(props) => (props.leftPadding ? \"6px\" : 0)};\n`;\n\nexport default function GlobalVariableName({ name, leftPadding }: {| name: string, leftPadding?: boolean |}) {\n  return (\n    <SGlobalVariableName title={name} leftPadding={leftPadding}>\n      ${name}\n    </SGlobalVariableName>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LinkPlusIcon from \"@mdi/svg/svg/link-plus.svg\";\nimport classNames from \"classnames\";\nimport * as React from \"react\";\n\nimport useLinkedGlobalVariables from \"../useLinkedGlobalVariables\";\nimport { SGlobalVariableForm, GlobalVariableName } from \"./index\";\nimport UnlinkGlobalVariables from \"./UnlinkGlobalVariables\";\nimport Button from \"webviz-core/src/components/Button\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\ntype AddToLinkedGlobalVariable = {\n  topic: string,\n  markerKeyPath: string[],\n  variableValue: any,\n};\n\ntype Props = {\n  highlight?: boolean,\n  addToLinkedGlobalVariable: AddToLinkedGlobalVariable,\n  style?: any,\n  tooltip?: React.Node,\n};\n\nfunction getInitialName(markerKeyPath: string[]) {\n  return markerKeyPath\n    .slice(0, 2)\n    .reverse()\n    .join(\"_\");\n}\n\nexport default function LinkToGlobalVariable({\n  style = {},\n  addToLinkedGlobalVariable: { topic, variableValue, markerKeyPath },\n  tooltip,\n  highlight,\n}: Props) {\n  const [isOpen, _setIsOpen] = React.useState<boolean>(false);\n  const [name, setName] = React.useState(() => getInitialName(markerKeyPath));\n\n  const setIsOpen = React.useCallback((newValue: boolean) => {\n    _setIsOpen(newValue);\n    if (newValue) {\n      setName(getInitialName(markerKeyPath));\n    }\n  }, [markerKeyPath]);\n\n  const { setGlobalVariables } = useGlobalVariables();\n  const { linkedGlobalVariables, setLinkedGlobalVariables } = useLinkedGlobalVariables();\n\n  const addLink = (ev) => {\n    ev.preventDefault();\n    setGlobalVariables({ [name]: variableValue });\n    const newLinkedGlobalVariables = [...linkedGlobalVariables, { topic, markerKeyPath, name }];\n    setLinkedGlobalVariables(newLinkedGlobalVariables);\n    setIsOpen(false);\n  };\n\n  const highlightIconStyle = highlight ? { color: colors.highlight } : {};\n\n  return (\n    <ChildToggle\n      dataTest={`link-${name}`}\n      position=\"above\"\n      onToggle={() => setIsOpen(!isOpen)}\n      isOpen={isOpen}\n      style={style}>\n      <Icon\n        className={classNames(\"link-icon\", { highlight })}\n        style={highlightIconStyle}\n        fade={!highlight}\n        tooltip={tooltip || \"Link this field to a global variable\"}\n        tooltipProps={{ placement: \"top\" }}>\n        <LinkPlusIcon />\n      </Icon>\n      <SGlobalVariableForm onSubmit={addLink} data-test=\"link-form\">\n        <p style={{ marginTop: 0, lineHeight: \"1.4\" }}>\n          When linked, clicking a new object from {topic} will update the global variable&nbsp;\n          <GlobalVariableName name={name} />.\n        </p>\n        <UnlinkGlobalVariables name={name} showList />\n        <input autoFocus type=\"text\" value={`$${name}`} onChange={(e) => setName(e.target.value.replace(/^\\$/, \"\"))} />\n        <p data-test=\"action-buttons\">\n          <Button primary={!!name} disabled={!name} onClick={addLink}>\n            Add Link\n          </Button>\n          <Button onClick={() => setIsOpen(false)}>Cancel</Button>\n        </p>\n      </SGlobalVariableForm>\n    </ChildToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\n\nimport { getPath } from \"../interactionUtils\";\nimport useLinkedGlobalVariables, { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport { SPath, SGlobalVariableForm, GlobalVariableName } from \"./index\";\nimport Button from \"webviz-core/src/components/Button\";\n\ntype Props = {\n  linkedGlobalVariable: LinkedGlobalVariable,\n  setIsOpen: (boolean) => void,\n};\nexport default function UnlinkGlobalVariable({\n  linkedGlobalVariable: { topic, markerKeyPath, name },\n  setIsOpen,\n}: Props) {\n  const { linkedGlobalVariables, setLinkedGlobalVariables } = useLinkedGlobalVariables();\n  return (\n    <SGlobalVariableForm style={{ marginLeft: 8 }} data-test=\"unlink-form\">\n      <p style={{ marginTop: 0, lineHeight: \"1.4\" }}>\n        Unlink <GlobalVariableName name={name} /> from {topic}.<SPath>{getPath(markerKeyPath)}</SPath>?\n      </p>\n      <Button\n        danger\n        onClick={() => {\n          const newLinkedGlobalVariables = linkedGlobalVariables.filter(\n            (linkedGlobalVariable) =>\n              !(\n                linkedGlobalVariable.topic === topic &&\n                isEqual(linkedGlobalVariable.markerKeyPath, markerKeyPath) &&\n                linkedGlobalVariable.name === name\n              )\n          );\n          setLinkedGlobalVariables(newLinkedGlobalVariables);\n          setIsOpen(false);\n        }}>\n        Unlink\n      </Button>\n      <Button onClick={() => setIsOpen(false)}>Cancel</Button>\n    </SGlobalVariableForm>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useCallback, useContext, useEffect } from \"react\";\nimport { type MouseEventObject } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport type { SelectedObject } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\nimport { type ClickedPosition } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport { ThreeDimensionalVizContext } from \"webviz-core/src/panels/ThreeDimensionalViz/ThreeDimensionalVizContext\";\nimport { getInteractionData, getObject } from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SInteractionContextMenu = styled.div`\n  position: fixed;\n  width: 240px;\n  background: ${colors.DARK4};\n  opacity: 0.9;\n  z-index: 101; /* above the Text marker */\n`;\n\nconst SMenu = styled.ul`\n  margin: 0;\n  padding: 0;\n`;\n\nconst STooltip = styled.div`\n  cursor: pointer;\n  background: ${colors.PURPLE1};\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: none;\n  padding: 8px;\n`;\n\nconst SMenuItem = styled.li`\n  cursor: pointer;\n  padding: 8px;\n  position: relative;\n  &:hover {\n    background: ${colors.PURPLE1};\n    ${STooltip} {\n      display: block;\n    }\n  }\n`;\n\nconst STopic = styled.div`\n  width: 100%;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n`;\n\nconst SId = styled.span`\n  color: ${colors.YELLOW1};\n`;\n\ntype Props = {\n  clickedPosition: ClickedPosition,\n  clickedObjects: MouseEventObject[],\n  selectObject: (MouseEventObject) => void,\n};\n\nexport default function InteractionContextMenu({ clickedObjects = [], clickedPosition = {}, selectObject }: Props) {\n  return (\n    <SInteractionContextMenu\n      style={{\n        top: clickedPosition.clientY,\n        left: clickedPosition.clientX,\n      }}>\n      <SMenu>\n        {clickedObjects.map((interactiveObject, index) => (\n          <InteractionContextMenuItem key={index} interactiveObject={interactiveObject} selectObject={selectObject} />\n        ))}\n      </SMenu>\n    </SInteractionContextMenu>\n  );\n}\n\nfunction InteractionContextMenuItem({\n  interactiveObject,\n  selectObject,\n}: {\n  selectObject: (?SelectedObject) => void,\n  interactiveObject?: MouseEventObject,\n}) {\n  const object = getObject(interactiveObject);\n  const topic = getInteractionData(interactiveObject)?.topic;\n  const menuText = (\n    <>\n      {object.id && <SId>{object.id}</SId>}\n      {object.interactionData?.topic}\n    </>\n  );\n\n  const { setHoveredMarkerMatchers } = useContext(ThreeDimensionalVizContext);\n  const onMouseEnter = useCallback(() => {\n    if (topic) {\n      const { id, ns } = object;\n      const checks = [{ markerKeyPath: [\"id\"], value: id }];\n      if (ns) {\n        checks.push({ markerKeyPath: [\"ns\"], value: ns });\n      }\n      return setHoveredMarkerMatchers([{ topic, checks }]);\n    }\n  }, [object, setHoveredMarkerMatchers, topic]);\n  const onMouseLeave = useCallback(() => setHoveredMarkerMatchers([]), [setHoveredMarkerMatchers]);\n  useEffect(() => onMouseLeave, [onMouseLeave]);\n\n  const selectItemObject = useCallback(() => selectObject(interactiveObject), [interactiveObject, selectObject]);\n\n  return (\n    <SMenuItem onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} data-test=\"InteractionContextMenuItem\">\n      <STopic key={object.id || object.interactionData?.topic} onClick={selectItemObject}>\n        {menuText}\n        <STooltip>{menuText}</STooltip>\n      </STopic>\n    </SMenuItem>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { DATATYPE } from \"./types\";\nimport log from \"webviz-core/src/panels/ThreeDimensionalViz/logger\";\n\nexport interface FieldReader {\n  read(data: number[] | Uint8Array, index: number): number;\n}\n\n// Shared between all readers. The JS main thread doesn't get preempted. Instantiating the buffer is\n// weirdly expensive. The buffer needs to be big enough for the largest reader type.\nconst buffer = new ArrayBuffer(4);\nconst view = new DataView(buffer);\n\nexport class Float32Reader implements FieldReader {\n  offset: number;\n  constructor(offset: number) {\n    this.offset = offset;\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    view.setUint8(0, data[index + this.offset]);\n    view.setUint8(1, data[index + this.offset + 1]);\n    view.setUint8(2, data[index + this.offset + 2]);\n    view.setUint8(3, data[index + this.offset + 3]);\n    return view.getFloat32(0, true);\n  }\n}\n\nexport class Int32Reader implements FieldReader {\n  offset: number;\n  constructor(offset: number) {\n    this.offset = offset;\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    view.setUint8(0, data[index + this.offset]);\n    view.setUint8(1, data[index + this.offset + 1]);\n    view.setUint8(2, data[index + this.offset + 2]);\n    view.setUint8(3, data[index + this.offset + 3]);\n    return view.getInt32(0, true);\n  }\n}\n\nexport class Uint16Reader implements FieldReader {\n  offset: number;\n  constructor(offset: number) {\n    this.offset = offset;\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    view.setUint8(0, data[index + this.offset]);\n    view.setUint8(1, data[index + this.offset + 1]);\n    return view.getUint16(0, true);\n  }\n}\nexport class Int16Reader implements FieldReader {\n  offset: number;\n  constructor(offset: number) {\n    this.offset = offset;\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    view.setUint8(0, data[index + this.offset]);\n    view.setUint8(1, data[index + this.offset + 1]);\n    return view.getInt16(0, true);\n  }\n}\n\nexport class Uint8Reader implements FieldReader {\n  offset: number;\n  constructor(offset: number) {\n    this.offset = offset;\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    return data[index + this.offset];\n  }\n}\n\nexport function getReader(datatype: number, offset: number) {\n  switch (datatype) {\n    case DATATYPE.float32:\n      return new Float32Reader(offset);\n    case DATATYPE.uint8:\n      return new Uint8Reader(offset);\n    case DATATYPE.uint16:\n      return new Uint16Reader(offset);\n    case DATATYPE.int16:\n      return new Int16Reader(offset);\n    case DATATYPE.int32:\n      return new Int32Reader(offset);\n    default:\n      log.error(\"Unsupported datatype\", datatype);\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { throttle } from \"lodash\";\n\nconst DELAY = 1000;\n\nconst warn = throttle((...args: any[]) => console.warn(...args), DELAY);\nconst error = throttle((...args: any[]) => console.error(...args), DELAY);\nconst info = throttle((...args: any[]) => console.info(...args), DELAY);\nconst debug = throttle((...args: any[]) => console.log(...args), DELAY);\n\nexport default {\n  debug,\n  info,\n  warn,\n  error,\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type FieldOffsetsAndReaders } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/buffers\";\nimport { type VertexBuffer } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/types\";\n\n// Allows converting azimuth, elevation, range points to x, y, z points.\nconst maybeConvertSphericalCoordinatePointCloudToCartesian = ({\n  data,\n  fields,\n  pointCount,\n  stride,\n  sphericalRangeScale,\n}: $ReadOnly<{|\n  data: Uint8Array,\n  fields: FieldOffsetsAndReaders,\n  pointCount: number,\n  stride: number,\n  sphericalRangeScale?: number,\n|}>): ?VertexBuffer => {\n  if (!fields.azimuth) {\n    return null;\n  }\n  const azimuthReader = fields.azimuth?.reader;\n  const elevationReader = fields.elevation?.reader;\n  const rangeReader = fields.scaled_range?.reader;\n  const toRadians = (centideg) => (0.01 * centideg * Math.PI) / 180.0;\n\n  if (azimuthReader && elevationReader && rangeReader) {\n    const COMPONENT_COUNT = 3;\n    const buffer = new Float32Array(COMPONENT_COUNT * pointCount);\n    for (let i = 0; i < pointCount; i++) {\n      const pointStart = i * stride;\n      const azimuth = toRadians(azimuthReader.read(data, pointStart));\n      const elevation = toRadians(elevationReader.read(data, pointStart));\n      const range = (sphericalRangeScale || 1) * rangeReader.read(data, pointStart);\n      const x = range * Math.cos(elevation) * Math.cos(azimuth);\n      const y = range * Math.cos(elevation) * Math.sin(azimuth);\n      const z = range * Math.sin(elevation);\n      const offset = i * COMPONENT_COUNT;\n      buffer[offset + 0] = x;\n      buffer[offset + 1] = y;\n      buffer[offset + 2] = z;\n    }\n    return {\n      buffer,\n      offset: 0,\n      stride: COMPONENT_COUNT,\n    };\n  }\n};\n\nexport default maybeConvertSphericalCoordinatePointCloudToCartesian;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ExportVariantIcon from \"@mdi/svg/svg/export-variant.svg\";\nimport React, { useState, useCallback } from \"react\";\nimport Tree from \"react-json-tree\";\n\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Menu from \"webviz-core/src/components/Menu\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport { downloadFiles } from \"webviz-core/src/util\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\n\ntype Props = {\n  pointDetails: {\n    index: number,\n    color: [number, number, number, number],\n    decodedData: { [field: string]: number }[],\n  },\n};\n\nfunction pointsToCsv(data) {\n  // There's always at least one point -- you can't click on \"no points\".\n  const fieldNames = Object.keys(data[0] ?? {});\n  const rows = [fieldNames.join(\",\")];\n  data.forEach((row) => {\n    rows.push(fieldNames.map((name) => row[name] ?? \"\").join(\",\"));\n  });\n  return rows.join(\"\\n\");\n}\n\nexport default function PointCloudDetails({ pointDetails: { color, decodedData, index } }: Props) {\n  const [isOpen, setIsOpen] = useState<boolean>(false);\n\n  const onCopy = useCallback(() => {\n    const blob = new Blob([pointsToCsv(decodedData)], { type: \"text/csv;charset=utf-8;\" });\n    downloadFiles([{ blob, fileName: \"PointCloud.csv\" }]);\n    setIsOpen(false);\n  }, [decodedData]);\n  const onToggle = useCallback(() => setIsOpen((open) => !open), []);\n\n  const clickedPoint = decodedData[index];\n  if (!clickedPoint) {\n    return null;\n  }\n\n  return (\n    <>\n      <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        <ChildToggle position=\"below\" onToggle={onToggle} isOpen={isOpen}>\n          <Icon small fade active={isOpen} tooltip=\"Export data\">\n            <ExportVariantIcon />\n          </Icon>\n          <Menu>\n            <Item\n              onClick={() => {\n                clipboard.copy(pointsToCsv([clickedPoint])).then(() => {\n                  setIsOpen(false);\n                });\n              }}>\n              Copy clicked point to clipboard\n            </Item>\n            <Item onClick={onCopy}>{\"Download point cloud as CSV\"}</Item>\n          </Menu>\n        </ChildToggle>\n      </div>\n      <Tree\n        data={{ clickedPoint, decodedData }}\n        shouldExpandNode={(keyPath) => keyPath.length === 1 && keyPath[0] === \"clickedPoint\"}\n        invertTheme={false}\n        theme={{\n          extend: jsonTreeTheme,\n          tree: { margin: 0 },\n          nestedNodeLabel: ({ style }, keyPath) => {\n            // Color clickedPoint label the same as the point itself.\n            if (keyPath.length === 1 && keyPath[0] === \"clickedPoint\") {\n              return { style: { ...style, color: `rgba(${color.join(\",\")})` } };\n            }\n          },\n        }}\n        hideRoot\n      />\n    </>\n  );\n}\n","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./ExpandingToolbar.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./ExpandingToolbar.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./ExpandingToolbar.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar .packages-webviz-core-src-components-ExpandingToolbar-module-4bm9d--tab{margin:0;padding-left:8px;padding-right:8px;border-radius:0;border-top:2px solid transparent;border-bottom:2px solid transparent}.packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar .packages-webviz-core-src-components-ExpandingToolbar-module-4bm9d--tab.packages-webviz-core-src-components-ExpandingToolbar-module-3ndvr--selected{border-bottom:2px solid rgba(247,247,243,.77)}.packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar .packages-webviz-core-src-components-ExpandingToolbar-module-hhvxd--spaceSeparator{-ms-flex-positive:1;flex-grow:1;min-width:24px}.packages-webviz-core-src-components-ExpandingToolbar-module-41fux--tabBody{background-color:#08080a;padding:4px 12px 12px 12px}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/ExpandingToolbar.module.scss\"],\"names\":[],\"mappings\":\"AASE,mJACE,SACA,iBACA,kBACA,gBACA,iCACA,mCAAA,CACA,+NACE,6CAAA,CAIJ,8JACE,oBAAA,YACA,cAAA,CAIJ,4EACE,yBACA,0BAAA,CAAA\",\"file\":\"ExpandingToolbar.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.tabBar {\\n  .tab {\\n    margin: 0;\\n    padding-left: 8px;\\n    padding-right: 8px;\\n    border-radius: 0;\\n    border-top: 2px solid transparent;\\n    border-bottom: 2px solid transparent;\\n    &.selected {\\n      border-bottom: 2px solid $text-normal;\\n    }\\n  }\\n\\n  .spaceSeparator {\\n    flex-grow: 1;\\n    min-width: 24px;\\n  }\\n}\\n\\n.tabBody {\\n  background-color: $dark;\\n  padding: 4px 12px 12px 12px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"tabBar\": \"packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar\",\n\t\"tab\": \"packages-webviz-core-src-components-ExpandingToolbar-module-4bm9d--tab\",\n\t\"selected\": \"packages-webviz-core-src-components-ExpandingToolbar-module-3ndvr--selected\",\n\t\"spaceSeparator\": \"packages-webviz-core-src-components-ExpandingToolbar-module-hhvxd--spaceSeparator\",\n\t\"tabBody\": \"packages-webviz-core-src-components-ExpandingToolbar-module-41fux--tabBody\"\n};","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useCallback, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { diffLabels, diffArrow } from \"webviz-core/src/panels/RawMessages/getDiff\";\n\n// Strings longer than this many characters will start off collapsed.\nconst COLLAPSE_TEXT_OVER_LENGTH = 512;\n\nexport const SDiffSpan = styled.span`\n  padding: 0px 4px;\n  text-decoration: inherit;\n  white-space: pre-line;\n`;\n\nexport function HighlightedValue({ itemLabel }: { itemLabel: string }) {\n  const diffArrowStr = ` ${diffArrow} `;\n  // react-json-tree's valueRenderer only gets called for primitives, so diff before/after values must be at same level by the time it gets to the tree\n  const splitItemLabel = `${itemLabel}`.split(diffArrowStr);\n  const itemLabelContainsChange = splitItemLabel.length === 2;\n  if (itemLabelContainsChange) {\n    const [before, after] = splitItemLabel;\n    const beforeText = JSON.parse(JSON.stringify(before));\n    const afterText = JSON.parse(JSON.stringify(after));\n    return (\n      <SDiffSpan style={{ color: diffLabels.CHANGED.color }}>\n        <MaybeCollapsedValue itemLabel={beforeText} />\n        {diffArrowStr}\n        <MaybeCollapsedValue itemLabel={afterText} />\n      </SDiffSpan>\n    );\n  }\n\n  return (\n    <SDiffSpan>\n      <MaybeCollapsedValue itemLabel={itemLabel} />\n    </SDiffSpan>\n  );\n}\n\nexport function MaybeCollapsedValue({ itemLabel }: { itemLabel: string }) {\n  const lengthOverLimit = itemLabel.length >= COLLAPSE_TEXT_OVER_LENGTH;\n  const [showingEntireLabel, setShowingEntireLabel] = useState(!lengthOverLimit);\n  const itemLabelToShow = showingEntireLabel ? itemLabel : itemLabel.slice(0, COLLAPSE_TEXT_OVER_LENGTH);\n  const expandText = useCallback(() => setShowingEntireLabel(true), []);\n  return (\n    <Tooltip contents={!showingEntireLabel ? \"Text was truncated, click to see all\" : \"\"}>\n      <span onClick={expandText} style={{ cursor: !showingEntireLabel ? \"pointer\" : \"inherit\" }}>\n        {`${itemLabelToShow}${!showingEntireLabel ? \"...\" : \"\"}`}\n      </span>\n    </Tooltip>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { last } from \"lodash\";\nimport memoizeWeak from \"memoize-weak\";\n\nimport { type MessagePathStructureItem } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport { getField, getIndex, isArrayView } from \"webviz-core/src/util/binaryObjects\";\n\nexport type ValueAction =\n  | {|\n      type: \"pivot\",\n      pivotPath: string, // Path to filter on using the current value, if the current value is an id.\n    |}\n  | {|\n      type: \"primitive\",\n      singleSlicePath: string, // Path that will only return one value per unit of time (for line charts).\n      multiSlicePath: string, // Path that might return multiple values per unit of time (for scatter plots).\n      primitiveType: string, // The ROS primitive type that these paths point at.\n    |};\n\nconst isObjectElement = (value, pathItem, structureItem): boolean %checks =>\n  typeof pathItem === \"string\" &&\n  ((structureItem.structureType === \"message\" && typeof value === \"object\") ||\n    (structureItem.structureType === \"primitive\" && structureItem.primitiveType === \"json\"));\n\nconst isArrayElement = (value, pathItem, structureItem): boolean %checks =>\n  typeof pathItem === \"number\" &&\n  ((structureItem.structureType === \"array\" && (Array.isArray(value) || isArrayView(value))) ||\n    (structureItem.structureType === \"primitive\" && structureItem.primitiveType === \"json\"));\n\n// Given a root value (e.g. a message object), a root structureItem (e.g. a message definition),\n// and a key path to navigate down the value and strutureItem (e.g. [\"items\", 10, \"speed\"]), return\n// a bunch of paths for that navigated down value.\nexport function getValueActionForValue(\n  rootValue: mixed,\n  rootStructureItem: ?MessagePathStructureItem,\n  keyPath: (number | string)[]\n): ?ValueAction {\n  let singleSlicePath = \"\";\n  let multiSlicePath = \"\";\n  let pivotPath = \"\";\n  let value: mixed = rootValue;\n  let structureItem: ?MessagePathStructureItem = rootStructureItem;\n  // Walk down the keyPath, while updating `value` and `structureItem`\n  for (const pathItem: number | string of keyPath) {\n    if (structureItem == null || value == null) {\n      break;\n    } else if (isObjectElement(value, pathItem, structureItem)) {\n      structureItem =\n        structureItem.structureType === \"message\" && typeof pathItem === \"string\"\n          ? structureItem.nextByName[pathItem]\n          : { structureType: \"primitive\", primitiveType: \"json\", datatype: \"\" };\n      value = getField(value, pathItem);\n      if (multiSlicePath.endsWith(\"[:]\")) {\n        // We're just inside a message that is inside an array, so we might want to pivot on this new value.\n        pivotPath = `${multiSlicePath}{${pathItem}==${JSON.stringify(value) || \"\"}}`;\n      } else {\n        pivotPath = \"\";\n      }\n      singleSlicePath += `.${pathItem}`;\n      multiSlicePath += `.${pathItem}`;\n    } else if (isArrayElement(value, pathItem, structureItem)) {\n      value = getIndex(value, pathItem);\n      structureItem =\n        structureItem.structureType === \"array\"\n          ? structureItem.next\n          : { structureType: \"primitive\", primitiveType: \"json\", datatype: \"\" };\n      if (!structureItem) {\n        break;\n      }\n      multiSlicePath = `${singleSlicePath}[:]`;\n      // Ideally show something like `/topic.object[:]{id=123}` for the singleSlicePath, but fall\n      // back to `/topic.object[10]` if necessary.\n      let typicalFilterName;\n      if (structureItem.structureType === \"message\") {\n        typicalFilterName = Object.keys(structureItem.nextByName).find((key) => isTypicalFilterName(key));\n      }\n      if (typeof value === \"object\" && value != null && typeof typicalFilterName === \"string\") {\n        singleSlicePath += `[:]{${typicalFilterName}==${JSON.stringify(getField(value, typicalFilterName)) || \"\"}}`;\n      } else {\n        singleSlicePath += `[${pathItem}]`;\n      }\n    } else if (structureItem.structureType === \"primitive\") {\n      // ROS has primitives with nested data (time, duration).\n      // We currently don't support looking inside them.\n      return;\n    } else {\n      throw new Error(`Invalid structureType: ${structureItem.structureType} for value/pathItem.`);\n    }\n  }\n  // At this point we should be looking at a primitive. If not, just return nothing.\n  if (structureItem && structureItem.structureType === \"primitive\" && value != null) {\n    if (pivotPath && isTypicalFilterName(last(keyPath).toString())) {\n      return { type: \"pivot\", pivotPath };\n    }\n    return {\n      type: \"primitive\",\n      singleSlicePath,\n      multiSlicePath,\n      primitiveType: structureItem.primitiveType,\n    };\n  }\n}\n\n// Given root structureItem (e.g. a message definition),\n// and a key path (comma-joined) to navigate down, return strutureItem for the field at that path\n// Using comma-joined path to allow memoization of this function\nexport const getStructureItemForPath = memoizeWeak(\n  (rootStructureItem: ?MessagePathStructureItem, keyPathJoined: string): ?MessagePathStructureItem => {\n    // split the path and parse into numbers and strings\n    const keyPath: (number | string)[] = [];\n    for (const part: string of keyPathJoined.split(\",\")) {\n      if (!isNaN(part)) {\n        keyPath.push(parseInt(part));\n      } else {\n        keyPath.push(part);\n      }\n    }\n    let structureItem: ?MessagePathStructureItem = rootStructureItem;\n    // Walk down the keyPath, while updating `value` and `structureItem`\n    for (const pathItem: number | string of keyPath) {\n      if (structureItem == null) {\n        break;\n      } else if (structureItem.structureType === \"message\" && typeof pathItem === \"string\") {\n        structureItem = structureItem.nextByName[pathItem];\n      } else if (structureItem.structureType === \"array\" && typeof pathItem === \"number\") {\n        structureItem = structureItem.next;\n        if (!structureItem) {\n          break;\n        }\n      } else if (structureItem.structureType === \"primitive\") {\n        // ROS has some primitives that contain nested data (time+duration). We currently don't\n        // support looking inside them.\n        return structureItem;\n      } else {\n        throw new Error(`Invalid structureType: ${structureItem.structureType} for value/pathItem.`);\n      }\n    }\n    return structureItem;\n  }\n);\n","module.exports = \"# Raw Messages\\n\\nDisplays the data from a specific topic in an easier to read format. As new messages are received the structure shows the latest data, but doesn't reset the view (e.g if you unfold a specific key - it'll stay that way with the values under it updating as messages come in).\\n\\nYou can drill down the message and filter arrays to specific messages using the [message path syntax](/help/message-path-syntax).\\n\\nIf you need to understand the data structure of the messages, a link is provided at the top.\\n\"","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-RawMessages-index-module-3np35--topicInputs{width:100%;line-height:20px}.packages-webviz-core-src-panels-RawMessages-index-module-2aqxa--container{padding-left:.5em;font-family:\\\"Inter UI\\\",-apple-system,BlinkMacSystemFont,sans-serif;-webkit-font-feature-settings:\\\"tnum\\\";font-feature-settings:\\\"tnum\\\"}.packages-webviz-core-src-panels-RawMessages-index-module-fnnzr--iconWrapper{display:inline;padding-right:40px}.packages-webviz-core-src-panels-RawMessages-index-module-2uwhq--iconBox{display:inline-block;white-space:nowrap;width:0px;height:0px;position:relative;left:6px}.packages-webviz-core-src-panels-RawMessages-index-module-44tte--icon>svg{vertical-align:top}.packages-webviz-core-src-panels-RawMessages-index-module-4kv8d--singleVal{font-size:2.5em;word-wrap:break-word;font-weight:bold;white-space:pre-line}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/RawMessages/index.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\"],\"names\":[],\"mappings\":\"AAQA,6EACE,WACA,gBAAA,CAGF,2EAEE,kBC4DA,mEACA,qCAAA,4BAAA,CDzDF,6EACE,eACA,kBAAA,CAGF,yEACE,qBACA,mBACA,UACA,WACA,kBACA,QAAA,CAIA,0EACE,kBAAA,CAIJ,2EACE,gBACA,qBACA,iBACA,oBAAA,CAAA\",\"file\":\"index.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.topicInputs {\\n  width: 100%;\\n  line-height: 20px;\\n}\\n\\n.container {\\n  // match the padding with the default padding used in react-json-tree\\n  padding-left: 0.5em;\\n  @include sans-serif;\\n}\\n\\n.iconWrapper {\\n  display: inline;\\n  padding-right: 40px; // To make it so the icons appear when you move the mouse somewhat close.\\n}\\n\\n.iconBox {\\n  display: inline-block;\\n  white-space: nowrap;\\n  width: 0px;\\n  height: 0px;\\n  position: relative;\\n  left: 6px;\\n}\\n\\n.icon {\\n  > svg {\\n    vertical-align: top;\\n  }\\n}\\n\\n.singleVal {\\n  font-size: 2.5em;\\n  word-wrap: break-word;\\n  font-weight: bold;\\n  white-space: pre-line;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"topicInputs\": \"packages-webviz-core-src-panels-RawMessages-index-module-3np35--topicInputs\",\n\t\"container\": \"packages-webviz-core-src-panels-RawMessages-index-module-2aqxa--container\",\n\t\"iconWrapper\": \"packages-webviz-core-src-panels-RawMessages-index-module-fnnzr--iconWrapper\",\n\t\"iconBox\": \"packages-webviz-core-src-panels-RawMessages-index-module-2uwhq--iconBox\",\n\t\"icon\": \"packages-webviz-core-src-panels-RawMessages-index-module-44tte--icon\",\n\t\"singleVal\": \"packages-webviz-core-src-panels-RawMessages-index-module-4kv8d--singleVal\"\n};","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ClipboardOutlineIcon from \"@mdi/svg/svg/clipboard-outline.svg\";\nimport { cloneDeepWith } from \"lodash\";\nimport React, { useCallback } from \"react\";\nimport styled from \"styled-components\";\n\nimport { getMessageDocumentationLink } from \"./utils\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport { deepParse, isBobject } from \"webviz-core/src/util/binaryObjects\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { formatTimeRaw } from \"webviz-core/src/util/time\";\n\nconst SMetadata = styled.div`\n  margin-top: 4px;\n  font-size: 11px;\n  line-height: 1.3;\n  color: #aaa;\n`;\ntype Props = {\n  data: any,\n  diffData: any,\n  diff: any,\n  datatype: ?string,\n  message: Message,\n  diffMessage: ?Message,\n};\n\nfunction CopyMessageButton({ text, onClick }) {\n  return (\n    <a onClick={onClick} href=\"#\" style={{ textDecoration: \"none\" }}>\n      <Icon tooltip=\"Copy entire message to clipboard\" style={{ position: \"relative\", top: -1 }}>\n        <ClipboardOutlineIcon style={{ verticalAlign: \"middle\" }} />\n      </Icon>{\" \"}\n      {text}\n    </a>\n  );\n}\n\nconst maybeParseValue = (data) => {\n  // Data may be\n  //  - A bobject,\n  //  - A primitive,\n  //  - An array of bobjects or primitives when the message-path algorithm returns an array.\n  if (Array.isArray(data)) {\n    return data.map((x) => (isBobject(x) ? deepParse(x) : x));\n  }\n  return isBobject(data) ? deepParse(data) : data;\n};\n\nexport default function Metadata({ data, diffData, diff, datatype, message, diffMessage }: Props) {\n  const onClickCopy = useCallback(\n    (maybeBobject) => (e: SyntheticMouseEvent<HTMLSpanElement>) => {\n      e.stopPropagation();\n      e.preventDefault();\n      const dataToCopy = maybeParseValue(maybeBobject);\n      const dataWithoutLargeArrays = cloneDeepWith(dataToCopy, (value) => {\n        if (typeof value === \"object\" && value.buffer) {\n          return \"<buffer>\";\n        }\n      });\n      clipboard.copy(JSON.stringify(dataWithoutLargeArrays, null, 2) || \"\");\n    },\n    []\n  );\n  return (\n    <SMetadata>\n      {!diffMessage &&\n        (datatype && (\n          <a\n            style={{ color: \"inherit\" }}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            href={getMessageDocumentationLink(datatype)}>\n            {datatype}\n          </a>\n        ))}\n      {message.receiveTime && `${diffMessage ? \" base\" : \"\"} @ ${formatTimeRaw(message.receiveTime)} ROS `}\n      <CopyMessageButton onClick={onClickCopy(data)} text=\"Copy msg\" />\n\n      {diffMessage && diffMessage.receiveTime && (\n        <>\n          <div>\n            {`diff @ ${formatTimeRaw(diffMessage.receiveTime)} ROS `}\n            <CopyMessageButton onClick={onClickCopy(diffData)} text=\"Copy msg\" />\n          </div>\n          <CopyMessageButton onClick={onClickCopy(diff)} text=\"Copy diff of msgs\" />\n        </>\n      )}\n    </SMetadata>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ChartBubbleIcon from \"@mdi/svg/svg/chart-bubble.svg\";\nimport ChartLineVariantIcon from \"@mdi/svg/svg/chart-line-variant.svg\";\nimport DotsHorizontalIcon from \"@mdi/svg/svg/dots-horizontal.svg\";\nimport TargetIcon from \"@mdi/svg/svg/target.svg\";\nimport React, { type Node, useCallback } from \"react\";\n\nimport { type ValueAction } from \"./getValueActionForValue\";\nimport styles from \"./index.module.scss\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { openSiblingPlotPanel, plotableRosTypes } from \"webviz-core/src/panels/Plot\";\nimport { openSiblingStateTransitionsPanel, transitionableRosTypes } from \"webviz-core/src/panels/StateTransitions\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\n\ntype Props = {\n  valueAction: ValueAction,\n  basePath: string,\n  onTopicPathChange: (string) => void,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n};\n\nexport default function RawMessagesIcons({ valueAction, basePath, onTopicPathChange, openSiblingPanel }: Props): Node {\n  const openPlotPanel = useCallback(\n    (pathSuffix: string) => () => {\n      openSiblingPlotPanel(openSiblingPanel, `${basePath}${pathSuffix}`);\n    },\n    [basePath, openSiblingPanel]\n  );\n  const openStateTransitionsPanel = useCallback(\n    (pathSuffix: string) => () => {\n      openSiblingStateTransitionsPanel(openSiblingPanel, `${basePath}${pathSuffix}`);\n    },\n    [basePath, openSiblingPanel]\n  );\n  const onPivot = useCallback(\n    () => onTopicPathChange(`${basePath}${valueAction.type === \"pivot\" ? valueAction.pivotPath : \"\"}`),\n    [basePath, onTopicPathChange, valueAction]\n  );\n  if (valueAction.type === \"pivot\") {\n    return (\n      <Icon fade className={styles.icon} onClick={onPivot} tooltip=\"Pivot on this value\" key=\"pivot\">\n        <TargetIcon />\n      </Icon>\n    );\n  }\n  const { singleSlicePath, multiSlicePath, primitiveType } = valueAction;\n  return (\n    <span>\n      {plotableRosTypes.includes(primitiveType) && (\n        <Icon fade className={styles.icon} onClick={openPlotPanel(singleSlicePath)} tooltip=\"Line chart\">\n          <ChartLineVariantIcon />\n        </Icon>\n      )}\n      {plotableRosTypes.includes(primitiveType) && multiSlicePath !== singleSlicePath && (\n        <Icon fade className={styles.icon} onClick={openPlotPanel(multiSlicePath)} tooltip=\"Scatter plot\">\n          <ChartBubbleIcon />\n        </Icon>\n      )}\n      {transitionableRosTypes.includes(primitiveType) && multiSlicePath === singleSlicePath && (\n        <Icon\n          fade\n          className={styles.icon}\n          onClick={openStateTransitionsPanel(singleSlicePath)}\n          tooltip=\"State Transitions\">\n          <DotsHorizontalIcon />\n        </Icon>\n      )}\n    </span>\n  );\n}\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-tw6e7--closeIcon{position:absolute;right:7px;top:7px;cursor:pointer;font-size:16px}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons,.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor{background-color:#242429;border-radius:4px;padding:0;-webkit-box-shadow:0 0px 32px rgba(8,8,10,.6);box-shadow:0 0px 32px rgba(8,8,10,.6);overflow:hidden;pointer-events:auto;-ms-flex-negative:0;flex-shrink:0}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4gt2e--container{display:-ms-flexbox;display:flex;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;width:100%;height:100%}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-36swq--world{position:absolute;top:0;left:0;bottom:0;right:0}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor{background-color:#08080a;width:360px;padding:20px}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar{position:absolute;top:15px;padding:0px;z-index:101;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:end;align-items:flex-end;pointer-events:none}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3xasx--left{left:15px}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-n75xz--right{top:35px;right:15px}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding:0px;margin-bottom:10px}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons button{background-color:transparent;border:none;padding-left:4px;padding-right:4px}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons span.icon{width:18px;height:18px;font-size:18px;display:inline-block}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3ppq8--buttonsActive span.icon{color:#248eff}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-ftsax--cameraWarning{margin-top:.5em;font-size:.9em;font-style:italic;color:rgba(247,247,243,.3);width:0;min-width:100%}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-33xh7--cartographer{padding:0px}.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-33xh7--cartographer button{width:31px !important;height:36px !important;margin:0px}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAkBA,kLACE,kBACA,UACA,QACA,eACA,cAAA,CAGF,gLACE,yBACA,kBACA,UACA,8CAAA,sCACA,gBACA,oBACA,oBAAA,aAAA,CA4DF,ACxFA,oFACE,oBAAA,aACA,kBAAA,cACA,kBACA,WACA,WAAA,CAGF,gFACE,kBACA,MACA,OACA,SACA,OAAA,CAGF,8FAEE,yBACA,YACA,YAAA,CAOF,kFACE,kBACA,SASA,YACA,YACA,oBAAA,aACA,0BAAA,sBACA,mBAAA,qBAGA,mBAAA,CAfA,gKACE,SApCM,CAsCR,iKAEE,SACA,UAzCM,CAqDV,kFAEE,oBAAA,aACA,0BAAA,sBACA,YACA,kBAAA,CAEA,yFACE,6BACA,YACA,iBACA,iBAAA,CAGF,4FACE,WACA,YACA,eACA,oBAAA,CAKF,kGACE,aCzCK,CD6CT,wFACE,gBACA,eACA,kBACA,2BAIA,QACA,cAAA,CAGF,uFACE,WAAA,CACA,8FACE,sBACA,uBACA,UAAA,CAAA\",\"file\":\"Layout.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"$spacing: 15px;\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n// container for the entire panel\\n.container {\\n  display: flex;\\n  flex: 1 1 auto;\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n.world {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  bottom: 0;\\n  right: 0;\\n}\\n\\n.topicSettingsEditor {\\n  @extend %floating-box;\\n  background-color: $dark;\\n  width: 360px;\\n  padding: 20px;\\n\\n  .closeIcon {\\n    @extend %floating-box-close-icon;\\n  }\\n}\\n\\n.toolbar {\\n  position: absolute;\\n  top: $spacing;\\n  &.left {\\n    left: $spacing;\\n  }\\n  &.right {\\n    // move the right toolbar below the floating panel controls\\n    top: $spacing + 20;\\n    right: $spacing;\\n  }\\n  padding: 0px;\\n  z-index: 101;\\n  display: flex;\\n  flex-direction: column;\\n  align-items: flex-end;\\n\\n  // allow mouse events to pass through the empty space in this container element\\n  pointer-events: none;\\n}\\n\\n.buttons {\\n  @extend %floating-box;\\n  display: flex;\\n  flex-direction: column;\\n  padding: 0px;\\n  margin-bottom: 10px;\\n\\n  button {\\n    background-color: transparent;\\n    border: none;\\n    padding-left: 4px;\\n    padding-right: 4px;\\n  }\\n\\n  span:global(.icon) {\\n    width: 18px;\\n    height: 18px;\\n    font-size: 18px;\\n    display: inline-block;\\n  }\\n}\\n\\n.buttonsActive {\\n  span:global(.icon) {\\n    color: $accent;\\n  }\\n}\\n\\n.cameraWarning {\\n  margin-top: 0.5em;\\n  font-size: 0.9em;\\n  font-style: italic;\\n  color: $text-muted;\\n\\n  // don't affect flex parent width\\n  // https://stackoverflow.com/a/25045641/23649\\n  width: 0;\\n  min-width: 100%;\\n}\\n\\n.cartographer {\\n  padding: 0px;\\n  button {\\n    width: 31px !important;\\n    height: 36px !important;\\n    margin: 0px;\\n  }\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"topicSettingsEditor\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor\",\n\t\"closeIcon\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-tw6e7--closeIcon\",\n\t\"buttons\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons\",\n\t\"container\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4gt2e--container\",\n\t\"world\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-36swq--world\",\n\t\"toolbar\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar\",\n\t\"left\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3xasx--left\",\n\t\"right\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-n75xz--right\",\n\t\"buttonsActive\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3ppq8--buttonsActive\",\n\t\"cameraWarning\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-ftsax--cameraWarning\",\n\t\"cartographer\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-33xh7--cartographer\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { TimeUtil, type Time } from \"rosbag\";\nimport uuid from \"uuid\";\n\nimport type { Interactive } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\nimport type { BaseMarker } from \"webviz-core/src/types/Messages\";\n\nconst ZERO_TIME = { sec: 0, nsec: 0 };\n\n// Not a concrete type, just descriptive.\ntype ObjectWithInteractionData = Interactive<any>;\n\nclass MessageWithLifetime {\n  message: ObjectWithInteractionData;\n  receiveTime: Time;\n  // If lifetime is present and non-zero, the marker expires when the collector clock is greater\n  // than receiveTime + lifetime.\n  // If lifetime is zero, the marker remains until deleted by name.\n  // If absent, the marker is removed from the collector using explicit \"flush\" actions.\n  lifetime: ?Time;\n\n  constructor(message: ObjectWithInteractionData, receiveTime: Time, lifetime: ?Time) {\n    this.message = message;\n    this.receiveTime = receiveTime;\n    this.lifetime = lifetime;\n  }\n\n  // support in place update w/ mutation to avoid allocating\n  // a MarkerWithLifetime wrapper for every marker on every tick\n  // only allocate on new markers\n  update(message: ObjectWithInteractionData, receiveTime: Time, lifetime: ?Time) {\n    this.message = message;\n    this.receiveTime = receiveTime;\n    this.lifetime = lifetime;\n  }\n\n  isExpired(currentTime: Time) {\n    // cannot tell if a marker is expired if we don't have a clock yet\n    if (!currentTime) {\n      return false;\n    }\n    if (this.lifetime == null) {\n      // Do not expire markers if we can't tell what their lifetime is.\n      // They'll be flushed later if needed (see flush below)\n      return false;\n    }\n    const lifetime: Time = this.lifetime;\n\n    if (TimeUtil.areSame(lifetime, ZERO_TIME)) {\n      // Do not expire markers with infinite lifetime (lifetime == 0)\n      return false;\n    }\n\n    // we use the receive time (clock) instead of the header stamp\n    // to match the behavior of rviz\n    const expiresAt = TimeUtil.add(this.receiveTime, lifetime);\n\n    return TimeUtil.isGreaterThan(currentTime, expiresAt);\n  }\n}\n\n// used to collect marker and non-marker visualization messages\n// for a given topic and ensure the lifecycle is managed properly\nexport default class MessageCollector {\n  markers: Map<string, MessageWithLifetime> = new Map();\n  clock: Time = { sec: 0, nsec: 0 };\n\n  setClock(clock: Time) {\n    if (!clock) {\n      return;\n    }\n\n    const clockMovedBackwards = TimeUtil.isGreaterThan(this.clock, clock);\n\n    if (clockMovedBackwards) {\n      this.markers.forEach((marker, key) => {\n        const markerReceivedAfterClock = TimeUtil.isGreaterThan(marker.receiveTime, clock);\n        if (markerReceivedAfterClock) {\n          this.markers.delete(key);\n        }\n      });\n      this.flush();\n    }\n    this.clock = clock;\n  }\n\n  flush() {\n    // clear out all null lifetime markers\n    this.markers.forEach((marker, key) => {\n      if (marker.lifetime == null) {\n        this.markers.delete(key);\n      }\n    });\n  }\n\n  _addItem(key: string, item: ObjectWithInteractionData, lifetime: ?Time): void {\n    const existing = this.markers.get(key);\n    if (existing) {\n      existing.update(item, this.clock, lifetime);\n    } else {\n      this.markers.set(key, new MessageWithLifetime(item, this.clock, lifetime));\n    }\n  }\n\n  addMarker(marker: Interactive<BaseMarker>, name: string) {\n    this._addItem(name, marker, marker.lifetime);\n  }\n\n  deleteMarker(name: string) {\n    if (!name) {\n      return console.error(\"Cannot delete marker, it is missing name\");\n    }\n    this.markers.delete(name);\n  }\n\n  deleteAll() {\n    this.markers.clear();\n  }\n\n  addNonMarker(topic: string, message: ObjectWithInteractionData, lifetime: ?Time) {\n    // Non-marker data is removed in two ways:\n    //  - Messages with lifetimes expire only at the end of their lifetime. Multiple messages on the\n    //    same topic are added and expired independently.\n    //  - Messages without lifetimes overwrite others on the same topic -- there is at most one per\n    //    topic at any time. These messages are also removed when `flush` is called.\n    //\n    // Topics are expected to have data in one of these two \"modes\" at a time.\n    // Non-marker messages are not expected to have names, as they have no \"delete\" operation.\n\n    if (lifetime != null) {\n      // Assuming that all future messages will have a decay time set,\n      // we need to immediately expire any pre-existing message that didn't have a decay time.\n      this.markers.delete(topic);\n\n      // Create a unique key for each new message.\n      const key = `${topic}/${uuid.v4()}`;\n      this._addItem(key, message, lifetime);\n    } else {\n      // if future messages will not have a decay time set,\n      // we should expire any pre-existing message that have potentially longer decay times.\n      for (const key of this.markers.keys()) {\n        if (key.indexOf(`${topic}/`) === 0) {\n          this.markers.delete(key);\n        }\n      }\n      this._addItem(topic, message);\n    }\n  }\n\n  getMessages(): ObjectWithInteractionData[] {\n    const result = [];\n    this.markers.forEach((marker, key) => {\n      // Check if the marker has a lifetime and should be deleted\n      if (marker.isExpired(this.clock)) {\n        this.markers.delete(key);\n      } else {\n        result.push(marker.message);\n      }\n    });\n    return result;\n  }\n}\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root{height:100%;position:relative}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3wsxs--canvas{min-width:0;min-height:0;-o-object-position:top left;object-position:top left}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar{-webkit-transition:opacity .1s ease-in-out;-o-transition:opacity .1s ease-in-out;transition:opacity .1s ease-in-out;display:-ms-flexbox;display:flex;-ms-flex:0 0 auto;flex:0 0 auto;-ms-flex-direction:row;flex-direction:row;background-color:transparent;text-align:right;position:absolute;right:4px;padding-right:5px;bottom:8px;z-index:100;background-color:transparent;opacity:0}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-a4s8k--containsOpen{opacity:1}.mosaic-window:hover .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar{opacity:1}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify{position:absolute;bottom:5px;left:0;z-index:102;opacity:1;background-color:#242429;display:none}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root:hover .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify{display:block}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify.hoverScreenshot{display:block}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify svg{width:16px;height:16px;fill:#fff;float:left}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify span{color:orange;float:right;padding-left:3px}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart{position:absolute;bottom:45px;left:0;z-index:102;opacity:1;background-color:#242429;width:145px;border-radius:4%;display:none}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root:hover .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart{display:block}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart.hoverScreenshot{display:block}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-kres5--round{margin:0;padding:1px 5px 1px 5px;border-radius:100%}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-23f2k--borderBottom{border-bottom:1px solid rgba(255,255,255,.1)}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-45bfu--menuItem{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;padding:8px 12px 8px 12px}.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-pmyrv--notInteractive{opacity:.5}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/ImageCanvas.module.scss\"],\"names\":[],\"mappings\":\"AAOqB,0ECCnB,YACA,iBAAA,CAGF,4EACE,YACA,aACA,4BAAA,wBAAA,CAGF,gFACE,2CAAA,sCAAA,mCACA,oBAAA,aACA,kBAAA,cACA,uBAAA,mBACA,6BACA,iBAEA,kBACA,UACA,kBACA,WACA,YACA,6BACA,SAAA,CAEA,iKACE,SAAA,CAGF,qGACE,SAAA,CAIJ,6EACE,kBACA,WACA,OACA,YACA,UACA,yBACA,YAAA,CACA,6JACE,aAAA,CAEF,6FACE,aAAA,CAEF,iFACE,WACA,YACA,UACA,UAAA,CAEF,kFACE,aACA,YACA,gBAAA,CAIJ,+EACE,kBACA,YACA,OACA,YACA,UACA,yBACA,YACA,iBACA,YAAA,CACA,+JACE,aAAA,CAEF,+FACE,aAAA,CAIJ,2EACE,SACA,wBACA,kBAAA,CAGF,kFACE,4CAAA,CAGF,8EACE,oBAAA,aACA,sBAAA,mBACA,sBAAA,8BACA,yBAAA,CAGF,oFACE,UAAA,CAAA\",\"file\":\"ImageCanvas.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.root {\\n  height: 100%;\\n  position: relative;\\n}\\n\\n.canvas {\\n  min-width: 0;\\n  min-height: 0;\\n  object-position: top left;\\n}\\n\\n.bottom-bar {\\n  transition: opacity 0.1s ease-in-out;\\n  display: flex;\\n  flex: 0 0 auto;\\n  flex-direction: row;\\n  background-color: transparent;\\n  text-align: right;\\n\\n  position: absolute;\\n  right: 4px;\\n  padding-right: 5px;\\n  bottom: 8px;\\n  z-index: 100;\\n  background-color: transparent;\\n  opacity: 0;\\n\\n  &.containsOpen {\\n    opacity: 1;\\n  }\\n\\n  :global(.mosaic-window):hover & {\\n    opacity: 1;\\n  }\\n}\\n\\n.magnify {\\n  position: absolute;\\n  bottom: 5px;\\n  left: 0;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: $dark3;\\n  display: none;\\n  .root:hover & {\\n    display: block;\\n  }\\n  &:global(.hoverScreenshot) {\\n    display: block;\\n  }\\n  svg {\\n    width: 16px;\\n    height: 16px;\\n    fill: white;\\n    float: left;\\n  }\\n  span {\\n    color: orange;\\n    float: right;\\n    padding-left: 3px;\\n  }\\n}\\n\\n.zoomChart {\\n  position: absolute;\\n  bottom: 45px;\\n  left: 0;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: $dark3;\\n  width: 145px;\\n  border-radius: 4%;\\n  display: none;\\n  .root:hover & {\\n    display: block;\\n  }\\n  &:global(.hoverScreenshot) {\\n    display: block;\\n  }\\n}\\n\\n.round {\\n  margin: 0;\\n  padding: 1px 5px 1px 5px;\\n  border-radius: 100%;\\n}\\n\\n.borderBottom {\\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\\n}\\n\\n.menuItem {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 8px 12px 8px 12px;\\n}\\n\\n.notInteractive {\\n  opacity: 0.5;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"root\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root\",\n\t\"canvas\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3wsxs--canvas\",\n\t\"bottom-bar\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar\",\n\t\"containsOpen\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-a4s8k--containsOpen\",\n\t\"magnify\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify\",\n\t\"zoomChart\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart\",\n\t\"round\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-kres5--round\",\n\t\"borderBottom\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-23f2k--borderBottom\",\n\t\"menuItem\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-45bfu--menuItem\",\n\t\"notInteractive\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-pmyrv--notInteractive\"\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"ImageCanvas.worker.js?5af784834a32c6158670\");\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { renderImage } from \"./renderImage\";\nimport { type Dimensions, type RawMarkerData, type OffscreenCanvas } from \"./util\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport Rpc from \"webviz-core/src/util/Rpc\";\n\nexport default class ImageCanvasRenderer {\n  _idToCanvas: { [string]: OffscreenCanvas } = {};\n  _rpc: Rpc;\n\n  constructor(rpc: Rpc) {\n    this._rpc = rpc;\n\n    rpc.receive(\"initialize\", async ({ id, canvas }: { id: string, canvas: OffscreenCanvas }) => {\n      this._idToCanvas[id] = canvas;\n    });\n\n    rpc.receive(\n      \"renderImage\",\n      async ({\n        id,\n        imageMessage,\n        imageMessageDatatype,\n        rawMarkerData,\n      }: {\n        id: string,\n        imageMessage: ?Message,\n        imageMessageDatatype: ?string,\n        rawMarkerData: RawMarkerData,\n      }): Promise<?Dimensions> => {\n        const canvas = this._idToCanvas[id];\n        return renderImage({ canvas, imageMessage, imageMessageDatatype, rawMarkerData });\n      }\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CameraModel from \"./CameraModel\";\nimport {\n  decodeYUV,\n  decodeRGB8,\n  decodeBGR8,\n  decodeFloat1c,\n  decodeBayerRGGB8,\n  decodeBayerBGGR8,\n  decodeBayerGBRG8,\n  decodeBayerGRBG8,\n  decodeMono8,\n  decodeMono16,\n} from \"./decodings\";\nimport { buildMarkerData, type Dimensions, type RawMarkerData, type MarkerData, type OffscreenCanvas } from \"./util\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport type { ImageMarker, Color, Point } from \"webviz-core/src/types/Messages\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\n\n// Just globally keep track of if we've shown an error in rendering, since typically when you get\n// one error, you'd then get a whole bunch more, which is spammy.\nlet hasLoggedCameraModelError: boolean = false;\n\n// Given a canvas, an image message, and marker info, render the image to the canvas.\n// Nothing in this module should have state.\nexport async function renderImage({\n  canvas,\n  imageMessage,\n  imageMessageDatatype,\n  rawMarkerData,\n}: {\n  canvas: ?(HTMLCanvasElement | OffscreenCanvas),\n  imageMessage: ?Message,\n  imageMessageDatatype: ?string,\n  rawMarkerData: RawMarkerData,\n}): Promise<?Dimensions> {\n  if (!canvas) {\n    return null;\n  }\n  if (!imageMessage || !imageMessageDatatype) {\n    clearCanvas(canvas);\n    return null;\n  }\n  let markerData = null;\n  try {\n    markerData = buildMarkerData(rawMarkerData);\n  } catch (error) {\n    if (!hasLoggedCameraModelError) {\n      sendNotification(`Failed to initialize camera model from CameraInfo`, error, \"user\", \"warn\");\n      hasLoggedCameraModelError = true;\n    }\n  }\n\n  try {\n    const bitmap = await decodeMessageToBitmap(imageMessage, imageMessageDatatype);\n    const dimensions = paintBitmap(canvas, bitmap, markerData);\n    bitmap.close();\n    return dimensions;\n  } catch (error) {\n    // If there is an error, clear the image and re-throw it.\n    clearCanvas(canvas);\n    throw error;\n  }\n}\n\nfunction toRGBA(color: Color) {\n  const { r, g, b, a } = color;\n  return `rgba(${r}, ${g}, ${b}, ${a || 1})`;\n}\n\n// Note: Return type is inexact -- may contain z.\nfunction maybeUnrectifyPoint(cameraModel: ?CameraModel, point: Point): $ReadOnly<{ x: number, y: number }> {\n  if (cameraModel) {\n    return cameraModel.unrectifyPoint(point);\n  }\n  return point;\n}\n\nasync function decodeMessageToBitmap(msg: Message, datatype: string): Promise<ImageBitmap> {\n  let image: ImageData | Image | Blob;\n  const { data: rawData, is_bigendian, width, height, encoding } = msg.message;\n  if (!(rawData instanceof Uint8Array)) {\n    throw new Error(\"Message must have data of type Uint8Array\");\n  }\n\n  // In a Websocket context, we don't know whether the message is compressed or\n  // raw. Our subscription interface for the WebsocketPlayer can request\n  // compressed verisons of topics, in which case the message datatype can\n  // differ from the one recorded during initialization. So here we just check\n  // for properties consistent with either datatype, and render accordingly.\n  if (datatype === \"sensor_msgs/Image\" && encoding) {\n    image = new ImageData(width, height);\n    // prettier-ignore\n    switch (encoding) {\n      case \"yuv422\": decodeYUV(rawData, width, height, image.data); break;\n      case \"rgb8\": decodeRGB8(rawData, width, height, image.data); break;\n      case \"bgr8\": decodeBGR8(rawData, width, height, image.data); break;\n      case \"32FC1\": decodeFloat1c(rawData, width, height, is_bigendian, image.data); break;\n      case \"bayer_rggb8\": decodeBayerRGGB8(rawData, width, height, image.data); break;\n      case \"bayer_bggr8\": decodeBayerBGGR8(rawData, width, height, image.data); break;\n      case \"bayer_gbrg8\": decodeBayerGBRG8(rawData, width, height, image.data); break;\n      case \"bayer_grbg8\": decodeBayerGRBG8(rawData, width, height, image.data); break;\n      case \"mono8\":\n      case \"8UC1\":\n          decodeMono8(rawData, width, height, image.data); break;\n      case \"mono16\":\n      case \"16UC1\":\n          decodeMono16(rawData, width, height, is_bigendian, image.data); break;\n      default:\n        throw new Error(`Unsupported encoding ${encoding}`);\n    }\n  } else if ([\"sensor_msgs/CompressedImage\", \"sensor_msgs/Image\"].includes(datatype) || msg.message.format) {\n    // The Blob constructor does not like typed arrays backed by SharedArrayBuffers.\n    const notSharedData =\n      // SharedArrayBuffer won't work if not cross origin isolated.\n      self.crossOriginIsolated && typeof SharedArrayBuffer === \"function\" && rawData.buffer instanceof SharedArrayBuffer\n        ? new Uint8Array(rawData)\n        : rawData;\n    image = new Blob([notSharedData], { type: `image/${msg.message.format}` });\n  } else {\n    throw new Error(`Message type is not usable for rendering images.`);\n  }\n\n  return self.createImageBitmap(image);\n}\n\nfunction clearCanvas(canvas: ?HTMLCanvasElement) {\n  if (canvas) {\n    canvas.getContext(\"2d\").clearRect(0, 0, canvas.width, canvas.height);\n  }\n}\n\nfunction paintBitmap(canvas: HTMLCanvasElement, bitmap: ImageBitmap, markerData: MarkerData): ?Dimensions {\n  let bitmapDimensions = { width: bitmap.width, height: bitmap.height };\n  const ctx = canvas.getContext(\"2d\");\n  if (!markerData) {\n    resizeCanvas(canvas, bitmap.width, bitmap.height);\n    ctx.transform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(bitmap, 0, 0);\n    return bitmapDimensions;\n  }\n\n  const { markers, cameraModel } = markerData;\n  let { originalWidth, originalHeight } = markerData;\n  if (originalWidth == null) {\n    originalWidth = bitmap.width;\n  }\n  if (originalHeight == null) {\n    originalHeight = bitmap.height;\n  }\n\n  bitmapDimensions = { width: originalWidth, height: originalHeight };\n  resizeCanvas(canvas, originalWidth, originalHeight);\n  ctx.save();\n  ctx.scale(originalWidth / bitmap.width, originalHeight / bitmap.height);\n  ctx.drawImage(bitmap, 0, 0);\n  ctx.restore();\n  ctx.save();\n  try {\n    paintMarkers(ctx, markers, cameraModel);\n  } catch (err) {\n    console.warn(\"error painting markers:\", err);\n  } finally {\n    ctx.restore();\n  }\n  return bitmapDimensions;\n}\n\nfunction paintMarkers(ctx: CanvasRenderingContext2D, messages: Message[], cameraModel: ?CameraModel) {\n  for (const { message } of messages) {\n    ctx.save();\n    try {\n      if (Array.isArray(message.markers)) {\n        for (const marker of message.markers) {\n          paintMarker(ctx, marker, cameraModel);\n        }\n      } else {\n        paintMarker(ctx, message, cameraModel);\n      }\n    } catch (e) {\n      console.error(\"Unable to paint marker to ImageView\", e, message);\n    }\n    ctx.restore();\n  }\n}\n\nfunction paintMarker(ctx: CanvasRenderingContext2D, marker: ImageMarker, cameraModel: ?CameraModel) {\n  switch (marker.type) {\n    case 0: {\n      // CIRCLE\n      ctx.beginPath();\n      const { x, y } = maybeUnrectifyPoint(cameraModel, marker.position);\n      ctx.arc(x, y, marker.scale, 0, 2 * Math.PI);\n      if (marker.thickness <= 0) {\n        ctx.fillStyle = toRGBA(marker.outline_color);\n        ctx.fill();\n      } else {\n        ctx.lineWidth = marker.thickness;\n        ctx.strokeStyle = toRGBA(marker.outline_color);\n        ctx.stroke();\n      }\n      break;\n    }\n\n    // LINE_LIST\n    case 2:\n      if (marker.points.length % 2 !== 0) {\n        break;\n      }\n      ctx.strokeStyle = toRGBA(marker.outline_color);\n      ctx.lineWidth = marker.thickness;\n      for (let i = 0; i < marker.points.length; i += 2) {\n        const { x: x1, y: y1 } = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n        const { x: x2, y: y2 } = maybeUnrectifyPoint(cameraModel, marker.points[i + 1]);\n        ctx.beginPath();\n        ctx.moveTo(x1, y1);\n        ctx.lineTo(x2, y2);\n        ctx.stroke();\n      }\n      break;\n\n    // LINE_STRIP, POLYGON\n    case 1:\n    case 3: {\n      if (marker.points.length === 0) {\n        break;\n      }\n      ctx.beginPath();\n      const { x, y } = maybeUnrectifyPoint(cameraModel, marker.points[0]);\n      ctx.moveTo(x, y);\n      for (let i = 1; i < marker.points.length; i++) {\n        const maybeUnrectifiedPoint = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n        ctx.lineTo(maybeUnrectifiedPoint.x, maybeUnrectifiedPoint.y);\n      }\n      if (marker.type === 3) {\n        ctx.closePath();\n      }\n      if (marker.thickness <= 0) {\n        ctx.fillStyle = toRGBA(marker.outline_color);\n        ctx.fill();\n      } else {\n        ctx.strokeStyle = toRGBA(marker.outline_color);\n        ctx.lineWidth = marker.thickness;\n        ctx.stroke();\n      }\n      break;\n    }\n\n    case 4: {\n      // POINTS\n      if (marker.points.length === 0) {\n        break;\n      }\n\n      const size = marker.scale || 4;\n      if (marker.outline_colors && marker.outline_colors.length === marker.points.length) {\n        for (let i = 0; i < marker.points.length; i++) {\n          const { x, y } = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n          ctx.fillStyle = toRGBA(marker.outline_colors[i]);\n          ctx.beginPath();\n          ctx.arc(x, y, size, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      } else {\n        ctx.beginPath();\n        for (let i = 0; i < marker.points.length; i++) {\n          const { x, y } = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n          ctx.arc(x, y, size, 0, 2 * Math.PI);\n          ctx.closePath();\n        }\n        ctx.fillStyle = toRGBA(marker.fill_color);\n        ctx.fill();\n      }\n      break;\n    }\n\n    case 5: {\n      // TEXT (our own extension on visualization_msgs/Marker)\n      const { x, y } = maybeUnrectifyPoint(cameraModel, marker.position);\n\n      const fontSize = marker.scale * 12;\n      const padding = 4 * marker.scale;\n      ctx.font = `${fontSize}px sans-serif`;\n      ctx.textBaseline = \"bottom\";\n      if (marker.filled) {\n        const metrics = ctx.measureText(marker.text.data);\n        const height = fontSize * 1.2; // Chrome doesn't yet support height in TextMetrics\n        ctx.fillStyle = toRGBA(marker.fill_color);\n        ctx.fillRect(x, y - height, Math.ceil(metrics.width + 2 * padding), Math.ceil(height));\n      }\n      ctx.fillStyle = toRGBA(marker.outline_color);\n      ctx.fillText(marker.text.data, x + padding, y);\n      break;\n    }\n\n    default:\n      console.warn(\"unrecognized image marker type\", marker);\n  }\n}\n\nfunction resizeCanvas(canvas: ?HTMLCanvasElement, width: number, height: number) {\n  if (canvas && (canvas.width !== width || canvas.height !== height)) {\n    canvas.width = width;\n    canvas.height = height;\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport function decodeYUV(yuv: Int8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let c = 0;\n  let off = 0;\n\n  // populate 2 pixels at a time\n  const max = height * width;\n  for (let r = 0; r <= max; r += 2) {\n    const u = yuv[off] - 128;\n    const y1 = yuv[off + 1];\n    const v = yuv[off + 2] - 128;\n    const y2 = yuv[off + 3];\n\n    // rgba\n    output[c] = y1 + 1.402 * v;\n    output[c + 1] = y1 - 0.34414 * u - 0.71414 * v;\n    output[c + 2] = y1 + 1.772 * u;\n    output[c + 3] = 255;\n\n    // rgba\n    output[c + 4] = y2 + 1.402 * v;\n    output[c + 5] = y2 - 0.34414 * u - 0.71414 * v;\n    output[c + 6] = y2 + 1.772 * u;\n    output[c + 7] = 255;\n\n    c += 8;\n    off += 4;\n  }\n}\n\nexport function decodeRGB8(rgb: Uint8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let inIdx = 0;\n  let outIdx = 0;\n\n  for (let i = 0; i < width * height; i++) {\n    const r = rgb[inIdx++];\n    const g = rgb[inIdx++];\n    const b = rgb[inIdx++];\n\n    output[outIdx++] = r;\n    output[outIdx++] = g;\n    output[outIdx++] = b;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeBGR8(bgr: Uint8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let inIdx = 0;\n  let outIdx = 0;\n\n  for (let i = 0; i < width * height; i++) {\n    const b = bgr[inIdx++];\n    const g = bgr[inIdx++];\n    const r = bgr[inIdx++];\n\n    output[outIdx++] = r;\n    output[outIdx++] = g;\n    output[outIdx++] = b;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeFloat1c(\n  gray: Uint8Array,\n  width: number,\n  height: number,\n  is_bigendian: boolean,\n  output: Uint8ClampedArray\n) {\n  const view = new DataView(gray.buffer, gray.byteOffset);\n\n  let outIdx = 0;\n  for (let i = 0; i < width * height * 4; i += 4) {\n    const val = view.getFloat32(i, !is_bigendian) * 255;\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeMono8(mono8: Uint8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let inIdx = 0;\n  let outIdx = 0;\n\n  for (let i = 0; i < width * height; i++) {\n    const ch = mono8[inIdx++];\n    output[outIdx++] = ch;\n    output[outIdx++] = ch;\n    output[outIdx++] = ch;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeMono16(\n  mono16: Uint8Array,\n  width: number,\n  height: number,\n  is_bigendian: boolean,\n  output: Uint8ClampedArray\n) {\n  const view = new DataView(mono16.buffer, mono16.byteOffset);\n\n  let outIdx = 0;\n  for (let i = 0; i < width * height * 2; i += 2) {\n    let val = view.getUint16(i, !is_bigendian);\n\n    // For now, just assume values are in the range 0-10000, consistent with image_view's default.\n    // TODO: support dynamic range adjustment and/or user-selectable range\n    // References:\n    // https://github.com/ros-perception/image_pipeline/blob/42266892502427eb566a4dffa61b009346491ce7/image_view/src/nodes/image_view.cpp#L80-L88\n    // https://github.com/ros-visualization/rqt_image_view/blob/fe076acd265a05c11c04f9d04392fda951878f54/src/rqt_image_view/image_view.cpp#L582\n    // https://github.com/ros-visualization/rviz/blob/68b464fb6571b8760f91e8eca6fb933ba31190bf/src/rviz/image/ros_image_texture.cpp#L114\n    val = (val / 10000) * 255;\n\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = 255;\n  }\n}\n\n// Specialize the Bayer decode function to a certain encoding. For performance reasons, we use\n// new Function() -- this is about 20% faster than a switch statement and .bind().\nfunction makeSpecializedDecodeBayer(\n  tl,\n  tr,\n  bl,\n  br\n): (data: Uint8Array, width: number, height: number, output: Uint8ClampedArray) => void {\n  // We probably can't afford real debayering/demosaicking, so do something simpler\n  // The input array look like a single-plane array of pixels.  However, each pixel represents a one particular color\n  // for a group of pixels in the 2x2 region.  For 'rggb', there color representatio for the 2x2 region looks like:\n  //\n  // R  | G0\n  // -------\n  // G1 | B\n  //\n  // In other words, a 2x2 region is represented by one R value, one B value, and two G values.  In sophisticated\n  // algorithms, each color will be weighted and interpolated to fill in the missing colors for the pixels.  These\n  // algorithms may reach beyond the local 2x2 region and use values from neighboring regions.\n  //\n  // We'll do something much simpler.  For each group of 2x2, we're replicate the R and B values for all pixels.\n  // For the two row, we'll replicate G0 for the green channels, and replicate G1 for the bottom row.\n  // eslint-disable-next-line no-new-func\n  return (new Function(\n    \"data\",\n    \"width\",\n    \"height\",\n    \"output\",\n    `\n  for (let i = 0; i < height / 2; i++) {\n    let inIdx = i * 2 * width;\n    let outTopIdx = i * 2 * width * 4; // Addresses top row\n    let outBottomIdx = (i * 2 + 1) * width * 4; // Addresses bottom row\n    for (let j = 0; j < width / 2; j++) {\n      const tl = data[inIdx++];\n      const tr = data[inIdx++];\n      const bl = data[inIdx + width - 2];\n      const br = data[inIdx + width - 1];\n\n      const ${tl} = tl;\n      const ${tr} = tr;\n      const ${bl} = bl;\n      const ${br} = br;\n\n      // Top row\n      output[outTopIdx++] = r;\n      output[outTopIdx++] = g0;\n      output[outTopIdx++] = b;\n      output[outTopIdx++] = 255;\n\n      output[outTopIdx++] = r;\n      output[outTopIdx++] = g0;\n      output[outTopIdx++] = b;\n      output[outTopIdx++] = 255;\n\n      // Bottom row\n      output[outBottomIdx++] = r;\n      output[outBottomIdx++] = g1;\n      output[outBottomIdx++] = b;\n      output[outBottomIdx++] = 255;\n\n      output[outBottomIdx++] = r;\n      output[outBottomIdx++] = g1;\n      output[outBottomIdx++] = b;\n      output[outBottomIdx++] = 255;\n    }\n  }`\n  ): any);\n}\n\nexport const decodeBayerRGGB8 = makeSpecializedDecodeBayer(\"r\", \"g0\", \"g1\", \"b\");\nexport const decodeBayerBGGR8 = makeSpecializedDecodeBayer(\"b\", \"g0\", \"g1\", \"r\");\nexport const decodeBayerGBRG8 = makeSpecializedDecodeBayer(\"g0\", \"b\", \"r\", \"g1\");\nexport const decodeBayerGRBG8 = makeSpecializedDecodeBayer(\"g0\", \"r\", \"b\", \"g1\");\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport Tooltip from \"@cruise-automation/tooltip\";\nimport * as React from \"react\";\n\nimport Menu from \"webviz-core/src/components/Menu\";\n\ntype Props = {\n  children: React.Node,\n};\n\n// a tiny wrapper around the tooltip component that automatically\n// hides on the next mouse click so you don't have to manage window listeners yourself\nexport default class ContextMenu extends React.Component<Props> {\n  static show(x: number, y: number, contents: React.Node) {\n    Tooltip.show(x, y, <ContextMenu>{contents}</ContextMenu>);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"click\", this.hide);\n  }\n\n  hide = () => {\n    window.removeEventListener(\"click\", this.hide);\n    Tooltip.hide();\n  };\n\n  render() {\n    return <Menu>{this.props.children}</Menu>;\n  }\n}\n","module.exports = \"# Image View\\n\\nThe Image View panel displays images from `sensor_msgs/Image` or `sensor_msgs/CompressedImage` topics.\\n\\n16-bit images (`16UC1`) are currently displayed assuming the values fall into the 0&ndash;10000 range, consistent with the defaults of the ROS `image_view` tool.\\n\\nThe **markers** dropdown can be used to toggle on and off topics with type `visualization_msgs/ImageMarker`, which will be overlayed on top of the selected image topic. Note that markers are only available if the `CameraInfo` for the selected camera is being published. If the image is unrectified, the markers will be transformed by webviz based on `CameraInfo`.\\n\\nThe **scale** dropdown allows you to adjust the scale of the image.  Since the images are fairly large, it is recommended to use the smallest scale you need to conserve bandwidth.  Currently using `scale 1.0` can negatively impact rendering speed, particularly if you have a limited bandwidth connection. (Note: only applies to streaming connections, which is not part of the open source version yet.)\\n\\nShortcuts:\\n\\n- =: Zoom in\\n- -: Zoom out\\n- Command + (1 2 3 ... 9 0): Go to percentage 10% - 100%. Note that 10% may be less than the minimum zoom size based on panel and image size.\\n\"","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-ImageView-index-module-6m7vg--controls{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex:1 1 auto;flex:1 1 auto;-ms-flex-align:center;align-items:center;overflow:hidden}.packages-webviz-core-src-panels-ImageView-index-module-6m7vg--controls button{margin:1px 4px 1px 0}.packages-webviz-core-src-panels-ImageView-index-module-3hq5q--dropdownItem{position:relative}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ImageView/index.module.scss\"],\"names\":[],\"mappings\":\"AAMA,wEACE,oBAAA,aACA,mBAAA,eACA,kBAAA,cACA,sBAAA,mBACA,eAAA,CACA,+EACE,oBAAA,CAIJ,4EACE,iBAAA,CAAA\",\"file\":\"index.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n.controls {\\n  display: flex;\\n  flex-wrap: wrap;\\n  flex: 1 1 auto;\\n  align-items: center;\\n  overflow: hidden;\\n  button {\\n    margin: 1px 4px 1px 0;\\n  }\\n}\\n\\n.dropdownItem {\\n  position: relative;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"controls\": \"packages-webviz-core-src-panels-ImageView-index-module-6m7vg--controls\",\n\t\"dropdownItem\": \"packages-webviz-core-src-panels-ImageView-index-module-3hq5q--dropdownItem\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport FormatTextIcon from \"@mdi/svg/svg/format-text-rotation-none.svg\";\nimport React from \"react\";\n\nimport { Item, SubMenu } from \"webviz-core/src/components/Menu\";\nimport TextField from \"webviz-core/src/components/TextField\";\n\nexport default function IconTextMenu({ value, onChange }: { value: string, onChange: (newVal: string) => void }) {\n  return (\n    <SubMenu checked={false} text=\"Icon text template\" icon={<FormatTextIcon />}>\n      <Item tooltip=\"Use the template string and metadata fields to configure the icon text, e.g. ${id} (${confidence})\">\n        <TextField value={value} autoFocus onChange={onChange} placeholder=\"e.g. `${id} (${confidence})`\" />\n      </Item>\n    </SubMenu>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { groupBy, sortBy, mapValues } from \"lodash\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { Item } from \"webviz-core/src/components/Menu\";\nimport MessageHistoryDEPRECATED from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TextContent from \"webviz-core/src/components/TextContent\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Topic, Message, SubscribePayload, AdvertisePayload } from \"webviz-core/src/players/types\";\nimport { downloadTextFile } from \"webviz-core/src/util\";\nimport { getTopicsByTopicName } from \"webviz-core/src/util/selectors\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst { useCallback } = React;\n\nconst RECORD_ALL = \"RECORD_ALL\";\n\nconst Container = styled.div`\n  padding: 16px;\n  overflow-y: auto;\n  ul {\n    font-size: 10px;\n    margin-left: 8px;\n  }\n  li {\n    margin: 4px 0;\n  }\n  // Taken shamelessly from https://stackoverflow.com/a/14424029.\n  li div {\n    padding-left: 1em;\n    position: relative;\n  }\n  li div::before {\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: -2px;\n    bottom: 50%;\n    width: 0.75em;\n    border: 2px solid ${colors.TEXT_MUTED};\n    border-top: 0 none transparent;\n    border-right: 0 none transparent;\n  }\n  h1 {\n    font-size: 1.5em;\n    margin-bottom: 0.5em;\n  }\n  section {\n    flex: 1 1 50%;\n    overflow: hidden;\n  }\n`;\n\nfunction getSubscriptionGroup({ requester }: SubscribePayload): string {\n  if (!requester) {\n    return \"<unknown>\";\n  }\n  switch (requester.type) {\n    case \"panel\":\n      return `Panel ${requester.name}`;\n    case \"node\":\n      return `Node ${requester.name}`;\n    case \"other\":\n      return requester.name;\n  }\n  (requester.type: empty); // enforce that all cases are handled in switch above\n  // this shouldn't be necessary, but Flow doesn't let us fall off the end without returning a string\n  // https://github.com/facebook/flow/issues/451\n  return `<unknown: ${requester.type} ${requester.name}>`;\n}\n\nfunction getPublisherGroup({ advertiser }: AdvertisePayload): string {\n  if (!advertiser) {\n    return \"<unknown>\";\n  }\n  switch (advertiser.type) {\n    case \"panel\":\n      return `Panel ${advertiser.name}`;\n  }\n  (advertiser.type: empty);\n  return `<unknown: ${advertiser.type} ${advertiser.name}>`;\n}\n\n// Display webviz internal state for debugging and viewing topic dependencies.\nfunction Internals(): React.Node {\n  const { topics } = PanelAPI.useDataSourceInfo();\n  const topicsByName = React.useMemo(() => getTopicsByTopicName(topics), [topics]);\n  const { subscriptions, publishers } = useMessagePipeline(\n    useCallback(\n      (messagePipeline) => ({ subscriptions: messagePipeline.subscriptions, publishers: messagePipeline.publishers }),\n      []\n    )\n  );\n\n  const [groupedSubscriptions, subscriptionGroups] = React.useMemo(() => {\n    const grouped = groupBy(subscriptions, getSubscriptionGroup);\n    return [grouped, Object.keys(grouped)];\n  }, [subscriptions]);\n\n  const renderedSubscriptions = React.useMemo(() => {\n    if (subscriptions.length === 0) {\n      return \"(none)\";\n    }\n    return Object.keys(groupedSubscriptions)\n      .sort()\n      .map((key) => {\n        return (\n          <React.Fragment key={key}>\n            <div style={{ marginTop: 16 }}>{key}:</div>\n            <ul>\n              {sortBy(groupedSubscriptions[key], (sub) => sub.topic).map((sub, i) => (\n                <li key={i}>\n                  <tt>\n                    {sub.topic}\n                    {topicsByName[sub.topic] &&\n                      topicsByName[sub.topic].originalTopic &&\n                      ` (original topic: ${topicsByName[sub.topic].originalTopic})`}\n                  </tt>\n                  <ul>\n                    {((topicsByName[sub.topic] && topicsByName[sub.topic].inputTopics) ?? []).map((inputTopic) => (\n                      <li key={`${i}-${inputTopic}`}>\n                        <div>{inputTopic}</div>\n                      </li>\n                    ))}\n                  </ul>\n                </li>\n              ))}\n            </ul>\n          </React.Fragment>\n        );\n      });\n  }, [groupedSubscriptions, subscriptions.length, topicsByName]);\n\n  const renderedPublishers = React.useMemo(() => {\n    if (publishers.length === 0) {\n      return \"(none)\";\n    }\n    const groupedPublishers = groupBy(publishers, getPublisherGroup);\n    return Object.keys(groupedPublishers)\n      .sort()\n      .map((key) => {\n        return (\n          <React.Fragment key={key}>\n            <div style={{ marginTop: 16 }}>{key}:</div>\n            <ul>\n              {sortBy(groupedPublishers[key], (sub) => sub.topic).map((sub, i) => (\n                <li key={i}>\n                  <tt>{sub.topic}</tt>\n                </li>\n              ))}\n            </ul>\n          </React.Fragment>\n        );\n      });\n  }, [publishers]);\n\n  const [recordGroup, setRecordGroup] = React.useState<string>(RECORD_ALL);\n  const [recordingTopics, setRecordingTopics] = React.useState<?(string[])>();\n  const recordedData = React.useRef<?{ topics: Topic[], frame: { [string]: Message[] } }>();\n\n  function onRecordClick() {\n    if (recordingTopics) {\n      recordedData.current = undefined;\n      setRecordingTopics(undefined);\n      return;\n    }\n    const recordSubs = recordGroup === RECORD_ALL ? subscriptions : groupedSubscriptions[recordGroup];\n    setRecordingTopics(recordSubs.map((sub) => sub.topic));\n  }\n\n  function downloadJSON() {\n    downloadTextFile(JSON.stringify(recordedData.current) || \"{}\", \"fixture.json\");\n  }\n\n  const historyRecorder = React.useMemo(() => {\n    if (!recordingTopics) {\n      return false;\n    }\n    return (\n      <MessageHistoryDEPRECATED paths={recordingTopics} historySize={1}>\n        {({ itemsByPath }) => {\n          const frame = mapValues(itemsByPath, (items) => items.map(({ message }) => message));\n          recordedData.current = {\n            topics: filterMap(Object.keys(itemsByPath), (topic) =>\n              itemsByPath[topic] && itemsByPath[topic].length\n                ? { name: topic, datatype: topicsByName[topic].datatype }\n                : null\n            ),\n            frame,\n          };\n          return null;\n        }}\n      </MessageHistoryDEPRECATED>\n    );\n  }, [recordingTopics, topicsByName]);\n\n  return (\n    <Container>\n      <PanelToolbar floating />\n      <h1>Recording</h1>\n      <TextContent>\n        Press to start recording topic data for debug purposes. The latest messages on each topic will be kept and\n        formatted into a fixture that can be used to create a test.\n      </TextContent>\n      <Flex row wrap style={{ padding: \"8px 0 32px\" }}>\n        <Button isPrimary small onClick={onRecordClick} data-test=\"internals-record-button\">\n          {recordingTopics ? `Recording ${recordingTopics.length} topics` : \"Record raw data\"}\n        </Button>\n        <Dropdown\n          disabled={!!recordingTopics}\n          text={`Record from: ${recordGroup === RECORD_ALL ? \"All panels\" : recordGroup}`}\n          value={recordGroup}\n          onChange={(value) => setRecordGroup(value)}>\n          <Item value={RECORD_ALL}>All panels</Item>\n          {subscriptionGroups.map((group) => (\n            <Item key={group} value={group}>\n              {group}\n            </Item>\n          ))}\n        </Dropdown>\n        {recordingTopics && (\n          <Button small onClick={downloadJSON} data-test=\"internals-download-button\">\n            Download JSON\n          </Button>\n        )}\n        {historyRecorder}\n      </Flex>\n      <Flex row>\n        <section data-test=\"internals-subscriptions\">\n          <h1>Subscriptions</h1>\n          {renderedSubscriptions}\n        </section>\n        <section data-test=\"internals-publishers\">\n          <h1>Publishers</h1>\n          {renderedPublishers}\n        </section>\n      </Flex>\n    </Container>\n  );\n}\nInternals.panelType = \"Internals\";\nInternals.defaultConfig = {};\n\nexport default hot(Panel<{}>(Internals));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ArrowLeftIcon from \"@mdi/svg/svg/arrow-left.svg\";\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport PlusIcon from \"@mdi/svg/svg/plus.svg\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\nimport uuid from \"uuid\";\n\nimport { type Script } from \"./script\";\nimport { setUserNodes as setUserNodesAction } from \"webviz-core/src/actions/panels\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport ResizableSplitFlex from \"webviz-core/src/components/ResizableSplitFlex\";\nimport SpinningLoadingIcon from \"webviz-core/src/components/SpinningLoadingIcon\";\nimport TextContent from \"webviz-core/src/components/TextContent\";\nimport BottomBar from \"webviz-core/src/panels/NodePlayground/BottomBar\";\nimport Playground from \"webviz-core/src/panels/NodePlayground/playground-icon.svg\";\nimport Sidebar from \"webviz-core/src/panels/NodePlayground/Sidebar\";\nimport type { UserNodes } from \"webviz-core/src/types/panels\";\nimport { DEFAULT_WEBVIZ_NODE_PREFIX } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst Editor = React.lazy(() =>\n  import(/* webpackChunkName: \"node-playground-editor\" */ \"webviz-core/src/panels/NodePlayground/Editor\")\n);\n\nconst skeletonBody = `import { Input, Messages } from \"ros\";\n\ntype Output = {};\ntype GlobalVariables = { id: number };\n\nexport const inputs = [];\nexport const output = \"${DEFAULT_WEBVIZ_NODE_PREFIX}\";\n\n// Populate 'Input' with a parameter to properly type your inputs, e.g. 'Input<\"/your_input_topic\">'\nconst publisher = (message: Input<>, globalVars: GlobalVariables): Output => {\n  return {};\n};\n\nexport default publisher;`;\n\ntype Config = {|\n  selectedNodeId: ?string,\n  // Used only for storybook screenshot testing.\n  editorForStorybook?: React.Node,\n  // Used only for storybook screenshot testing.\n  additionalBackStackItems?: Script[],\n  vimMode: boolean,\n  autoFormatOnSave?: boolean,\n|};\n\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n};\n\nconst UnsavedDot = styled.div`\n  display: ${({ isSaved }: { isSaved: boolean }) => (isSaved ? \"none\" : \"initial\")};\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  position: absolute;\n  right: 8px;\n  top: 50%;\n  transform: translateY(-50%);\n  background-color: ${colors.DARK9};\n`;\n\n// Exported for screenshot testing.\nexport const NodePlaygroundSettings = ({ config, saveConfig }: Props) => (\n  <>\n    <Item\n      icon={config.autoFormatOnSave ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n      onClick={() => saveConfig({ autoFormatOnSave: !config.autoFormatOnSave })}>\n      <span>Auto-format on save</span>\n    </Item>\n    <Item\n      icon={config.vimMode ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n      onClick={() => saveConfig({ vimMode: !config.vimMode })}>\n      <span>Vim Mode</span>\n    </Item>\n  </>\n);\n\nconst SWelcomeScreen = styled.div`\n  display: flex;\n  text-align: center;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  padding: 25%;\n  height: 100%;\n  > * {\n    margin: 4px 0;\n  }\n`;\n\nexport type Explorer = null | \"docs\" | \"nodes\" | \"utils\" | \"templates\";\n\nconst WelcomeScreen = ({\n  addNewNode,\n  updateExplorer,\n}: {|\n  addNewNode: () => void,\n  updateExplorer: (explorer: Explorer) => void,\n|}) => {\n  return (\n    <SWelcomeScreen>\n      <Playground />\n      <TextContent>\n        Welcome to Node Playground! Get started by reading the{\" \"}\n        <a\n          href=\"\"\n          onClick={(e) => {\n            e.preventDefault();\n            updateExplorer(\"docs\");\n          }}>\n          docs\n        </a>\n        , or just create a new node.\n      </TextContent>\n      <Button style={{ marginTop: \"8px\" }} onClick={addNewNode}>\n        <Icon medium>\n          <PlusIcon />\n        </Icon>{\" \"}\n        New node\n      </Button>\n    </SWelcomeScreen>\n  );\n};\n\nfunction NodePlayground(props: Props) {\n  const { config, saveConfig } = props;\n  const { autoFormatOnSave, selectedNodeId, editorForStorybook, vimMode } = config;\n\n  const [explorer, updateExplorer] = React.useState<Explorer>(null);\n  const [bottomBarSplitPercent, setBottomBarSplitPercent] = React.useState<number>(1);\n\n  const bottomBarOpen = bottomBarSplitPercent < 0.95;\n  const toggleBottomBarOpen = React.useCallback(() => setBottomBarSplitPercent(bottomBarOpen ? 1 : 0.8), [\n    bottomBarOpen,\n  ]);\n\n  const userNodes = useSelector((state) => state.persistedState.panels.userNodes);\n  const userNodeDiagnostics = useSelector((state) => state.userNodes.userNodeDiagnostics);\n  const rosLib = useSelector((state) => state.userNodes.rosLib);\n\n  const dispatch = useDispatch();\n  const setUserNodes = React.useCallback((payload: UserNodes) => dispatch(setUserNodesAction(payload)), [dispatch]);\n\n  const selectedNodeDiagnostics =\n    selectedNodeId && userNodeDiagnostics[selectedNodeId] ? userNodeDiagnostics[selectedNodeId].diagnostics : [];\n  const selectedNode = selectedNodeId ? userNodes[selectedNodeId] : undefined;\n  const [scriptBackStack, setScriptBackStack] = React.useState<Script[]>([]);\n  // Holds the currently active script\n  const currentScript = scriptBackStack.length > 0 ? scriptBackStack[scriptBackStack.length - 1] : null;\n  const isCurrentScriptSelectedNode = !!selectedNode && !!currentScript && currentScript.filePath === selectedNode.name;\n  const isNodeSaved = !isCurrentScriptSelectedNode || currentScript?.code === selectedNode?.sourceCode;\n  const selectedNodeLogs =\n    selectedNodeId && userNodeDiagnostics[selectedNodeId] ? userNodeDiagnostics[selectedNodeId].logs : [];\n\n  const inputTitle = currentScript\n    ? currentScript.filePath + (currentScript.readOnly ? \" (READONLY)\" : \"\")\n    : \"node name\";\n  const inputStyle = {\n    borderRadius: 0,\n    margin: 0,\n    backgroundColor: colors.DARK2,\n    padding: \"4px 20px\",\n    width: `${inputTitle.length + 4}ch`, // Width based on character count of title + padding\n  };\n\n  React.useLayoutEffect(() => {\n    if (selectedNode) {\n      const testItems = props.config.additionalBackStackItems || [];\n      setScriptBackStack([\n        { filePath: selectedNode.name, code: selectedNode.sourceCode, readOnly: false },\n        ...testItems,\n      ]);\n    }\n  }, [props.config.additionalBackStackItems, selectedNode]);\n\n  const addNewNode = React.useCallback((_, code?: string) => {\n    const newNodeId = uuid.v4();\n    const sourceCode = code || skeletonBody;\n    // TODO: Add integration test for this flow.\n    setUserNodes({\n      [newNodeId]: {\n        sourceCode,\n        name: `${DEFAULT_WEBVIZ_NODE_PREFIX}${newNodeId.split(\"-\")[0]}`,\n      },\n    });\n    saveConfig({ selectedNodeId: newNodeId });\n  }, [saveConfig, setUserNodes]);\n\n  const saveNode = React.useCallback((script) => {\n    if (!selectedNodeId || !script) {\n      return;\n    }\n    setUserNodes({ [selectedNodeId]: { ...selectedNode, sourceCode: script } });\n  }, [selectedNode, selectedNodeId, setUserNodes]);\n\n  const setScriptOverride = React.useCallback((script: Script, maxDepth?: number) => {\n    if (maxDepth && scriptBackStack.length >= maxDepth) {\n      setScriptBackStack([...scriptBackStack.slice(0, maxDepth - 1), script]);\n    } else {\n      setScriptBackStack([...scriptBackStack, script]);\n    }\n  }, [scriptBackStack]);\n\n  const goBack = React.useCallback(() => {\n    setScriptBackStack(scriptBackStack.slice(0, scriptBackStack.length - 1));\n  }, [scriptBackStack]);\n\n  const setScriptCode = React.useCallback((code: string) => {\n    // update code at top of backstack\n    const backStack = [...scriptBackStack];\n    if (backStack.length > 0) {\n      const script = backStack.pop();\n      if (!script.readOnly) {\n        setScriptBackStack([...backStack, { ...script, code }]);\n      }\n    }\n  }, [scriptBackStack]);\n\n  return (\n    <Dimensions>\n      {({ height, width }) => (\n        <Flex col style={{ height, position: \"relative\" }}>\n          <PanelToolbar floating menuContent={<NodePlaygroundSettings {...props} />} />\n          <Flex style={{ height, width }}>\n            <Sidebar\n              explorer={explorer}\n              updateExplorer={updateExplorer}\n              selectNode={(nodeId) => {\n                if (selectedNodeId && currentScript && isCurrentScriptSelectedNode) {\n                  // Save current state so that user can seamlessly go back to previous work.\n                  setUserNodes({\n                    [selectedNodeId]: { ...selectedNode, sourceCode: currentScript.code },\n                  });\n                }\n                saveConfig({ selectedNodeId: nodeId });\n              }}\n              deleteNode={(nodeId) => {\n                setUserNodes({ ...userNodes, [nodeId]: undefined });\n                saveConfig({ selectedNodeId: undefined });\n              }}\n              selectedNodeId={selectedNodeId}\n              userNodes={userNodes}\n              userNodeDiagnostics={userNodeDiagnostics}\n              script={currentScript}\n              setScriptOverride={setScriptOverride}\n              addNewNode={addNewNode}\n            />\n            <Flex col>\n              <Flex\n                start\n                style={{\n                  flexGrow: 0,\n                  backgroundColor: colors.DARK1,\n                  alignItems: \"center\",\n                }}>\n                {scriptBackStack.length > 1 && (\n                  <Icon large tooltip=\"Go back\" dataTest=\"go-back\" style={{ color: colors.DARK9 }} onClick={goBack}>\n                    <ArrowLeftIcon />\n                  </Icon>\n                )}\n                {selectedNodeId && (\n                  <div style={{ position: \"relative\" }}>\n                    <input\n                      type=\"text\"\n                      placeholder=\"node name\"\n                      value={inputTitle}\n                      disabled={!currentScript || currentScript.readOnly}\n                      style={inputStyle}\n                      spellCheck={false}\n                      onChange={(e) => {\n                        const newNodeName = e.target.value;\n                        setUserNodes({\n                          ...userNodes,\n                          [selectedNodeId]: { ...selectedNode, name: newNodeName },\n                        });\n                      }}\n                    />\n                    <UnsavedDot isSaved={isNodeSaved} />\n                  </div>\n                )}\n                <Icon\n                  large\n                  tooltip=\"new node\"\n                  dataTest=\"new-node\"\n                  style={{ color: colors.DARK9, padding: \"0 5px\" }}\n                  onClick={addNewNode}>\n                  <PlusIcon />\n                </Icon>\n              </Flex>\n\n              <Flex col style={{ flexGrow: 1, position: \"relative\" }}>\n                {!selectedNodeId && <WelcomeScreen addNewNode={addNewNode} updateExplorer={updateExplorer} />}\n\n                <ResizableSplitFlex column splitPercent={bottomBarSplitPercent} onChange={setBottomBarSplitPercent}>\n                  <div\n                    key={`${height}x${width}`}\n                    data-nativeundoredo=\"true\"\n                    style={{\n                      height: \"100%\",\n                      width: \"100%\",\n                      display: selectedNodeId\n                        ? \"initial\"\n                        : \"none\" /* Ensures the monaco-editor starts loading before the user opens it */,\n                    }}>\n                    <React.Suspense\n                      fallback={\n                        <Flex center style={{ width: \"100%\", height: \"100%\" }}>\n                          <Icon large>\n                            <SpinningLoadingIcon />\n                          </Icon>\n                        </Flex>\n                      }>\n                      {editorForStorybook || (\n                        <Editor\n                          autoFormatOnSave={!!autoFormatOnSave}\n                          script={currentScript}\n                          setScriptCode={setScriptCode}\n                          setScriptOverride={setScriptOverride}\n                          vimMode={vimMode}\n                          rosLib={rosLib}\n                          resizeKey={`${width}-${height}-${explorer || \"none\"}-${selectedNodeId || \"none\"}`}\n                          save={saveNode}\n                        />\n                      )}\n                    </React.Suspense>\n                  </div>\n                  <div style={{ width: \"100%\", height: \"100%\", minHeight: \"28px\" }}>\n                    <BottomBar\n                      nodeId={selectedNodeId}\n                      isSaved={isNodeSaved}\n                      save={() => saveNode(currentScript?.code)}\n                      diagnostics={selectedNodeDiagnostics}\n                      logs={selectedNodeLogs}\n                      open={bottomBarOpen}\n                      toggleBottomBarOpen={toggleBottomBarOpen}\n                    />\n                  </div>\n                </ResizableSplitFlex>\n              </Flex>\n            </Flex>\n          </Flex>\n        </Flex>\n      )}\n    </Dimensions>\n  );\n}\n\nNodePlayground.panelType = \"NodePlayground\";\nNodePlayground.defaultConfig = { selectedNodeId: undefined, vimMode: false, autoFormatOnSave: true };\n\nexport default hot(Panel<Config>(NodePlayground));\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nconst getDraggingCursor = (column) => (column ? \"row-resize\" : \"col-resize\");\n\nconst SContainer = styled.div`\n  position: relative;\n  z-index: 1;\n  display: flex;\n  width: 100%;\n  height: 100%;\n  flex-direction: column;\n`;\n\nconst SSide = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  overflow: hidden;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  align-items: stretch;\n`;\n\nconst SDraggableBorder = styled.div`\n  width: ${({ column }) => (column ? \"100%\" : \"2px\")};\n  height: ${({ column }) => (!column ? \"100%\" : \"2px\")};\n  background: #777;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 1;\n  opacity: ${({ dragging }) => (dragging ? 1 : 0)};\n  pointer-events: ${({ dragging }) => (dragging ? \"none\" : \"auto\")};\n  cursor: ${({ column }) => getDraggingCursor(column)};\n\n  &:hover {\n    opacity: 1;\n  }\n`;\n\ntype Props = {|\n  children: React.Node[],\n  column?: boolean,\n  defaultSplitPercent?: number,\n  splitPercent?: number,\n  onChange?: (number) => void,\n|};\n\nconst convertPercentToAbsolute = (valueRaw: string | number, containerSize: number): number => {\n  const valueAsStr = `${valueRaw}`;\n  const value = parseFloat(valueAsStr);\n  if (valueAsStr.includes(\"%\")) {\n    return value / 100;\n  }\n  return value / containerSize;\n};\n// A container similar to <Flex> that adds a draggable, split border between the container's child elements.\nconst ResizableSplitFlex = ({ children, column, defaultSplitPercent, splitPercent, onChange }: Props) => {\n  const resizingCursor = getDraggingCursor(column);\n  const positionPropName = column ? \"top\" : \"left\";\n  const sizePropName = column ? \"height\" : \"width\";\n  const minStyleName = column ? \"minHeight\" : \"minWidth\";\n  const maxStyleName = column ? \"maxHeight\" : \"maxWidth\";\n\n  // const containerRef = React.useRef<?HTMLElement>(null);\n  const [dragging, setDragging] = React.useState(false);\n  const [containerRef, setContainerRef] = React.useState(undefined);\n\n  const [splitPercentInternal, setSplitPercent] = React.useState(defaultSplitPercent ?? 0.5);\n  const splitPercentToUse = splitPercent ?? splitPercentInternal;\n\n  const childrenStyles = React.useMemo(\n    () =>\n      React.Children.map(children, (element) => {\n        if (!React.isValidElement(element)) {\n          return {};\n        }\n\n        const { minHeight, maxHeight, minWidth, maxWidth } = element.props.style || {};\n        return { minHeight, maxHeight, minWidth, maxWidth };\n      }),\n    [children]\n  );\n\n  const setContainerRefCallback = React.useCallback((element) => {\n    if (element) {\n      setContainerRef(element);\n    }\n  }, []);\n\n  const getConstrainedMinMax = React.useCallback(() => {\n    if (containerRef) {\n      const { height, width } = containerRef.getBoundingClientRect();\n      const containerSize = column ? height : width;\n      const absoluteStyles = childrenStyles.map((styles) => {\n        const minVal = styles[minStyleName];\n        const maxVal = styles[maxStyleName];\n        return {\n          min: minVal && convertPercentToAbsolute(minVal, containerSize),\n          max: maxVal && convertPercentToAbsolute(maxVal, containerSize),\n        };\n      });\n\n      const constrainedMin = Math.max(absoluteStyles[0].min ?? 0, 1 - (absoluteStyles[1].max ?? 1));\n      const constrainedMax = Math.min(absoluteStyles[0].max ?? 1, 1 - (absoluteStyles[1].min ?? 0));\n      return [constrainedMin, constrainedMax];\n    }\n    return [0, 1];\n  }, [childrenStyles, column, containerRef, maxStyleName, minStyleName]);\n\n  const stylesByChildType = React.useMemo(() => {\n    const [constrainedMin, constrainedMax] = getConstrainedMinMax();\n    const constrainedSplit = Math.max(constrainedMin, Math.min(splitPercentToUse, constrainedMax));\n    return {\n      first: { [sizePropName]: `${constrainedSplit * 100}%` },\n      border: { [positionPropName]: `${constrainedSplit * 100}%` },\n      second: {\n        [positionPropName]: `${constrainedSplit * 100}%`,\n        [sizePropName]: `${(1 - constrainedSplit) * 100}%`,\n      },\n    };\n  }, [getConstrainedMinMax, positionPropName, sizePropName, splitPercentToUse]);\n\n  const dragStart = React.useCallback(() => setDragging(true), []);\n  const dragStop = React.useCallback(() => setDragging(false), []);\n  const drag = React.useCallback((ev: MouseEvent) => {\n    if (containerRef) {\n      const { height, width, top, left } = containerRef.getBoundingClientRect();\n      const cursorDistance = column ? ev.clientY : ev.clientX;\n      const minEdge = column ? top : left;\n      const containerSize = column ? height : width;\n      const newSplit = (cursorDistance - minEdge) / containerSize;\n      setSplitPercent(newSplit);\n      if (onChange) {\n        onChange(newSplit);\n      }\n    }\n  }, [column, containerRef, onChange]);\n\n  React.useEffect(() => {\n    if (dragging) {\n      document.addEventListener(\"mouseup\", dragStop);\n      document.addEventListener(\"mousemove\", drag);\n    }\n    return () => {\n      document.removeEventListener(\"mouseup\", dragStop);\n      document.removeEventListener(\"mousemove\", drag);\n    };\n  }, [drag, dragStop, dragging]);\n\n  return (\n    <SContainer ref={setContainerRefCallback} style={{ cursor: dragging ? resizingCursor : \"default\" }}>\n      <SSide column={column} style={stylesByChildType.first}>\n        {children[0]}\n      </SSide>\n      <SDraggableBorder dragging={dragging} column={column} onMouseDown={dragStart} style={stylesByChildType.border} />\n      <SSide column={column} style={stylesByChildType.second}>\n        {children[1]}\n      </SSide>\n    </SContainer>\n  );\n};\nexport default ResizableSplitFlex;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\n\nimport { clearUserNodeLogs } from \"webviz-core/src/actions/userNodes\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport DiagnosticsSection from \"webviz-core/src/panels/NodePlayground/BottomBar/DiagnosticsSection\";\nimport LogsSection from \"webviz-core/src/panels/NodePlayground/BottomBar/LogsSection\";\nimport type { Diagnostic, UserNodeLog } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SHeaderItem = styled.div`\n  cursor: pointer;\n  padding: 4px;\n  text-transform: uppercase;\n  user-select: none;\n`;\n\ntype Props = {|\n  nodeId: ?string,\n  open: boolean,\n  isSaved: boolean,\n  toggleBottomBarOpen: () => void,\n  save: () => void,\n  diagnostics: Diagnostic[],\n  logs: UserNodeLog[],\n|};\n\ntype HeaderItemProps = {\n  text: string,\n  isOpen: boolean,\n  numItems: number,\n};\n\nconst HeaderItem = ({ isOpen, numItems, text }: HeaderItemProps) => (\n  <SHeaderItem\n    style={{\n      color: numItems ? colors.RED : \"inherit\",\n      borderBottom: isOpen ? `1px solid ${colors.DARK6}` : \"none\",\n      paddingBottom: isOpen ? 2 : 0,\n    }}>\n    {text} {numItems || \"\"}\n  </SHeaderItem>\n);\n\ntype BottomBarDisplayState = \"diagnostics\" | \"logs\";\n\nconst BottomBar = ({ nodeId, isSaved, save, diagnostics, logs, toggleBottomBarOpen, open }: Props) => {\n  const [bottomBarDisplay: BottomBarDisplayState, setBottomBarDisplay] = useState(\"diagnostics\");\n  const [autoScroll, setAutoScroll] = useState(true);\n\n  const dispatch = useDispatch();\n  const clearLogs = React.useCallback((payload: string) => dispatch(clearUserNodeLogs(payload)), [dispatch]);\n  const scrollContainer = useRef(null);\n\n  useEffect(() => {\n    if (autoScroll) {\n      if (scrollContainer.current) {\n        scrollContainer.current.scrollTop = scrollContainer.current.scrollHeight;\n      }\n    }\n  }, [autoScroll, logs]);\n\n  return (\n    <Flex\n      col\n      style={{\n        backgroundColor: colors.DARK1,\n        position: \"absolute\",\n        bottom: 0,\n        right: 0,\n        left: 0,\n        height: \"100%\",\n        width: \"100%\",\n      }}>\n      <Flex\n        row\n        start\n        style={{\n          padding: 5,\n          bottom: 0,\n        }}>\n        <Flex\n          center\n          style={{ flexGrow: 0, color: colors.DARK9 }}\n          dataTest=\"np-errors\"\n          onClick={() => {\n            setBottomBarDisplay(\"diagnostics\");\n            if (!open || bottomBarDisplay === \"diagnostics\") {\n              toggleBottomBarOpen();\n            }\n          }}>\n          <HeaderItem text=\"Problems\" numItems={diagnostics.length} isOpen={bottomBarDisplay === \"diagnostics\"} />\n        </Flex>\n        <Flex\n          center\n          style={{ flexGrow: 0, color: colors.DARK9 }}\n          dataTest=\"np-logs\"\n          onClick={() => {\n            setBottomBarDisplay(\"logs\");\n            if (!open || bottomBarDisplay === \"logs\") {\n              toggleBottomBarOpen();\n            }\n          }}>\n          <HeaderItem text=\"Logs\" numItems={logs.length} isOpen={bottomBarDisplay === \"logs\"} />\n        </Flex>\n        <Button\n          style={{ padding: \"2px 4px\" }}\n          primary={!isSaved}\n          disabled={isSaved}\n          tooltip={\"ctrl/cmd + s\"}\n          onClick={() => {\n            if (nodeId) {\n              save();\n              clearLogs(nodeId);\n            }\n          }}>\n          {isSaved ? \"saved\" : \"save\"}\n        </Button>\n      </Flex>\n      <div\n        ref={scrollContainer}\n        onScroll={({ target }) => {\n          const scrolledUp = target.scrollHeight - target.scrollTop > target.clientHeight;\n          if (scrolledUp && autoScroll) {\n            setAutoScroll(false);\n          } else if (!scrolledUp && !autoScroll) {\n            setAutoScroll(true);\n          }\n        }}\n        style={{\n          overflowY: \"auto\",\n          height: \"100%\",\n          color: colors.DARK9,\n        }}>\n        {bottomBarDisplay === \"diagnostics\" && <DiagnosticsSection diagnostics={diagnostics} />}\n        {bottomBarDisplay === \"logs\" && <LogsSection nodeId={nodeId} logs={logs} clearLogs={clearLogs} />}\n      </div>\n    </Flex>\n  );\n};\n\nexport default BottomBar;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport AlertCircleIcon from \"@mdi/svg/svg/alert-circle.svg\";\nimport AlertIcon from \"@mdi/svg/svg/alert.svg\";\nimport HelpCircleIcon from \"@mdi/svg/svg/help-circle.svg\";\nimport InformationIcon from \"@mdi/svg/svg/information.svg\";\nimport { invert } from \"lodash\";\nimport React from \"react\";\n\nimport Icon from \"webviz-core/src/components/Icon\";\nimport type { Diagnostic } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { DiagnosticSeverity } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst severityColors = {\n  Hint: colors.YELLOWL1,\n  Info: colors.BLUEL1,\n  Warning: colors.ORANGEL1,\n  Error: colors.REDL1,\n};\n\nconst severityIcons = {\n  Hint: <HelpCircleIcon />,\n  Info: <InformationIcon />,\n  Warning: <AlertIcon />,\n  Error: <AlertCircleIcon />,\n};\n\ntype Props = {\n  diagnostics: Diagnostic[],\n};\n\nconst DiagnosticsSection = ({ diagnostics }: Props) => {\n  return diagnostics.length ? (\n    <ul>\n      {diagnostics.map(({ severity, message, source, startColumn = null, startLineNumber = null }, i) => {\n        const severityLabel = invert(DiagnosticSeverity)[severity];\n        const errorLoc =\n          startLineNumber != null && startColumn != null ? `[${startLineNumber + 1},${startColumn + 1}]` : null;\n        return (\n          <li key={`${message}_${i}`}>\n            <Icon tooltip=\"Severity\" small style={{ color: severityColors[severityLabel] }} active>\n              {severityIcons[severityLabel]}\n            </Icon>\n            <span style={{ padding: \"5px\" }}>{message}</span>\n            <span style={{ color: colors.GRAY }}>\n              {source} {errorLoc}\n            </span>\n          </li>\n        );\n      })}\n    </ul>\n  ) : (\n    <p>No problems to display.</p>\n  );\n};\n\nexport default DiagnosticsSection;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React from \"react\";\nimport Tree from \"react-json-tree\";\nimport styled from \"styled-components\";\n\nimport type { UserNodeLog } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SListItem = styled.li`\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  cursor: default;\n\n  :hover {\n    background-color: ${colors.DARK4};\n  }\n`;\n\ntype Props = {\n  nodeId: ?string,\n  logs: UserNodeLog[],\n  clearLogs: (nodeId: string) => void,\n};\n\nconst valueColorMap = {\n  string: jsonTreeTheme.base0B,\n  number: jsonTreeTheme.base09,\n  boolean: jsonTreeTheme.base09,\n  object: jsonTreeTheme.base08, // null\n  undefined: jsonTreeTheme.base08,\n};\n\nconst LogsSection = ({ nodeId, logs, clearLogs }: Props) => {\n  if (logs.length === 0) {\n    return (\n      <>\n        <p>No logs to display.</p>\n        <p>\n          Invoke <code>log(someValue)</code> in your Webviz node code to see data printed here.\n        </p>\n      </>\n    );\n  }\n  return (\n    <>\n      <button\n        data-test=\"np-logs-clear\"\n        style={{ padding: \"3px 5px\", position: \"absolute\", right: 5, top: 5 }}\n        onClick={() => {\n          if (nodeId) {\n            clearLogs(nodeId);\n          }\n        }}>\n        clear logs\n      </button>\n      <ul>\n        {logs.map(({ source, value }, idx) => {\n          const renderTreeObj = value != null && typeof value === \"object\";\n          return (\n            <SListItem key={`${idx}${source}`} style={{ padding: renderTreeObj ? \"0px 3px\" : \"6px 3px 3px\" }}>\n              {renderTreeObj ? (\n                <Tree hideRoot data={value} invertTheme={false} theme={jsonTreeTheme} />\n              ) : (\n                <span style={{ color: valueColorMap[typeof value] || colors.LIGHT }}>\n                  {value == null || value === false ? String(value) : value}\n                </span>\n              )}\n              <div style={{ color: colors.DARK9, textDecoration: \"underline\" }}>{source}</div>\n            </SListItem>\n          );\n        })}\n      </ul>\n    </>\n  );\n};\n\nexport default LogsSection;\n","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport React from \"react\";\nexport default ((_ref) => {\n  let {\n    styles = {}\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"styles\"]);\n\n  return React.createElement(\n    \"svg\",\n    _extends({ width: \"138\", height: \"107\", viewBox: \"0 0 138 107\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" }, props),\n    React.createElement(\"path\", { d: \"M47.5 19L44 21l3.5 1.5M53.5 22.5L57 21l-3.5-2\", stroke: \"#C8C8C7\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }),\n    React.createElement(\"path\", { d: \"M47 28l5-10.5\", stroke: \"#C8C8C7\", strokeLinecap: \"round\" }),\n    React.createElement(\"path\", { d: \"M0 106.5h39m9.5 0H79m5.5 0H109m11.5 0H136M29.076 47.5L47 27.744 64.924 47.5H29.076z\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"path\", { d: \"M89.5 2.5l-3.5 2L89.5 6M95.5 6L99 4.5l-3.5-2\", stroke: \"#C8C8C7\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }),\n    React.createElement(\"path\", { d: \"M89 11.5L94 1\", stroke: \"#C8C8C7\", strokeLinecap: \"round\" }),\n    React.createElement(\"path\", { d: \"M71.076 31L89 11.244 106.924 31H71.076zM34.5 79.238h25V89.5h-25V79.238zm25-1h-25V47.5h25v30.738zM76.5 37.073h25V71.5h-25V37.073zm25-1h-25V31h25v5.073z\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"circle\", { cx: \"47\", cy: \"61\", r: \"4.5\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"circle\", { cx: \"89\", cy: \"89\", r: \"5.5\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"path\", { d: \"M113 71.5v-11H68m45 11V85c0 5 9.092 12.56 19 10.5l4.5 11H120m-7-35h-11.5M68 60.5h-8.5v11H68m0-11v11m0 0h8.5m43 35h.5m-18.5-35H89m12.5 0V89m0 17.5V89m-25-17.5V89m0-17.5H89m-12.5 35V89m0 0h7M89 71.5v12m5.5 5.5h7m0 0c1.6 9.6 13 15.667 18.5 17.5m-31-12v12M49.075 34.928l4.85 5.144M59.5 89.5v17M34.5 89.5v17M.5 93l34-28.5M1.5 106.5l33-27.5M14 106.5l20.5-17M6 88.5L5.5 103M14 82l-.5 14.5M22 75l-.5 14.5m8.5-21L29.5 83\", stroke: \"#C8C8C7\" })\n  );\n});","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowLeftBoldIcon from \"@mdi/svg/svg/arrow-left-bold.svg\";\nimport DeleteIcon from \"@mdi/svg/svg/delete.svg\";\nimport FileMultipleIcon from \"@mdi/svg/svg/file-multiple.svg\";\nimport HelpCircleIcon from \"@mdi/svg/svg/help-circle.svg\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport TextContent from \"webviz-core/src/components/TextContent\";\nimport type { Explorer } from \"webviz-core/src/panels/NodePlayground\";\nimport TemplateIcon from \"webviz-core/src/panels/NodePlayground/assets/file-document-edit.svg\";\nimport HammerWrenchIcon from \"webviz-core/src/panels/NodePlayground/assets/hammer-wrench.svg\";\nimport nodePlaygroundDocs from \"webviz-core/src/panels/NodePlayground/index.help.md\";\nimport { type Script } from \"webviz-core/src/panels/NodePlayground/script\";\nimport { getNodeProjectConfig } from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/projectConfig\";\nimport templates from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/templates\";\nimport userUtilsReadMe from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/README.md\";\nimport type { UserNodeDiagnostics } from \"webviz-core/src/reducers/userNodes\";\nimport { type UserNodes } from \"webviz-core/src/types/panels\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst MenuWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 40px;\n  background-color: ${colors.DARK1};\n  & > * {\n    margin: 10px;\n  }\n`;\n\nconst ExplorerWrapper = styled.div`\n  display: ${({ show }: { show: boolean }) => (show ? \"initial\" : \"none\")};\n  background-color: ${colors.GRAY2};\n  max-width: 325px;\n  min-width: 275px;\n  overflow: auto;\n`;\n\nconst ListItem = styled.li`\n  padding: 5px;\n  cursor: pointer;\n  display: flex;\n  font-size: 14px;\n  justify-content: space-between;\n  word-break: break-all;\n  align-items: center;\n  background-color: ${({ selected }: { selected: boolean }) => (selected ? colors.DARK9 : \"transparent\")};\n  > span {\n    opacity: 0;\n  }\n  &:hover {\n    background-color: ${colors.DARK9};\n    span {\n      opacity: 1;\n    }\n  }\n`;\n\nconst TemplateItem = styled.li`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 5px;\n  cursor: pointer;\n  display: flex;\n  font-size: 14px;\n  word-break: break-all;\n  > span {\n    display: block;\n    margin: 3px 0;\n  }\n  &:hover {\n    background-color: ${colors.DARK9};\n  }\n`;\n\nconst SFlex = styled.div`\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n\n  pre {\n    white-space: pre-wrap;\n  }\n`;\n\ntype NodesListProps = {|\n  nodes: UserNodes,\n  selectNode: (id: string) => void,\n  deleteNode: (id: string) => void,\n  collapse: () => void,\n  selectedNodeId: ?string,\n  userNodeDiagnostics: {\n    [guid: string]: UserNodeDiagnostics,\n  },\n|};\n\nconst NodesList = ({ nodes, selectNode, deleteNode, collapse, selectedNodeId }: NodesListProps) => {\n  return (\n    <Flex col>\n      <SidebarTitle title={\"nodes\"} collapse={collapse} />\n      {Object.keys(nodes).map((nodeId) => {\n        return (\n          <ListItem key={nodeId} selected={selectedNodeId === nodeId} onClick={() => selectNode(nodeId)}>\n            {nodes[nodeId].name}\n            <Icon onClick={() => deleteNode(nodeId)} medium>\n              <DeleteIcon />\n            </Icon>\n          </ListItem>\n        );\n      })}\n    </Flex>\n  );\n};\n\ntype Props = {|\n  selectNode: (nodeId: string) => void,\n  deleteNode: (nodeId: string) => void,\n  userNodes: UserNodes,\n  selectedNodeId: ?string,\n  otherMarkdownDocsForTest?: string,\n  userNodeDiagnostics: {\n    [guid: string]: UserNodeDiagnostics,\n  },\n  explorer: Explorer,\n  updateExplorer: (explorer: Explorer) => void,\n  setScriptOverride: (script: Script, maxDepth?: number) => void,\n  script: Script | null,\n  addNewNode: (_: any, sourceCode?: string) => void,\n|};\n\nconst { utilityFiles } = getNodeProjectConfig();\n\nconst SidebarTitle = ({ title, tooltip, collapse }: { title: string, tooltip?: string, collapse: () => void }) => (\n  <Flex row style={{ alignItems: \"center\", color: colors.DARK9, padding: \"5px\" }}>\n    <h3 style={{ textTransform: \"uppercase\" }}>{title}</h3>\n    {tooltip && (\n      <Icon style={{ cursor: \"unset\", marginLeft: \"5px\" }} medium tooltip={tooltip}>\n        <HelpCircleIcon />\n      </Icon>\n    )}\n    <div style={{ display: \"flex\", justifyContent: \"flex-end\", flexGrow: 1 }}>\n      <Icon onClick={collapse} medium tooltip={\"collapse\"}>\n        <ArrowLeftBoldIcon />\n      </Icon>\n    </div>\n  </Flex>\n);\n\nconst Sidebar = ({\n  userNodes,\n  selectNode,\n  deleteNode,\n  selectedNodeId,\n  otherMarkdownDocsForTest,\n  userNodeDiagnostics,\n  explorer,\n  updateExplorer,\n  setScriptOverride,\n  script,\n  addNewNode,\n}: Props) => {\n  const nodesSelected = explorer === \"nodes\";\n  const docsSelected = explorer === \"docs\";\n  const utilsSelected = explorer === \"utils\";\n  const templatesSelected = explorer === \"templates\";\n\n  const gotoUtils = React.useCallback((filePath) => {\n    import(/* webpackChunkName: \"monaco-api\" */ \"monaco-editor/esm/vs/editor/editor.api\").then((monacoApi) => {\n      const monacoFilePath = monacoApi.Uri.parse(`file://${filePath}`);\n      const requestedModel = monacoApi.editor.getModel(monacoFilePath);\n      if (!requestedModel) {\n        return;\n      }\n      setScriptOverride(\n        {\n          filePath: requestedModel.uri.path,\n          code: requestedModel.getValue(),\n          readOnly: true,\n          selection: undefined,\n        },\n        2\n      );\n    });\n  }, [setScriptOverride]);\n\n  const explorers = React.useMemo(\n    () => ({\n      nodes: (\n        <NodesList\n          nodes={userNodes}\n          selectNode={selectNode}\n          deleteNode={deleteNode}\n          collapse={() => updateExplorer(null)}\n          selectedNodeId={selectedNodeId}\n          userNodeDiagnostics={userNodeDiagnostics}\n        />\n      ),\n      docs: (\n        <SFlex>\n          <SidebarTitle title={\"docs\"} collapse={() => updateExplorer(null)} />\n          <TextContent style={{ backgroundColor: \"transparent\" }} linkTarget=\"_blank\">\n            {otherMarkdownDocsForTest || nodePlaygroundDocs}\n          </TextContent>\n          <br />\n          <br />\n          <TextContent style={{ backgroundColor: \"transparent\" }} linkTarget=\"_blank\">\n            {userUtilsReadMe}\n          </TextContent>\n        </SFlex>\n      ),\n      utils: (\n        <Flex col style={{ position: \"relative\" }}>\n          <SidebarTitle\n            collapse={() => updateExplorer(null)}\n            title={\"utilities\"}\n            tooltip={`You can import any of these modules into your node using the following syntax: 'import { .. } from \"./pointClouds.ts\".\\n\\nWant to contribute? Scroll to the bottom of the docs for details!`}\n          />\n          {utilityFiles.map(({ fileName, filePath }) => (\n            <ListItem\n              key={filePath}\n              onClick={gotoUtils.bind(null, filePath)}\n              selected={script && filePath === script.filePath}>\n              {fileName}\n            </ListItem>\n          ))}\n        </Flex>\n      ),\n\n      templates: (\n        <Flex col>\n          <SidebarTitle\n            title={\"templates\"}\n            tooltip={\"Create nodes from these templates\"}\n            collapse={() => updateExplorer(null)}\n          />\n          {templates.map(({ name, description, template }, i) => (\n            <TemplateItem key={`${name}-${i}`} onClick={addNewNode.bind(null, undefined, template)}>\n              <span style={{ fontWeight: \"bold\" }}>{name}</span>\n              <span>{description}</span>\n            </TemplateItem>\n          ))}\n        </Flex>\n      ),\n    }),\n    [\n      addNewNode,\n      deleteNode,\n      gotoUtils,\n      otherMarkdownDocsForTest,\n      script,\n      selectNode,\n      selectedNodeId,\n      updateExplorer,\n      userNodeDiagnostics,\n      userNodes,\n    ]\n  );\n\n  return (\n    <>\n      <MenuWrapper>\n        <Icon\n          dataTest=\"node-explorer\"\n          onClick={() => updateExplorer(nodesSelected ? null : \"nodes\")}\n          large\n          tooltip={\"nodes\"}\n          style={{ color: nodesSelected ? \"inherit\" : colors.DARK9, position: \"relative\" }}>\n          <FileMultipleIcon />\n        </Icon>\n        <Icon\n          dataTest=\"utils-explorer\"\n          onClick={() => updateExplorer(utilsSelected ? null : \"utils\")}\n          large\n          tooltip={\"utilities\"}\n          style={{ color: utilsSelected ? \"inherit\" : colors.DARK9 }}>\n          <HammerWrenchIcon />\n        </Icon>\n        <Icon\n          dataTest=\"templates-explorer\"\n          onClick={() => updateExplorer(templatesSelected ? null : \"templates\")}\n          large\n          tooltip={\"templates\"}\n          style={{ color: templatesSelected ? \"inherit\" : colors.DARK9 }}>\n          <TemplateIcon />\n        </Icon>\n        <Icon\n          dataTest=\"docs-explorer\"\n          onClick={() => updateExplorer(docsSelected ? null : \"docs\")}\n          large\n          tooltip={\"docs\"}\n          style={{ color: docsSelected ? \"inherit\" : colors.DARK9 }}>\n          <HelpCircleIcon />\n        </Icon>\n      </MenuWrapper>\n      <ExplorerWrapper show={!!explorer}>{explorer && explorers[explorer]}</ExplorerWrapper>\n    </>\n  );\n};\n\nexport default Sidebar;\n","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport React from \"react\";\nexport default ((_ref) => {\n  let {\n    styles = {}\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"styles\"]);\n\n  return React.createElement(\n    \"svg\",\n    _extends({ style: {\n        width: \"24px\",\n        height: \"24px\"\n      }, viewBox: \"0 0 24 24\" }, props),\n    React.createElement(\"path\", { fill: \"currentColor\", d: \"M6 2c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v-1.91L12.09 18H6v-2h8.09l2-2H6v-2h12.09L20 10.09V8l-6-6H6m7 1.5L18.5 9H13V3.5m7.15 9.5a.55.55 0 0 0-.4.16l-1.02 1.02 2.09 2.08 1.02-1.01c.21-.22.21-.58 0-.79l-1.3-1.3a.544.544 0 0 0-.39-.16m-2.01 1.77L12 20.92V23h2.08l6.15-6.15-2.09-2.08z\" })\n  );\n});","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport React from \"react\";\nexport default ((_ref) => {\n  let {\n    styles = {}\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"styles\"]);\n\n  return React.createElement(\n    \"svg\",\n    _extends({ xmlns: \"http://www.w3.org/2000/svg\", width: \"24\", height: \"24\", viewBox: \"0 0 24 24\" }, props),\n    React.createElement(\"path\", { d: \"M13.78 15.3l6 6 2.11-2.16-6-6-2.11 2.16m3.72-5.2c-.39 0-.81-.05-1.14-.19L4.97 21.25l-2.11-2.11 7.41-7.4L8.5 9.96l-.72.7-1.45-1.41v2.86l-.7.7-3.52-3.56.7-.7h2.81l-1.4-1.41 3.56-3.56a2.976 2.976 0 0 1 4.22 0L9.89 5.74l1.41 1.4-.71.71 1.79 1.78 1.82-1.88c-.14-.33-.2-.75-.2-1.12a3.49 3.49 0 0 1 3.5-3.52c.59 0 1.11.14 1.58.42L16.41 6.2l1.5 1.5 2.67-2.67c.28.47.42.97.42 1.6 0 1.92-1.55 3.47-3.5 3.47z\" })\n  );\n});","module.exports = \"# Node Playground\\n\\nNode Playground is a code editor sandbox in which you can write pseudo-ROS topics that get published within Webviz. Node Playground allows you to manipulate, reduce, and filter existing ROS messages and output them in a way that is useful to you.\\n\\n## Getting Started\\n\\nNode Playground uses TypeScript to typecheck messages coming in and out of your nodes. If you are already familiar with TypeScript, skip the \\\"Learning TypeScript\\\" section below.\\n\\n### Learning TypeScript\\n\\nTypeScript is a superset of JavaScript, so Google syntactic questions (e.g. how to manipulate arrays, or access object properties) using JavaScript terms, and semantic questions (e.g. how to make an object property optional) using TypeScript terms.\\n\\nHere are some resources to get yourself ramped up:\\n\\n- [Basic Types](https://www.typescriptlang.org/docs/handbook/basic-types.html)\\n- [Gitbook](https://basarat.gitbooks.io/typescript/content/docs/why-typescript.html)\\n\\nPost in #typescript for TypeScript questions.\\n\\n### Writing Your First Webviz Node\\n\\nEvery Webviz node must declare 3 exports that determine how it should execute:\\n\\n- An inputs array of topic names.\\n- An output topic with an enforced prefix: `/webviz_node/`.\\n- A publisher function that takes messages from input topics and publishes messages under your output topic.\\n\\nHere is a basic node that echoes its input:\\n\\n```typescript\\nimport { Input, Messages } from \\\"ros\\\";\\n\\nexport const inputs = [ \\\"/rosout\\\" ];\\nexport const output = \\\"/webviz_node/echo\\\";\\n\\nconst publisher = (message: Input<\\\"/rosout\\\">): Messages.rosgraph_msgs__Log => {\\n  return message.message;\\n};\\n\\nexport default publisher;\\n```\\n\\nIf you drag in a bag, you should now be able to subscribe to the /webviz_node/echo topic in the Raw Messages panel.\\n\\nBut lets say you want to render some markers in the 3D panel. When you create a new node, youll be presented with some boilerplate:\\n\\n```typescript\\nimport { Input, Messages } from \\\"ros\\\";\\n\\ntype Output = {};\\ntype GlobalVariables = { id: number };\\n\\nexport const inputs = [];\\nexport const output = \\\"/webviz_node/\\\";\\n\\n// Populate 'Input' with a parameter to properly type your inputs, e.g. 'Input<\\\"/your_input_topic\\\">'\\nconst publisher = (message: Input<>, globalVars: GlobalVariables): Output => {\\n  return {};\\n};\\n\\nexport default publisher;\\n```\\n\\nYoull notice a few things:\\n\\n- The types `Input` and `Messages` are being imported from the `ros` module.\\n\\n- The type `Output` has no properties.\\n\\n- The type `GlobalVariables` is declared for convenience.\\n\\n`Input` is a generic type, meaning that it takes a parameter in order to be used. It is left empty on purpose as you'll need to populate it with the name of your input topic, e.g. `Input<\\\"/rosout\\\">`.\\n\\nAs for the `Output` type, you can either manually type out your output with the properties you care about or use one of the dynamically generated types from the `Messages` type imported above. For instance, if you want to publish an array of markers, you can return the type `Messages.visualization_msgs__MarkerArray`.\\n\\nThe `GlobalVariables` type is used to specify the types of any global variables you'd like to access in your node. It is not required.\\n\\nStrictly typing your nodes will help you debug issues at compile time rather than at runtime. It's not always obvious in Webviz how message properties are affecting the visualized output, and so the more you strictly type your nodes, the less likely you will make mistakes.\\n\\nWith that said, you can disable Typescript checks while getting a rough draft of your node working by adding `// @ts-ignore` on the line above the one you want to ignore.\\n\\n#### Using Multiple Input Topics\\n\\nIn some cases, you will want to define multiple input topics:\\n\\n```typescript\\nimport { Input, Messages } from \\\"ros\\\";\\n\\nexport const inputs = [ \\\"/rosout\\\", \\\"/tf\\\" ];\\nexport const output = \\\"/webviz_node/echo\\\";\\n\\nconst publisher = (message: Input<\\\"/rosout\\\"> | Input<\\\"/tf\\\">): { data: number[] }  => {\\n\\n  if (message.topic === \\\"/rosout\\\") {\\n    // type is now refined to `/rosout` -- you can use `message.message.pose` safely\\n  } else {\\n    // type is now refined to `/tf` -- you can use `message.message.transforms` safely\\n  }\\n\\n  return { data: [] };\\n};\\n\\nexport default publisher;\\n```\\n\\nThis snippet uses [union types](https://www.typescriptlang.org/docs/handbook/advanced-types.html#union-types) to assert that the message in the publisher function can take either a `/rosout` or `/tf` topic. Use an `if`/`else` clause to differentiate between incoming topic datatypes when manipulating messages.\\n\\nTo combine messages from multiple topics, create a variable in your node's global scope to reference every time your publisher function is invoked. Check timestamps to make sure you are not publishing out-of-sync data.\\n\\n```typescript\\nimport { Input, Messages, Time } from \\\"ros\\\";\\n\\nexport const inputs = [ \\\"/rosout\\\", \\\"/tf\\\" ];\\nexport const output = \\\"/webviz_node/echo\\\";\\n\\nlet lastReceiveTime: Time = { sec: 0, nsec: 0 };\\nconst myScope: {\\n  tf: Messages.tf2_msgs__TFMessage | null,\\n  rosout: Messages.rosgraph_msgs__Log | null\\n} = { 'tf': null, 'rosout': null };\\n\\nconst publisher = (message: Input<\\\"/rosout\\\"> | Input<\\\"/tf\\\">): { data: number[] } | undefined => {\\n  const { receiveTime  } = message;\\n  let inSync = true;\\n  if (receiveTime.sec !== lastReceiveTime.sec || receiveTime.nsec !== lastReceiveTime.nsec) {\\n    lastReceiveTime = receiveTime;\\n    inSync = false;\\n  }\\n\\n  if (message.topic === \\\"/rosout\\\") {\\n    myScope.rosout = message.message;\\n  } else {\\n    myScope.tf = message.message\\n  }\\n\\n  if (!inSync) {\\n    return { data: [] };\\n  }\\n}\\n\\nexport default publisher;\\n```\\n\\n#### Using Global Variables\\n\\nThe publisher function will receive all of the Webviz global variables as an object every time it is called. If the global variables change, the publisher function will automatically re-run with the new values:\\n\\n```typescript\\nimport { Input, Messages } from \\\"ros\\\";\\n\\ntype Output = {};\\ntype GlobalVariables = { someGlobalId: number };\\n\\nexport const inputs = [];\\nexport const output = \\\"/webviz_node/\\\";\\n\\nconst publisher = (message: Input<\\\"/foo_marker\\\">, globalVars: GlobalVariables): Output => {\\n  if (message.message.id === globalVars.someGlobalId) {\\n    // The message matches the global variable $someGlobalId\\n  }\\n  return { data: [] };\\n};\\n```\\n\\n## Debugging\\n\\nFor easier debugging, invoke `log(someValue)` anywhere in your Webviz node code to print values to the `Logs` section at the bottom of the panel. The only value you cannot `log()` is one that is, or contains, a function definition.\\n\\n```typescript\\nconst add = (a: number, b: number): number => a + b;\\n\\n// NO ERRORS\\nlog(50, \\\"ABC\\\", null, undefined, 5 + 5, { \\\"abc\\\": 2, \\\"def\\\": false }, add(1, 2));\\n\\n// ERRORS\\nlog(() => {});\\nlog(add);\\nlog({ \\\"add\\\": add, \\\"subtract\\\": (a: number, b: number): number => a - b })\\n```\\n\\nInvoking `log()` outside your publisher function will invoke it once, when your node is registered. Invoking `log()` inside your publisher function will log that value every time your publisher function is called.\\n\\nNote that if your topic publishes at a high rate (`tick_information` for instance) using `log` will significantly slow down Node Playground.\\n\\n## FAQ\\n\\n> What if I don't want to produce a message every time `publish` is called?\\n\\nAll you need to do is do an early (or late) return in your function body that is hit when you don't want to publish. For instance, let's say you only wanted to publish messages when a constant in the input is _not_ `3`:\\n\\n```typescript\\nimport { Input } from \\\"ros\\\";\\n\\nexport const inputs = [\\\"/state\\\"];\\nexport const output = \\\"/webviz_node/manual_metrics\\\";\\n\\nconst publisher = (msg: Input<\\\"/state\\\">): { metrics: number } | undefined => {\\n  if (msg.message.constant === 3) {\\n    return;\\n  }\\n  return { /* YOUR DATA HERE */ };\\n};\\n\\nexport default publisher;\\n```\\n\\nNote the union return type in the `publisher` definition. We've indicated to Typescript that this function can return `undefined`, and we do so within the conditional block (In Typescript, if you `return` without a value, it will implicitly return `undefined`). When this code path is hit, we don't publish any message.\\n\\n> Does Node Playground work with multiple sources?\\n\\nYes, Node Playground will automatically run your code for topics starting with `/webviz_source_2`, as long as the node doesn't read directly from any `source_2` topics. For example, a node with the following inputs/outputs would run for the input topic, `/webviz_source_2/topic_a` and output to the topic `/webviz_source_2/webviz_node/example`:\\n\\n```typescript\\nexport const inputs = [\\\"/topic_a\\\"];\\nexport const output = \\\"/webviz_node/example\\\";\\n```\\n\\n> Can I return arbitrary JSON data in a message?\\n\\nYes, Node Playground supports the `json` type. You can import it from the \\\"ros\\\" module:\\n\\n```typescript\\nimport { Input, json } from \\\"ros\\\";\\n\\nexport const inputs = [\\\"/state\\\"];\\nexport const output = \\\"/webviz_node/json_data\\\";\\n\\nconst publisher = (msg: Input<\\\"/state\\\">): { data: json } => ({\\n  data: {\\n    foo: 123,\\n    bar: 'string',\\n    nested: { array: [1, 2, 3], working: true }\\n  }\\n});\\nexport default publisher;\\n```\\n\"","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// All of these definitions can be found in the Typescript project under `libs`.\nexport const lib_filename = \"lib.d.ts\";\n\n// For users debugging in Node Playground.\nconst lib_logger = `\n  declare type BaseTypes<T> = number | string | boolean | void | null | T;\n  declare type LogArgs = { [key: string]: BaseTypes<LogArgs> | BaseTypes<LogArgs>[] };\n  declare var log: (...args: Array<BaseTypes<LogArgs> | BaseTypes<LogArgs>[]>) => void;\n`;\n\nconst lib_es2015_symbol_dts =\n  '/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n\\ninterface SymbolConstructor {\\n    /**\\n     * A reference to the prototype.\\n     */\\n    readonly prototype: Symbol;\\n\\n    /**\\n     * Returns a new unique Symbol value.\\n     * @param  description Description of the new Symbol object.\\n     */\\n    (description?: string | number): symbol;\\n\\n    /**\\n     * Returns a Symbol object from the global symbol registry matching the given key if found.\\n     * Otherwise, returns a new symbol with this key.\\n     * @param key key to search for.\\n     */\\n    for(key: string): symbol;\\n\\n    /**\\n     * Returns a key from the global symbol registry matching the given Symbol if found.\\n     * Otherwise, returns a undefined.\\n     * @param sym Symbol to find the key for.\\n     */\\n    keyFor(sym: symbol): string | undefined;\\n}\\n\\ndeclare var Symbol: SymbolConstructor;';\n\nconst lib_es2015_symbol_wellknown_dts = `/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n${lib_es2015_symbol_dts}\\ninterface SymbolConstructor {\\n    /**\\n     * A method that determines if a constructor object recognizes an object as one of the\\n     * constructors instances. Called by the semantics of the instanceof operator.\\n     */\\n    readonly hasInstance: symbol;\\n\\n    /**\\n     * A Boolean value that if true indicates that an object should flatten to its array elements\\n     * by Array.prototype.concat.\\n     */\\n    readonly isConcatSpreadable: symbol;\\n\\n    /**\\n     * A regular expression method that matches the regular expression against a string. Called\\n     * by the String.prototype.match method.\\n     */\\n    readonly match: symbol;\\n\\n    /**\\n     * A regular expression method that replaces matched substrings of a string. Called by the\\n     * String.prototype.replace method.\\n     */\\n    readonly replace: symbol;\\n\\n    /**\\n     * A regular expression method that returns the index within a string that matches the\\n     * regular expression. Called by the String.prototype.search method.\\n     */\\n    readonly search: symbol;\\n\\n    /**\\n     * A function valued property that is the constructor function that is used to create\\n     * derived objects.\\n     */\\n    readonly species: symbol;\\n\\n    /**\\n     * A regular expression method that splits a string at the indices that match the regular\\n     * expression. Called by the String.prototype.split method.\\n     */\\n    readonly split: symbol;\\n\\n    /**\\n     * A method that converts an object to a corresponding primitive value.\\n     * Called by the ToPrimitive abstract operation.\\n     */\\n    readonly toPrimitive: symbol;\\n\\n    /**\\n     * A String value that is used in the creation of the default string description of an object.\\n     * Called by the built-in method Object.prototype.toString.\\n     */\\n    readonly toStringTag: symbol;\\n\\n    /**\\n     * An Object whose own property names are property names that are excluded from the 'with'\\n     * environment bindings of the associated objects.\\n     */\\n    readonly unscopables: symbol;\\n}\\n\\ninterface Symbol {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface Array<T> {\\n    /**\\n     * Returns an object whose properties have the value 'true'\\n     * when they will be absent when used in a 'with' statement.\\n     */\\n    [Symbol.unscopables](): {\\n        copyWithin: boolean;\\n        entries: boolean;\\n        fill: boolean;\\n        find: boolean;\\n        findIndex: boolean;\\n        keys: boolean;\\n        values: boolean;\\n    };\\n}\\n\\ninterface Date {\\n    /**\\n     * Converts a Date object to a string.\\n     */\\n    [Symbol.toPrimitive](hint: \"default\"): string;\\n    /**\\n     * Converts a Date object to a string.\\n     */\\n    [Symbol.toPrimitive](hint: \"string\"): string;\\n    /**\\n     * Converts a Date object to a number.\\n     */\\n    [Symbol.toPrimitive](hint: \"number\"): number;\\n    /**\\n     * Converts a Date object to a string or number.\\n     *\\n     * @param hint The strings \"number\", \"string\", or \"default\" to specify what primitive to return.\\n     *\\n     * @throws {TypeError} If 'hint' was given something other than \"number\", \"string\", or \"default\".\\n     * @returns A number if 'hint' was \"number\", a string if 'hint' was \"string\" or \"default\".\\n     */\\n    [Symbol.toPrimitive](hint: string): string | number;\\n}\\n\\ninterface Map<K, V> {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface WeakMap<K extends object, V> {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface Set<T> {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface WeakSet<T extends object> {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface JSON {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface Function {\\n    /**\\n     * Determines whether the given value inherits from this function if this function was used\\n     * as a constructor function.\\n     *\\n     * A constructor function can control which objects are recognized as its instances by\\n     * 'instanceof' by overriding this method.\\n     */\\n    [Symbol.hasInstance](value: any): boolean;\\n}\\n\\ninterface GeneratorFunction {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface Math {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface Promise<T> {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface PromiseConstructor {\\n    readonly [Symbol.species]: PromiseConstructor;\\n}\\n\\ninterface RegExp {\\n    /**\\n     * Matches a string with this regular expression, and returns an array containing the results of\\n     * that search.\\n     * @param string A string to search within.\\n     */\\n    [Symbol.match](string: string): RegExpMatchArray | null;\\n\\n    /**\\n     * Replaces text in a string, using this regular expression.\\n     * @param string A String object or string literal whose contents matching against\\n     *               this regular expression will be replaced\\n     * @param replaceValue A String object or string literal containing the text to replace for every\\n     *                     successful match of this regular expression.\\n     */\\n    [Symbol.replace](string: string, replaceValue: string): string;\\n\\n    /**\\n     * Replaces text in a string, using this regular expression.\\n     * @param string A String object or string literal whose contents matching against\\n     *               this regular expression will be replaced\\n     * @param replacer A function that returns the replacement text.\\n     */\\n    [Symbol.replace](string: string, replacer: (substring: string, ...args: any[]) => string): string;\\n\\n    /**\\n     * Finds the position beginning first substring match in a regular expression search\\n     * using this regular expression.\\n     *\\n     * @param string The string to search within.\\n     */\\n    [Symbol.search](string: string): number;\\n\\n    /**\\n     * Returns an array of substrings that were delimited by strings in the original input that\\n     * match against this regular expression.\\n     *\\n     * If the regular expression contains capturing parentheses, then each time this\\n     * regular expression matches, the results (including any undefined results) of the\\n     * capturing parentheses are spliced.\\n     *\\n     * @param string string value to split\\n     * @param limit if not undefined, the output array is truncated so that it contains no more\\n     * than 'limit' elements.\\n     */\\n    [Symbol.split](string: string, limit?: number): string[];\\n}\\n\\ninterface RegExpConstructor {\\n    readonly [Symbol.species]: RegExpConstructor;\\n}\\n\\ninterface String {\\n    /**\\n     * Matches a string an object that supports being matched against, and returns an array containing the results of that search.\\n     * @param matcher An object that supports being matched against.\\n     */\\n    match(matcher: { [Symbol.match](string: string): RegExpMatchArray | null; }): RegExpMatchArray | null;\\n\\n    /**\\n     * Replaces text in a string, using an object that supports replacement within a string.\\n     * @param searchValue A object can search for and replace matches within a string.\\n     * @param replaceValue A string containing the text to replace for every successful match of searchValue in this string.\\n     */\\n    replace(searchValue: { [Symbol.replace](string: string, replaceValue: string): string; }, replaceValue: string): string;\\n\\n    /**\\n     * Replaces text in a string, using an object that supports replacement within a string.\\n     * @param searchValue A object can search for and replace matches within a string.\\n     * @param replacer A function that returns the replacement text.\\n     */\\n    replace(searchValue: { [Symbol.replace](string: string, replacer: (substring: string, ...args: any[]) => string): string; }, replacer: (substring: string, ...args: any[]) => string): string;\\n\\n    /**\\n     * Finds the first substring match in a regular expression search.\\n     * @param searcher An object which supports searching within a string.\\n     */\\n    search(searcher: { [Symbol.search](string: string): number; }): number;\\n\\n    /**\\n     * Split a string into substrings using the specified separator and return them as an array.\\n     * @param splitter An object that can split a string.\\n     * @param limit A value used to limit the number of elements returned in the array.\\n     */\\n    split(splitter: { [Symbol.split](string: string, limit?: number): string[]; }, limit?: number): string[];\\n}\\n\\ninterface ArrayBuffer {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface DataView {\\n    readonly [Symbol.toStringTag]: string;\\n}\\n\\ninterface Int8Array {\\n    readonly [Symbol.toStringTag]: \"Int8Array\";\\n}\\n\\ninterface Uint8Array {\\n    readonly [Symbol.toStringTag]: \"UInt8Array\";\\n}\\n\\ninterface Uint8ClampedArray {\\n    readonly [Symbol.toStringTag]: \"Uint8ClampedArray\";\\n}\\n\\ninterface Int16Array {\\n    readonly [Symbol.toStringTag]: \"Int16Array\";\\n}\\n\\ninterface Uint16Array {\\n    readonly [Symbol.toStringTag]: \"Uint16Array\";\\n}\\n\\ninterface Int32Array {\\n    readonly [Symbol.toStringTag]: \"Int32Array\";\\n}\\n\\ninterface Uint32Array {\\n    readonly [Symbol.toStringTag]: \"Uint32Array\";\\n}\\n\\ninterface Float32Array {\\n    readonly [Symbol.toStringTag]: \"Float32Array\";\\n}\\n\\ninterface Float64Array {\\n    readonly [Symbol.toStringTag]: \"Float64Array\";\\n}\\n\\ninterface ArrayConstructor {\\n    readonly [Symbol.species]: ArrayConstructor;\\n}\\ninterface MapConstructor {\\n    readonly [Symbol.species]: MapConstructor;\\n}\\ninterface SetConstructor {\\n    readonly [Symbol.species]: SetConstructor;\\n}\\ninterface ArrayBufferConstructor {\\n    readonly [Symbol.species]: ArrayBufferConstructor;\\n}`;\n\nconst lib_es2015_reflect_dts =\n  '/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n\\ndeclare namespace Reflect {\\n    function apply(target: Function, thisArgument: any, argumentsList: ArrayLike<any>): any;\\n    function construct(target: Function, argumentsList: ArrayLike<any>, newTarget?: any): any;\\n    function defineProperty(target: object, propertyKey: PropertyKey, attributes: PropertyDescriptor): boolean;\\n    function deleteProperty(target: object, propertyKey: PropertyKey): boolean;\\n    function get(target: object, propertyKey: PropertyKey, receiver?: any): any;\\n    function getOwnPropertyDescriptor(target: object, propertyKey: PropertyKey): PropertyDescriptor | undefined;\\n    function getPrototypeOf(target: object): object;\\n    function has(target: object, propertyKey: PropertyKey): boolean;\\n    function isExtensible(target: object): boolean;\\n    function ownKeys(target: object): PropertyKey[];\\n    function preventExtensions(target: object): boolean;\\n    function set(target: object, propertyKey: PropertyKey, value: any, receiver?: any): boolean;\\n    function setPrototypeOf(target: object, proto: any): boolean;\\n}\\n';\n\nconst lib_es2015_proxy_dts =\n  '/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n\\ninterface ProxyHandler<T extends object> {\\n    getPrototypeOf? (target: T): object | null;\\n    setPrototypeOf? (target: T, v: any): boolean;\\n    isExtensible? (target: T): boolean;\\n    preventExtensions? (target: T): boolean;\\n    getOwnPropertyDescriptor? (target: T, p: PropertyKey): PropertyDescriptor | undefined;\\n    has? (target: T, p: PropertyKey): boolean;\\n    get? (target: T, p: PropertyKey, receiver: any): any;\\n    set? (target: T, p: PropertyKey, value: any, receiver: any): boolean;\\n    deleteProperty? (target: T, p: PropertyKey): boolean;\\n    defineProperty? (target: T, p: PropertyKey, attributes: PropertyDescriptor): boolean;\\n    enumerate? (target: T): PropertyKey[];\\n    ownKeys? (target: T): PropertyKey[];\\n    apply? (target: T, thisArg: any, argArray?: any): any;\\n    construct? (target: T, argArray: any, newTarget?: any): object;\\n}\\n\\ninterface ProxyConstructor {\\n    revocable<T extends object>(target: T, handler: ProxyHandler<T>): { proxy: T; revoke: () => void; };\\n    new <T extends object>(target: T, handler: ProxyHandler<T>): T;\\n}\\ndeclare var Proxy: ProxyConstructor;\\n';\n\nconst lib_es2015_iterable_dts = `/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n${lib_es2015_symbol_dts}\\ninterface SymbolConstructor {\\n    /**\\n     * A method that returns the default iterator for an object. Called by the semantics of the\\n     * for-of statement.\\n     */\\n    readonly iterator: symbol;\\n}\\n\\ninterface IteratorResult<T> {\\n    done: boolean;\\n    value: T;\\n}\\n\\ninterface Iterator<T> {\\n    next(value?: any): IteratorResult<T>;\\n    return?(value?: any): IteratorResult<T>;\\n    throw?(e?: any): IteratorResult<T>;\\n}\\n\\ninterface Iterable<T> {\\n    [Symbol.iterator](): Iterator<T>;\\n}\\n\\ninterface IterableIterator<T> extends Iterator<T> {\\n    [Symbol.iterator](): IterableIterator<T>;\\n}\\n\\ninterface Array<T> {\\n    /** Iterator */\\n    [Symbol.iterator](): IterableIterator<T>;\\n\\n    /**\\n     * Returns an iterable of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, T]>;\\n\\n    /**\\n     * Returns an iterable of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n\\n    /**\\n     * Returns an iterable of values in the array\\n     */\\n    values(): IterableIterator<T>;\\n}\\n\\ninterface ArrayConstructor {\\n    /**\\n     * Creates an array from an iterable object.\\n     * @param iterable An iterable object to convert to an array.\\n     */\\n    from<T>(iterable: Iterable<T> | ArrayLike<T>): T[];\\n\\n    /**\\n     * Creates an array from an iterable object.\\n     * @param iterable An iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from<T, U>(iterable: Iterable<T> | ArrayLike<T>, mapfn: (v: T, k: number) => U, thisArg?: any): U[];\\n}\\n\\ninterface ReadonlyArray<T> {\\n    /** Iterator of values in the array. */\\n    [Symbol.iterator](): IterableIterator<T>;\\n\\n    /**\\n     * Returns an iterable of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, T]>;\\n\\n    /**\\n     * Returns an iterable of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n\\n    /**\\n     * Returns an iterable of values in the array\\n     */\\n    values(): IterableIterator<T>;\\n}\\n\\ninterface IArguments {\\n    /** Iterator */\\n    [Symbol.iterator](): IterableIterator<any>;\\n}\\n\\ninterface Map<K, V> {\\n    /** Returns an iterable of entries in the map. */\\n    [Symbol.iterator](): IterableIterator<[K, V]>;\\n\\n    /**\\n     * Returns an iterable of key, value pairs for every entry in the map.\\n     */\\n    entries(): IterableIterator<[K, V]>;\\n\\n    /**\\n     * Returns an iterable of keys in the map\\n     */\\n    keys(): IterableIterator<K>;\\n\\n    /**\\n     * Returns an iterable of values in the map\\n     */\\n    values(): IterableIterator<V>;\\n}\\n\\ninterface ReadonlyMap<K, V> {\\n    /** Returns an iterable of entries in the map. */\\n    [Symbol.iterator](): IterableIterator<[K, V]>;\\n\\n    /**\\n     * Returns an iterable of key, value pairs for every entry in the map.\\n     */\\n    entries(): IterableIterator<[K, V]>;\\n\\n    /**\\n     * Returns an iterable of keys in the map\\n     */\\n    keys(): IterableIterator<K>;\\n\\n    /**\\n     * Returns an iterable of values in the map\\n     */\\n    values(): IterableIterator<V>;\\n}\\n\\ninterface MapConstructor {\\n    new <K, V>(iterable: Iterable<readonly [K, V]>): Map<K, V>;\\n}\\n\\ninterface WeakMap<K extends object, V> { }\\n\\ninterface WeakMapConstructor {\\n    new <K extends object, V>(iterable: Iterable<[K, V]>): WeakMap<K, V>;\\n}\\n\\ninterface Set<T> {\\n    /** Iterates over values in the set. */\\n    [Symbol.iterator](): IterableIterator<T>;\\n    /**\\n     * Returns an iterable of [v,v] pairs for every value \\`v\\` in the set.\\n     */\\n    entries(): IterableIterator<[T, T]>;\\n    /**\\n     * Despite its name, returns an iterable of the values in the set,\\n     */\\n    keys(): IterableIterator<T>;\\n\\n    /**\\n     * Returns an iterable of values in the set.\\n     */\\n    values(): IterableIterator<T>;\\n}\\n\\ninterface ReadonlySet<T> {\\n    /** Iterates over values in the set. */\\n    [Symbol.iterator](): IterableIterator<T>;\\n\\n    /**\\n     * Returns an iterable of [v,v] pairs for every value \\`v\\` in the set.\\n     */\\n    entries(): IterableIterator<[T, T]>;\\n\\n    /**\\n     * Despite its name, returns an iterable of the values in the set,\\n     */\\n    keys(): IterableIterator<T>;\\n\\n    /**\\n     * Returns an iterable of values in the set.\\n     */\\n    values(): IterableIterator<T>;\\n}\\n\\ninterface SetConstructor {\\n    new <T>(iterable?: Iterable<T> | null): Set<T>;\\n}\\n\\ninterface WeakSet<T extends object> { }\\n\\ninterface WeakSetConstructor {\\n    new <T extends object = object>(iterable: Iterable<T>): WeakSet<T>;\\n}\\n\\ninterface Promise<T> { }\\n\\ninterface PromiseConstructor {\\n    /**\\n     * Creates a Promise that is resolved with an array of results when all of the provided Promises\\n     * resolve, or rejected when any Promise is rejected.\\n     * @param values An array of Promises.\\n     * @returns A new Promise.\\n     */\\n    all<TAll>(values: Iterable<TAll | PromiseLike<TAll>>): Promise<TAll[]>;\\n\\n    /**\\n     * Creates a Promise that is resolved or rejected when any of the provided Promises are resolved\\n     * or rejected.\\n     * @param values An array of Promises.\\n     * @returns A new Promise.\\n     */\\n    race<T>(values: Iterable<T | PromiseLike<T>>): Promise<T>;\\n}\\n\\ndeclare namespace Reflect {\\n    function enumerate(target: object): IterableIterator<any>;\\n}\\n\\ninterface String {\\n    /** Iterator */\\n    [Symbol.iterator](): IterableIterator<string>;\\n}\\n\\ninterface Int8Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Int8ArrayConstructor {\\n    new (elements: Iterable<number>): Int8Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Int8Array;\\n}\\n\\ninterface Uint8Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Uint8ArrayConstructor {\\n    new (elements: Iterable<number>): Uint8Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Uint8Array;\\n}\\n\\ninterface Uint8ClampedArray {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Uint8ClampedArrayConstructor {\\n    new (elements: Iterable<number>): Uint8ClampedArray;\\n\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Uint8ClampedArray;\\n}\\n\\ninterface Int16Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Int16ArrayConstructor {\\n    new (elements: Iterable<number>): Int16Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Int16Array;\\n}\\n\\ninterface Uint16Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Uint16ArrayConstructor {\\n    new (elements: Iterable<number>): Uint16Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Uint16Array;\\n}\\n\\ninterface Int32Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Int32ArrayConstructor {\\n    new (elements: Iterable<number>): Int32Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Int32Array;\\n}\\n\\ninterface Uint32Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Uint32ArrayConstructor {\\n    new (elements: Iterable<number>): Uint32Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Uint32Array;\\n}\\n\\ninterface Float32Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Float32ArrayConstructor {\\n    new (elements: Iterable<number>): Float32Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Float32Array;\\n}\\n\\ninterface Float64Array {\\n    [Symbol.iterator](): IterableIterator<number>;\\n    /**\\n     * Returns an array of key, value pairs for every entry in the array\\n     */\\n    entries(): IterableIterator<[number, number]>;\\n    /**\\n     * Returns an list of keys in the array\\n     */\\n    keys(): IterableIterator<number>;\\n    /**\\n     * Returns an list of values in the array\\n     */\\n    values(): IterableIterator<number>;\\n}\\n\\ninterface Float64ArrayConstructor {\\n    new (elements: Iterable<number>): Float64Array;\\n\\n    /**\\n     * Creates an array from an array-like or iterable object.\\n     * @param arrayLike An array-like or iterable object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of 'this' used to invoke the mapfn.\\n     */\\n    from(arrayLike: Iterable<number>, mapfn?: (v: number, k: number) => number, thisArg?: any): Float64Array;\\n}\\n`;\n\nconst lib_es2015_collection_dts =\n  '/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n\\ninterface Map<K, V> {\\n    clear(): void;\\n    delete(key: K): boolean;\\n    forEach(callbackfn: (value: V, key: K, map: Map<K, V>) => void, thisArg?: any): void;\\n    get(key: K): V | undefined;\\n    has(key: K): boolean;\\n    set(key: K, value: V): this;\\n    readonly size: number;\\n}\\n\\ninterface MapConstructor {\\n    new(): Map<any, any>;\\n    new<K, V>(entries?: ReadonlyArray<readonly [K, V]> | null): Map<K, V>;\\n    readonly prototype: Map<any, any>;\\n}\\ndeclare var Map: MapConstructor;\\n\\ninterface ReadonlyMap<K, V> {\\n    forEach(callbackfn: (value: V, key: K, map: ReadonlyMap<K, V>) => void, thisArg?: any): void;\\n    get(key: K): V | undefined;\\n    has(key: K): boolean;\\n    readonly size: number;\\n}\\n\\ninterface WeakMap<K extends object, V> {\\n    delete(key: K): boolean;\\n    get(key: K): V | undefined;\\n    has(key: K): boolean;\\n    set(key: K, value: V): this;\\n}\\n\\ninterface WeakMapConstructor {\\n    new <K extends object = object, V = any>(entries?: ReadonlyArray<[K, V]> | null): WeakMap<K, V>;\\n    readonly prototype: WeakMap<object, any>;\\n}\\ndeclare var WeakMap: WeakMapConstructor;\\n\\ninterface Set<T> {\\n    add(value: T): this;\\n    clear(): void;\\n    delete(value: T): boolean;\\n    forEach(callbackfn: (value: T, value2: T, set: Set<T>) => void, thisArg?: any): void;\\n    has(value: T): boolean;\\n    readonly size: number;\\n}\\n\\ninterface SetConstructor {\\n    new <T = any>(values?: ReadonlyArray<T> | null): Set<T>;\\n    readonly prototype: Set<any>;\\n}\\ndeclare var Set: SetConstructor;\\n\\ninterface ReadonlySet<T> {\\n    forEach(callbackfn: (value: T, value2: T, set: ReadonlySet<T>) => void, thisArg?: any): void;\\n    has(value: T): boolean;\\n    readonly size: number;\\n}\\n\\ninterface WeakSet<T extends object> {\\n    add(value: T): this;\\n    delete(value: T): boolean;\\n    has(value: T): boolean;\\n}\\n\\ninterface WeakSetConstructor {\\n    new <T extends object = object>(values?: ReadonlyArray<T> | null): WeakSet<T>;\\n    readonly prototype: WeakSet<object>;\\n}\\ndeclare var WeakSet: WeakSetConstructor;\\n';\n\nconst lib_es2015_core_dts =\n  '/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n\\ninterface Array<T> {\\n    /**\\n     * Returns the value of the first element in the array where predicate is true, and undefined\\n     * otherwise.\\n     * @param predicate find calls predicate once for each element of the array, in ascending\\n     * order, until it finds one where predicate returns true. If such an element is found, find\\n     * immediately returns that element value. Otherwise, find returns undefined.\\n     * @param thisArg If provided, it will be used as the this value for each invocation of\\n     * predicate. If it is not provided, undefined is used instead.\\n     */\\n    find<S extends T>(predicate: (this: void, value: T, index: number, obj: T[]) => value is S, thisArg?: any): S | undefined;\\n    find(predicate: (value: T, index: number, obj: T[]) => unknown, thisArg?: any): T | undefined;\\n\\n    /**\\n     * Returns the index of the first element in the array where predicate is true, and -1\\n     * otherwise.\\n     * @param predicate find calls predicate once for each element of the array, in ascending\\n     * order, until it finds one where predicate returns true. If such an element is found,\\n     * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n     * @param thisArg If provided, it will be used as the this value for each invocation of\\n     * predicate. If it is not provided, undefined is used instead.\\n     */\\n    findIndex(predicate: (value: T, index: number, obj: T[]) => unknown, thisArg?: any): number;\\n\\n    /**\\n     * Returns the this object after filling the section identified by start and end with value\\n     * @param value value to fill array section with\\n     * @param start index to start filling the array at. If start is negative, it is treated as\\n     * length+start where length is the length of the array.\\n     * @param end index to stop filling the array at. If end is negative, it is treated as\\n     * length+end.\\n     */\\n    fill(value: T, start?: number, end?: number): this;\\n\\n    /**\\n     * Returns the this object after copying a section of the array identified by start and end\\n     * to the same array starting at position target\\n     * @param target If target is negative, it is treated as length+target where length is the\\n     * length of the array.\\n     * @param start If start is negative, it is treated as length+start. If end is negative, it\\n     * is treated as length+end.\\n     * @param end If not specified, length of the this object is used as its default value.\\n     */\\n    copyWithin(target: number, start: number, end?: number): this;\\n}\\n\\ninterface ArrayConstructor {\\n    /**\\n     * Creates an array from an array-like object.\\n     * @param arrayLike An array-like object to convert to an array.\\n     */\\n    from<T>(arrayLike: ArrayLike<T>): T[];\\n\\n    /**\\n     * Creates an array from an iterable object.\\n     * @param arrayLike An array-like object to convert to an array.\\n     * @param mapfn A mapping function to call on every element of the array.\\n     * @param thisArg Value of \\'this\\' used to invoke the mapfn.\\n     */\\n    from<T, U>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => U, thisArg?: any): U[];\\n\\n    /**\\n     * Returns a new array from a set of elements.\\n     * @param items A set of elements to include in the new array object.\\n     */\\n    of<T>(...items: T[]): T[];\\n}\\n\\ninterface DateConstructor {\\n    new (value: number | string | Date): Date;\\n}\\n\\ninterface Function {\\n    /**\\n     * Returns the name of the function. Function names are read-only and can not be changed.\\n     */\\n    readonly name: string;\\n}\\n\\ninterface Math {\\n    /**\\n     * Returns the number of leading zero bits in the 32-bit binary representation of a number.\\n     * @param x A numeric expression.\\n     */\\n    clz32(x: number): number;\\n\\n    /**\\n     * Returns the result of 32-bit multiplication of two numbers.\\n     * @param x First number\\n     * @param y Second number\\n     */\\n    imul(x: number, y: number): number;\\n\\n    /**\\n     * Returns the sign of the x, indicating whether x is positive, negative or zero.\\n     * @param x The numeric expression to test\\n     */\\n    sign(x: number): number;\\n\\n    /**\\n     * Returns the base 10 logarithm of a number.\\n     * @param x A numeric expression.\\n     */\\n    log10(x: number): number;\\n\\n    /**\\n     * Returns the base 2 logarithm of a number.\\n     * @param x A numeric expression.\\n     */\\n    log2(x: number): number;\\n\\n    /**\\n     * Returns the natural logarithm of 1 + x.\\n     * @param x A numeric expression.\\n     */\\n    log1p(x: number): number;\\n\\n    /**\\n     * Returns the result of (e^x - 1), which is an implementation-dependent approximation to\\n     * subtracting 1 from the exponential function of x (e raised to the power of x, where e\\n     * is the base of the natural logarithms).\\n     * @param x A numeric expression.\\n     */\\n    expm1(x: number): number;\\n\\n    /**\\n     * Returns the hyperbolic cosine of a number.\\n     * @param x A numeric expression that contains an angle measured in radians.\\n     */\\n    cosh(x: number): number;\\n\\n    /**\\n     * Returns the hyperbolic sine of a number.\\n     * @param x A numeric expression that contains an angle measured in radians.\\n     */\\n    sinh(x: number): number;\\n\\n    /**\\n     * Returns the hyperbolic tangent of a number.\\n     * @param x A numeric expression that contains an angle measured in radians.\\n     */\\n    tanh(x: number): number;\\n\\n    /**\\n     * Returns the inverse hyperbolic cosine of a number.\\n     * @param x A numeric expression that contains an angle measured in radians.\\n     */\\n    acosh(x: number): number;\\n\\n    /**\\n     * Returns the inverse hyperbolic sine of a number.\\n     * @param x A numeric expression that contains an angle measured in radians.\\n     */\\n    asinh(x: number): number;\\n\\n    /**\\n     * Returns the inverse hyperbolic tangent of a number.\\n     * @param x A numeric expression that contains an angle measured in radians.\\n     */\\n    atanh(x: number): number;\\n\\n    /**\\n     * Returns the square root of the sum of squares of its arguments.\\n     * @param values Values to compute the square root for.\\n     *     If no arguments are passed, the result is +0.\\n     *     If there is only one argument, the result is the absolute value.\\n     *     If any argument is +Infinity or -Infinity, the result is +Infinity.\\n     *     If any argument is NaN, the result is NaN.\\n     *     If all arguments are either +0 or 0, the result is +0.\\n     */\\n    hypot(...values: number[]): number;\\n\\n    /**\\n     * Returns the integral part of the a numeric expression, x, removing any fractional digits.\\n     * If x is already an integer, the result is x.\\n     * @param x A numeric expression.\\n     */\\n    trunc(x: number): number;\\n\\n    /**\\n     * Returns the nearest single precision float representation of a number.\\n     * @param x A numeric expression.\\n     */\\n    fround(x: number): number;\\n\\n    /**\\n     * Returns an implementation-dependent approximation to the cube root of number.\\n     * @param x A numeric expression.\\n     */\\n    cbrt(x: number): number;\\n}\\n\\ninterface NumberConstructor {\\n    /**\\n     * The value of Number.EPSILON is the difference between 1 and the smallest value greater than 1\\n     * that is representable as a Number value, which is approximately:\\n     * 2.2204460492503130808472633361816 x 1016.\\n     */\\n    readonly EPSILON: number;\\n\\n    /**\\n     * Returns true if passed value is finite.\\n     * Unlike the global isFinite, Number.isFinite doesn\\'t forcibly convert the parameter to a\\n     * number. Only finite values of the type number, result in true.\\n     * @param number A numeric value.\\n     */\\n    isFinite(number: number): boolean;\\n\\n    /**\\n     * Returns true if the value passed is an integer, false otherwise.\\n     * @param number A numeric value.\\n     */\\n    isInteger(number: number): boolean;\\n\\n    /**\\n     * Returns a Boolean value that indicates whether a value is the reserved value NaN (not a\\n     * number). Unlike the global isNaN(), Number.isNaN() doesn\\'t forcefully convert the parameter\\n     * to a number. Only values of the type number, that are also NaN, result in true.\\n     * @param number A numeric value.\\n     */\\n    isNaN(number: number): boolean;\\n\\n    /**\\n     * Returns true if the value passed is a safe integer.\\n     * @param number A numeric value.\\n     */\\n    isSafeInteger(number: number): boolean;\\n\\n    /**\\n     * The value of the largest integer n such that n and n + 1 are both exactly representable as\\n     * a Number value.\\n     * The value of Number.MAX_SAFE_INTEGER is 9007199254740991 2^53  1.\\n     */\\n    readonly MAX_SAFE_INTEGER: number;\\n\\n    /**\\n     * The value of the smallest integer n such that n and n  1 are both exactly representable as\\n     * a Number value.\\n     * The value of Number.MIN_SAFE_INTEGER is 9007199254740991 ((2^53  1)).\\n     */\\n    readonly MIN_SAFE_INTEGER: number;\\n\\n    /**\\n     * Converts a string to a floating-point number.\\n     * @param string A string that contains a floating-point number.\\n     */\\n    parseFloat(string: string): number;\\n\\n    /**\\n     * Converts A string to an integer.\\n     * @param s A string to convert into a number.\\n     * @param radix A value between 2 and 36 that specifies the base of the number in numString.\\n     * If this argument is not supplied, strings with a prefix of \\'0x\\' are considered hexadecimal.\\n     * All other strings are considered decimal.\\n     */\\n    parseInt(string: string, radix?: number): number;\\n}\\n\\ninterface ObjectConstructor {\\n    /**\\n     * Copy the values of all of the enumerable own properties from one or more source objects to a\\n     * target object. Returns the target object.\\n     * @param target The target object to copy to.\\n     * @param source The source object from which to copy properties.\\n     */\\n    assign<T, U>(target: T, source: U): T & U;\\n\\n    /**\\n     * Copy the values of all of the enumerable own properties from one or more source objects to a\\n     * target object. Returns the target object.\\n     * @param target The target object to copy to.\\n     * @param source1 The first source object from which to copy properties.\\n     * @param source2 The second source object from which to copy properties.\\n     */\\n    assign<T, U, V>(target: T, source1: U, source2: V): T & U & V;\\n\\n    /**\\n     * Copy the values of all of the enumerable own properties from one or more source objects to a\\n     * target object. Returns the target object.\\n     * @param target The target object to copy to.\\n     * @param source1 The first source object from which to copy properties.\\n     * @param source2 The second source object from which to copy properties.\\n     * @param source3 The third source object from which to copy properties.\\n     */\\n    assign<T, U, V, W>(target: T, source1: U, source2: V, source3: W): T & U & V & W;\\n\\n    /**\\n     * Copy the values of all of the enumerable own properties from one or more source objects to a\\n     * target object. Returns the target object.\\n     * @param target The target object to copy to.\\n     * @param sources One or more source objects from which to copy properties\\n     */\\n    assign(target: object, ...sources: any[]): any;\\n\\n    /**\\n     * Returns an array of all symbol properties found directly on object o.\\n     * @param o Object to retrieve the symbols from.\\n     */\\n    getOwnPropertySymbols(o: any): symbol[];\\n\\n    /**\\n      * Returns the names of the enumerable string properties and methods of an object.\\n      * @param o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\\n      */\\n    keys(o: {}): string[];\\n\\n    /**\\n     * Returns true if the values are the same value, false otherwise.\\n     * @param value1 The first value.\\n     * @param value2 The second value.\\n     */\\n    is(value1: any, value2: any): boolean;\\n\\n    /**\\n     * Sets the prototype of a specified object o to  object proto or null. Returns the object o.\\n     * @param o The object to change its prototype.\\n     * @param proto The value of the new prototype or null.\\n     */\\n    setPrototypeOf(o: any, proto: object | null): any;\\n}\\n\\ninterface ReadonlyArray<T> {\\n    /**\\n     * Returns the value of the first element in the array where predicate is true, and undefined\\n     * otherwise.\\n     * @param predicate find calls predicate once for each element of the array, in ascending\\n     * order, until it finds one where predicate returns true. If such an element is found, find\\n     * immediately returns that element value. Otherwise, find returns undefined.\\n     * @param thisArg If provided, it will be used as the this value for each invocation of\\n     * predicate. If it is not provided, undefined is used instead.\\n     */\\n    find<S extends T>(predicate: (this: void, value: T, index: number, obj: ReadonlyArray<T>) => value is S, thisArg?: any): S | undefined;\\n    find(predicate: (value: T, index: number, obj: ReadonlyArray<T>) => unknown, thisArg?: any): T | undefined;\\n\\n    /**\\n     * Returns the index of the first element in the array where predicate is true, and -1\\n     * otherwise.\\n     * @param predicate find calls predicate once for each element of the array, in ascending\\n     * order, until it finds one where predicate returns true. If such an element is found,\\n     * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n     * @param thisArg If provided, it will be used as the this value for each invocation of\\n     * predicate. If it is not provided, undefined is used instead.\\n     */\\n    findIndex(predicate: (value: T, index: number, obj: ReadonlyArray<T>) => unknown, thisArg?: any): number;\\n}\\n\\ninterface RegExp {\\n    /**\\n     * Returns a string indicating the flags of the regular expression in question. This field is read-only.\\n     * The characters in this string are sequenced and concatenated in the following order:\\n     *\\n     *    - \"g\" for global\\n     *    - \"i\" for ignoreCase\\n     *    - \"m\" for multiline\\n     *    - \"u\" for unicode\\n     *    - \"y\" for sticky\\n     *\\n     * If no flags are set, the value is the empty string.\\n     */\\n    readonly flags: string;\\n\\n    /**\\n     * Returns a Boolean value indicating the state of the sticky flag (y) used with a regular\\n     * expression. Default is false. Read-only.\\n     */\\n    readonly sticky: boolean;\\n\\n    /**\\n     * Returns a Boolean value indicating the state of the Unicode flag (u) used with a regular\\n     * expression. Default is false. Read-only.\\n     */\\n    readonly unicode: boolean;\\n}\\n\\ninterface RegExpConstructor {\\n    new (pattern: RegExp, flags?: string): RegExp;\\n    (pattern: RegExp, flags?: string): RegExp;\\n}\\n\\ninterface String {\\n    /**\\n     * Returns a nonnegative integer Number less than 1114112 (0x110000) that is the code point\\n     * value of the UTF-16 encoded code point starting at the string element at position pos in\\n     * the String resulting from converting this object to a String.\\n     * If there is no element at that position, the result is undefined.\\n     * If a valid UTF-16 surrogate pair does not begin at pos, the result is the code unit at pos.\\n     */\\n    codePointAt(pos: number): number | undefined;\\n\\n    /**\\n     * Returns true if searchString appears as a substring of the result of converting this\\n     * object to a String, at one or more positions that are\\n     * greater than or equal to position; otherwise, returns false.\\n     * @param searchString search string\\n     * @param position If position is undefined, 0 is assumed, so as to search all of the String.\\n     */\\n    includes(searchString: string, position?: number): boolean;\\n\\n    /**\\n     * Returns true if the sequence of elements of searchString converted to a String is the\\n     * same as the corresponding elements of this object (converted to a String) starting at\\n     * endPosition  length(this). Otherwise returns false.\\n     */\\n    endsWith(searchString: string, endPosition?: number): boolean;\\n\\n    /**\\n     * Returns the String value result of normalizing the string into the normalization form\\n     * named by form as specified in Unicode Standard Annex #15, Unicode Normalization Forms.\\n     * @param form Applicable values: \"NFC\", \"NFD\", \"NFKC\", or \"NFKD\", If not specified default\\n     * is \"NFC\"\\n     */\\n    normalize(form: \"NFC\" | \"NFD\" | \"NFKC\" | \"NFKD\"): string;\\n\\n    /**\\n     * Returns the String value result of normalizing the string into the normalization form\\n     * named by form as specified in Unicode Standard Annex #15, Unicode Normalization Forms.\\n     * @param form Applicable values: \"NFC\", \"NFD\", \"NFKC\", or \"NFKD\", If not specified default\\n     * is \"NFC\"\\n     */\\n    normalize(form?: string): string;\\n\\n    /**\\n     * Returns a String value that is made from count copies appended together. If count is 0,\\n     * the empty string is returned.\\n     * @param count number of copies to append\\n     */\\n    repeat(count: number): string;\\n\\n    /**\\n     * Returns true if the sequence of elements of searchString converted to a String is the\\n     * same as the corresponding elements of this object (converted to a String) starting at\\n     * position. Otherwise returns false.\\n     */\\n    startsWith(searchString: string, position?: number): boolean;\\n\\n    /**\\n     * Returns an <a> HTML anchor element and sets the name attribute to the text value\\n     * @param name\\n     */\\n    anchor(name: string): string;\\n\\n    /** Returns a <big> HTML element */\\n    big(): string;\\n\\n    /** Returns a <blink> HTML element */\\n    blink(): string;\\n\\n    /** Returns a <b> HTML element */\\n    bold(): string;\\n\\n    /** Returns a <tt> HTML element */\\n    fixed(): string;\\n\\n    /** Returns a <font> HTML element and sets the color attribute value */\\n    fontcolor(color: string): string;\\n\\n    /** Returns a <font> HTML element and sets the size attribute value */\\n    fontsize(size: number): string;\\n\\n    /** Returns a <font> HTML element and sets the size attribute value */\\n    fontsize(size: string): string;\\n\\n    /** Returns an <i> HTML element */\\n    italics(): string;\\n\\n    /** Returns an <a> HTML element and sets the href attribute value */\\n    link(url: string): string;\\n\\n    /** Returns a <small> HTML element */\\n    small(): string;\\n\\n    /** Returns a <strike> HTML element */\\n    strike(): string;\\n\\n    /** Returns a <sub> HTML element */\\n    sub(): string;\\n\\n    /** Returns a <sup> HTML element */\\n    sup(): string;\\n}\\n\\ninterface StringConstructor {\\n    /**\\n     * Return the String value whose elements are, in order, the elements in the List elements.\\n     * If length is 0, the empty string is returned.\\n     */\\n    fromCodePoint(...codePoints: number[]): string;\\n\\n    /**\\n     * String.raw is intended for use as a tag function of a Tagged Template String. When called\\n     * as such the first argument will be a well formed template call site object and the rest\\n     * parameter will contain the substitution values.\\n     * @param template A well-formed template string call site representation.\\n     * @param substitutions A set of substitution values.\\n     */\\n    raw(template: TemplateStringsArray, ...substitutions: any[]): string;\\n}\\n';\n\nconst lib_es5_dts =\n  \"/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\\\"true\\\"/>\\n\\n\\n/////////////////////////////\\n/// ECMAScript APIs\\n/////////////////////////////\\n\\ndeclare var NaN: number;\\ndeclare var Infinity: number;\\n\\n/**\\n  * Evaluates JavaScript code and executes it.\\n  * @param x A String value that contains valid JavaScript code.\\n  */\\ndeclare function eval(x: string): any;\\n\\n/**\\n  * Converts A string to an integer.\\n  * @param s A string to convert into a number.\\n  * @param radix A value between 2 and 36 that specifies the base of the number in numString.\\n  * If this argument is not supplied, strings with a prefix of '0x' are considered hexadecimal.\\n  * All other strings are considered decimal.\\n  */\\ndeclare function parseInt(s: string, radix?: number): number;\\n\\n/**\\n  * Converts a string to a floating-point number.\\n  * @param string A string that contains a floating-point number.\\n  */\\ndeclare function parseFloat(string: string): number;\\n\\n/**\\n  * Returns a Boolean value that indicates whether a value is the reserved value NaN (not a number).\\n  * @param number A numeric value.\\n  */\\ndeclare function isNaN(number: number): boolean;\\n\\n/**\\n  * Determines whether a supplied number is finite.\\n  * @param number Any numeric value.\\n  */\\ndeclare function isFinite(number: number): boolean;\\n\\n/**\\n  * Gets the unencoded version of an encoded Uniform Resource Identifier (URI).\\n  * @param encodedURI A value representing an encoded URI.\\n  */\\ndeclare function decodeURI(encodedURI: string): string;\\n\\n/**\\n  * Gets the unencoded version of an encoded component of a Uniform Resource Identifier (URI).\\n  * @param encodedURIComponent A value representing an encoded URI component.\\n  */\\ndeclare function decodeURIComponent(encodedURIComponent: string): string;\\n\\n/**\\n  * Encodes a text string as a valid Uniform Resource Identifier (URI)\\n  * @param uri A value representing an encoded URI.\\n  */\\ndeclare function encodeURI(uri: string): string;\\n\\n/**\\n  * Encodes a text string as a valid component of a Uniform Resource Identifier (URI).\\n  * @param uriComponent A value representing an encoded URI component.\\n  */\\ndeclare function encodeURIComponent(uriComponent: string | number | boolean): string;\\n\\n/**\\n  * Computes a new string in which certain characters have been replaced by a hexadecimal escape sequence.\\n  * @param string A string value\\n  */\\ndeclare function escape(string: string): string;\\n\\n/**\\n  * Computes a new string in which hexadecimal escape sequences are replaced with the character that it represents.\\n  * @param string A string value\\n  */\\ndeclare function unescape(string: string): string;\\n\\ninterface Symbol {\\n  /** Returns a string representation of an object. */\\n  toString(): string;\\n\\n  /** Returns the primitive value of the specified object. */\\n  valueOf(): symbol;\\n}\\n\\ndeclare type PropertyKey = string | number | symbol;\\n\\ninterface PropertyDescriptor {\\n    configurable?: boolean;\\n    enumerable?: boolean;\\n    value?: any;\\n    writable?: boolean;\\n    get?(): any;\\n    set?(v: any): void;\\n}\\n\\ninterface PropertyDescriptorMap {\\n    [s: string]: PropertyDescriptor;\\n}\\n\\ninterface Object {\\n    /** The initial value of Object.prototype.constructor is the standard built-in Object constructor. */\\n    constructor: Function;\\n\\n    /** Returns a string representation of an object. */\\n    toString(): string;\\n\\n    /** Returns a date converted to a string using the current locale. */\\n    toLocaleString(): string;\\n\\n    /** Returns the primitive value of the specified object. */\\n    valueOf(): Object;\\n\\n    /**\\n      * Determines whether an object has a property with the specified name.\\n      * @param v A property name.\\n      */\\n    hasOwnProperty(v: PropertyKey): boolean;\\n\\n    /**\\n      * Determines whether an object exists in another object's prototype chain.\\n      * @param v Another object whose prototype chain is to be checked.\\n      */\\n    isPrototypeOf(v: Object): boolean;\\n\\n    /**\\n      * Determines whether a specified property is enumerable.\\n      * @param v A property name.\\n      */\\n    propertyIsEnumerable(v: PropertyKey): boolean;\\n}\\n\\ninterface ObjectConstructor {\\n    new(value?: any): Object;\\n    (): any;\\n    (value: any): any;\\n\\n    /** A reference to the prototype for a class of objects. */\\n    readonly prototype: Object;\\n\\n    /**\\n      * Returns the prototype of an object.\\n      * @param o The object that references the prototype.\\n      */\\n    getPrototypeOf(o: any): any;\\n\\n    /**\\n      * Gets the own property descriptor of the specified object.\\n      * An own property descriptor is one that is defined directly on the object and is not inherited from the object's prototype.\\n      * @param o Object that contains the property.\\n      * @param p Name of the property.\\n    */\\n    getOwnPropertyDescriptor(o: any, p: PropertyKey): PropertyDescriptor | undefined;\\n\\n    /**\\n      * Returns the names of the own properties of an object. The own properties of an object are those that are defined directly\\n      * on that object, and are not inherited from the object's prototype. The properties of an object include both fields (objects) and functions.\\n      * @param o Object that contains the own properties.\\n      */\\n    getOwnPropertyNames(o: any): string[];\\n\\n    /**\\n      * Creates an object that has the specified prototype or that has null prototype.\\n      * @param o Object to use as a prototype. May be null.\\n      */\\n    create(o: object | null): any;\\n\\n    /**\\n      * Creates an object that has the specified prototype, and that optionally contains specified properties.\\n      * @param o Object to use as a prototype. May be null\\n      * @param properties JavaScript object that contains one or more property descriptors.\\n      */\\n    create(o: object | null, properties: PropertyDescriptorMap & ThisType<any>): any;\\n\\n    /**\\n      * Adds a property to an object, or modifies attributes of an existing property.\\n      * @param o Object on which to add or modify the property. This can be a native JavaScript object (that is, a user-defined object or a built in object) or a DOM object.\\n      * @param p The property name.\\n      * @param attributes Descriptor for the property. It can be for a data property or an accessor property.\\n      */\\n    defineProperty(o: any, p: PropertyKey, attributes: PropertyDescriptor & ThisType<any>): any;\\n\\n    /**\\n      * Adds one or more properties to an object, and/or modifies attributes of existing properties.\\n      * @param o Object on which to add or modify the properties. This can be a native JavaScript object or a DOM object.\\n      * @param properties JavaScript object that contains one or more descriptor objects. Each descriptor object describes a data property or an accessor property.\\n      */\\n    defineProperties(o: any, properties: PropertyDescriptorMap & ThisType<any>): any;\\n\\n    /**\\n      * Prevents the modification of attributes of existing properties, and prevents the addition of new properties.\\n      * @param o Object on which to lock the attributes.\\n      */\\n    seal<T>(o: T): T;\\n\\n    /**\\n      * Prevents the modification of existing property attributes and values, and prevents the addition of new properties.\\n      * @param o Object on which to lock the attributes.\\n      */\\n    freeze<T>(a: T[]): ReadonlyArray<T>;\\n\\n    /**\\n      * Prevents the modification of existing property attributes and values, and prevents the addition of new properties.\\n      * @param o Object on which to lock the attributes.\\n      */\\n    freeze<T extends Function>(f: T): T;\\n\\n    /**\\n      * Prevents the modification of existing property attributes and values, and prevents the addition of new properties.\\n      * @param o Object on which to lock the attributes.\\n      */\\n    freeze<T>(o: T): Readonly<T>;\\n\\n    /**\\n      * Prevents the addition of new properties to an object.\\n      * @param o Object to make non-extensible.\\n      */\\n    preventExtensions<T>(o: T): T;\\n\\n    /**\\n      * Returns true if existing property attributes cannot be modified in an object and new properties cannot be added to the object.\\n      * @param o Object to test.\\n      */\\n    isSealed(o: any): boolean;\\n\\n    /**\\n      * Returns true if existing property attributes and values cannot be modified in an object, and new properties cannot be added to the object.\\n      * @param o Object to test.\\n      */\\n    isFrozen(o: any): boolean;\\n\\n    /**\\n      * Returns a value that indicates whether new properties can be added to an object.\\n      * @param o Object to test.\\n      */\\n    isExtensible(o: any): boolean;\\n\\n    /**\\n      * Returns the names of the enumerable string properties and methods of an object.\\n      * @param o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\\n      */\\n     keys(o: object): string[];\\n}\\n\\n/**\\n  * Provides functionality common to all JavaScript objects.\\n  */\\ndeclare var Object: ObjectConstructor;\\n\\n/**\\n  * Creates a new function.\\n  */\\ninterface Function {\\n    /**\\n      * Calls the function, substituting the specified object for the this value of the function, and the specified array for the arguments of the function.\\n      * @param thisArg The object to be used as the this object.\\n      * @param argArray A set of arguments to be passed to the function.\\n      */\\n    apply(this: Function, thisArg: any, argArray?: any): any;\\n\\n    /**\\n      * Calls a method of an object, substituting another object for the current object.\\n      * @param thisArg The object to be used as the current object.\\n      * @param argArray A list of arguments to be passed to the method.\\n      */\\n    call(this: Function, thisArg: any, ...argArray: any[]): any;\\n\\n    /**\\n      * For a given function, creates a bound function that has the same body as the original function.\\n      * The this object of the bound function is associated with the specified object, and has the specified initial parameters.\\n      * @param thisArg An object to which the this keyword can refer inside the new function.\\n      * @param argArray A list of arguments to be passed to the new function.\\n      */\\n    bind(this: Function, thisArg: any, ...argArray: any[]): any;\\n\\n    /** Returns a string representation of a function. */\\n    toString(): string;\\n\\n    prototype: any;\\n    readonly length: number;\\n\\n    // Non-standard extensions\\n    arguments: any;\\n    caller: Function;\\n}\\n\\ninterface FunctionConstructor {\\n    /**\\n      * Creates a new function.\\n      * @param args A list of arguments the function accepts.\\n      */\\n    new(...args: string[]): Function;\\n    (...args: string[]): Function;\\n    readonly prototype: Function;\\n}\\n\\ndeclare var Function: FunctionConstructor;\\n\\n/**\\n * Extracts the type of the 'this' parameter of a function type, or 'unknown' if the function type has no 'this' parameter.\\n */\\ntype ThisParameterType<T> = T extends (this: unknown, ...args: any[]) => any ? unknown : T extends (this: infer U, ...args: any[]) => any ? U : unknown;\\n\\n/**\\n * Removes the 'this' parameter from a function type.\\n */\\ntype OmitThisParameter<T> = unknown extends ThisParameterType<T> ? T : T extends (...args: infer A) => infer R ? (...args: A) => R : T;\\n\\ninterface CallableFunction extends Function {\\n    /**\\n      * Calls the function with the specified object as the this value and the elements of specified array as the arguments.\\n      * @param thisArg The object to be used as the this object.\\n      * @param args An array of argument values to be passed to the function.\\n      */\\n    apply<T, R>(this: (this: T) => R, thisArg: T): R;\\n    apply<T, A extends any[], R>(this: (this: T, ...args: A) => R, thisArg: T, args: A): R;\\n\\n    /**\\n      * Calls the function with the specified object as the this value and the specified rest arguments as the arguments.\\n      * @param thisArg The object to be used as the this object.\\n      * @param args Argument values to be passed to the function.\\n      */\\n    call<T, A extends any[], R>(this: (this: T, ...args: A) => R, thisArg: T, ...args: A): R;\\n\\n    /**\\n      * For a given function, creates a bound function that has the same body as the original function.\\n      * The this object of the bound function is associated with the specified object, and has the specified initial parameters.\\n      * @param thisArg The object to be used as the this object.\\n      * @param args Arguments to bind to the parameters of the function.\\n      */\\n    bind<T>(this: T, thisArg: ThisParameterType<T>): OmitThisParameter<T>;\\n    bind<T, A0, A extends any[], R>(this: (this: T, arg0: A0, ...args: A) => R, thisArg: T, arg0: A0): (...args: A) => R;\\n    bind<T, A0, A1, A extends any[], R>(this: (this: T, arg0: A0, arg1: A1, ...args: A) => R, thisArg: T, arg0: A0, arg1: A1): (...args: A) => R;\\n    bind<T, A0, A1, A2, A extends any[], R>(this: (this: T, arg0: A0, arg1: A1, arg2: A2, ...args: A) => R, thisArg: T, arg0: A0, arg1: A1, arg2: A2): (...args: A) => R;\\n    bind<T, A0, A1, A2, A3, A extends any[], R>(this: (this: T, arg0: A0, arg1: A1, arg2: A2, arg3: A3, ...args: A) => R, thisArg: T, arg0: A0, arg1: A1, arg2: A2, arg3: A3): (...args: A) => R;\\n    bind<T, AX, R>(this: (this: T, ...args: AX[]) => R, thisArg: T, ...args: AX[]): (...args: AX[]) => R;\\n}\\n\\ninterface NewableFunction extends Function {\\n    /**\\n      * Calls the function with the specified object as the this value and the elements of specified array as the arguments.\\n      * @param thisArg The object to be used as the this object.\\n      * @param args An array of argument values to be passed to the function.\\n      */\\n    apply<T>(this: new () => T, thisArg: T): void;\\n    apply<T, A extends any[]>(this: new (...args: A) => T, thisArg: T, args: A): void;\\n\\n    /**\\n      * Calls the function with the specified object as the this value and the specified rest arguments as the arguments.\\n      * @param thisArg The object to be used as the this object.\\n      * @param args Argument values to be passed to the function.\\n      */\\n    call<T, A extends any[]>(this: new (...args: A) => T, thisArg: T, ...args: A): void;\\n\\n    /**\\n      * For a given function, creates a bound function that has the same body as the original function.\\n      * The this object of the bound function is associated with the specified object, and has the specified initial parameters.\\n      * @param thisArg The object to be used as the this object.\\n      * @param args Arguments to bind to the parameters of the function.\\n      */\\n    bind<T>(this: T, thisArg: any): T;\\n    bind<A0, A extends any[], R>(this: new (arg0: A0, ...args: A) => R, thisArg: any, arg0: A0): new (...args: A) => R;\\n    bind<A0, A1, A extends any[], R>(this: new (arg0: A0, arg1: A1, ...args: A) => R, thisArg: any, arg0: A0, arg1: A1): new (...args: A) => R;\\n    bind<A0, A1, A2, A extends any[], R>(this: new (arg0: A0, arg1: A1, arg2: A2, ...args: A) => R, thisArg: any, arg0: A0, arg1: A1, arg2: A2): new (...args: A) => R;\\n    bind<A0, A1, A2, A3, A extends any[], R>(this: new (arg0: A0, arg1: A1, arg2: A2, arg3: A3, ...args: A) => R, thisArg: any, arg0: A0, arg1: A1, arg2: A2, arg3: A3): new (...args: A) => R;\\n    bind<AX, R>(this: new (...args: AX[]) => R, thisArg: any, ...args: AX[]): new (...args: AX[]) => R;\\n}\\n\\ninterface IArguments {\\n    [index: number]: any;\\n    length: number;\\n    callee: Function;\\n}\\n\\ninterface String {\\n    /** Returns a string representation of a string. */\\n    toString(): string;\\n\\n    /**\\n      * Returns the character at the specified index.\\n      * @param pos The zero-based index of the desired character.\\n      */\\n    charAt(pos: number): string;\\n\\n    /**\\n      * Returns the Unicode value of the character at the specified location.\\n      * @param index The zero-based index of the desired character. If there is no character at the specified index, NaN is returned.\\n      */\\n    charCodeAt(index: number): number;\\n\\n    /**\\n      * Returns a string that contains the concatenation of two or more strings.\\n      * @param strings The strings to append to the end of the string.\\n      */\\n    concat(...strings: string[]): string;\\n\\n    /**\\n      * Returns the position of the first occurrence of a substring.\\n      * @param searchString The substring to search for in the string\\n      * @param position The index at which to begin searching the String object. If omitted, search starts at the beginning of the string.\\n      */\\n    indexOf(searchString: string, position?: number): number;\\n\\n    /**\\n      * Returns the last occurrence of a substring in the string.\\n      * @param searchString The substring to search for.\\n      * @param position The index at which to begin searching. If omitted, the search begins at the end of the string.\\n      */\\n    lastIndexOf(searchString: string, position?: number): number;\\n\\n    /**\\n      * Determines whether two strings are equivalent in the current locale.\\n      * @param that String to compare to target string\\n      */\\n    localeCompare(that: string): number;\\n\\n    /**\\n      * Matches a string with a regular expression, and returns an array containing the results of that search.\\n      * @param regexp A variable name or string literal containing the regular expression pattern and flags.\\n      */\\n    match(regexp: string | RegExp): RegExpMatchArray | null;\\n\\n    /**\\n      * Replaces text in a string, using a regular expression or search string.\\n      * @param searchValue A string to search for.\\n      * @param replaceValue A string containing the text to replace for every successful match of searchValue in this string.\\n      */\\n    replace(searchValue: string | RegExp, replaceValue: string): string;\\n\\n    /**\\n      * Replaces text in a string, using a regular expression or search string.\\n      * @param searchValue A string to search for.\\n      * @param replacer A function that returns the replacement text.\\n      */\\n    replace(searchValue: string | RegExp, replacer: (substring: string, ...args: any[]) => string): string;\\n\\n    /**\\n      * Finds the first substring match in a regular expression search.\\n      * @param regexp The regular expression pattern and applicable flags.\\n      */\\n    search(regexp: string | RegExp): number;\\n\\n    /**\\n      * Returns a section of a string.\\n      * @param start The index to the beginning of the specified portion of stringObj.\\n      * @param end The index to the end of the specified portion of stringObj. The substring includes the characters up to, but not including, the character indicated by end.\\n      * If this value is not specified, the substring continues to the end of stringObj.\\n      */\\n    slice(start?: number, end?: number): string;\\n\\n    /**\\n      * Split a string into substrings using the specified separator and return them as an array.\\n      * @param separator A string that identifies character or characters to use in separating the string. If omitted, a single-element array containing the entire string is returned.\\n      * @param limit A value used to limit the number of elements returned in the array.\\n      */\\n    split(separator: string | RegExp, limit?: number): string[];\\n\\n    /**\\n      * Returns the substring at the specified location within a String object.\\n      * @param start The zero-based index number indicating the beginning of the substring.\\n      * @param end Zero-based index number indicating the end of the substring. The substring includes the characters up to, but not including, the character indicated by end.\\n      * If end is omitted, the characters from start through the end of the original string are returned.\\n      */\\n    substring(start: number, end?: number): string;\\n\\n    /** Converts all the alphabetic characters in a string to lowercase. */\\n    toLowerCase(): string;\\n\\n    /** Converts all alphabetic characters to lowercase, taking into account the host environment's current locale. */\\n    toLocaleLowerCase(): string;\\n\\n    /** Converts all the alphabetic characters in a string to uppercase. */\\n    toUpperCase(): string;\\n\\n    /** Returns a string where all alphabetic characters have been converted to uppercase, taking into account the host environment's current locale. */\\n    toLocaleUpperCase(): string;\\n\\n    /** Removes the leading and trailing white space and line terminator characters from a string. */\\n    trim(): string;\\n\\n    /** Returns the length of a String object. */\\n    readonly length: number;\\n\\n    // IE extensions\\n    /**\\n      * Gets a substring beginning at the specified location and having the specified length.\\n      * @param from The starting position of the desired substring. The index of the first character in the string is zero.\\n      * @param length The number of characters to include in the returned substring.\\n      */\\n    substr(from: number, length?: number): string;\\n\\n    /** Returns the primitive value of the specified object. */\\n    valueOf(): string;\\n\\n    readonly [index: number]: string;\\n}\\n\\ninterface StringConstructor {\\n    new(value?: any): String;\\n    (value?: any): string;\\n    readonly prototype: String;\\n    fromCharCode(...codes: number[]): string;\\n}\\n\\n/**\\n  * Allows manipulation and formatting of text strings and determination and location of substrings within strings.\\n  */\\ndeclare var String: StringConstructor;\\n\\ninterface Boolean {\\n    /** Returns the primitive value of the specified object. */\\n    valueOf(): boolean;\\n}\\n\\ninterface BooleanConstructor {\\n    new(value?: any): Boolean;\\n    <T>(value?: T): boolean;\\n    readonly prototype: Boolean;\\n}\\n\\ndeclare var Boolean: BooleanConstructor;\\n\\ninterface Number {\\n    /**\\n      * Returns a string representation of an object.\\n      * @param radix Specifies a radix for converting numeric values to strings. This value is only used for numbers.\\n      */\\n    toString(radix?: number): string;\\n\\n    /**\\n      * Returns a string representing a number in fixed-point notation.\\n      * @param fractionDigits Number of digits after the decimal point. Must be in the range 0 - 20, inclusive.\\n      */\\n    toFixed(fractionDigits?: number): string;\\n\\n    /**\\n      * Returns a string containing a number represented in exponential notation.\\n      * @param fractionDigits Number of digits after the decimal point. Must be in the range 0 - 20, inclusive.\\n      */\\n    toExponential(fractionDigits?: number): string;\\n\\n    /**\\n      * Returns a string containing a number represented either in exponential or fixed-point notation with a specified number of digits.\\n      * @param precision Number of significant digits. Must be in the range 1 - 21, inclusive.\\n      */\\n    toPrecision(precision?: number): string;\\n\\n    /** Returns the primitive value of the specified object. */\\n    valueOf(): number;\\n}\\n\\ninterface NumberConstructor {\\n    new(value?: any): Number;\\n    (value?: any): number;\\n    readonly prototype: Number;\\n\\n    /** The largest number that can be represented in JavaScript. Equal to approximately 1.79E+308. */\\n    readonly MAX_VALUE: number;\\n\\n    /** The closest number to zero that can be represented in JavaScript. Equal to approximately 5.00E-324. */\\n    readonly MIN_VALUE: number;\\n\\n    /**\\n      * A value that is not a number.\\n      * In equality comparisons, NaN does not equal any value, including itself. To test whether a value is equivalent to NaN, use the isNaN function.\\n      */\\n    readonly NaN: number;\\n\\n    /**\\n      * A value that is less than the largest negative number that can be represented in JavaScript.\\n      * JavaScript displays NEGATIVE_INFINITY values as -infinity.\\n      */\\n    readonly NEGATIVE_INFINITY: number;\\n\\n    /**\\n      * A value greater than the largest number that can be represented in JavaScript.\\n      * JavaScript displays POSITIVE_INFINITY values as infinity.\\n      */\\n    readonly POSITIVE_INFINITY: number;\\n}\\n\\n/** An object that represents a number of any kind. All JavaScript numbers are 64-bit floating-point numbers. */\\ndeclare var Number: NumberConstructor;\\n\\ninterface TemplateStringsArray extends ReadonlyArray<string> {\\n    readonly raw: ReadonlyArray<string>;\\n}\\n\\n/**\\n * The type of `import.meta`.\\n *\\n * If you need to declare that a given property exists on `import.meta`,\\n * this type may be augmented via interface merging.\\n */\\ninterface ImportMeta {\\n}\\n\\ninterface Math {\\n    /** The mathematical constant e. This is Euler's number, the base of natural logarithms. */\\n    readonly E: number;\\n    /** The natural logarithm of 10. */\\n    readonly LN10: number;\\n    /** The natural logarithm of 2. */\\n    readonly LN2: number;\\n    /** The base-2 logarithm of e. */\\n    readonly LOG2E: number;\\n    /** The base-10 logarithm of e. */\\n    readonly LOG10E: number;\\n    /** Pi. This is the ratio of the circumference of a circle to its diameter. */\\n    readonly PI: number;\\n    /** The square root of 0.5, or, equivalently, one divided by the square root of 2. */\\n    readonly SQRT1_2: number;\\n    /** The square root of 2. */\\n    readonly SQRT2: number;\\n    /**\\n      * Returns the absolute value of a number (the value without regard to whether it is positive or negative).\\n      * For example, the absolute value of -5 is the same as the absolute value of 5.\\n      * @param x A numeric expression for which the absolute value is needed.\\n      */\\n    abs(x: number): number;\\n    /**\\n      * Returns the arc cosine (or inverse cosine) of a number.\\n      * @param x A numeric expression.\\n      */\\n    acos(x: number): number;\\n    /**\\n      * Returns the arcsine of a number.\\n      * @param x A numeric expression.\\n      */\\n    asin(x: number): number;\\n    /**\\n      * Returns the arctangent of a number.\\n      * @param x A numeric expression for which the arctangent is needed.\\n      */\\n    atan(x: number): number;\\n    /**\\n      * Returns the angle (in radians) from the X axis to a point.\\n      * @param y A numeric expression representing the cartesian y-coordinate.\\n      * @param x A numeric expression representing the cartesian x-coordinate.\\n      */\\n    atan2(y: number, x: number): number;\\n    /**\\n      * Returns the smallest integer greater than or equal to its numeric argument.\\n      * @param x A numeric expression.\\n      */\\n    ceil(x: number): number;\\n    /**\\n      * Returns the cosine of a number.\\n      * @param x A numeric expression that contains an angle measured in radians.\\n      */\\n    cos(x: number): number;\\n    /**\\n      * Returns e (the base of natural logarithms) raised to a power.\\n      * @param x A numeric expression representing the power of e.\\n      */\\n    exp(x: number): number;\\n    /**\\n      * Returns the greatest integer less than or equal to its numeric argument.\\n      * @param x A numeric expression.\\n      */\\n    floor(x: number): number;\\n    /**\\n      * Returns the natural logarithm (base e) of a number.\\n      * @param x A numeric expression.\\n      */\\n    log(x: number): number;\\n    /**\\n      * Returns the larger of a set of supplied numeric expressions.\\n      * @param values Numeric expressions to be evaluated.\\n      */\\n    max(...values: number[]): number;\\n    /**\\n      * Returns the smaller of a set of supplied numeric expressions.\\n      * @param values Numeric expressions to be evaluated.\\n      */\\n    min(...values: number[]): number;\\n    /**\\n      * Returns the value of a base expression taken to a specified power.\\n      * @param x The base value of the expression.\\n      * @param y The exponent value of the expression.\\n      */\\n    pow(x: number, y: number): number;\\n    /** Returns a pseudorandom number between 0 and 1. */\\n    random(): number;\\n    /**\\n      * Returns a supplied numeric expression rounded to the nearest number.\\n      * @param x The value to be rounded to the nearest number.\\n      */\\n    round(x: number): number;\\n    /**\\n      * Returns the sine of a number.\\n      * @param x A numeric expression that contains an angle measured in radians.\\n      */\\n    sin(x: number): number;\\n    /**\\n      * Returns the square root of a number.\\n      * @param x A numeric expression.\\n      */\\n    sqrt(x: number): number;\\n    /**\\n      * Returns the tangent of a number.\\n      * @param x A numeric expression that contains an angle measured in radians.\\n      */\\n    tan(x: number): number;\\n}\\n/** An intrinsic object that provides basic mathematics functionality and constants. */\\ndeclare var Math: Math;\\n\\n/** Enables basic storage and retrieval of dates and times. */\\ninterface Date {\\n    /** Returns a string representation of a date. The format of the string depends on the locale. */\\n    toString(): string;\\n    /** Returns a date as a string value. */\\n    toDateString(): string;\\n    /** Returns a time as a string value. */\\n    toTimeString(): string;\\n    /** Returns a value as a string value appropriate to the host environment's current locale. */\\n    toLocaleString(): string;\\n    /** Returns a date as a string value appropriate to the host environment's current locale. */\\n    toLocaleDateString(): string;\\n    /** Returns a time as a string value appropriate to the host environment's current locale. */\\n    toLocaleTimeString(): string;\\n    /** Returns the stored time value in milliseconds since midnight, January 1, 1970 UTC. */\\n    valueOf(): number;\\n    /** Gets the time value in milliseconds. */\\n    getTime(): number;\\n    /** Gets the year, using local time. */\\n    getFullYear(): number;\\n    /** Gets the year using Universal Coordinated Time (UTC). */\\n    getUTCFullYear(): number;\\n    /** Gets the month, using local time. */\\n    getMonth(): number;\\n    /** Gets the month of a Date object using Universal Coordinated Time (UTC). */\\n    getUTCMonth(): number;\\n    /** Gets the day-of-the-month, using local time. */\\n    getDate(): number;\\n    /** Gets the day-of-the-month, using Universal Coordinated Time (UTC). */\\n    getUTCDate(): number;\\n    /** Gets the day of the week, using local time. */\\n    getDay(): number;\\n    /** Gets the day of the week using Universal Coordinated Time (UTC). */\\n    getUTCDay(): number;\\n    /** Gets the hours in a date, using local time. */\\n    getHours(): number;\\n    /** Gets the hours value in a Date object using Universal Coordinated Time (UTC). */\\n    getUTCHours(): number;\\n    /** Gets the minutes of a Date object, using local time. */\\n    getMinutes(): number;\\n    /** Gets the minutes of a Date object using Universal Coordinated Time (UTC). */\\n    getUTCMinutes(): number;\\n    /** Gets the seconds of a Date object, using local time. */\\n    getSeconds(): number;\\n    /** Gets the seconds of a Date object using Universal Coordinated Time (UTC). */\\n    getUTCSeconds(): number;\\n    /** Gets the milliseconds of a Date, using local time. */\\n    getMilliseconds(): number;\\n    /** Gets the milliseconds of a Date object using Universal Coordinated Time (UTC). */\\n    getUTCMilliseconds(): number;\\n    /** Gets the difference in minutes between the time on the local computer and Universal Coordinated Time (UTC). */\\n    getTimezoneOffset(): number;\\n    /**\\n      * Sets the date and time value in the Date object.\\n      * @param time A numeric value representing the number of elapsed milliseconds since midnight, January 1, 1970 GMT.\\n      */\\n    setTime(time: number): number;\\n    /**\\n      * Sets the milliseconds value in the Date object using local time.\\n      * @param ms A numeric value equal to the millisecond value.\\n      */\\n    setMilliseconds(ms: number): number;\\n    /**\\n      * Sets the milliseconds value in the Date object using Universal Coordinated Time (UTC).\\n      * @param ms A numeric value equal to the millisecond value.\\n      */\\n    setUTCMilliseconds(ms: number): number;\\n\\n    /**\\n      * Sets the seconds value in the Date object using local time.\\n      * @param sec A numeric value equal to the seconds value.\\n      * @param ms A numeric value equal to the milliseconds value.\\n      */\\n    setSeconds(sec: number, ms?: number): number;\\n    /**\\n      * Sets the seconds value in the Date object using Universal Coordinated Time (UTC).\\n      * @param sec A numeric value equal to the seconds value.\\n      * @param ms A numeric value equal to the milliseconds value.\\n      */\\n    setUTCSeconds(sec: number, ms?: number): number;\\n    /**\\n      * Sets the minutes value in the Date object using local time.\\n      * @param min A numeric value equal to the minutes value.\\n      * @param sec A numeric value equal to the seconds value.\\n      * @param ms A numeric value equal to the milliseconds value.\\n      */\\n    setMinutes(min: number, sec?: number, ms?: number): number;\\n    /**\\n      * Sets the minutes value in the Date object using Universal Coordinated Time (UTC).\\n      * @param min A numeric value equal to the minutes value.\\n      * @param sec A numeric value equal to the seconds value.\\n      * @param ms A numeric value equal to the milliseconds value.\\n      */\\n    setUTCMinutes(min: number, sec?: number, ms?: number): number;\\n    /**\\n      * Sets the hour value in the Date object using local time.\\n      * @param hours A numeric value equal to the hours value.\\n      * @param min A numeric value equal to the minutes value.\\n      * @param sec A numeric value equal to the seconds value.\\n      * @param ms A numeric value equal to the milliseconds value.\\n      */\\n    setHours(hours: number, min?: number, sec?: number, ms?: number): number;\\n    /**\\n      * Sets the hours value in the Date object using Universal Coordinated Time (UTC).\\n      * @param hours A numeric value equal to the hours value.\\n      * @param min A numeric value equal to the minutes value.\\n      * @param sec A numeric value equal to the seconds value.\\n      * @param ms A numeric value equal to the milliseconds value.\\n      */\\n    setUTCHours(hours: number, min?: number, sec?: number, ms?: number): number;\\n    /**\\n      * Sets the numeric day-of-the-month value of the Date object using local time.\\n      * @param date A numeric value equal to the day of the month.\\n      */\\n    setDate(date: number): number;\\n    /**\\n      * Sets the numeric day of the month in the Date object using Universal Coordinated Time (UTC).\\n      * @param date A numeric value equal to the day of the month.\\n      */\\n    setUTCDate(date: number): number;\\n    /**\\n      * Sets the month value in the Date object using local time.\\n      * @param month A numeric value equal to the month. The value for January is 0, and other month values follow consecutively.\\n      * @param date A numeric value representing the day of the month. If this value is not supplied, the value from a call to the getDate method is used.\\n      */\\n    setMonth(month: number, date?: number): number;\\n    /**\\n      * Sets the month value in the Date object using Universal Coordinated Time (UTC).\\n      * @param month A numeric value equal to the month. The value for January is 0, and other month values follow consecutively.\\n      * @param date A numeric value representing the day of the month. If it is not supplied, the value from a call to the getUTCDate method is used.\\n      */\\n    setUTCMonth(month: number, date?: number): number;\\n    /**\\n      * Sets the year of the Date object using local time.\\n      * @param year A numeric value for the year.\\n      * @param month A zero-based numeric value for the month (0 for January, 11 for December). Must be specified if numDate is specified.\\n      * @param date A numeric value equal for the day of the month.\\n      */\\n    setFullYear(year: number, month?: number, date?: number): number;\\n    /**\\n      * Sets the year value in the Date object using Universal Coordinated Time (UTC).\\n      * @param year A numeric value equal to the year.\\n      * @param month A numeric value equal to the month. The value for January is 0, and other month values follow consecutively. Must be supplied if numDate is supplied.\\n      * @param date A numeric value equal to the day of the month.\\n      */\\n    setUTCFullYear(year: number, month?: number, date?: number): number;\\n    /** Returns a date converted to a string using Universal Coordinated Time (UTC). */\\n    toUTCString(): string;\\n    /** Returns a date as a string value in ISO format. */\\n    toISOString(): string;\\n    /** Used by the JSON.stringify method to enable the transformation of an object's data for JavaScript Object Notation (JSON) serialization. */\\n    toJSON(key?: any): string;\\n}\\n\\ninterface DateConstructor {\\n    new(): Date;\\n    new(value: number | string): Date;\\n    new(year: number, month: number, date?: number, hours?: number, minutes?: number, seconds?: number, ms?: number): Date;\\n    (): string;\\n    readonly prototype: Date;\\n    /**\\n      * Parses a string containing a date, and returns the number of milliseconds between that date and midnight, January 1, 1970.\\n      * @param s A date string\\n      */\\n    parse(s: string): number;\\n    /**\\n      * Returns the number of milliseconds between midnight, January 1, 1970 Universal Coordinated Time (UTC) (or GMT) and the specified date.\\n      * @param year The full year designation is required for cross-century date accuracy. If year is between 0 and 99 is used, then year is assumed to be 1900 + year.\\n      * @param month The month as an number between 0 and 11 (January to December).\\n      * @param date The date as an number between 1 and 31.\\n      * @param hours Must be supplied if minutes is supplied. An number from 0 to 23 (midnight to 11pm) that specifies the hour.\\n      * @param minutes Must be supplied if seconds is supplied. An number from 0 to 59 that specifies the minutes.\\n      * @param seconds Must be supplied if milliseconds is supplied. An number from 0 to 59 that specifies the seconds.\\n      * @param ms An number from 0 to 999 that specifies the milliseconds.\\n      */\\n    UTC(year: number, month: number, date?: number, hours?: number, minutes?: number, seconds?: number, ms?: number): number;\\n    now(): number;\\n}\\n\\ndeclare var Date: DateConstructor;\\n\\ninterface RegExpMatchArray extends Array<string> {\\n    index?: number;\\n    input?: string;\\n}\\n\\ninterface RegExpExecArray extends Array<string> {\\n    index: number;\\n    input: string;\\n}\\n\\ninterface RegExp {\\n    /**\\n      * Executes a search on a string using a regular expression pattern, and returns an array containing the results of that search.\\n      * @param string The String object or string literal on which to perform the search.\\n      */\\n    exec(string: string): RegExpExecArray | null;\\n\\n    /**\\n      * Returns a Boolean value that indicates whether or not a pattern exists in a searched string.\\n      * @param string String on which to perform the search.\\n      */\\n    test(string: string): boolean;\\n\\n    /** Returns a copy of the text of the regular expression pattern. Read-only. The regExp argument is a Regular expression object. It can be a variable name or a literal. */\\n    readonly source: string;\\n\\n    /** Returns a Boolean value indicating the state of the global flag (g) used with a regular expression. Default is false. Read-only. */\\n    readonly global: boolean;\\n\\n    /** Returns a Boolean value indicating the state of the ignoreCase flag (i) used with a regular expression. Default is false. Read-only. */\\n    readonly ignoreCase: boolean;\\n\\n    /** Returns a Boolean value indicating the state of the multiline flag (m) used with a regular expression. Default is false. Read-only. */\\n    readonly multiline: boolean;\\n\\n    lastIndex: number;\\n\\n    // Non-standard extensions\\n    compile(): this;\\n}\\n\\ninterface RegExpConstructor {\\n    new(pattern: RegExp | string): RegExp;\\n    new(pattern: string, flags?: string): RegExp;\\n    (pattern: RegExp | string): RegExp;\\n    (pattern: string, flags?: string): RegExp;\\n    readonly prototype: RegExp;\\n\\n    // Non-standard extensions\\n    $1: string;\\n    $2: string;\\n    $3: string;\\n    $4: string;\\n    $5: string;\\n    $6: string;\\n    $7: string;\\n    $8: string;\\n    $9: string;\\n    lastMatch: string;\\n}\\n\\ndeclare var RegExp: RegExpConstructor;\\n\\ninterface Error {\\n    name: string;\\n    message: string;\\n    stack?: string;\\n}\\n\\ninterface ErrorConstructor {\\n    new(message?: string): Error;\\n    (message?: string): Error;\\n    readonly prototype: Error;\\n}\\n\\ndeclare var Error: ErrorConstructor;\\n\\ninterface EvalError extends Error {\\n}\\n\\ninterface EvalErrorConstructor {\\n    new(message?: string): EvalError;\\n    (message?: string): EvalError;\\n    readonly prototype: EvalError;\\n}\\n\\ndeclare var EvalError: EvalErrorConstructor;\\n\\ninterface RangeError extends Error {\\n}\\n\\ninterface RangeErrorConstructor {\\n    new(message?: string): RangeError;\\n    (message?: string): RangeError;\\n    readonly prototype: RangeError;\\n}\\n\\ndeclare var RangeError: RangeErrorConstructor;\\n\\ninterface ReferenceError extends Error {\\n}\\n\\ninterface ReferenceErrorConstructor {\\n    new(message?: string): ReferenceError;\\n    (message?: string): ReferenceError;\\n    readonly prototype: ReferenceError;\\n}\\n\\ndeclare var ReferenceError: ReferenceErrorConstructor;\\n\\ninterface SyntaxError extends Error {\\n}\\n\\ninterface SyntaxErrorConstructor {\\n    new(message?: string): SyntaxError;\\n    (message?: string): SyntaxError;\\n    readonly prototype: SyntaxError;\\n}\\n\\ndeclare var SyntaxError: SyntaxErrorConstructor;\\n\\ninterface TypeError extends Error {\\n}\\n\\ninterface TypeErrorConstructor {\\n    new(message?: string): TypeError;\\n    (message?: string): TypeError;\\n    readonly prototype: TypeError;\\n}\\n\\ndeclare var TypeError: TypeErrorConstructor;\\n\\ninterface URIError extends Error {\\n}\\n\\ninterface URIErrorConstructor {\\n    new(message?: string): URIError;\\n    (message?: string): URIError;\\n    readonly prototype: URIError;\\n}\\n\\ndeclare var URIError: URIErrorConstructor;\\n\\ninterface JSON {\\n    /**\\n      * Converts a JavaScript Object Notation (JSON) string into an object.\\n      * @param text A valid JSON string.\\n      * @param reviver A function that transforms the results. This function is called for each member of the object.\\n      * If a member contains nested objects, the nested objects are transformed before the parent object is.\\n      */\\n    parse(text: string, reviver?: (this: any, key: string, value: any) => any): any;\\n    /**\\n      * Converts a JavaScript value to a JavaScript Object Notation (JSON) string.\\n      * @param value A JavaScript value, usually an object or array, to be converted.\\n      * @param replacer A function that transforms the results.\\n      * @param space Adds indentation, white space, and line break characters to the return-value JSON text to make it easier to read.\\n      */\\n    stringify(value: any, replacer?: (this: any, key: string, value: any) => any, space?: string | number): string;\\n    /**\\n      * Converts a JavaScript value to a JavaScript Object Notation (JSON) string.\\n      * @param value A JavaScript value, usually an object or array, to be converted.\\n      * @param replacer An array of strings and numbers that acts as a approved list for selecting the object properties that will be stringified.\\n      * @param space Adds indentation, white space, and line break characters to the return-value JSON text to make it easier to read.\\n      */\\n    stringify(value: any, replacer?: (number | string)[] | null, space?: string | number): string;\\n}\\n\\n/**\\n  * An intrinsic object that provides functions to convert JavaScript values to and from the JavaScript Object Notation (JSON) format.\\n  */\\ndeclare var JSON: JSON;\\n\\n\\n/////////////////////////////\\n/// ECMAScript Array API (specially handled by compiler)\\n/////////////////////////////\\n\\ninterface ReadonlyArray<T> {\\n    /**\\n      * Gets the length of the array. This is a number one higher than the highest element defined in an array.\\n      */\\n    readonly length: number;\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n    /**\\n      * Returns a string representation of an array. The elements are converted to string using their toLocalString methods.\\n      */\\n    toLocaleString(): string;\\n    /**\\n      * Combines two or more arrays.\\n      * @param items Additional items to add to the end of array1.\\n      */\\n    concat(...items: ConcatArray<T>[]): T[];\\n    /**\\n      * Combines two or more arrays.\\n      * @param items Additional items to add to the end of array1.\\n      */\\n    concat(...items: (T | ConcatArray<T>)[]): T[];\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): T[];\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at index 0.\\n      */\\n    indexOf(searchElement: T, fromIndex?: number): number;\\n    /**\\n      * Returns the index of the last occurrence of a specified value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at the last index in the array.\\n      */\\n    lastIndexOf(searchElement: T, fromIndex?: number): number;\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls the callbackfn function for each element in array1 until the callbackfn returns false, or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: T, index: number, array: ReadonlyArray<T>) => unknown, thisArg?: any): boolean;\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the callbackfn function for each element in array1 until the callbackfn returns true, or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: T, index: number, array: ReadonlyArray<T>) => unknown, thisArg?: any): boolean;\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: T, index: number, array: ReadonlyArray<T>) => void, thisArg?: any): void;\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map<U>(callbackfn: (value: T, index: number, array: ReadonlyArray<T>) => U, thisArg?: any): U[];\\n    /**\\n     * Returns the elements of an array that meet the condition specified in a callback function.\\n     * @param callbackfn A function that accepts up to three arguments. The filter method calls the callbackfn function one time for each element in the array.\\n     * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n     */\\n    filter<S extends T>(callbackfn: (value: T, index: number, array: ReadonlyArray<T>) => value is S, thisArg?: any): S[];\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: T, index: number, array: ReadonlyArray<T>) => unknown, thisArg?: any): T[];\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: ReadonlyArray<T>) => T): T;\\n    reduce(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: ReadonlyArray<T>) => T, initialValue: T): T;\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: T, currentIndex: number, array: ReadonlyArray<T>) => U, initialValue: U): U;\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: ReadonlyArray<T>) => T): T;\\n    reduceRight(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: ReadonlyArray<T>) => T, initialValue: T): T;\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: T, currentIndex: number, array: ReadonlyArray<T>) => U, initialValue: U): U;\\n\\n    readonly [n: number]: T;\\n}\\n\\ninterface ConcatArray<T> {\\n    readonly length: number;\\n    readonly [n: number]: T;\\n    join(separator?: string): string;\\n    slice(start?: number, end?: number): T[];\\n}\\n\\ninterface Array<T> {\\n    /**\\n      * Gets or sets the length of the array. This is a number one higher than the highest element defined in an array.\\n      */\\n    length: number;\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n    /**\\n      * Returns a string representation of an array. The elements are converted to string using their toLocalString methods.\\n      */\\n    toLocaleString(): string;\\n    /**\\n      * Removes the last element from an array and returns it.\\n      */\\n    pop(): T | undefined;\\n    /**\\n      * Appends new elements to an array, and returns the new length of the array.\\n      * @param items New elements of the Array.\\n      */\\n    push(...items: T[]): number;\\n    /**\\n      * Combines two or more arrays.\\n      * @param items Additional items to add to the end of array1.\\n      */\\n    concat(...items: ConcatArray<T>[]): T[];\\n    /**\\n      * Combines two or more arrays.\\n      * @param items Additional items to add to the end of array1.\\n      */\\n    concat(...items: (T | ConcatArray<T>)[]): T[];\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): T[];\\n    /**\\n      * Removes the first element from an array and returns it.\\n      */\\n    shift(): T | undefined;\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): T[];\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: T, b: T) => number): this;\\n    /**\\n      * Removes elements from an array and, if necessary, inserts new elements in their place, returning the deleted elements.\\n      * @param start The zero-based location in the array from which to start removing elements.\\n      * @param deleteCount The number of elements to remove.\\n      */\\n    splice(start: number, deleteCount?: number): T[];\\n    /**\\n      * Removes elements from an array and, if necessary, inserts new elements in their place, returning the deleted elements.\\n      * @param start The zero-based location in the array from which to start removing elements.\\n      * @param deleteCount The number of elements to remove.\\n      * @param items Elements to insert into the array in place of the deleted elements.\\n      */\\n    splice(start: number, deleteCount: number, ...items: T[]): T[];\\n    /**\\n      * Inserts new elements at the start of an array.\\n      * @param items  Elements to insert at the start of the Array.\\n      */\\n    unshift(...items: T[]): number;\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at index 0.\\n      */\\n    indexOf(searchElement: T, fromIndex?: number): number;\\n    /**\\n      * Returns the index of the last occurrence of a specified value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at the last index in the array.\\n      */\\n    lastIndexOf(searchElement: T, fromIndex?: number): number;\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls the callbackfn function for each element in array1 until the callbackfn returns false, or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: T, index: number, array: T[]) => unknown, thisArg?: any): boolean;\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the callbackfn function for each element in array1 until the callbackfn returns true, or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: T, index: number, array: T[]) => unknown, thisArg?: any): boolean;\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: T, index: number, array: T[]) => void, thisArg?: any): void;\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map<U>(callbackfn: (value: T, index: number, array: T[]) => U, thisArg?: any): U[];\\n    /**\\n     * Returns the elements of an array that meet the condition specified in a callback function.\\n     * @param callbackfn A function that accepts up to three arguments. The filter method calls the callbackfn function one time for each element in the array.\\n     * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n     */\\n    filter<S extends T>(callbackfn: (value: T, index: number, array: T[]) => value is S, thisArg?: any): S[];\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: T, index: number, array: T[]) => unknown, thisArg?: any): T[];\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: T[]) => T): T;\\n    reduce(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: T[]) => T, initialValue: T): T;\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: T, currentIndex: number, array: T[]) => U, initialValue: U): U;\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: T[]) => T): T;\\n    reduceRight(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: T[]) => T, initialValue: T): T;\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: T, currentIndex: number, array: T[]) => U, initialValue: U): U;\\n\\n    [n: number]: T;\\n}\\n\\ninterface ArrayConstructor {\\n    new(arrayLength?: number): any[];\\n    new <T>(arrayLength: number): T[];\\n    new <T>(...items: T[]): T[];\\n    (arrayLength?: number): any[];\\n    <T>(arrayLength: number): T[];\\n    <T>(...items: T[]): T[];\\n    isArray(arg: any): arg is Array<any>;\\n    readonly prototype: Array<any>;\\n}\\n\\ndeclare var Array: ArrayConstructor;\\n\\ninterface TypedPropertyDescriptor<T> {\\n    enumerable?: boolean;\\n    configurable?: boolean;\\n    writable?: boolean;\\n    value?: T;\\n    get?: () => T;\\n    set?: (value: T) => void;\\n}\\n\\ndeclare type ClassDecorator = <TFunction extends Function>(target: TFunction) => TFunction | void;\\ndeclare type PropertyDecorator = (target: Object, propertyKey: string | symbol) => void;\\ndeclare type MethodDecorator = <T>(target: Object, propertyKey: string | symbol, descriptor: TypedPropertyDescriptor<T>) => TypedPropertyDescriptor<T> | void;\\ndeclare type ParameterDecorator = (target: Object, propertyKey: string | symbol, parameterIndex: number) => void;\\n\\ndeclare type PromiseConstructorLike = new <T>(executor: (resolve: (value?: T | PromiseLike<T>) => void, reject: (reason?: any) => void) => void) => PromiseLike<T>;\\n\\ninterface PromiseLike<T> {\\n    /**\\n     * Attaches callbacks for the resolution and/or rejection of the Promise.\\n     * @param onfulfilled The callback to execute when the Promise is resolved.\\n     * @param onrejected The callback to execute when the Promise is rejected.\\n     * @returns A Promise for the completion of which ever callback is executed.\\n     */\\n    then<TResult1 = T, TResult2 = never>(onfulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | undefined | null, onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null): PromiseLike<TResult1 | TResult2>;\\n}\\n\\n/**\\n * Represents the completion of an asynchronous operation\\n */\\ninterface Promise<T> {\\n    /**\\n     * Attaches callbacks for the resolution and/or rejection of the Promise.\\n     * @param onfulfilled The callback to execute when the Promise is resolved.\\n     * @param onrejected The callback to execute when the Promise is rejected.\\n     * @returns A Promise for the completion of which ever callback is executed.\\n     */\\n    then<TResult1 = T, TResult2 = never>(onfulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | undefined | null, onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null): Promise<TResult1 | TResult2>;\\n\\n    /**\\n     * Attaches a callback for only the rejection of the Promise.\\n     * @param onrejected The callback to execute when the Promise is rejected.\\n     * @returns A Promise for the completion of the callback.\\n     */\\n    catch<TResult = never>(onrejected?: ((reason: any) => TResult | PromiseLike<TResult>) | undefined | null): Promise<T | TResult>;\\n}\\n\\ninterface ArrayLike<T> {\\n    readonly length: number;\\n    readonly [n: number]: T;\\n}\\n\\n/**\\n * Make all properties in T optional\\n */\\ntype Partial<T> = {\\n    [P in keyof T]?: T[P];\\n};\\n\\n/**\\n * Make all properties in T required\\n */\\ntype Required<T> = {\\n    [P in keyof T]-?: T[P];\\n};\\n\\n/**\\n * Make all properties in T readonly\\n */\\ntype Readonly<T> = {\\n    readonly [P in keyof T]: T[P];\\n};\\n\\n/**\\n * From T, pick a set of properties whose keys are in the union K\\n */\\ntype Pick<T, K extends keyof T> = {\\n    [P in K]: T[P];\\n};\\n\\n/**\\n * Construct a type with a set of properties K of type T\\n */\\ntype Record<K extends keyof any, T> = {\\n    [P in K]: T;\\n};\\n\\n/**\\n * Exclude from T those types that are assignable to U\\n */\\ntype Exclude<T, U> = T extends U ? never : T;\\n\\n/**\\n * Extract from T those types that are assignable to U\\n */\\ntype Extract<T, U> = T extends U ? T : never;\\n\\n/**\\n * Construct a type with the properties of T except for those in type K.\\n */\\ntype Omit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>;\\n\\n/**\\n * Exclude null and undefined from T\\n */\\ntype NonNullable<T> = T extends null | undefined ? never : T;\\n\\n/**\\n * Obtain the parameters of a function type in a tuple\\n */\\ntype Parameters<T extends (...args: any) => any> = T extends (...args: infer P) => any ? P : never;\\n\\n/**\\n * Obtain the parameters of a constructor function type in a tuple\\n */\\ntype ConstructorParameters<T extends new (...args: any) => any> = T extends new (...args: infer P) => any ? P : never;\\n\\n/**\\n * Obtain the return type of a function type\\n */\\ntype ReturnType<T extends (...args: any) => any> = T extends (...args: any) => infer R ? R : any;\\n\\n/**\\n * Obtain the return type of a constructor function type\\n */\\ntype InstanceType<T extends new (...args: any) => any> = T extends new (...args: any) => infer R ? R : any;\\n\\n/**\\n * Marker for contextual 'this' type\\n */\\ninterface ThisType<T> { }\\n\\n/**\\n  * Represents a raw buffer of binary data, which is used to store data for the\\n  * different typed arrays. ArrayBuffers cannot be read from or written to directly,\\n  * but can be passed to a typed array or DataView Object to interpret the raw\\n  * buffer as needed.\\n  */\\ninterface ArrayBuffer {\\n    /**\\n      * Read-only. The length of the ArrayBuffer (in bytes).\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * Returns a section of an ArrayBuffer.\\n      */\\n    slice(begin: number, end?: number): ArrayBuffer;\\n}\\n\\n/**\\n * Allowed ArrayBuffer types for the buffer of an ArrayBufferView and related Typed Arrays.\\n */\\ninterface ArrayBufferTypes {\\n    ArrayBuffer: ArrayBuffer;\\n}\\ntype ArrayBufferLike = ArrayBufferTypes[keyof ArrayBufferTypes];\\n\\ninterface ArrayBufferConstructor {\\n    readonly prototype: ArrayBuffer;\\n    new(byteLength: number): ArrayBuffer;\\n    isView(arg: any): arg is ArrayBufferView;\\n}\\ndeclare var ArrayBuffer: ArrayBufferConstructor;\\n\\ninterface ArrayBufferView {\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    byteOffset: number;\\n}\\n\\ninterface DataView {\\n    readonly buffer: ArrayBuffer;\\n    readonly byteLength: number;\\n    readonly byteOffset: number;\\n    /**\\n      * Gets the Float32 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getFloat32(byteOffset: number, littleEndian?: boolean): number;\\n\\n    /**\\n      * Gets the Float64 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getFloat64(byteOffset: number, littleEndian?: boolean): number;\\n\\n    /**\\n      * Gets the Int8 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getInt8(byteOffset: number): number;\\n\\n    /**\\n      * Gets the Int16 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getInt16(byteOffset: number, littleEndian?: boolean): number;\\n    /**\\n      * Gets the Int32 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getInt32(byteOffset: number, littleEndian?: boolean): number;\\n\\n    /**\\n      * Gets the Uint8 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getUint8(byteOffset: number): number;\\n\\n    /**\\n      * Gets the Uint16 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getUint16(byteOffset: number, littleEndian?: boolean): number;\\n\\n    /**\\n      * Gets the Uint32 value at the specified byte offset from the start of the view. There is\\n      * no alignment constraint; multi-byte values may be fetched from any offset.\\n      * @param byteOffset The place in the buffer at which the value should be retrieved.\\n      */\\n    getUint32(byteOffset: number, littleEndian?: boolean): number;\\n\\n    /**\\n      * Stores an Float32 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      * @param littleEndian If false or undefined, a big-endian value should be written,\\n      * otherwise a little-endian value should be written.\\n      */\\n    setFloat32(byteOffset: number, value: number, littleEndian?: boolean): void;\\n\\n    /**\\n      * Stores an Float64 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      * @param littleEndian If false or undefined, a big-endian value should be written,\\n      * otherwise a little-endian value should be written.\\n      */\\n    setFloat64(byteOffset: number, value: number, littleEndian?: boolean): void;\\n\\n    /**\\n      * Stores an Int8 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      */\\n    setInt8(byteOffset: number, value: number): void;\\n\\n    /**\\n      * Stores an Int16 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      * @param littleEndian If false or undefined, a big-endian value should be written,\\n      * otherwise a little-endian value should be written.\\n      */\\n    setInt16(byteOffset: number, value: number, littleEndian?: boolean): void;\\n\\n    /**\\n      * Stores an Int32 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      * @param littleEndian If false or undefined, a big-endian value should be written,\\n      * otherwise a little-endian value should be written.\\n      */\\n    setInt32(byteOffset: number, value: number, littleEndian?: boolean): void;\\n\\n    /**\\n      * Stores an Uint8 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      */\\n    setUint8(byteOffset: number, value: number): void;\\n\\n    /**\\n      * Stores an Uint16 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      * @param littleEndian If false or undefined, a big-endian value should be written,\\n      * otherwise a little-endian value should be written.\\n      */\\n    setUint16(byteOffset: number, value: number, littleEndian?: boolean): void;\\n\\n    /**\\n      * Stores an Uint32 value at the specified byte offset from the start of the view.\\n      * @param byteOffset The place in the buffer at which the value should be set.\\n      * @param value The value to set.\\n      * @param littleEndian If false or undefined, a big-endian value should be written,\\n      * otherwise a little-endian value should be written.\\n      */\\n    setUint32(byteOffset: number, value: number, littleEndian?: boolean): void;\\n}\\n\\ninterface DataViewConstructor {\\n    new(buffer: ArrayBufferLike, byteOffset?: number, byteLength?: number): DataView;\\n}\\ndeclare var DataView: DataViewConstructor;\\n\\n/**\\n  * A typed array of 8-bit integer values. The contents are initialized to 0. If the requested\\n  * number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Int8Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Int8Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Int8Array) => any, thisArg?: any): Int8Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Int8Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Int8Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Int8Array) => void, thisArg?: any): void;\\n\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Int8Array) => number, thisArg?: any): Int8Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int8Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int8Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Int8Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int8Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int8Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Int8Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Int8Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Int8Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Int8Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Int8Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Int8Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\ninterface Int8ArrayConstructor {\\n    readonly prototype: Int8Array;\\n    new(length: number): Int8Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Int8Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Int8Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Int8Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Int8Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Int8Array;\\n\\n\\n}\\ndeclare var Int8Array: Int8ArrayConstructor;\\n\\n/**\\n  * A typed array of 8-bit unsigned integer values. The contents are initialized to 0. If the\\n  * requested number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Uint8Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Uint8Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Uint8Array) => any, thisArg?: any): Uint8Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Uint8Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Uint8Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Uint8Array) => void, thisArg?: any): void;\\n\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Uint8Array) => number, thisArg?: any): Uint8Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint8Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint8Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Uint8Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Uint8Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Uint8Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Uint8Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Uint8Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Uint8ArrayConstructor {\\n    readonly prototype: Uint8Array;\\n    new(length: number): Uint8Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Uint8Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Uint8Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Uint8Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Uint8Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Uint8Array;\\n\\n}\\ndeclare var Uint8Array: Uint8ArrayConstructor;\\n\\n/**\\n  * A typed array of 8-bit unsigned integer (clamped) values. The contents are initialized to 0.\\n  * If the requested number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Uint8ClampedArray {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Uint8ClampedArray) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Uint8ClampedArray) => any, thisArg?: any): Uint8ClampedArray;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Uint8ClampedArray) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Uint8ClampedArray) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Uint8ClampedArray) => void, thisArg?: any): void;\\n\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Uint8ClampedArray) => number, thisArg?: any): Uint8ClampedArray;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8ClampedArray) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8ClampedArray) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint8ClampedArray) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8ClampedArray) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint8ClampedArray) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint8ClampedArray) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Uint8ClampedArray;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Uint8ClampedArray;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Uint8ClampedArray) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Uint8ClampedArray view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Uint8ClampedArray;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Uint8ClampedArrayConstructor {\\n    readonly prototype: Uint8ClampedArray;\\n    new(length: number): Uint8ClampedArray;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Uint8ClampedArray;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Uint8ClampedArray;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Uint8ClampedArray;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Uint8ClampedArray;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Uint8ClampedArray;\\n}\\ndeclare var Uint8ClampedArray: Uint8ClampedArrayConstructor;\\n\\n/**\\n  * A typed array of 16-bit signed integer values. The contents are initialized to 0. If the\\n  * requested number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Int16Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Int16Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Int16Array) => any, thisArg?: any): Int16Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Int16Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Int16Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Int16Array) => void, thisArg?: any): void;\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Int16Array) => number, thisArg?: any): Int16Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int16Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int16Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Int16Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int16Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int16Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Int16Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Int16Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Int16Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Int16Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Int16Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Int16Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Int16ArrayConstructor {\\n    readonly prototype: Int16Array;\\n    new(length: number): Int16Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Int16Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Int16Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Int16Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Int16Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Int16Array;\\n\\n\\n}\\ndeclare var Int16Array: Int16ArrayConstructor;\\n\\n/**\\n  * A typed array of 16-bit unsigned integer values. The contents are initialized to 0. If the\\n  * requested number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Uint16Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Uint16Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Uint16Array) => any, thisArg?: any): Uint16Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Uint16Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Uint16Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Uint16Array) => void, thisArg?: any): void;\\n\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Uint16Array) => number, thisArg?: any): Uint16Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint16Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint16Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint16Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint16Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint16Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint16Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Uint16Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Uint16Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Uint16Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Uint16Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Uint16Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Uint16ArrayConstructor {\\n    readonly prototype: Uint16Array;\\n    new(length: number): Uint16Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Uint16Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Uint16Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Uint16Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Uint16Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Uint16Array;\\n\\n\\n}\\ndeclare var Uint16Array: Uint16ArrayConstructor;\\n/**\\n  * A typed array of 32-bit signed integer values. The contents are initialized to 0. If the\\n  * requested number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Int32Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Int32Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Int32Array) => any, thisArg?: any): Int32Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Int32Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Int32Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Int32Array) => void, thisArg?: any): void;\\n\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Int32Array) => number, thisArg?: any): Int32Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int32Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int32Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Int32Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int32Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Int32Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Int32Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Int32Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Int32Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Int32Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Int32Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Int32Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Int32ArrayConstructor {\\n    readonly prototype: Int32Array;\\n    new(length: number): Int32Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Int32Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Int32Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Int32Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Int32Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Int32Array;\\n\\n}\\ndeclare var Int32Array: Int32ArrayConstructor;\\n\\n/**\\n  * A typed array of 32-bit unsigned integer values. The contents are initialized to 0. If the\\n  * requested number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Uint32Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Uint32Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Uint32Array) => any, thisArg?: any): Uint32Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Uint32Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Uint32Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Uint32Array) => void, thisArg?: any): void;\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Uint32Array) => number, thisArg?: any): Uint32Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint32Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint32Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint32Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint32Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Uint32Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Uint32Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Uint32Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Uint32Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Uint32Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Uint32Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Uint32Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Uint32ArrayConstructor {\\n    readonly prototype: Uint32Array;\\n    new(length: number): Uint32Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Uint32Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Uint32Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Uint32Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Uint32Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Uint32Array;\\n\\n}\\ndeclare var Uint32Array: Uint32ArrayConstructor;\\n\\n/**\\n  * A typed array of 32-bit float values. The contents are initialized to 0. If the requested number\\n  * of bytes could not be allocated an exception is raised.\\n  */\\ninterface Float32Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Float32Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Float32Array) => any, thisArg?: any): Float32Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Float32Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Float32Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Float32Array) => void, thisArg?: any): void;\\n\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Float32Array) => number, thisArg?: any): Float32Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float32Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float32Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Float32Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float32Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float32Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Float32Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Float32Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Float32Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Float32Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Float32Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Float32Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Float32ArrayConstructor {\\n    readonly prototype: Float32Array;\\n    new(length: number): Float32Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Float32Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Float32Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Float32Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Float32Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Float32Array;\\n\\n\\n}\\ndeclare var Float32Array: Float32ArrayConstructor;\\n\\n/**\\n  * A typed array of 64-bit float values. The contents are initialized to 0. If the requested\\n  * number of bytes could not be allocated an exception is raised.\\n  */\\ninterface Float64Array {\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * The ArrayBuffer instance referenced by the array.\\n      */\\n    readonly buffer: ArrayBufferLike;\\n\\n    /**\\n      * The length in bytes of the array.\\n      */\\n    readonly byteLength: number;\\n\\n    /**\\n      * The offset in bytes of the array.\\n      */\\n    readonly byteOffset: number;\\n\\n    /**\\n      * Returns the this object after copying a section of the array identified by start and end\\n      * to the same array starting at position target\\n      * @param target If target is negative, it is treated as length+target where length is the\\n      * length of the array.\\n      * @param start If start is negative, it is treated as length+start. If end is negative, it\\n      * is treated as length+end.\\n      * @param end If not specified, length of the this object is used as its default value.\\n      */\\n    copyWithin(target: number, start: number, end?: number): this;\\n\\n    /**\\n      * Determines whether all the members of an array satisfy the specified test.\\n      * @param callbackfn A function that accepts up to three arguments. The every method calls\\n      * the callbackfn function for each element in array1 until the callbackfn returns false,\\n      * or until the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    every(callbackfn: (value: number, index: number, array: Float64Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n        * Returns the this object after filling the section identified by start and end with value\\n        * @param value value to fill array section with\\n        * @param start index to start filling the array at. If start is negative, it is treated as\\n        * length+start where length is the length of the array.\\n        * @param end index to stop filling the array at. If end is negative, it is treated as\\n        * length+end.\\n        */\\n    fill(value: number, start?: number, end?: number): this;\\n\\n    /**\\n      * Returns the elements of an array that meet the condition specified in a callback function.\\n      * @param callbackfn A function that accepts up to three arguments. The filter method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    filter(callbackfn: (value: number, index: number, array: Float64Array) => any, thisArg?: any): Float64Array;\\n\\n    /**\\n      * Returns the value of the first element in the array where predicate is true, and undefined\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found, find\\n      * immediately returns that element value. Otherwise, find returns undefined.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    find(predicate: (value: number, index: number, obj: Float64Array) => boolean, thisArg?: any): number | undefined;\\n\\n    /**\\n      * Returns the index of the first element in the array where predicate is true, and -1\\n      * otherwise.\\n      * @param predicate find calls predicate once for each element of the array, in ascending\\n      * order, until it finds one where predicate returns true. If such an element is found,\\n      * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\\n      * @param thisArg If provided, it will be used as the this value for each invocation of\\n      * predicate. If it is not provided, undefined is used instead.\\n      */\\n    findIndex(predicate: (value: number, index: number, obj: Float64Array) => boolean, thisArg?: any): number;\\n\\n    /**\\n      * Performs the specified action for each element in an array.\\n      * @param callbackfn  A function that accepts up to three arguments. forEach calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg  An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    forEach(callbackfn: (value: number, index: number, array: Float64Array) => void, thisArg?: any): void;\\n\\n    /**\\n      * Returns the index of the first occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      *  search starts at index 0.\\n      */\\n    indexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * Adds all the elements of an array separated by the specified separator string.\\n      * @param separator A string used to separate one element of an array from the next in the\\n      * resulting String. If omitted, the array elements are separated with a comma.\\n      */\\n    join(separator?: string): string;\\n\\n    /**\\n      * Returns the index of the last occurrence of a value in an array.\\n      * @param searchElement The value to locate in the array.\\n      * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the\\n      * search starts at index 0.\\n      */\\n    lastIndexOf(searchElement: number, fromIndex?: number): number;\\n\\n    /**\\n      * The length of the array.\\n      */\\n    readonly length: number;\\n\\n    /**\\n      * Calls a defined callback function on each element of an array, and returns an array that\\n      * contains the results.\\n      * @param callbackfn A function that accepts up to three arguments. The map method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    map(callbackfn: (value: number, index: number, array: Float64Array) => number, thisArg?: any): Float64Array;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float64Array) => number): number;\\n    reduce(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float64Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array. The return value of\\n      * the callback function is the accumulated result, and is provided as an argument in the next\\n      * call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduce method calls the\\n      * callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduce<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Float64Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an\\n      * argument instead of an array value.\\n      */\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float64Array) => number): number;\\n    reduceRight(callbackfn: (previousValue: number, currentValue: number, currentIndex: number, array: Float64Array) => number, initialValue: number): number;\\n\\n    /**\\n      * Calls the specified callback function for all the elements in an array, in descending order.\\n      * The return value of the callback function is the accumulated result, and is provided as an\\n      * argument in the next call to the callback function.\\n      * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls\\n      * the callbackfn function one time for each element in the array.\\n      * @param initialValue If initialValue is specified, it is used as the initial value to start\\n      * the accumulation. The first call to the callbackfn function provides this value as an argument\\n      * instead of an array value.\\n      */\\n    reduceRight<U>(callbackfn: (previousValue: U, currentValue: number, currentIndex: number, array: Float64Array) => U, initialValue: U): U;\\n\\n    /**\\n      * Reverses the elements in an Array.\\n      */\\n    reverse(): Float64Array;\\n\\n    /**\\n      * Sets a value or an array of values.\\n      * @param array A typed or untyped array of values to set.\\n      * @param offset The index in the current array at which the values are to be written.\\n      */\\n    set(array: ArrayLike<number>, offset?: number): void;\\n\\n    /**\\n      * Returns a section of an array.\\n      * @param start The beginning of the specified portion of the array.\\n      * @param end The end of the specified portion of the array.\\n      */\\n    slice(start?: number, end?: number): Float64Array;\\n\\n    /**\\n      * Determines whether the specified callback function returns true for any element of an array.\\n      * @param callbackfn A function that accepts up to three arguments. The some method calls the\\n      * callbackfn function for each element in array1 until the callbackfn returns true, or until\\n      * the end of the array.\\n      * @param thisArg An object to which the this keyword can refer in the callbackfn function.\\n      * If thisArg is omitted, undefined is used as the this value.\\n      */\\n    some(callbackfn: (value: number, index: number, array: Float64Array) => boolean, thisArg?: any): boolean;\\n\\n    /**\\n      * Sorts an array.\\n      * @param compareFn The name of the function used to determine the order of the elements. If\\n      * omitted, the elements are sorted in ascending, ASCII character order.\\n      */\\n    sort(compareFn?: (a: number, b: number) => number): this;\\n\\n    /**\\n      * Gets a new Float64Array view of the ArrayBuffer store for this array, referencing the elements\\n      * at begin, inclusive, up to end, exclusive.\\n      * @param begin The index of the beginning of the array.\\n      * @param end The index of the end of the array.\\n      */\\n    subarray(begin: number, end?: number): Float64Array;\\n\\n    /**\\n      * Converts a number to a string by using the current locale.\\n      */\\n    toLocaleString(): string;\\n\\n    /**\\n      * Returns a string representation of an array.\\n      */\\n    toString(): string;\\n\\n    [index: number]: number;\\n}\\n\\ninterface Float64ArrayConstructor {\\n    readonly prototype: Float64Array;\\n    new(length: number): Float64Array;\\n    new(arrayOrArrayBuffer: ArrayLike<number> | ArrayBufferLike): Float64Array;\\n    new(buffer: ArrayBufferLike, byteOffset: number, length?: number): Float64Array;\\n\\n    /**\\n      * The size in bytes of each element in the array.\\n      */\\n    readonly BYTES_PER_ELEMENT: number;\\n\\n    /**\\n      * Returns a new array from a set of elements.\\n      * @param items A set of elements to include in the new array object.\\n      */\\n    of(...items: number[]): Float64Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      */\\n    from(arrayLike: ArrayLike<number>): Float64Array;\\n\\n    /**\\n      * Creates an array from an array-like or iterable object.\\n      * @param arrayLike An array-like or iterable object to convert to an array.\\n      * @param mapfn A mapping function to call on every element of the array.\\n      * @param thisArg Value of 'this' used to invoke the mapfn.\\n      */\\n    from<T>(arrayLike: ArrayLike<T>, mapfn: (v: T, k: number) => number, thisArg?: any): Float64Array;\\n\\n}\\ndeclare var Float64Array: Float64ArrayConstructor;\\n\\n/////////////////////////////\\n/// ECMAScript Internationalization API\\n/////////////////////////////\\n\\ndeclare namespace Intl {\\n    interface CollatorOptions {\\n        usage?: string;\\n        localeMatcher?: string;\\n        numeric?: boolean;\\n        caseFirst?: string;\\n        sensitivity?: string;\\n        ignorePunctuation?: boolean;\\n    }\\n\\n    interface ResolvedCollatorOptions {\\n        locale: string;\\n        usage: string;\\n        sensitivity: string;\\n        ignorePunctuation: boolean;\\n        collation: string;\\n        caseFirst: string;\\n        numeric: boolean;\\n    }\\n\\n    interface Collator {\\n        compare(x: string, y: string): number;\\n        resolvedOptions(): ResolvedCollatorOptions;\\n    }\\n    var Collator: {\\n        new(locales?: string | string[], options?: CollatorOptions): Collator;\\n        (locales?: string | string[], options?: CollatorOptions): Collator;\\n        supportedLocalesOf(locales: string | string[], options?: CollatorOptions): string[];\\n    };\\n\\n    interface NumberFormatOptions {\\n        localeMatcher?: string;\\n        style?: string;\\n        currency?: string;\\n        currencyDisplay?: string;\\n        useGrouping?: boolean;\\n        minimumIntegerDigits?: number;\\n        minimumFractionDigits?: number;\\n        maximumFractionDigits?: number;\\n        minimumSignificantDigits?: number;\\n        maximumSignificantDigits?: number;\\n    }\\n\\n    interface ResolvedNumberFormatOptions {\\n        locale: string;\\n        numberingSystem: string;\\n        style: string;\\n        currency?: string;\\n        currencyDisplay?: string;\\n        minimumIntegerDigits: number;\\n        minimumFractionDigits: number;\\n        maximumFractionDigits: number;\\n        minimumSignificantDigits?: number;\\n        maximumSignificantDigits?: number;\\n        useGrouping: boolean;\\n    }\\n\\n    interface NumberFormat {\\n        format(value: number): string;\\n        resolvedOptions(): ResolvedNumberFormatOptions;\\n    }\\n    var NumberFormat: {\\n        new(locales?: string | string[], options?: NumberFormatOptions): NumberFormat;\\n        (locales?: string | string[], options?: NumberFormatOptions): NumberFormat;\\n        supportedLocalesOf(locales: string | string[], options?: NumberFormatOptions): string[];\\n    };\\n\\n    interface DateTimeFormatOptions {\\n        localeMatcher?: string;\\n        weekday?: string;\\n        era?: string;\\n        year?: string;\\n        month?: string;\\n        day?: string;\\n        hour?: string;\\n        minute?: string;\\n        second?: string;\\n        timeZoneName?: string;\\n        formatMatcher?: string;\\n        hour12?: boolean;\\n        timeZone?: string;\\n    }\\n\\n    interface ResolvedDateTimeFormatOptions {\\n        locale: string;\\n        calendar: string;\\n        numberingSystem: string;\\n        timeZone: string;\\n        hour12?: boolean;\\n        weekday?: string;\\n        era?: string;\\n        year?: string;\\n        month?: string;\\n        day?: string;\\n        hour?: string;\\n        minute?: string;\\n        second?: string;\\n        timeZoneName?: string;\\n    }\\n\\n    interface DateTimeFormat {\\n        format(date?: Date | number): string;\\n        resolvedOptions(): ResolvedDateTimeFormatOptions;\\n    }\\n    var DateTimeFormat: {\\n        new(locales?: string | string[], options?: DateTimeFormatOptions): DateTimeFormat;\\n        (locales?: string | string[], options?: DateTimeFormatOptions): DateTimeFormat;\\n        supportedLocalesOf(locales: string | string[], options?: DateTimeFormatOptions): string[];\\n    };\\n}\\n\\ninterface String {\\n    /**\\n      * Determines whether two strings are equivalent in the current or specified locale.\\n      * @param that String to compare to target string\\n      * @param locales A locale string or array of locale strings that contain one or more language or locale tags. If you include more than one locale string, list them in descending order of priority so that the first entry is the preferred locale. If you omit this parameter, the default locale of the JavaScript runtime is used. This parameter must conform to BCP 47 standards; see the Intl.Collator object for details.\\n      * @param options An object that contains one or more properties that specify comparison options. see the Intl.Collator object for details.\\n      */\\n    localeCompare(that: string, locales?: string | string[], options?: Intl.CollatorOptions): number;\\n}\\n\\ninterface Number {\\n    /**\\n      * Converts a number to a string by using the current or specified locale.\\n      * @param locales A locale string or array of locale strings that contain one or more language or locale tags. If you include more than one locale string, list them in descending order of priority so that the first entry is the preferred locale. If you omit this parameter, the default locale of the JavaScript runtime is used.\\n      * @param options An object that contains one or more properties that specify comparison options.\\n      */\\n    toLocaleString(locales?: string | string[], options?: Intl.NumberFormatOptions): string;\\n}\\n\\ninterface Date {\\n    /**\\n      * Converts a date and time to a string by using the current or specified locale.\\n      * @param locales A locale string or array of locale strings that contain one or more language or locale tags. If you include more than one locale string, list them in descending order of priority so that the first entry is the preferred locale. If you omit this parameter, the default locale of the JavaScript runtime is used.\\n      * @param options An object that contains one or more properties that specify comparison options.\\n      */\\n    toLocaleString(locales?: string | string[], options?: Intl.DateTimeFormatOptions): string;\\n    /**\\n      * Converts a date to a string by using the current or specified locale.\\n      * @param locales A locale string or array of locale strings that contain one or more language or locale tags. If you include more than one locale string, list them in descending order of priority so that the first entry is the preferred locale. If you omit this parameter, the default locale of the JavaScript runtime is used.\\n      * @param options An object that contains one or more properties that specify comparison options.\\n      */\\n    toLocaleDateString(locales?: string | string[], options?: Intl.DateTimeFormatOptions): string;\\n\\n    /**\\n      * Converts a time to a string by using the current or specified locale.\\n      * @param locales A locale string or array of locale strings that contain one or more language or locale tags. If you include more than one locale string, list them in descending order of priority so that the first entry is the preferred locale. If you omit this parameter, the default locale of the JavaScript runtime is used.\\n      * @param options An object that contains one or more properties that specify comparison options.\\n      */\\n    toLocaleTimeString(locales?: string | string[], options?: Intl.DateTimeFormatOptions): string;\\n}\\n\";\n\nconst lib_es2015_dts = `/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n${lib_es5_dts}${lib_es2015_core_dts}${lib_es2015_collection_dts}${lib_es2015_iterable_dts}${lib_es2015_proxy_dts}${lib_es2015_reflect_dts}${lib_es2015_symbol_dts}${lib_es2015_symbol_wellknown_dts}`;\n\nexport const lib_es6_dts = `/*! *****************************************************************************\\nCopyright (c) Microsoft Corporation. All rights reserved. \\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\\nthis file except in compliance with the License. You may obtain a copy of the\\nLicense at http://www.apache.org/licenses/LICENSE-2.0  \\n \\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, \\nMERCHANTABLITY OR NON-INFRINGEMENT. \\n \\nSee the Apache Version 2.0 License for specific language governing permissions\\nand limitations under the License.\\n***************************************************************************** */\\n\\n\\n\\n/// <reference no-default-lib=\"true\"/>\\n\\n${lib_es2015_dts}\\n\\n${lib_logger}`;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport const DEPRECATED__ros_lib_filename = \"DEPRECATED__ros/index.d.ts\";\nexport const DEPRECATED__ros_lib_dts = `\nexport declare type RGBA = { // all values are scaled between 0-1 instead of 0-255\n  r: number,\n  g: number,\n  b: number,\n  a: number // opacity -- typically you should set this to 1.\n};\n\nexport declare type Time = {\n  sec: number,\n  nsec: number\n}\n\nexport declare type Message<T> = {\n  topic: string,\n  receiveTime: Time,\n  message: T,\n}\n\nexport declare type Header = {\n  frame_id: string,\n  stamp: Time,\n};\n\nexport declare type Point = {\n  x: number,\n  y: number,\n  z: number\n};\n\nexport declare type Scale = {\n  x: number,\n  y: number,\n  z: number\n};\n\nexport declare type Orientation = {\n  x: number,\n  y: number,\n  z: number,\n  w: number\n};\n\nexport declare type Pose = {\n  position: Point,\n  orientation: Orientation\n};\n\n/**\n * For publishing markers, every other marker is built up on this base type.\n * The 'id' property has to be unique, as duplicate ids will cause markers to\n * be overwritten. The 'ns' property corresponds to namespace under which your\n * marker is published. In most cases, you will just want to set the 'action'\n * property to '0'.\n  */\nexport declare type BaseMarker = {\n  header: Header,\n  ns: string, // namespace that your marker is published under.\n  id: string | number, // IMPORTANT: Needs to be unique. Duplicate ids will overwrite other markers.\n  action: 0 | 1 | 2 | 3, // In most cases, you will want to use '0' here.\n  pose: Pose,\n  scale: Scale,\n  color?: RGBA,\n  metadata?: { [key: string]: any }\n};\n\n/**\n * When publishing markers with a 'points' array, the 'color' field takes 1 RGBA object to apply to all points,\n * while the 'colors' field takes in an array of RGBA objects to apply to each point. When both are present,\n * the 'colors' field overrides the 'color' field.\n  */\nexport declare type MultiPointMarker = BaseMarker & {\n  points: Point[]\n  colors?: RGBA[]\n};\n\n/**\n * When publishing markers with a 'points' array, the 'color' field takes 1 RGBA object to apply to all points,\n * while the 'colors' field takes in an array of RGBA objects to apply to each point. When both are present,\n * the 'colors' field overrides the 'color' field.\n  */\nexport declare type ArrowMarker = BaseMarker & {\n  type: 0,\n  points?: Point[],\n  size?: ArrowSize,\n}\n\nexport declare type ArrowSize = {\n  shaftWidth: number,\n  headLength: number,\n  headWidth: number\n};\n\nexport declare type CubeMarker = BaseMarker & {\n  type: 1\n};\n\nexport declare type CubeListMarker = MultiPointMarker & {\n  type: 6\n};\n\nexport declare type SphereMarker = BaseMarker & {\n  type: 2\n};\n\nexport declare type SphereListMarker = MultiPointMarker & {\n  type: 7\n};\n\nexport declare type CylinderMarker = BaseMarker & {\n  type: 3\n};\n\nexport declare type LineStripMarker = MultiPointMarker & {\n  type: 4\n};\n\nexport declare type LineListMarker = MultiPointMarker & {\n  type: 5\n};\n\nexport declare type PointsMarker = MultiPointMarker & {\n  type: 8\n};\n\nexport declare type TextMarker = BaseMarker & {\n  type: 9,\n  text: string\n};\n\nexport declare type TriangleListMarker = MultiPointMarker & {\n  type: 11\n};\n\nexport declare type MeshMarker = MultiPointMarker & {\n  type: 10\n};\n\nexport declare type FilledPolygonMarker = MultiPointMarker & {\n  type: 107\n};\n`;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport colors from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/colors.ts\";\nimport lodash from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/lodash.ts\";\nimport markers from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/markers.ts\";\nimport pointClouds from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/pointClouds.ts\";\nimport readers from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/readers.ts\";\nimport time from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/time.ts\";\nimport types from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/types.ts\";\nimport vectors from \"webviz-core/src/players/UserNodePlayer/nodeTransformerWorker/typescript/userUtils/vectors.ts\";\n\nexport default [\n  { fileName: \"colors.ts\", sourceCode: colors },\n  { fileName: \"lodash.ts\", sourceCode: lodash },\n  { fileName: \"markers.ts\", sourceCode: markers },\n  { fileName: \"pointClouds.ts\", sourceCode: pointClouds },\n  { fileName: \"readers.ts\", sourceCode: readers },\n  { fileName: \"time.ts\", sourceCode: time },\n  { fileName: \"types.ts\", sourceCode: types },\n  { fileName: \"vectors.ts\", sourceCode: vectors },\n];\n","module.exports = \"//\\n//  Copyright (c) 2021-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\nimport { RGBA } from \\\"./types\\\";\\n\\nexport const COLORS = {\\n  DARK: { r: 0.03, g: 0.03, b: 0.04, a: 1 },\\n  DARK1: { r: 0.07, g: 0.07, b: 0.08, a: 1 },\\n  DARK2: { r: 0.1, g: 0.1, b: 0.12, a: 1 },\\n  DARK3: { r: 0.14, g: 0.14, b: 0.16, a: 1 },\\n  DARK4: { r: 0.18, g: 0.18, b: 0.2, a: 1 },\\n  DARK5: { r: 0.21, g: 0.21, b: 0.24, a: 1 },\\n  DARK6: { r: 0.25, g: 0.25, b: 0.28, a: 1 },\\n  DARK7: { r: 0.29, g: 0.29, b: 0.32, a: 1 },\\n  DARK8: { r: 0.33, g: 0.33, b: 0.36, a: 1 },\\n  DARK9: { r: 0.38, g: 0.38, b: 0.4, a: 1 },\\n  LIGHT: { r: 1.0, g: 1.0, b: 1.0, a: 1 },\\n  LIGHT1: { r: 0.94, g: 0.94, b: 0.94, a: 1 },\\n  LIGHT2: { r: 0.79, g: 0.79, b: 0.8, a: 1 },\\n  GRAY: { r: 0.62, g: 0.62, b: 0.64, a: 1 },\\n  GRAY2: { r: 0.18, g: 0.17, b: 0.2, a: 1 },\\n  MAGENTAL1: { r: 0.88, g: 0.37, b: 0.98, a: 1 },\\n  MAGENTA: { r: 0.78, g: 0.24, b: 0.92, a: 1 },\\n  MAGENTA1: { r: 0.69, g: 0.14, b: 0.84, a: 1 },\\n  PURPLEL1: { r: 0.6, g: 0.53, b: 1.0, a: 1 },\\n  PURPLE: { r: 0.49, g: 0.42, b: 1.0, a: 1 },\\n  PURPLE1: { r: 0.41, g: 0.35, b: 0.96, a: 1 },\\n  BLUEL1: { r: 0.27, g: 0.65, b: 1.0, a: 1 },\\n  BLUE: { r: 0.14, g: 0.56, b: 1.0, a: 1 },\\n  BLUE1: { r: 0.06, g: 0.44, b: 0.95, a: 1 },\\n  TEALL1: { r: 0.16, g: 0.75, b: 0.82, a: 1 },\\n  TEAL: { r: 0.0, g: 0.66, b: 0.76, a: 1 },\\n  TEAL1: { r: 0.0, g: 0.56, b: 0.68, a: 1 },\\n  GREENL1: { r: 0.1, g: 0.74, b: 0.54, a: 1 },\\n  GREEN: { r: 0.0, g: 0.64, b: 0.46, a: 1 },\\n  GREEN1: { r: 0.0, g: 0.53, b: 0.41, a: 1 },\\n  LIMEL1: { r: 0.42, g: 0.84, b: 0.44, a: 1 },\\n  LIME: { r: 0.29, g: 0.76, b: 0.32, a: 1 },\\n  LIME1: { r: 0.19, g: 0.68, b: 0.29, a: 1 },\\n  YELLOWL1: { r: 0.96, g: 0.83, b: 0.35, a: 1 },\\n  YELLOW: { r: 0.97, g: 0.75, b: 0.0, a: 1 },\\n  YELLOW1: { r: 0.92, g: 0.66, b: 0.0, a: 1 },\\n  ORANGEL1: { r: 0.99, g: 0.54, b: 0.26, a: 1 },\\n  ORANGE: { r: 0.97, g: 0.42, b: 0.11, a: 1 },\\n  ORANGE1: { r: 0.9, g: 0.33, b: 0.04, a: 1 },\\n  REDL1: { r: 1.0, g: 0.42, b: 0.51, a: 1 },\\n  RED: { r: 0.96, g: 0.29, b: 0.4, a: 1 },\\n  RED1: { r: 0.86, g: 0.21, b: 0.33, a: 1 },\\n  RED2: { r: 1.0, g: 0.49, b: 0.59, a: 1 },\\n};\\n\\nexport const SEMANTIC_CLASS_TO_COLOR_MAP = {\\n  \\\"1\\\": COLORS.BLUE, // CAR\\n  \\\"2\\\": COLORS.TEAL, // HUMAN\\n  \\\"3\\\": COLORS.PURPLE, // BIKE\\n  \\\"4\\\": COLORS.PURPLE1, // MOTORCYCLE\\n  \\\"5\\\": COLORS.BLUE, // TRUCK\\n  \\\"6\\\": COLORS.BLUE, // BUS\\n  \\\"7\\\": COLORS.BLUE, // SCHOOL_BUS\\n  \\\"8\\\": COLORS.RED, // EMV\\n  \\\"9\\\": COLORS.BLUE, // TRAIN\\n  \\\"10\\\": COLORS.BLUE, // ANIMAL\\n  \\\"2000\\\": COLORS.LIME, // STATIC_UNKNOWN\\n  defaultColor: COLORS.LIME,\\n};\\n\\nexport type HSL = {\\n  h: number;\\n  s: number;\\n  l: number;\\n};\\n\\n/**\\n* \\\"Rotates\\\" the given color around the HSL color wheel by an amount between 0 and 1\\n* Similar to CSS hue-rotate() function: https://www.quackit.com/css/functions/css_hue-rotate_function.cfm\\n*/\\nexport function rotateHue(color: RGBA, amount: number): RGBA {\\n  const { h, s, l } = rgbToHsl(color);\\n  const { r, g, b } = hslToRgb({ h: (h + amount + 1) % 1, s, l });\\n  return { r, g, b, a: color.a };\\n}\\n\\n/**\\n* Converts an RGBA color into a hue-saturation-luminance (HSL) color\\n*/\\nexport function rgbToHsl(rgbColor: RGBA): HSL {\\n  const { r, g, b } = rgbColor;\\n  const max = Math.max(r, g, b);\\n  const min = Math.min(r, g, b);\\n  const l = (max + min) / 2;\\n  let h = 0;\\n  let s;\\n\\n  if (Math.abs(max - min) <= 0.001) {\\n    h = s = 0; // achromatic\\n  } else {\\n    const d = max - min;\\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\\n\\n    switch (max) {\\n      case r:\\n        h = (g - b) / d + (g < b ? 6 : 0);\\n        break;\\n      case g:\\n        h = (b - r) / d + 2;\\n        break;\\n      case b:\\n        h = (r - g) / d + 4;\\n        break;\\n    }\\n    h /= 6;\\n  }\\n  return { h, s, l };\\n}\\n\\n/**\\n* Converts an HSL color into a RGBA color\\n*/\\nexport function hslToRgb(color: HSL): RGBA {\\n  const { h, s, l } = color;\\n  let r, g, b;\\n\\n  if (s === 0) {\\n    r = g = b = l; // achromatic\\n  } else {\\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\\n    const p = 2 * l - q;\\n    r = hueToColorComponent(p, q, h + 1 / 3);\\n    g = hueToColorComponent(p, q, h);\\n    b = hueToColorComponent(p, q, h - 1 / 3);\\n  }\\n  return { r, g, b, a: 1 };\\n}\\n\\nfunction hueToColorComponent(p: number, q: number, tRaw: number): number {\\n  const t = (tRaw + 1) % 1;\\n  if (t < 1 / 6) {\\n    return p + (q - p) * 6 * t;\\n  }\\n  if (t < 1 / 2) {\\n    return q;\\n  }\\n  if (t < 2 / 3) {\\n    return p + (q - p) * (2 / 3 - t) * 6;\\n  }\\n  return p;\\n}\\n\\n/**\\n* Samples a colormap.\\n* @param colormap 256 entry rgb array\\n* @param x value between 0-1 that linearly interpolates the colormap\\n* @returns RGBA color\\n*/\\nexport function interpolateColormap(colormap: number[][], x: number): RGBA {\\n  x = Math.max(0.0, Math.min(1.0, x));\\n  const a = Math.floor(x * 255.0);\\n  const b = Math.min(255, a + 1);\\n  const f = x * 255.0 - a;\\n  return {\\n    r: colormap[a][0] + (colormap[b][0] - colormap[a][0]) * f,\\n    g: colormap[a][1] + (colormap[b][1] - colormap[a][1]) * f,\\n    b: colormap[a][2] + (colormap[b][2] - colormap[a][2]) * f,\\n    a: 1.0\\n  };\\n}\\n\\nexport const VIRIDIS_COLORMAP = [\\n  [0.267004, 0.004874, 0.329415],\\n  [0.268510, 0.009605, 0.335427],\\n  [0.269944, 0.014625, 0.341379],\\n  [0.271305, 0.019942, 0.347269],\\n  [0.272594, 0.025563, 0.353093],\\n  [0.273809, 0.031497, 0.358853],\\n  [0.274952, 0.037752, 0.364543],\\n  [0.276022, 0.044167, 0.370164],\\n  [0.277018, 0.050344, 0.375715],\\n  [0.277941, 0.056324, 0.381191],\\n  [0.278791, 0.062145, 0.386592],\\n  [0.279566, 0.067836, 0.391917],\\n  [0.280267, 0.073417, 0.397163],\\n  [0.280894, 0.078907, 0.402329],\\n  [0.281446, 0.084320, 0.407414],\\n  [0.281924, 0.089666, 0.412415],\\n  [0.282327, 0.094955, 0.417331],\\n  [0.282656, 0.100196, 0.422160],\\n  [0.282910, 0.105393, 0.426902],\\n  [0.283091, 0.110553, 0.431554],\\n  [0.283197, 0.115680, 0.436115],\\n  [0.283229, 0.120777, 0.440584],\\n  [0.283187, 0.125848, 0.444960],\\n  [0.283072, 0.130895, 0.449241],\\n  [0.282884, 0.135920, 0.453427],\\n  [0.282623, 0.140926, 0.457517],\\n  [0.282290, 0.145912, 0.461510],\\n  [0.281887, 0.150881, 0.465405],\\n  [0.281412, 0.155834, 0.469201],\\n  [0.280868, 0.160771, 0.472899],\\n  [0.280255, 0.165693, 0.476498],\\n  [0.279574, 0.170599, 0.479997],\\n  [0.278826, 0.175490, 0.483397],\\n  [0.278012, 0.180367, 0.486697],\\n  [0.277134, 0.185228, 0.489898],\\n  [0.276194, 0.190074, 0.493001],\\n  [0.275191, 0.194905, 0.496005],\\n  [0.274128, 0.199721, 0.498911],\\n  [0.273006, 0.204520, 0.501721],\\n  [0.271828, 0.209303, 0.504434],\\n  [0.270595, 0.214069, 0.507052],\\n  [0.269308, 0.218818, 0.509577],\\n  [0.267968, 0.223549, 0.512008],\\n  [0.266580, 0.228262, 0.514349],\\n  [0.265145, 0.232956, 0.516599],\\n  [0.263663, 0.237631, 0.518762],\\n  [0.262138, 0.242286, 0.520837],\\n  [0.260571, 0.246922, 0.522828],\\n  [0.258965, 0.251537, 0.524736],\\n  [0.257322, 0.256130, 0.526563],\\n  [0.255645, 0.260703, 0.528312],\\n  [0.253935, 0.265254, 0.529983],\\n  [0.252194, 0.269783, 0.531579],\\n  [0.250425, 0.274290, 0.533103],\\n  [0.248629, 0.278775, 0.534556],\\n  [0.246811, 0.283237, 0.535941],\\n  [0.244972, 0.287675, 0.537260],\\n  [0.243113, 0.292092, 0.538516],\\n  [0.241237, 0.296485, 0.539709],\\n  [0.239346, 0.300855, 0.540844],\\n  [0.237441, 0.305202, 0.541921],\\n  [0.235526, 0.309527, 0.542944],\\n  [0.233603, 0.313828, 0.543914],\\n  [0.231674, 0.318106, 0.544834],\\n  [0.229739, 0.322361, 0.545706],\\n  [0.227802, 0.326594, 0.546532],\\n  [0.225863, 0.330805, 0.547314],\\n  [0.223925, 0.334994, 0.548053],\\n  [0.221989, 0.339161, 0.548752],\\n  [0.220057, 0.343307, 0.549413],\\n  [0.218130, 0.347432, 0.550038],\\n  [0.216210, 0.351535, 0.550627],\\n  [0.214298, 0.355619, 0.551184],\\n  [0.212395, 0.359683, 0.551710],\\n  [0.210503, 0.363727, 0.552206],\\n  [0.208623, 0.367752, 0.552675],\\n  [0.206756, 0.371758, 0.553117],\\n  [0.204903, 0.375746, 0.553533],\\n  [0.203063, 0.379716, 0.553925],\\n  [0.201239, 0.383670, 0.554294],\\n  [0.199430, 0.387607, 0.554642],\\n  [0.197636, 0.391528, 0.554969],\\n  [0.195860, 0.395433, 0.555276],\\n  [0.194100, 0.399323, 0.555565],\\n  [0.192357, 0.403199, 0.555836],\\n  [0.190631, 0.407061, 0.556089],\\n  [0.188923, 0.410910, 0.556326],\\n  [0.187231, 0.414746, 0.556547],\\n  [0.185556, 0.418570, 0.556753],\\n  [0.183898, 0.422383, 0.556944],\\n  [0.182256, 0.426184, 0.557120],\\n  [0.180629, 0.429975, 0.557282],\\n  [0.179019, 0.433756, 0.557430],\\n  [0.177423, 0.437527, 0.557565],\\n  [0.175841, 0.441290, 0.557685],\\n  [0.174274, 0.445044, 0.557792],\\n  [0.172719, 0.448791, 0.557885],\\n  [0.171176, 0.452530, 0.557965],\\n  [0.169646, 0.456262, 0.558030],\\n  [0.168126, 0.459988, 0.558082],\\n  [0.166617, 0.463708, 0.558119],\\n  [0.165117, 0.467423, 0.558141],\\n  [0.163625, 0.471133, 0.558148],\\n  [0.162142, 0.474838, 0.558140],\\n  [0.160665, 0.478540, 0.558115],\\n  [0.159194, 0.482237, 0.558073],\\n  [0.157729, 0.485932, 0.558013],\\n  [0.156270, 0.489624, 0.557936],\\n  [0.154815, 0.493313, 0.557840],\\n  [0.153364, 0.497000, 0.557724],\\n  [0.151918, 0.500685, 0.557587],\\n  [0.150476, 0.504369, 0.557430],\\n  [0.149039, 0.508051, 0.557250],\\n  [0.147607, 0.511733, 0.557049],\\n  [0.146180, 0.515413, 0.556823],\\n  [0.144759, 0.519093, 0.556572],\\n  [0.143343, 0.522773, 0.556295],\\n  [0.141935, 0.526453, 0.555991],\\n  [0.140536, 0.530132, 0.555659],\\n  [0.139147, 0.533812, 0.555298],\\n  [0.137770, 0.537492, 0.554906],\\n  [0.136408, 0.541173, 0.554483],\\n  [0.135066, 0.544853, 0.554029],\\n  [0.133743, 0.548535, 0.553541],\\n  [0.132444, 0.552216, 0.553018],\\n  [0.131172, 0.555899, 0.552459],\\n  [0.129933, 0.559582, 0.551864],\\n  [0.128729, 0.563265, 0.551229],\\n  [0.127568, 0.566949, 0.550556],\\n  [0.126453, 0.570633, 0.549841],\\n  [0.125394, 0.574318, 0.549086],\\n  [0.124395, 0.578002, 0.548287],\\n  [0.123463, 0.581687, 0.547445],\\n  [0.122606, 0.585371, 0.546557],\\n  [0.121831, 0.589055, 0.545623],\\n  [0.121148, 0.592739, 0.544641],\\n  [0.120565, 0.596422, 0.543611],\\n  [0.120092, 0.600104, 0.542530],\\n  [0.119738, 0.603785, 0.541400],\\n  [0.119512, 0.607464, 0.540218],\\n  [0.119423, 0.611141, 0.538982],\\n  [0.119483, 0.614817, 0.537692],\\n  [0.119699, 0.618490, 0.536347],\\n  [0.120081, 0.622161, 0.534946],\\n  [0.120638, 0.625828, 0.533488],\\n  [0.121380, 0.629492, 0.531973],\\n  [0.122312, 0.633153, 0.530398],\\n  [0.123444, 0.636809, 0.528763],\\n  [0.124780, 0.640461, 0.527068],\\n  [0.126326, 0.644107, 0.525311],\\n  [0.128087, 0.647749, 0.523491],\\n  [0.130067, 0.651384, 0.521608],\\n  [0.132268, 0.655014, 0.519661],\\n  [0.134692, 0.658636, 0.517649],\\n  [0.137339, 0.662252, 0.515571],\\n  [0.140210, 0.665859, 0.513427],\\n  [0.143303, 0.669459, 0.511215],\\n  [0.146616, 0.673050, 0.508936],\\n  [0.150148, 0.676631, 0.506589],\\n  [0.153894, 0.680203, 0.504172],\\n  [0.157851, 0.683765, 0.501686],\\n  [0.162016, 0.687316, 0.499129],\\n  [0.166383, 0.690856, 0.496502],\\n  [0.170948, 0.694384, 0.493803],\\n  [0.175707, 0.697900, 0.491033],\\n  [0.180653, 0.701402, 0.488189],\\n  [0.185783, 0.704891, 0.485273],\\n  [0.191090, 0.708366, 0.482284],\\n  [0.196571, 0.711827, 0.479221],\\n  [0.202219, 0.715272, 0.476084],\\n  [0.208030, 0.718701, 0.472873],\\n  [0.214000, 0.722114, 0.469588],\\n  [0.220124, 0.725509, 0.466226],\\n  [0.226397, 0.728888, 0.462789],\\n  [0.232815, 0.732247, 0.459277],\\n  [0.239374, 0.735588, 0.455688],\\n  [0.246070, 0.738910, 0.452024],\\n  [0.252899, 0.742211, 0.448284],\\n  [0.259857, 0.745492, 0.444467],\\n  [0.266941, 0.748751, 0.440573],\\n  [0.274149, 0.751988, 0.436601],\\n  [0.281477, 0.755203, 0.432552],\\n  [0.288921, 0.758394, 0.428426],\\n  [0.296479, 0.761561, 0.424223],\\n  [0.304148, 0.764704, 0.419943],\\n  [0.311925, 0.767822, 0.415586],\\n  [0.319809, 0.770914, 0.411152],\\n  [0.327796, 0.773980, 0.406640],\\n  [0.335885, 0.777018, 0.402049],\\n  [0.344074, 0.780029, 0.397381],\\n  [0.352360, 0.783011, 0.392636],\\n  [0.360741, 0.785964, 0.387814],\\n  [0.369214, 0.788888, 0.382914],\\n  [0.377779, 0.791781, 0.377939],\\n  [0.386433, 0.794644, 0.372886],\\n  [0.395174, 0.797475, 0.367757],\\n  [0.404001, 0.800275, 0.362552],\\n  [0.412913, 0.803041, 0.357269],\\n  [0.421908, 0.805774, 0.351910],\\n  [0.430983, 0.808473, 0.346476],\\n  [0.440137, 0.811138, 0.340967],\\n  [0.449368, 0.813768, 0.335384],\\n  [0.458674, 0.816363, 0.329727],\\n  [0.468053, 0.818921, 0.323998],\\n  [0.477504, 0.821444, 0.318195],\\n  [0.487026, 0.823929, 0.312321],\\n  [0.496615, 0.826376, 0.306377],\\n  [0.506271, 0.828786, 0.300362],\\n  [0.515992, 0.831158, 0.294279],\\n  [0.525776, 0.833491, 0.288127],\\n  [0.535621, 0.835785, 0.281908],\\n  [0.545524, 0.838039, 0.275626],\\n  [0.555484, 0.840254, 0.269281],\\n  [0.565498, 0.842430, 0.262877],\\n  [0.575563, 0.844566, 0.256415],\\n  [0.585678, 0.846661, 0.249897],\\n  [0.595839, 0.848717, 0.243329],\\n  [0.606045, 0.850733, 0.236712],\\n  [0.616293, 0.852709, 0.230052],\\n  [0.626579, 0.854645, 0.223353],\\n  [0.636902, 0.856542, 0.216620],\\n  [0.647257, 0.858400, 0.209861],\\n  [0.657642, 0.860219, 0.203082],\\n  [0.668054, 0.861999, 0.196293],\\n  [0.678489, 0.863742, 0.189503],\\n  [0.688944, 0.865448, 0.182725],\\n  [0.699415, 0.867117, 0.175971],\\n  [0.709898, 0.868751, 0.169257],\\n  [0.720391, 0.870350, 0.162603],\\n  [0.730889, 0.871916, 0.156029],\\n  [0.741388, 0.873449, 0.149561],\\n  [0.751884, 0.874951, 0.143228],\\n  [0.762373, 0.876424, 0.137064],\\n  [0.772852, 0.877868, 0.131109],\\n  [0.783315, 0.879285, 0.125405],\\n  [0.793760, 0.880678, 0.120005],\\n  [0.804182, 0.882046, 0.114965],\\n  [0.814576, 0.883393, 0.110347],\\n  [0.824940, 0.884720, 0.106217],\\n  [0.835270, 0.886029, 0.102646],\\n  [0.845561, 0.887322, 0.099702],\\n  [0.855810, 0.888601, 0.097452],\\n  [0.866013, 0.889868, 0.095953],\\n  [0.876168, 0.891125, 0.095250],\\n  [0.886271, 0.892374, 0.095374],\\n  [0.896320, 0.893616, 0.096335],\\n  [0.906311, 0.894855, 0.098125],\\n  [0.916242, 0.896091, 0.100717],\\n  [0.926106, 0.897330, 0.104071],\\n  [0.935904, 0.898570, 0.108131],\\n  [0.945636, 0.899815, 0.112838],\\n  [0.955300, 0.901065, 0.118128],\\n  [0.964894, 0.902323, 0.123941],\\n  [0.974417, 0.903590, 0.130215],\\n  [0.983868, 0.904867, 0.136897],\\n  [0.993248, 0.906157, 0.143936]\\n];\\n\\nexport const INFERNO_COLORMAP = [\\n  [0.001462, 0.000466, 0.013866],\\n  [0.002267, 0.001270, 0.018570],\\n  [0.003299, 0.002249, 0.024239],\\n  [0.004547, 0.003392, 0.030909],\\n  [0.006006, 0.004692, 0.038558],\\n  [0.007676, 0.006136, 0.046836],\\n  [0.009561, 0.007713, 0.055143],\\n  [0.011663, 0.009417, 0.063460],\\n  [0.013995, 0.011225, 0.071862],\\n  [0.016561, 0.013136, 0.080282],\\n  [0.019373, 0.015133, 0.088767],\\n  [0.022447, 0.017199, 0.097327],\\n  [0.025793, 0.019331, 0.105930],\\n  [0.029432, 0.021503, 0.114621],\\n  [0.033385, 0.023702, 0.123397],\\n  [0.037668, 0.025921, 0.132232],\\n  [0.042253, 0.028139, 0.141141],\\n  [0.046915, 0.030324, 0.150164],\\n  [0.051644, 0.032474, 0.159254],\\n  [0.056449, 0.034569, 0.168414],\\n  [0.061340, 0.036590, 0.177642],\\n  [0.066331, 0.038504, 0.186962],\\n  [0.071429, 0.040294, 0.196354],\\n  [0.076637, 0.041905, 0.205799],\\n  [0.081962, 0.043328, 0.215289],\\n  [0.087411, 0.044556, 0.224813],\\n  [0.092990, 0.045583, 0.234358],\\n  [0.098702, 0.046402, 0.243904],\\n  [0.104551, 0.047008, 0.253430],\\n  [0.110536, 0.047399, 0.262912],\\n  [0.116656, 0.047574, 0.272321],\\n  [0.122908, 0.047536, 0.281624],\\n  [0.129285, 0.047293, 0.290788],\\n  [0.135778, 0.046856, 0.299776],\\n  [0.142378, 0.046242, 0.308553],\\n  [0.149073, 0.045468, 0.317085],\\n  [0.155850, 0.044559, 0.325338],\\n  [0.162689, 0.043554, 0.333277],\\n  [0.169575, 0.042489, 0.340874],\\n  [0.176493, 0.041402, 0.348111],\\n  [0.183429, 0.040329, 0.354971],\\n  [0.190367, 0.039309, 0.361447],\\n  [0.197297, 0.038400, 0.367535],\\n  [0.204209, 0.037632, 0.373238],\\n  [0.211095, 0.037030, 0.378563],\\n  [0.217949, 0.036615, 0.383522],\\n  [0.224763, 0.036405, 0.388129],\\n  [0.231538, 0.036405, 0.392400],\\n  [0.238273, 0.036621, 0.396353],\\n  [0.244967, 0.037055, 0.400007],\\n  [0.251620, 0.037705, 0.403378],\\n  [0.258234, 0.038571, 0.406485],\\n  [0.264810, 0.039647, 0.409345],\\n  [0.271347, 0.040922, 0.411976],\\n  [0.277850, 0.042353, 0.414392],\\n  [0.284321, 0.043933, 0.416608],\\n  [0.290763, 0.045644, 0.418637],\\n  [0.297178, 0.047470, 0.420491],\\n  [0.303568, 0.049396, 0.422182],\\n  [0.309935, 0.051407, 0.423721],\\n  [0.316282, 0.053490, 0.425116],\\n  [0.322610, 0.055634, 0.426377],\\n  [0.328921, 0.057827, 0.427511],\\n  [0.335217, 0.060060, 0.428524],\\n  [0.341500, 0.062325, 0.429425],\\n  [0.347771, 0.064616, 0.430217],\\n  [0.354032, 0.066925, 0.430906],\\n  [0.360284, 0.069247, 0.431497],\\n  [0.366529, 0.071579, 0.431994],\\n  [0.372768, 0.073915, 0.432400],\\n  [0.379001, 0.076253, 0.432719],\\n  [0.385228, 0.078591, 0.432955],\\n  [0.391453, 0.080927, 0.433109],\\n  [0.397674, 0.083257, 0.433183],\\n  [0.403894, 0.085580, 0.433179],\\n  [0.410113, 0.087896, 0.433098],\\n  [0.416331, 0.090203, 0.432943],\\n  [0.422549, 0.092501, 0.432714],\\n  [0.428768, 0.094790, 0.432412],\\n  [0.434987, 0.097069, 0.432039],\\n  [0.441207, 0.099338, 0.431594],\\n  [0.447428, 0.101597, 0.431080],\\n  [0.453651, 0.103848, 0.430498],\\n  [0.459875, 0.106089, 0.429846],\\n  [0.466100, 0.108322, 0.429125],\\n  [0.472328, 0.110547, 0.428334],\\n  [0.478558, 0.112764, 0.427475],\\n  [0.484789, 0.114974, 0.426548],\\n  [0.491022, 0.117179, 0.425552],\\n  [0.497257, 0.119379, 0.424488],\\n  [0.503493, 0.121575, 0.423356],\\n  [0.509730, 0.123769, 0.422156],\\n  [0.515967, 0.125960, 0.420887],\\n  [0.522206, 0.128150, 0.419549],\\n  [0.528444, 0.130341, 0.418142],\\n  [0.534683, 0.132534, 0.416667],\\n  [0.540920, 0.134729, 0.415123],\\n  [0.547157, 0.136929, 0.413511],\\n  [0.553392, 0.139134, 0.411829],\\n  [0.559624, 0.141346, 0.410078],\\n  [0.565854, 0.143567, 0.408258],\\n  [0.572081, 0.145797, 0.406369],\\n  [0.578304, 0.148039, 0.404411],\\n  [0.584521, 0.150294, 0.402385],\\n  [0.590734, 0.152563, 0.400290],\\n  [0.596940, 0.154848, 0.398125],\\n  [0.603139, 0.157151, 0.395891],\\n  [0.609330, 0.159474, 0.393589],\\n  [0.615513, 0.161817, 0.391219],\\n  [0.621685, 0.164184, 0.388781],\\n  [0.627847, 0.166575, 0.386276],\\n  [0.633998, 0.168992, 0.383704],\\n  [0.640135, 0.171438, 0.381065],\\n  [0.646260, 0.173914, 0.378359],\\n  [0.652369, 0.176421, 0.375586],\\n  [0.658463, 0.178962, 0.372748],\\n  [0.664540, 0.181539, 0.369846],\\n  [0.670599, 0.184153, 0.366879],\\n  [0.676638, 0.186807, 0.363849],\\n  [0.682656, 0.189501, 0.360757],\\n  [0.688653, 0.192239, 0.357603],\\n  [0.694627, 0.195021, 0.354388],\\n  [0.700576, 0.197851, 0.351113],\\n  [0.706500, 0.200728, 0.347777],\\n  [0.712396, 0.203656, 0.344383],\\n  [0.718264, 0.206636, 0.340931],\\n  [0.724103, 0.209670, 0.337424],\\n  [0.729909, 0.212759, 0.333861],\\n  [0.735683, 0.215906, 0.330245],\\n  [0.741423, 0.219112, 0.326576],\\n  [0.747127, 0.222378, 0.322856],\\n  [0.752794, 0.225706, 0.319085],\\n  [0.758422, 0.229097, 0.315266],\\n  [0.764010, 0.232554, 0.311399],\\n  [0.769556, 0.236077, 0.307485],\\n  [0.775059, 0.239667, 0.303526],\\n  [0.780517, 0.243327, 0.299523],\\n  [0.785929, 0.247056, 0.295477],\\n  [0.791293, 0.250856, 0.291390],\\n  [0.796607, 0.254728, 0.287264],\\n  [0.801871, 0.258674, 0.283099],\\n  [0.807082, 0.262692, 0.278898],\\n  [0.812239, 0.266786, 0.274661],\\n  [0.817341, 0.270954, 0.270390],\\n  [0.822386, 0.275197, 0.266085],\\n  [0.827372, 0.279517, 0.261750],\\n  [0.832299, 0.283913, 0.257383],\\n  [0.837165, 0.288385, 0.252988],\\n  [0.841969, 0.292933, 0.248564],\\n  [0.846709, 0.297559, 0.244113],\\n  [0.851384, 0.302260, 0.239636],\\n  [0.855992, 0.307038, 0.235133],\\n  [0.860533, 0.311892, 0.230606],\\n  [0.865006, 0.316822, 0.226055],\\n  [0.869409, 0.321827, 0.221482],\\n  [0.873741, 0.326906, 0.216886],\\n  [0.878001, 0.332060, 0.212268],\\n  [0.882188, 0.337287, 0.207628],\\n  [0.886302, 0.342586, 0.202968],\\n  [0.890341, 0.347957, 0.198286],\\n  [0.894305, 0.353399, 0.193584],\\n  [0.898192, 0.358911, 0.188860],\\n  [0.902003, 0.364492, 0.184116],\\n  [0.905735, 0.370140, 0.179350],\\n  [0.909390, 0.375856, 0.174563],\\n  [0.912966, 0.381636, 0.169755],\\n  [0.916462, 0.387481, 0.164924],\\n  [0.919879, 0.393389, 0.160070],\\n  [0.923215, 0.399359, 0.155193],\\n  [0.926470, 0.405389, 0.150292],\\n  [0.929644, 0.411479, 0.145367],\\n  [0.932737, 0.417627, 0.140417],\\n  [0.935747, 0.423831, 0.135440],\\n  [0.938675, 0.430091, 0.130438],\\n  [0.941521, 0.436405, 0.125409],\\n  [0.944285, 0.442772, 0.120354],\\n  [0.946965, 0.449191, 0.115272],\\n  [0.949562, 0.455660, 0.110164],\\n  [0.952075, 0.462178, 0.105031],\\n  [0.954506, 0.468744, 0.099874],\\n  [0.956852, 0.475356, 0.094695],\\n  [0.959114, 0.482014, 0.089499],\\n  [0.961293, 0.488716, 0.084289],\\n  [0.963387, 0.495462, 0.079073],\\n  [0.965397, 0.502249, 0.073859],\\n  [0.967322, 0.509078, 0.068659],\\n  [0.969163, 0.515946, 0.063488],\\n  [0.970919, 0.522853, 0.058367],\\n  [0.972590, 0.529798, 0.053324],\\n  [0.974176, 0.536780, 0.048392],\\n  [0.975677, 0.543798, 0.043618],\\n  [0.977092, 0.550850, 0.039050],\\n  [0.978422, 0.557937, 0.034931],\\n  [0.979666, 0.565057, 0.031409],\\n  [0.980824, 0.572209, 0.028508],\\n  [0.981895, 0.579392, 0.026250],\\n  [0.982881, 0.586606, 0.024661],\\n  [0.983779, 0.593849, 0.023770],\\n  [0.984591, 0.601122, 0.023606],\\n  [0.985315, 0.608422, 0.024202],\\n  [0.985952, 0.615750, 0.025592],\\n  [0.986502, 0.623105, 0.027814],\\n  [0.986964, 0.630485, 0.030908],\\n  [0.987337, 0.637890, 0.034916],\\n  [0.987622, 0.645320, 0.039886],\\n  [0.987819, 0.652773, 0.045581],\\n  [0.987926, 0.660250, 0.051750],\\n  [0.987945, 0.667748, 0.058329],\\n  [0.987874, 0.675267, 0.065257],\\n  [0.987714, 0.682807, 0.072489],\\n  [0.987464, 0.690366, 0.079990],\\n  [0.987124, 0.697944, 0.087731],\\n  [0.986694, 0.705540, 0.095694],\\n  [0.986175, 0.713153, 0.103863],\\n  [0.985566, 0.720782, 0.112229],\\n  [0.984865, 0.728427, 0.120785],\\n  [0.984075, 0.736087, 0.129527],\\n  [0.983196, 0.743758, 0.138453],\\n  [0.982228, 0.751442, 0.147565],\\n  [0.981173, 0.759135, 0.156863],\\n  [0.980032, 0.766837, 0.166353],\\n  [0.978806, 0.774545, 0.176037],\\n  [0.977497, 0.782258, 0.185923],\\n  [0.976108, 0.789974, 0.196018],\\n  [0.974638, 0.797692, 0.206332],\\n  [0.973088, 0.805409, 0.216877],\\n  [0.971468, 0.813122, 0.227658],\\n  [0.969783, 0.820825, 0.238686],\\n  [0.968041, 0.828515, 0.249972],\\n  [0.966243, 0.836191, 0.261534],\\n  [0.964394, 0.843848, 0.273391],\\n  [0.962517, 0.851476, 0.285546],\\n  [0.960626, 0.859069, 0.298010],\\n  [0.958720, 0.866624, 0.310820],\\n  [0.956834, 0.874129, 0.323974],\\n  [0.954997, 0.881569, 0.337475],\\n  [0.953215, 0.888942, 0.351369],\\n  [0.951546, 0.896226, 0.365627],\\n  [0.950018, 0.903409, 0.380271],\\n  [0.948683, 0.910473, 0.395289],\\n  [0.947594, 0.917399, 0.410665],\\n  [0.946809, 0.924168, 0.426373],\\n  [0.946392, 0.930761, 0.442367],\\n  [0.946403, 0.937159, 0.458592],\\n  [0.946903, 0.943348, 0.474970],\\n  [0.947937, 0.949318, 0.491426],\\n  [0.949545, 0.955063, 0.507860],\\n  [0.951740, 0.960587, 0.524203],\\n  [0.954529, 0.965896, 0.540361],\\n  [0.957896, 0.971003, 0.556275],\\n  [0.961812, 0.975924, 0.571925],\\n  [0.966249, 0.980678, 0.587206],\\n  [0.971162, 0.985282, 0.602154],\\n  [0.976511, 0.989753, 0.616760],\\n  [0.982257, 0.994109, 0.631017],\\n  [0.988362, 0.998364, 0.644924]\\n];\\n\\nexport const TURBO_COLORMAP = [\\n  [0.189950, 0.071760, 0.232170],\\n  [0.194830, 0.083390, 0.261490],\\n  [0.199560, 0.094980, 0.290240],\\n  [0.204150, 0.106520, 0.318440],\\n  [0.208600, 0.118020, 0.346070],\\n  [0.212910, 0.129470, 0.373140],\\n  [0.217080, 0.140870, 0.399640],\\n  [0.221110, 0.152230, 0.425580],\\n  [0.225000, 0.163540, 0.450960],\\n  [0.228750, 0.174810, 0.475780],\\n  [0.232360, 0.186030, 0.500040],\\n  [0.235820, 0.197200, 0.523730],\\n  [0.239150, 0.208330, 0.546860],\\n  [0.242340, 0.219410, 0.569420],\\n  [0.245390, 0.230440, 0.591420],\\n  [0.248300, 0.241430, 0.612860],\\n  [0.251070, 0.252370, 0.633740],\\n  [0.253690, 0.263270, 0.654060],\\n  [0.256180, 0.274120, 0.673810],\\n  [0.258530, 0.284920, 0.693000],\\n  [0.260740, 0.295680, 0.711620],\\n  [0.262800, 0.306390, 0.729680],\\n  [0.264730, 0.317060, 0.747180],\\n  [0.266520, 0.327680, 0.764120],\\n  [0.268160, 0.338250, 0.780500],\\n  [0.269670, 0.348780, 0.796310],\\n  [0.271030, 0.359260, 0.811560],\\n  [0.272260, 0.369700, 0.826240],\\n  [0.273340, 0.380080, 0.840370],\\n  [0.274290, 0.390430, 0.853930],\\n  [0.275090, 0.400720, 0.866920],\\n  [0.275760, 0.410970, 0.879360],\\n  [0.276280, 0.421180, 0.891230],\\n  [0.276670, 0.431340, 0.902540],\\n  [0.276910, 0.441450, 0.913280],\\n  [0.277010, 0.451520, 0.923470],\\n  [0.276980, 0.461530, 0.933090],\\n  [0.276800, 0.471510, 0.942140],\\n  [0.276480, 0.481440, 0.950640],\\n  [0.276030, 0.491320, 0.958570],\\n  [0.275430, 0.501150, 0.965940],\\n  [0.274690, 0.510940, 0.972750],\\n  [0.273810, 0.520690, 0.978990],\\n  [0.272730, 0.530400, 0.984610],\\n  [0.271060, 0.540150, 0.989300],\\n  [0.268780, 0.549950, 0.993030],\\n  [0.265920, 0.559790, 0.995830],\\n  [0.262520, 0.569670, 0.997730],\\n  [0.258620, 0.579580, 0.998760],\\n  [0.254250, 0.589500, 0.998960],\\n  [0.249460, 0.599430, 0.998350],\\n  [0.244270, 0.609370, 0.996970],\\n  [0.238740, 0.619310, 0.994850],\\n  [0.232880, 0.629230, 0.992020],\\n  [0.226760, 0.639130, 0.988510],\\n  [0.220390, 0.649010, 0.984360],\\n  [0.213820, 0.658860, 0.979590],\\n  [0.207080, 0.668660, 0.974230],\\n  [0.200210, 0.678420, 0.968330],\\n  [0.193260, 0.688120, 0.961900],\\n  [0.186250, 0.697750, 0.954980],\\n  [0.179230, 0.707320, 0.947610],\\n  [0.172230, 0.716800, 0.939810],\\n  [0.165290, 0.726200, 0.931610],\\n  [0.158440, 0.735510, 0.923050],\\n  [0.151730, 0.744720, 0.914160],\\n  [0.145190, 0.753810, 0.904960],\\n  [0.138860, 0.762790, 0.895500],\\n  [0.132780, 0.771650, 0.885800],\\n  [0.126980, 0.780370, 0.875900],\\n  [0.121510, 0.788960, 0.865810],\\n  [0.116390, 0.797400, 0.855590],\\n  [0.111670, 0.805690, 0.845250],\\n  [0.107380, 0.813810, 0.834840],\\n  [0.103570, 0.821770, 0.824370],\\n  [0.100260, 0.829550, 0.813890],\\n  [0.097500, 0.837140, 0.803420],\\n  [0.095320, 0.844550, 0.792990],\\n  [0.093770, 0.851750, 0.782640],\\n  [0.092870, 0.858750, 0.772400],\\n  [0.092670, 0.865540, 0.762300],\\n  [0.093200, 0.872110, 0.752370],\\n  [0.094510, 0.878440, 0.742650],\\n  [0.096620, 0.884540, 0.733160],\\n  [0.099580, 0.890400, 0.723930],\\n  [0.103420, 0.896000, 0.715000],\\n  [0.108150, 0.901420, 0.705990],\\n  [0.113740, 0.906730, 0.696510],\\n  [0.120140, 0.911930, 0.686600],\\n  [0.127330, 0.917010, 0.676270],\\n  [0.135260, 0.921970, 0.665560],\\n  [0.143910, 0.926800, 0.654480],\\n  [0.153230, 0.931510, 0.643080],\\n  [0.163190, 0.936090, 0.631370],\\n  [0.173770, 0.940530, 0.619380],\\n  [0.184910, 0.944840, 0.607130],\\n  [0.196590, 0.949010, 0.594660],\\n  [0.208770, 0.953040, 0.581990],\\n  [0.221420, 0.956920, 0.569140],\\n  [0.234490, 0.960650, 0.556140],\\n  [0.247970, 0.964230, 0.543030],\\n  [0.261800, 0.967650, 0.529810],\\n  [0.275970, 0.970920, 0.516530],\\n  [0.290420, 0.974030, 0.503210],\\n  [0.305130, 0.976970, 0.489870],\\n  [0.320060, 0.979740, 0.476540],\\n  [0.335170, 0.982340, 0.463250],\\n  [0.350430, 0.984770, 0.450020],\\n  [0.365810, 0.987020, 0.436880],\\n  [0.381270, 0.989090, 0.423860],\\n  [0.396780, 0.990980, 0.410980],\\n  [0.412290, 0.992680, 0.398260],\\n  [0.427780, 0.994190, 0.385750],\\n  [0.443210, 0.995510, 0.373450],\\n  [0.458540, 0.996630, 0.361400],\\n  [0.473750, 0.997550, 0.349630],\\n  [0.488790, 0.998280, 0.338160],\\n  [0.503620, 0.998790, 0.327010],\\n  [0.518220, 0.999100, 0.316220],\\n  [0.532550, 0.999190, 0.305810],\\n  [0.546580, 0.999070, 0.295810],\\n  [0.560260, 0.998730, 0.286230],\\n  [0.573570, 0.998170, 0.277120],\\n  [0.586460, 0.997390, 0.268490],\\n  [0.598910, 0.996380, 0.260380],\\n  [0.610880, 0.995140, 0.252800],\\n  [0.622330, 0.993660, 0.245790],\\n  [0.633230, 0.991950, 0.239370],\\n  [0.643620, 0.989990, 0.233560],\\n  [0.653940, 0.987750, 0.228350],\\n  [0.664280, 0.985240, 0.223700],\\n  [0.674620, 0.982460, 0.219600],\\n  [0.684940, 0.979410, 0.216020],\\n  [0.695250, 0.976100, 0.212940],\\n  [0.705530, 0.972550, 0.210320],\\n  [0.715770, 0.968750, 0.208150],\\n  [0.725960, 0.964700, 0.206400],\\n  [0.736100, 0.960430, 0.205040],\\n  [0.746170, 0.955930, 0.204060],\\n  [0.756170, 0.951210, 0.203430],\\n  [0.766080, 0.946270, 0.203110],\\n  [0.775910, 0.941130, 0.203100],\\n  [0.785630, 0.935790, 0.203360],\\n  [0.795240, 0.930250, 0.203860],\\n  [0.804730, 0.924520, 0.204590],\\n  [0.814100, 0.918610, 0.205520],\\n  [0.823330, 0.912530, 0.206630],\\n  [0.832410, 0.906270, 0.207880],\\n  [0.841330, 0.899860, 0.209260],\\n  [0.850100, 0.893280, 0.210740],\\n  [0.858680, 0.886550, 0.212300],\\n  [0.867090, 0.879680, 0.213910],\\n  [0.875300, 0.872670, 0.215550],\\n  [0.883310, 0.865530, 0.217190],\\n  [0.891120, 0.858260, 0.218800],\\n  [0.898700, 0.850870, 0.220380],\\n  [0.906050, 0.843370, 0.221880],\\n  [0.913170, 0.835760, 0.223280],\\n  [0.920040, 0.828060, 0.224560],\\n  [0.926660, 0.820250, 0.225700],\\n  [0.933010, 0.812360, 0.226670],\\n  [0.939090, 0.804390, 0.227440],\\n  [0.944890, 0.796340, 0.228000],\\n  [0.950390, 0.788230, 0.228310],\\n  [0.955600, 0.780050, 0.228360],\\n  [0.960490, 0.771810, 0.228110],\\n  [0.965070, 0.763520, 0.227540],\\n  [0.969310, 0.755190, 0.226630],\\n  [0.973230, 0.746820, 0.225360],\\n  [0.976790, 0.738420, 0.223690],\\n  [0.980000, 0.730000, 0.221610],\\n  [0.982890, 0.721400, 0.219180],\\n  [0.985490, 0.712500, 0.216500],\\n  [0.987810, 0.703300, 0.213580],\\n  [0.989860, 0.693820, 0.210430],\\n  [0.991630, 0.684080, 0.207060],\\n  [0.993140, 0.674080, 0.203480],\\n  [0.994380, 0.663860, 0.199710],\\n  [0.995350, 0.653410, 0.195770],\\n  [0.996070, 0.642770, 0.191650],\\n  [0.996540, 0.631930, 0.187380],\\n  [0.996750, 0.620930, 0.182970],\\n  [0.996720, 0.609770, 0.178420],\\n  [0.996440, 0.598460, 0.173760],\\n  [0.995930, 0.587030, 0.168990],\\n  [0.995170, 0.575490, 0.164120],\\n  [0.994190, 0.563860, 0.159180],\\n  [0.992970, 0.552140, 0.154170],\\n  [0.991530, 0.540360, 0.149100],\\n  [0.989870, 0.528540, 0.143980],\\n  [0.987990, 0.516670, 0.138830],\\n  [0.985900, 0.504790, 0.133670],\\n  [0.983600, 0.492910, 0.128490],\\n  [0.981080, 0.481040, 0.123320],\\n  [0.978370, 0.469200, 0.118170],\\n  [0.975450, 0.457400, 0.113050],\\n  [0.972340, 0.445650, 0.107970],\\n  [0.969040, 0.433990, 0.102940],\\n  [0.965550, 0.422410, 0.097980],\\n  [0.961870, 0.410930, 0.093100],\\n  [0.958010, 0.399580, 0.088310],\\n  [0.953980, 0.388360, 0.083620],\\n  [0.949770, 0.377290, 0.079050],\\n  [0.945380, 0.366380, 0.074610],\\n  [0.940840, 0.355660, 0.070310],\\n  [0.936120, 0.345130, 0.066160],\\n  [0.931250, 0.334820, 0.062180],\\n  [0.926230, 0.324730, 0.058370],\\n  [0.921050, 0.314890, 0.054750],\\n  [0.915720, 0.305300, 0.051340],\\n  [0.910240, 0.295990, 0.048140],\\n  [0.904630, 0.286960, 0.045160],\\n  [0.898880, 0.278240, 0.042430],\\n  [0.892980, 0.269810, 0.039930],\\n  [0.886910, 0.261520, 0.037530],\\n  [0.880660, 0.253340, 0.035210],\\n  [0.874220, 0.245260, 0.032970],\\n  [0.867600, 0.237300, 0.030820],\\n  [0.860790, 0.229450, 0.028750],\\n  [0.853800, 0.221700, 0.026770],\\n  [0.846620, 0.214070, 0.024870],\\n  [0.839260, 0.206540, 0.023050],\\n  [0.831720, 0.199120, 0.021310],\\n  [0.823990, 0.191820, 0.019660],\\n  [0.816080, 0.184620, 0.018090],\\n  [0.807990, 0.177530, 0.016600],\\n  [0.799710, 0.170550, 0.015200],\\n  [0.791250, 0.163680, 0.013870],\\n  [0.782600, 0.156930, 0.012640],\\n  [0.773770, 0.150280, 0.011480],\\n  [0.764760, 0.143740, 0.010410],\\n  [0.755560, 0.137310, 0.009420],\\n  [0.746170, 0.130980, 0.008510],\\n  [0.736610, 0.124770, 0.007690],\\n  [0.726860, 0.118670, 0.006950],\\n  [0.716920, 0.112680, 0.006290],\\n  [0.706800, 0.106800, 0.005710],\\n  [0.696500, 0.101020, 0.005220],\\n  [0.686020, 0.095360, 0.004810],\\n  [0.675350, 0.089800, 0.004490],\\n  [0.664490, 0.084360, 0.004240],\\n  [0.653450, 0.079020, 0.004080],\\n  [0.642230, 0.073800, 0.004010],\\n  [0.630820, 0.068680, 0.004010],\\n  [0.619230, 0.063670, 0.004100],\\n  [0.607460, 0.058780, 0.004270],\\n  [0.595500, 0.053990, 0.004530],\\n  [0.583360, 0.049310, 0.004860],\\n  [0.571030, 0.044740, 0.005290],\\n  [0.558520, 0.040280, 0.005790],\\n  [0.545830, 0.035930, 0.006380],\\n  [0.532950, 0.031690, 0.007050],\\n  [0.519890, 0.027560, 0.007800],\\n  [0.506640, 0.023540, 0.008630],\\n  [0.493210, 0.019630, 0.009550],\\n  [0.479600, 0.015830, 0.010550]\\n];\\n\\nexport const GRAY_COLORMAP = [\\n  [0.000000, 0.000000, 0.000000],\\n  [0.003922, 0.003922, 0.003922],\\n  [0.007843, 0.007843, 0.007843],\\n  [0.011765, 0.011765, 0.011765],\\n  [0.015686, 0.015686, 0.015686],\\n  [0.019608, 0.019608, 0.019608],\\n  [0.023529, 0.023529, 0.023529],\\n  [0.027451, 0.027451, 0.027451],\\n  [0.031373, 0.031373, 0.031373],\\n  [0.035294, 0.035294, 0.035294],\\n  [0.039216, 0.039216, 0.039216],\\n  [0.043137, 0.043137, 0.043137],\\n  [0.047059, 0.047059, 0.047059],\\n  [0.050980, 0.050980, 0.050980],\\n  [0.054902, 0.054902, 0.054902],\\n  [0.058824, 0.058824, 0.058824],\\n  [0.062745, 0.062745, 0.062745],\\n  [0.066667, 0.066667, 0.066667],\\n  [0.070588, 0.070588, 0.070588],\\n  [0.074510, 0.074510, 0.074510],\\n  [0.078431, 0.078431, 0.078431],\\n  [0.082353, 0.082353, 0.082353],\\n  [0.086275, 0.086275, 0.086275],\\n  [0.090196, 0.090196, 0.090196],\\n  [0.094118, 0.094118, 0.094118],\\n  [0.098039, 0.098039, 0.098039],\\n  [0.101961, 0.101961, 0.101961],\\n  [0.105882, 0.105882, 0.105882],\\n  [0.109804, 0.109804, 0.109804],\\n  [0.113725, 0.113725, 0.113725],\\n  [0.117647, 0.117647, 0.117647],\\n  [0.121569, 0.121569, 0.121569],\\n  [0.125490, 0.125490, 0.125490],\\n  [0.129412, 0.129412, 0.129412],\\n  [0.133333, 0.133333, 0.133333],\\n  [0.137255, 0.137255, 0.137255],\\n  [0.141176, 0.141176, 0.141176],\\n  [0.145098, 0.145098, 0.145098],\\n  [0.149020, 0.149020, 0.149020],\\n  [0.152941, 0.152941, 0.152941],\\n  [0.156863, 0.156863, 0.156863],\\n  [0.160784, 0.160784, 0.160784],\\n  [0.164706, 0.164706, 0.164706],\\n  [0.168627, 0.168627, 0.168627],\\n  [0.172549, 0.172549, 0.172549],\\n  [0.176471, 0.176471, 0.176471],\\n  [0.180392, 0.180392, 0.180392],\\n  [0.184314, 0.184314, 0.184314],\\n  [0.188235, 0.188235, 0.188235],\\n  [0.192157, 0.192157, 0.192157],\\n  [0.196078, 0.196078, 0.196078],\\n  [0.200000, 0.200000, 0.200000],\\n  [0.203922, 0.203922, 0.203922],\\n  [0.207843, 0.207843, 0.207843],\\n  [0.211765, 0.211765, 0.211765],\\n  [0.215686, 0.215686, 0.215686],\\n  [0.219608, 0.219608, 0.219608],\\n  [0.223529, 0.223529, 0.223529],\\n  [0.227451, 0.227451, 0.227451],\\n  [0.231373, 0.231373, 0.231373],\\n  [0.235294, 0.235294, 0.235294],\\n  [0.239216, 0.239216, 0.239216],\\n  [0.243137, 0.243137, 0.243137],\\n  [0.247059, 0.247059, 0.247059],\\n  [0.250980, 0.250980, 0.250980],\\n  [0.254902, 0.254902, 0.254902],\\n  [0.258824, 0.258824, 0.258824],\\n  [0.262745, 0.262745, 0.262745],\\n  [0.266667, 0.266667, 0.266667],\\n  [0.270588, 0.270588, 0.270588],\\n  [0.274510, 0.274510, 0.274510],\\n  [0.278431, 0.278431, 0.278431],\\n  [0.282353, 0.282353, 0.282353],\\n  [0.286275, 0.286275, 0.286275],\\n  [0.290196, 0.290196, 0.290196],\\n  [0.294118, 0.294118, 0.294118],\\n  [0.298039, 0.298039, 0.298039],\\n  [0.301961, 0.301961, 0.301961],\\n  [0.305882, 0.305882, 0.305882],\\n  [0.309804, 0.309804, 0.309804],\\n  [0.313725, 0.313725, 0.313725],\\n  [0.317647, 0.317647, 0.317647],\\n  [0.321569, 0.321569, 0.321569],\\n  [0.325490, 0.325490, 0.325490],\\n  [0.329412, 0.329412, 0.329412],\\n  [0.333333, 0.333333, 0.333333],\\n  [0.337255, 0.337255, 0.337255],\\n  [0.341176, 0.341176, 0.341176],\\n  [0.345098, 0.345098, 0.345098],\\n  [0.349020, 0.349020, 0.349020],\\n  [0.352941, 0.352941, 0.352941],\\n  [0.356863, 0.356863, 0.356863],\\n  [0.360784, 0.360784, 0.360784],\\n  [0.364706, 0.364706, 0.364706],\\n  [0.368627, 0.368627, 0.368627],\\n  [0.372549, 0.372549, 0.372549],\\n  [0.376471, 0.376471, 0.376471],\\n  [0.380392, 0.380392, 0.380392],\\n  [0.384314, 0.384314, 0.384314],\\n  [0.388235, 0.388235, 0.388235],\\n  [0.392157, 0.392157, 0.392157],\\n  [0.396078, 0.396078, 0.396078],\\n  [0.400000, 0.400000, 0.400000],\\n  [0.403922, 0.403922, 0.403922],\\n  [0.407843, 0.407843, 0.407843],\\n  [0.411765, 0.411765, 0.411765],\\n  [0.415686, 0.415686, 0.415686],\\n  [0.419608, 0.419608, 0.419608],\\n  [0.423529, 0.423529, 0.423529],\\n  [0.427451, 0.427451, 0.427451],\\n  [0.431373, 0.431373, 0.431373],\\n  [0.435294, 0.435294, 0.435294],\\n  [0.439216, 0.439216, 0.439216],\\n  [0.443137, 0.443137, 0.443137],\\n  [0.447059, 0.447059, 0.447059],\\n  [0.450980, 0.450980, 0.450980],\\n  [0.454902, 0.454902, 0.454902],\\n  [0.458824, 0.458824, 0.458824],\\n  [0.462745, 0.462745, 0.462745],\\n  [0.466667, 0.466667, 0.466667],\\n  [0.470588, 0.470588, 0.470588],\\n  [0.474510, 0.474510, 0.474510],\\n  [0.478431, 0.478431, 0.478431],\\n  [0.482353, 0.482353, 0.482353],\\n  [0.486275, 0.486275, 0.486275],\\n  [0.490196, 0.490196, 0.490196],\\n  [0.494118, 0.494118, 0.494118],\\n  [0.498039, 0.498039, 0.498039],\\n  [0.501961, 0.501961, 0.501961],\\n  [0.505882, 0.505882, 0.505882],\\n  [0.509804, 0.509804, 0.509804],\\n  [0.513725, 0.513725, 0.513725],\\n  [0.517647, 0.517647, 0.517647],\\n  [0.521569, 0.521569, 0.521569],\\n  [0.525490, 0.525490, 0.525490],\\n  [0.529412, 0.529412, 0.529412],\\n  [0.533333, 0.533333, 0.533333],\\n  [0.537255, 0.537255, 0.537255],\\n  [0.541176, 0.541176, 0.541176],\\n  [0.545098, 0.545098, 0.545098],\\n  [0.549020, 0.549020, 0.549020],\\n  [0.552941, 0.552941, 0.552941],\\n  [0.556863, 0.556863, 0.556863],\\n  [0.560784, 0.560784, 0.560784],\\n  [0.564706, 0.564706, 0.564706],\\n  [0.568627, 0.568627, 0.568627],\\n  [0.572549, 0.572549, 0.572549],\\n  [0.576471, 0.576471, 0.576471],\\n  [0.580392, 0.580392, 0.580392],\\n  [0.584314, 0.584314, 0.584314],\\n  [0.588235, 0.588235, 0.588235],\\n  [0.592157, 0.592157, 0.592157],\\n  [0.596078, 0.596078, 0.596078],\\n  [0.600000, 0.600000, 0.600000],\\n  [0.603922, 0.603922, 0.603922],\\n  [0.607843, 0.607843, 0.607843],\\n  [0.611765, 0.611765, 0.611765],\\n  [0.615686, 0.615686, 0.615686],\\n  [0.619608, 0.619608, 0.619608],\\n  [0.623529, 0.623529, 0.623529],\\n  [0.627451, 0.627451, 0.627451],\\n  [0.631373, 0.631373, 0.631373],\\n  [0.635294, 0.635294, 0.635294],\\n  [0.639216, 0.639216, 0.639216],\\n  [0.643137, 0.643137, 0.643137],\\n  [0.647059, 0.647059, 0.647059],\\n  [0.650980, 0.650980, 0.650980],\\n  [0.654902, 0.654902, 0.654902],\\n  [0.658824, 0.658824, 0.658824],\\n  [0.662745, 0.662745, 0.662745],\\n  [0.666667, 0.666667, 0.666667],\\n  [0.670588, 0.670588, 0.670588],\\n  [0.674510, 0.674510, 0.674510],\\n  [0.678431, 0.678431, 0.678431],\\n  [0.682353, 0.682353, 0.682353],\\n  [0.686275, 0.686275, 0.686275],\\n  [0.690196, 0.690196, 0.690196],\\n  [0.694118, 0.694118, 0.694118],\\n  [0.698039, 0.698039, 0.698039],\\n  [0.701961, 0.701961, 0.701961],\\n  [0.705882, 0.705882, 0.705882],\\n  [0.709804, 0.709804, 0.709804],\\n  [0.713725, 0.713725, 0.713725],\\n  [0.717647, 0.717647, 0.717647],\\n  [0.721569, 0.721569, 0.721569],\\n  [0.725490, 0.725490, 0.725490],\\n  [0.729412, 0.729412, 0.729412],\\n  [0.733333, 0.733333, 0.733333],\\n  [0.737255, 0.737255, 0.737255],\\n  [0.741176, 0.741176, 0.741176],\\n  [0.745098, 0.745098, 0.745098],\\n  [0.749020, 0.749020, 0.749020],\\n  [0.752941, 0.752941, 0.752941],\\n  [0.756863, 0.756863, 0.756863],\\n  [0.760784, 0.760784, 0.760784],\\n  [0.764706, 0.764706, 0.764706],\\n  [0.768627, 0.768627, 0.768627],\\n  [0.772549, 0.772549, 0.772549],\\n  [0.776471, 0.776471, 0.776471],\\n  [0.780392, 0.780392, 0.780392],\\n  [0.784314, 0.784314, 0.784314],\\n  [0.788235, 0.788235, 0.788235],\\n  [0.792157, 0.792157, 0.792157],\\n  [0.796078, 0.796078, 0.796078],\\n  [0.800000, 0.800000, 0.800000],\\n  [0.803922, 0.803922, 0.803922],\\n  [0.807843, 0.807843, 0.807843],\\n  [0.811765, 0.811765, 0.811765],\\n  [0.815686, 0.815686, 0.815686],\\n  [0.819608, 0.819608, 0.819608],\\n  [0.823529, 0.823529, 0.823529],\\n  [0.827451, 0.827451, 0.827451],\\n  [0.831373, 0.831373, 0.831373],\\n  [0.835294, 0.835294, 0.835294],\\n  [0.839216, 0.839216, 0.839216],\\n  [0.843137, 0.843137, 0.843137],\\n  [0.847059, 0.847059, 0.847059],\\n  [0.850980, 0.850980, 0.850980],\\n  [0.854902, 0.854902, 0.854902],\\n  [0.858824, 0.858824, 0.858824],\\n  [0.862745, 0.862745, 0.862745],\\n  [0.866667, 0.866667, 0.866667],\\n  [0.870588, 0.870588, 0.870588],\\n  [0.874510, 0.874510, 0.874510],\\n  [0.878431, 0.878431, 0.878431],\\n  [0.882353, 0.882353, 0.882353],\\n  [0.886275, 0.886275, 0.886275],\\n  [0.890196, 0.890196, 0.890196],\\n  [0.894118, 0.894118, 0.894118],\\n  [0.898039, 0.898039, 0.898039],\\n  [0.901961, 0.901961, 0.901961],\\n  [0.905882, 0.905882, 0.905882],\\n  [0.909804, 0.909804, 0.909804],\\n  [0.913725, 0.913725, 0.913725],\\n  [0.917647, 0.917647, 0.917647],\\n  [0.921569, 0.921569, 0.921569],\\n  [0.925490, 0.925490, 0.925490],\\n  [0.929412, 0.929412, 0.929412],\\n  [0.933333, 0.933333, 0.933333],\\n  [0.937255, 0.937255, 0.937255],\\n  [0.941176, 0.941176, 0.941176],\\n  [0.945098, 0.945098, 0.945098],\\n  [0.949020, 0.949020, 0.949020],\\n  [0.952941, 0.952941, 0.952941],\\n  [0.956863, 0.956863, 0.956863],\\n  [0.960784, 0.960784, 0.960784],\\n  [0.964706, 0.964706, 0.964706],\\n  [0.968627, 0.968627, 0.968627],\\n  [0.972549, 0.972549, 0.972549],\\n  [0.976471, 0.976471, 0.976471],\\n  [0.980392, 0.980392, 0.980392],\\n  [0.984314, 0.984314, 0.984314],\\n  [0.988235, 0.988235, 0.988235],\\n  [0.992157, 0.992157, 0.992157],\\n  [0.996078, 0.996078, 0.996078],\\n  [1.000000, 1.000000, 1.000000]\\n];\\n\"","module.exports = \"//\\n//  Copyright (c) 2021-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\nexport function keyBy<T>(collection: T[], fn: (item: T) => string): Record<string, T> {\\n  const groups: Record<string, T> = {};\\n  for (const item of collection) {\\n    const key = fn(item);\\n    groups[key] = item;\\n  }\\n  return groups;\\n}\\n\\nexport function groupBy<T>(collection: T[], fn: (item: T) => string): Record<string, T[]> {\\n  const groups: Record<string, T[]> = {};\\n  for (const item of collection) {\\n    const key = fn(item);\\n    const existing = groups[key] || [];\\n    groups[key] = [...existing, item];\\n  }\\n  return groups;\\n}\\n\\nexport function mapValues<I, O>(obj: Record<string, I>, fn: (val: I) => O): Record<string, O> {\\n  const result: Record<string, O> = {};\\n  Object.keys(obj).forEach((key: string) => {\\n    result[key] = fn(obj[key]);\\n  });\\n  return result;\\n}\\n\"","module.exports = \"import { Header, Pose, Point, RGBA, Time } from \\\"./types\\\";\\n\\nexport interface IMarker {\\n  header: Header;\\n  ns: string;\\n  id: number;\\n  type: number;\\n  action: number;\\n  pose: Pose;\\n  scale: Point;\\n  color: RGBA;\\n  lifetime: Time;\\n  frame_locked: boolean;\\n  points: Point[];\\n  colors: RGBA[];\\n  text: string;\\n  mesh_resource: string;\\n  mesh_use_embedded_materials: boolean;\\n}\\n\\n/**\\n * Use this class to instantiate marker-like objects with defaulted values.\\n */\\nexport class Marker implements IMarker {\\n  header: Header = {\\n    frame_id: \\\"\\\",\\n    stamp: {\\n      sec: 0,\\n      nsec: 0,\\n    },\\n    seq: 0,\\n  };\\n  ns: string = \\\"\\\";\\n  id: number = 0;\\n  type: number = 0;\\n  action: number = 0;\\n  pose: Pose = {\\n    position: {\\n      x: 0,\\n      y: 0,\\n      z: 0,\\n    },\\n    orientation: {\\n      x: 0,\\n      y: 0,\\n      z: 0,\\n      w: 0,\\n    },\\n  };\\n  scale: Point = {\\n    x: 0,\\n    y: 0,\\n    z: 0,\\n  };\\n  color: RGBA = { r: 0, g: 0, b: 0, a: 0 };\\n  lifetime: Time = { sec: 0, nsec: 0 };\\n  frame_locked: boolean = false;\\n  points: Point[] = [];\\n  colors: RGBA[] = [];\\n  text: string = \\\"\\\";\\n  mesh_resource: string = \\\"\\\";\\n  mesh_use_embedded_materials: boolean = false;\\n\\n  constructor({\\n    header,\\n    ns,\\n    id,\\n    type,\\n    action,\\n    pose,\\n    scale,\\n    color,\\n    lifetime,\\n    frame_locked,\\n    points,\\n    colors,\\n    text,\\n    mesh_resource,\\n    mesh_use_embedded_materials,\\n  }: Partial<IMarker>) {\\n    this.header = header || {\\n      frame_id: \\\"\\\",\\n      stamp: {\\n        sec: 0,\\n        nsec: 0,\\n      },\\n      seq: 0,\\n    };\\n    this.ns = ns || \\\"\\\";\\n    this.id = id || 0;\\n    this.type = type || 0;\\n    this.action = action || 0;\\n    this.pose = pose || {\\n      position: {\\n        x: 0,\\n        y: 0,\\n        z: 0,\\n      },\\n      orientation: {\\n        x: 0,\\n        y: 0,\\n        z: 0,\\n        w: 0,\\n      },\\n    };\\n    this.scale = scale || { x: 0, y: 0, z: 0 };\\n    this.color = color || { r: 0, g: 0, b: 0, a: 0 };\\n    this.lifetime = lifetime || { sec: 0, nsec: 0 };\\n    this.frame_locked = frame_locked || false;\\n    this.points = points || [];\\n    this.colors = colors || [];\\n    this.text = text || \\\"\\\";\\n    this.mesh_resource = mesh_resource || \\\"\\\";\\n    this.mesh_use_embedded_materials = mesh_use_embedded_materials || false;\\n  }\\n}\\n/**\\n * Corresponds to the 'type' field of a marker.\\n */\\nexport enum MarkerTypes {\\n  ARROW = 0,\\n  CUBE = 1,\\n  SPHERE = 2,\\n  CYLINDER = 3,\\n  LINE_STRIP = 4,\\n  LINE_LIST = 5,\\n  CUBE_LIST = 6,\\n  SPHERE_LIST = 7,\\n  POINTS = 8,\\n  TEXT = 9,\\n  MESH = 10,\\n  TRIANGLE_LIST = 11,\\n  FILLED_POLYGON = 107,\\n}\\n\"","module.exports = \"import { Point, Header, RGBA } from \\\"./types\\\";\\nimport { rotate } from \\\"./vectors\\\";\\nimport { FieldReader, getReader } from \\\"./readers\\\";\\n\\ninterface sensor_msgs__PointField {\\n  name: string;\\n  offset: number;\\n  datatype: number;\\n  count: number;\\n}\\n\\nexport interface sensor_msgs__PointCloud2 {\\n  header: Header;\\n  height: number;\\n  width: number;\\n  fields: sensor_msgs__PointField[];\\n  is_bigendian: boolean;\\n  point_step: number;\\n  row_step: number;\\n  data: Uint8Array;\\n  is_dense: boolean;\\n}\\n\\ntype Reader = { datatype: number; offset: number; reader: FieldReader };\\n\\nfunction getFieldOffsetsAndReaders(fields: sensor_msgs__PointField[]): Reader[] {\\n  const result: Reader[] = [];\\n  for (const { name, datatype, offset = 0 } of fields) {\\n    result.push({ datatype, offset, reader: getReader(datatype, offset) });\\n  }\\n  return result;\\n}\\n\\ntype Field = number | string;\\n\\n/**\\n * Read points from a sensor_msgs.PointCloud2 message. Returns a nested array\\n * of values whose index corresponds to that of the 'fields' value.\\n */\\nexport const readPoints = (message: sensor_msgs__PointCloud2): Array<Field[]> => {\\n  const { fields, height, point_step, row_step, width, data } = message;\\n  const readers = getFieldOffsetsAndReaders(fields);\\n\\n  const points: Array<Field[]> = [];\\n  for (let i = 0; i < height; i++) {\\n    const dataOffset = i * row_step;\\n    for (let j = 0; j < width; j++) {\\n      const row: Field[] = [];\\n      const dataStart = j * point_step + dataOffset;\\n      for (const reader of readers) {\\n        const value = reader.reader.read(data, dataStart);\\n        row.push(value);\\n      }\\n      points.push(row);\\n    }\\n  }\\n  return points;\\n};\\n\\nexport function norm({ x, y, z }: Point) {\\n  return Math.sqrt(x * x + y * y + z * z);\\n}\\n\\nexport function setRayDistance(pt: Point, distance: number) {\\n  const { x, y, z } = pt;\\n  const scale = distance / norm(pt);\\n  return {\\n    x: x * scale,\\n    y: y * scale,\\n    z: z * scale,\\n  };\\n}\\n\\nexport function convertToRangeView(points: Point[], range: number, makeColors: boolean) {\\n  let colors: RGBA[] = makeColors ? new Array(points.length) : [];\\n  // First pass to get min and max ranges\\n  // TODO: Could be more efficient and extract this during\\n  // transforms for free\\n  let maxRange = Number.MIN_VALUE;\\n  if (makeColors) {\\n    for (let i = 0; i < points.length; ++i) {\\n      maxRange = Math.max(maxRange, norm(points[i]));\\n    }\\n  }\\n  // actually move the points and generate colors if specified\\n  for (let i = 0; i < points.length; ++i) {\\n    const pt = points[i];\\n    if (makeColors) {\\n      const dist = norm(pt);\\n      if (dist <= range) {\\n        // don't go all the way to white\\n        const extent = 0.8;\\n        // closest to target range is lightest,\\n        // closest to AV is darkest\\n        const other = (extent * dist) / range;\\n        colors[i] = { r: 1, g: other, b: other, a: 1 };\\n      } else {\\n        // don't go all the way to white\\n        const extent = 0.8;\\n        // closest to target range is lightest,\\n        // closest to max range is darkest\\n        const upper = maxRange - range;\\n        const other = extent * (1.0 - dist / upper);\\n        colors[i] = { r: other, g: other, b: 1, a: 1 };\\n      }\\n    }\\n    points[i] = setRayDistance(pt, range);\\n  }\\n  return colors;\\n}\\n\"","module.exports = \"export const DATATYPE = {\\n  uint8: 2,\\n  uint16: 4,\\n  int16: 3,\\n  int32: 5,\\n  float32: 7,\\n};\\n\\nexport interface FieldReader {\\n  read(data: Uint8Array, index: number): number;\\n}\\n\\nexport class Float32Reader implements FieldReader {\\n  offset: number;\\n  view: DataView;\\n  constructor(offset: number) {\\n    this.offset = offset;\\n    const buffer = new ArrayBuffer(4);\\n    this.view = new DataView(buffer);\\n  }\\n\\n  read(data: Uint8Array, index: number): number {\\n    this.view.setUint8(0, data[index + this.offset]);\\n    this.view.setUint8(1, data[index + this.offset + 1]);\\n    this.view.setUint8(2, data[index + this.offset + 2]);\\n    this.view.setUint8(3, data[index + this.offset + 3]);\\n    return this.view.getFloat32(0, true);\\n  }\\n}\\n\\nexport class Int32Reader implements FieldReader {\\n  offset: number;\\n  view: DataView;\\n  constructor(offset: number) {\\n    this.offset = offset;\\n    const buffer = new ArrayBuffer(4);\\n    this.view = new DataView(buffer);\\n  }\\n\\n  read(data: Uint8Array, index: number): number {\\n    this.view.setUint8(0, data[index + this.offset]);\\n    this.view.setUint8(1, data[index + this.offset + 1]);\\n    this.view.setUint8(2, data[index + this.offset + 2]);\\n    this.view.setUint8(3, data[index + this.offset + 3]);\\n    return this.view.getInt32(0, true);\\n  }\\n}\\n\\nexport class Uint16Reader implements FieldReader {\\n  offset: number;\\n  view: DataView;\\n  constructor(offset: number) {\\n    this.offset = offset;\\n    const buffer = new ArrayBuffer(2);\\n    this.view = new DataView(buffer);\\n  }\\n\\n  read(data: Uint8Array, index: number): number {\\n    this.view.setUint8(0, data[index + this.offset]);\\n    this.view.setUint8(1, data[index + this.offset + 1]);\\n    return this.view.getUint16(0, true);\\n  }\\n}\\n\\nexport class Uint8Reader implements FieldReader {\\n  offset: number;\\n  constructor(offset: number) {\\n    this.offset = offset;\\n  }\\n\\n  read(data: Uint8Array, index: number): number {\\n    return data[index + this.offset];\\n  }\\n}\\n\\nexport class Int16Reader implements FieldReader {\\n  offset: number;\\n  view: DataView;\\n  constructor(offset: number) {\\n    this.offset = offset;\\n    const buffer = new ArrayBuffer(2);\\n    this.view = new DataView(buffer);\\n  }\\n\\n  read(data: Uint8Array, index: number): number {\\n    this.view.setUint8(0, data[index + this.offset]);\\n    this.view.setUint8(1, data[index + this.offset + 1]);\\n    return this.view.getInt16(0, true);\\n  }\\n}\\n\\nexport function getReader(datatype: number, offset: number) {\\n  switch (datatype) {\\n    case DATATYPE.float32:\\n      return new Float32Reader(offset);\\n    case DATATYPE.uint8:\\n      return new Uint8Reader(offset);\\n    case DATATYPE.uint16:\\n      return new Uint16Reader(offset);\\n    case DATATYPE.int16:\\n      return new Int16Reader(offset);\\n    case DATATYPE.int32:\\n      return new Int32Reader(offset);\\n    default:\\n      throw new Error(`Unsupported datatype: '${datatype}'`);\\n  }\\n}\\n\"","module.exports = \"import { Time } from \\\"./types\\\";\\n\\n/*\\n * Checks ROS-time equality.\\n */\\nexport const areSame = (t1: Time, t2: Time) => t1.sec === t2.sec && t1.nsec === t2.nsec;\\n\\n/*\\n * Compare two times, returning a negative value if the right is greater or a\\n * positive value if the left is greater or 0 if the times are equal useful to\\n * supply to Array.prototype.sort\\n */\\nexport const compare = (left: Time, right: Time) => {\\n  const secDiff = left.sec - right.sec;\\n  return secDiff || left.nsec - right.nsec;\\n};\\n\\nconst fixTime = (t: Time): Time => {\\n  // Equivalent to fromNanoSec(toNanoSec(t)), but no chance of precision loss.\\n  // nsec should be non-negative, and less than 1e9.\\n  let { sec, nsec } = t;\\n  while (nsec > 1e9) {\\n    nsec -= 1e9;\\n    sec += 1;\\n  }\\n  while (nsec < 0) {\\n    nsec += 1e9;\\n    sec -= 1;\\n  }\\n  return { sec, nsec };\\n};\\n\\nexport const subtractTimes = ({ sec: sec1, nsec: nsec1 }: Time, { sec: sec2, nsec: nsec2 }: Time): Time => {\\n  return fixTime({ sec: sec1 - sec2, nsec: nsec1 - nsec2 });\\n};\\n\"","module.exports = \"export type RGBA = {\\n  // all values are scaled between 0-1 instead of 0-255\\n  r: number;\\n  g: number;\\n  b: number;\\n  a: number; // opacity -- typically you should set this to 1.\\n};\\n\\nexport type Header = {\\n  frame_id: string;\\n  stamp: Time;\\n  seq: number;\\n};\\n\\nexport type Point = {\\n  x: number;\\n  y: number;\\n  z: number;\\n};\\n\\nexport type Time = {\\n  sec: number;\\n  nsec: number;\\n};\\n\\nexport type Translation = {\\n  x: number;\\n  y: number;\\n  z: number;\\n};\\n\\nexport type Rotation = {\\n  x: number;\\n  y: number;\\n  z: number;\\n  w: number;\\n};\\n\\nexport type Pose = {\\n  position: Point;\\n  orientation: Quaternion;\\n};\\n\\nexport type Quaternion = {\\n  x: number;\\n  y: number;\\n  z: number;\\n  w: number;\\n};\\n\\nexport type Transform = {\\n  header: Header;\\n  child_frame_id: string;\\n  transform: {\\n    translation: Translation;\\n    rotation: Rotation;\\n  };\\n};\\n\\nexport type PointStyle =\\n  | \\\"circle\\\"\\n  | \\\"cross\\\"\\n  | \\\"crossRot\\\"\\n  | \\\"dash\\\"\\n  | \\\"line\\\"\\n  | \\\"rect\\\"\\n  | \\\"rectRounded\\\"\\n  | \\\"rectRot\\\"\\n  | \\\"star\\\"\\n  | \\\"triangle\\\";\\n\\nexport type TwoDimensionalPlotLine = {\\n  order?: number;\\n  label: string;\\n  backgroundColor?: string;\\n  borderColor?: string;\\n  borderDash?: number[];\\n  borderWidth?: number;\\n  pointBackgroundColor?: string;\\n  pointBorderColor?: string;\\n  pointBorderWidth?: number;\\n  pointRadius?: number;\\n  pointStyle?: PointStyle;\\n  lineTension?: number;\\n  data: { x: number; y: number }[];\\n};\\n/*\\n * Use this type to plot values in the 2D Panel. If you need to change this\\n * type, please ensure that is kept in sync with the TwoDimensionalPlot\\n * counterpart.\\n */\\nexport type TwoDimensionalPlot = {\\n  lines: TwoDimensionalPlotLine[];\\n  points?: TwoDimensionalPlotLine[];\\n  polygons?: TwoDimensionalPlotLine[];\\n  title?: string;\\n  yAxisLabel?: string;\\n  xAxisLabel?: string;\\n  gridColor?: string;\\n};\\n\"","module.exports = \"import { Point, Rotation } from \\\"./types\\\";\\n\\ntype vec3 = [number, number, number];\\n\\n/*\\n * Dot-product of two vectors.\\n */\\nexport function dot(vec1: number[], vec2: number[]) {\\n  let i;\\n  let ret: number = 0.0;\\n  for (i = 0; i < vec1.length; ++i) {\\n    ret += vec1[i] * vec2[i];\\n  }\\n  return ret;\\n}\\n\\n/*\\n * Cross-product of two vectors.\\n */\\nexport function cross(vec1: vec3, vec2: vec3) {\\n  const [ax, ay, az] = vec1;\\n  const [bx, by, bz] = vec2;\\n  let ret = [ay * bz - az * by, az * bx - ax * bz, ax * by - ay * bx];\\n  return ret;\\n}\\n\\n/*\\n * Performs a rotation transformation on a point.\\n */\\nexport function rotate(rotation: Rotation, point: Point) {\\n  const v: vec3 = [point.x, point.y, point.z];\\n\\n  // Extract the vector part of the quaternion\\n  const u: vec3 = [rotation.x, rotation.y, rotation.z];\\n\\n  // Extract the scalar part of the quaternion\\n  const s = -1 * rotation.w;\\n\\n  // Do the math\\n  const t1 = scalarMultiply(u, 2.0 * dot(u, v));\\n  const t2 = scalarMultiply(v, s * s - dot(u, u));\\n  const t3 = scalarMultiply(cross(u, v), 2 * s);\\n  const d = vectorAddition([t1, t2, t3]);\\n\\n  return {\\n    x: d[0],\\n    y: d[1],\\n    z: d[2],\\n  };\\n}\\n\\n/*\\n * Scales a vector.\\n */\\nexport function scalarMultiply(vector: number[], scalar: number) {\\n  const ret = vector.slice();\\n  let i;\\n  for (i = 0; i < ret.length; ++i) {\\n    ret[i] *= scalar;\\n  }\\n  return ret;\\n}\\n\\n/*\\n * Sums an array of vectors.\\n */\\nexport function vectorAddition(vectors: number[][]): number[] {\\n  let i;\\n  let ret = vectors[0].slice();\\n  for (i = 1; i < vectors.length; ++i) {\\n    let j;\\n    for (j = 0; j < ret.length; ++j) {\\n      ret[j] += vectors[i][j];\\n    }\\n  }\\n  return ret;\\n}\\n\"","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport markerArray from \"./markerArray.template.ts\";\nimport twoDimensionalPlot from \"./twoDimensionalPlot.template.ts\";\n\nexport default [\n  { name: \"2D Plot\", description: \"Quickly create 2D Plot topics\", template: twoDimensionalPlot },\n  {\n    name: \"MarkerArray\",\n    description: \"Basic template for a node that publishes one or more markers\",\n    template: markerArray,\n  },\n];\n","module.exports = \"import { Input, Messages } from \\\"ros\\\";\\nimport { Marker, MarkerTypes } from \\\"./markers\\\";\\n\\ntype GlobalVariables = { id: number };\\n\\nexport const inputs = [];\\nexport const output = \\\"/webviz_node/\\\";\\n\\n// Populate 'Input' with a parameter to properly type your inputs, e.g. 'Input<\\\"/your_input_topic\\\">'\\nconst publisher = (message: Input<>, globalVars: GlobalVariables): Messages.visualization_msgs__MarkerArray => {\\n  const markers: Marker[] = [\\n    new Marker({\\n      /* e.g 'type: MarkerTypes.ARROW' */\\n    }),\\n  ];\\n  return {\\n    markers,\\n  };\\n};\\n\\nexport default publisher;\\n\"","module.exports = \"import { Input, Messages } from \\\"ros\\\";\\nimport { TwoDimensionalPlot, TwoDimensionalPlotLine } from \\\"./types\\\";\\n\\ntype GlobalVariables = { id: number };\\n\\nexport const inputs = [];\\nexport const output = \\\"/webviz_node/\\\";\\n\\n// Populate 'Input' with a parameter to properly type your inputs, e.g. 'Input<\\\"/your_input_topic\\\">'\\nconst publisher = (message: Input<>, globalVars: GlobalVariables): TwoDimensionalPlot => {\\n  const lines: TwoDimensionalPlotLine[] = [];\\n  const points: TwoDimensionalPlotLine[] = [];\\n  const polygons: TwoDimensionalPlotLine[] = [];\\n\\n  return {\\n    lines,\\n    points,\\n    polygons,\\n  };\\n};\\n\\nexport default publisher;\\n\"","module.exports = \"# Node Playground Utilities\\n\\nThis directory includes a number of utility functions that can be used in any node playground. You can import them into your node like this:\\n\\n```typescript\\nimport { compare } from \\\"./time.ts\\\"\\n```\\n\\n## Contributing\\n\\n_Prequisites: You will need to have the Webviz repo cloned locally to update these utilities. You just need to have node and yarn installed to get going though, follow those steps in the `developer-guide.md`._\\n\\n### TL;DR\\n\\n- Update utility\\n- Add unit testing and a structured comment (as needed)\\n- Run `yarn run test:user-utilities` (checks compilation and runs tests)\\n- Open PR for Webviz review\\n\\nIf you'd like to add any reusable utilities, simply add (or tweak) the relevant file with the function/class/constant you'd like to expose! Make sure to mark your variable declaration with the `export` keyword so that it will be importable from other modules.\\n\\nIf one of the filenames is not to your liking, or you'd like to add a new one, just make sure to keep the `*.ts` extension and keep the directory flat (i.e. not nested folders). You will also need to import the file in `userUtils/index.js` and add an entry that mimics the format present in other imports.\\n\\nFor adding new functions and what not, also be sure to add a short description of what it is used for using the multiline comment syntax:\\n\\n```typescript\\n/**\\n* YOUR COMMENT\\n*/\\n```\\n\\nThis structure will ensure your modules get coupled with inline documentation.\\n\\nWe also have unit testing available for these modules! Please add releveant unit tests for all new/amended code, it'll help us keep the bar high for our consumers.\\n\\nThen open up a PR in the webviz repo and post in the webviz channel. We'll make sure a team member looks at it in a timely manner! :)\\n\\n### FAQ\\n\\n> Can I use third-party packages?\\n\\nNot at the moment, but please let us know if that would be useful for you! Be sure to specify which package(s) you would like and why you want them.\\n\\n> Can I use other Webviz code here?\\n\\nWebviz has many utilities that you are free to copy and paste into this directory, as long as you also provide relevant unit testing. Keep in mind the rest of Webviz is written in Flow, which, while very similar to Typescript, has a few discrepancies. Feel free to reach out to the Webviz team if you're having any trouble with this!\\n\\n> Are these utilities versioned?\\n\\nNot currently. We would like to get around to this eventually, but wanted to harden this feature first.\\n\"","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useCallback } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport helpContent from \"./index.help.md\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\n\nconst STextArea = styled.textarea`\n  width: 100%;\n  height: 100%;\n  resize: none;\n  border: none;\n  margin: 0;\n  padding: 4px 6px;\n  &:focus {\n    background: rgba(255, 255, 255, 0.1);\n  }\n`;\n\ntype Config = { noteText: string };\ntype Props = { config: Config, saveConfig: SaveConfig<Config> };\nfunction Note({ config, saveConfig }: Props) {\n  const onChangeText = useCallback((event: SyntheticInputEvent<HTMLTextAreaElement>) => {\n    saveConfig({ noteText: event.target.value });\n  }, [saveConfig]);\n\n  return (\n    <Flex col style={{ height: \"100%\" }}>\n      <PanelToolbar helpContent={helpContent} floating />\n      <STextArea placeholder=\"Enter note here\" value={config.noteText} onChange={onChangeText} />\n    </Flex>\n  );\n}\nNote.panelType = \"Note\";\nNote.defaultConfig = { noteText: \"\" };\n\nexport default hot(Panel<Config>(Note));\n","module.exports = \"# Note Panel\\n\\nProvides a place for you to write and save your notes.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport Flex from \"webviz-core/src/components/Flex\";\nimport MessageHistoryDEPRECATED from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport { type MessagePipelineContext, useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\n\nconst MAX_ALLOWABLE_RENDER_COUNT = 10;\n\n// Little dummy panel that just shows the number of renders that happen when not subscribing\n// to anything. Useful for debugging performance issues.\nlet panelRenderCount = 0;\nlet messageHistoryRenderCount = 0;\nlet messagePipelineRenderCount = 0;\nlet useMessageReducerRenderCount = 0;\n\n// Exported for stories\nexport const resetRenderCountsForTests = () => {\n  panelRenderCount = 0;\n  messageHistoryRenderCount = 0;\n  messagePipelineRenderCount = 0;\n  useMessageReducerRenderCount = 0;\n};\n\nwindow.getNumberOfRendersCountsForTests = function() {\n  return {\n    panelRenderCount,\n    messageHistoryRenderCount,\n    useMessageReducerRenderCount,\n    messagePipelineRenderCount,\n  };\n};\n\nconst getRenderCountMessage = (renderCount) =>\n  renderCount <= MAX_ALLOWABLE_RENDER_COUNT ? \" Ok!\" : ` Too many renders = ${renderCount}`;\n\nfunction HooksComponent() {\n  PanelAPI.useMessageReducer({\n    topics: [],\n    restore: React.useCallback(() => null, []),\n    addMessage: React.useCallback(() => null, []),\n  });\n  return `useMessageReducerRenderCount: ${getRenderCountMessage(useMessageReducerRenderCount++)}`;\n}\n\nfunction MessagePipelineRendersComponent() {\n  // This is a private API, so panels should not be using it, but it's still bad if it renders too\n  // much. And in practice there might still be some panels that use it directly. :-(\n  useMessagePipeline<MessagePipelineContext>((context: MessagePipelineContext) => context);\n  return `messagePipelineRenderCount: ${++messagePipelineRenderCount}`;\n}\n\nfunction NumberOfRenders(): React.Node {\n  panelRenderCount++;\n  return (\n    <Flex col>\n      <PanelToolbar />\n      <Flex col center style={{ fontSize: 20, lineHeight: 1.5, textAlign: \"center\" }}>\n        <div>\n          <MessageHistoryDEPRECATED paths={[]}>\n            {() => (\n              <>\n                panelRenderCount: {getRenderCountMessage(panelRenderCount)} <br />\n                messageHistoryRenderCount: {getRenderCountMessage(++messageHistoryRenderCount)}\n              </>\n            )}\n          </MessageHistoryDEPRECATED>\n        </div>\n        <div>\n          <HooksComponent />\n        </div>\n        {!inScreenshotTests() && <MessagePipelineRendersComponent /> // Too flakey for screenshots.\n        }\n      </Flex>\n    </Flex>\n  );\n}\n\nNumberOfRenders.panelType = \"NumberOfRenders\";\nNumberOfRenders.defaultConfig = {};\n\nexport default hot(Panel<{}>(NumberOfRenders));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { last, sumBy } from \"lodash\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport helpContent from \"./index.help.md\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport { Sparkline, type SparklinePoint } from \"webviz-core/src/components/Sparkline\";\nimport type { PlayerStateActiveData } from \"webviz-core/src/players/types\";\nimport { subtractTimes, toSec } from \"webviz-core/src/util/time\";\n\nconst TIME_RANGE = 5000;\n\ntype PlaybackPerformanceItemProps = {|\n  points: SparklinePoint[],\n  maximum: number,\n  decimalPlaces: number,\n  children: React.Node,\n|};\n\nfunction PlaybackPerformanceItem(props: PlaybackPerformanceItemProps): React.Node {\n  return (\n    <div style={{ margin: 8 }}>\n      <Sparkline points={props.points} maximum={props.maximum} width={100} height={30} timeRange={TIME_RANGE} />\n      <div style={{ display: \"inline-block\", marginLeft: 12, verticalAlign: \"middle\" }}>\n        {(last(props.points) || { value: 0 }).value.toFixed(props.decimalPlaces)}\n        {props.children}\n        <div style={{ color: \"#aaa\" }}>\n          {(sumBy(props.points, \"value\") / props.points.length).toFixed(props.decimalPlaces)} avg\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport type UnconnectedPlaybackPerformanceProps = $ReadOnly<{|\n  timestamp: number,\n  activeData: ?PlayerStateActiveData,\n|}>;\n\n// Exported for stories\nexport function UnconnectedPlaybackPerformance({ timestamp, activeData }: UnconnectedPlaybackPerformanceProps) {\n  const playbackInfo = React.useRef<?{| timestamp: number, activeData: PlayerStateActiveData |}>();\n  const lastPlaybackInfo = playbackInfo.current;\n  if (activeData && (!playbackInfo.current || playbackInfo.current.activeData !== activeData)) {\n    playbackInfo.current = { timestamp, activeData };\n  }\n\n  const perfPoints = React.useRef<{|\n    speed: SparklinePoint[],\n    framerate: SparklinePoint[],\n    bagTimeMs: SparklinePoint[],\n    megabitsPerSecond: SparklinePoint[],\n  |}>({\n    speed: [],\n    framerate: [],\n    bagTimeMs: [],\n    megabitsPerSecond: [],\n  });\n\n  if (activeData && playbackInfo.current && lastPlaybackInfo && lastPlaybackInfo.activeData !== activeData) {\n    const renderTimeMs = timestamp - lastPlaybackInfo.timestamp;\n    if (\n      lastPlaybackInfo.activeData.isPlaying &&\n      activeData.isPlaying &&\n      lastPlaybackInfo.activeData.lastSeekTime === activeData.lastSeekTime &&\n      lastPlaybackInfo.activeData.currentTime !== activeData.currentTime\n    ) {\n      const bagTimeMs = toSec(subtractTimes(activeData.currentTime, lastPlaybackInfo.activeData.currentTime)) * 1000;\n      perfPoints.current.speed.push({ value: bagTimeMs / renderTimeMs, timestamp });\n      perfPoints.current.framerate.push({ value: 1000 / renderTimeMs, timestamp });\n      perfPoints.current.bagTimeMs.push({ value: bagTimeMs, timestamp });\n    }\n    const newBytesReceived = activeData.totalBytesReceived - lastPlaybackInfo.activeData.totalBytesReceived;\n    const newMegabitsReceived = (8 * newBytesReceived) / 1e6;\n    const megabitsPerSecond = newMegabitsReceived / (renderTimeMs / 1000);\n    perfPoints.current.megabitsPerSecond.push({ value: megabitsPerSecond, timestamp });\n    for (const name in perfPoints.current) {\n      const points = perfPoints.current[name];\n      while (points[0] && points[0].timestamp < timestamp - TIME_RANGE) {\n        points.shift();\n      }\n    }\n  }\n\n  return (\n    <Flex col>\n      <PanelToolbar floating helpContent={helpContent} />\n      <Flex col wrap center start style={{ lineHeight: 1, whiteSpace: \"nowrap\" }}>\n        <PlaybackPerformanceItem points={perfPoints.current.speed} maximum={1.6} decimalPlaces={2}>\n          &times; realtime\n        </PlaybackPerformanceItem>\n        <PlaybackPerformanceItem points={perfPoints.current.framerate} maximum={30} decimalPlaces={1}>\n          fps\n        </PlaybackPerformanceItem>\n        <PlaybackPerformanceItem points={perfPoints.current.bagTimeMs} maximum={300} decimalPlaces={0}>\n          ms bag frame\n        </PlaybackPerformanceItem>\n        <PlaybackPerformanceItem points={perfPoints.current.megabitsPerSecond} maximum={100} decimalPlaces={1}>\n          Mbps\n        </PlaybackPerformanceItem>\n      </Flex>\n    </Flex>\n  );\n}\n\nfunction PlaybackPerformance(): React.Node {\n  const timestamp = Date.now();\n  const { activeData } = useMessagePipeline(\n    React.useCallback(({ playerState }) => ({ activeData: playerState.activeData }), [])\n  );\n  return <UnconnectedPlaybackPerformance timestamp={timestamp} activeData={activeData} />;\n}\n\nPlaybackPerformance.panelType = \"PlaybackPerformance\";\nPlaybackPerformance.defaultConfig = {};\n\nexport default hot(Panel<{}>(PlaybackPerformance));\n","module.exports = \"# Playback performance\\n\\nDisplays statistics on recent playback and data-streaming performance.\\n\\n\\\"Instantaneous\\\" statistics are reported based on the most recent frame, and also averaged over the last five seconds.\\n\\n## Playback speed\\n\\nThe player tries to play at the speed specified by the user, but may not be able to keep up, given heavy layouts and large amounts of data. This chart displays the _actual_ playback speed as a ratio of bag time to playback time.\\n\\n## Frame rate\\n\\nThe number of frames played per second. Though the player can play back at up to 60fps, this statistic will be lower if frames take longer than 16ms to render.\\n\\n## Bag frame time\\n\\nThe duration in bag-time for the rendered frames in milliseconds. To \\\"keep up\\\" with playback, Webviz will often emit \\\"larger\\\" frames.\\n\\n## Data throughput\\n\\nThe amount of data received by the player in megabits per second. For remote bags, this includes topics that the player is not subscribed to.\\n\\nThis statistic does not account for `Content-Encoding` compression, so it may be larger than the actual network bandwidth.\\n\"","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { max } from \"lodash\";\nimport * as React from \"react\";\n\nimport AutoSizingCanvas from \"webviz-core/src/components/AutoSizingCanvas\";\n\nexport type SparklinePoint = {| value: number, timestamp: number |};\n\ntype SparklineProps = {|\n  points: SparklinePoint[],\n  width: number,\n  height: number,\n  timeRange: number,\n  maximum?: number,\n  nowStamp?: number, // Mostly for testing.\n|};\n\nfunction draw(\n  points: SparklinePoint[],\n  maximum: number,\n  timeRange: number,\n  nowStamp: number,\n  context: CanvasRenderingContext2D,\n  width: number,\n  height: number\n) {\n  const maxValue = Math.max(maximum, max(points.map(({ value }) => value)));\n  context.clearRect(0, 0, width, height);\n  context.beginPath();\n  context.strokeStyle = \"white\";\n  let first = true;\n  for (const { value, timestamp } of points) {\n    const x = ((timeRange + timestamp - nowStamp) / timeRange) * width;\n    const y = (1 - value / maxValue) * height;\n    if (first) {\n      context.moveTo(x, y);\n      first = false;\n    } else {\n      context.lineTo(x, y);\n    }\n  }\n  context.stroke();\n}\n\nexport function Sparkline(props: SparklineProps) {\n  return (\n    <div\n      style={{\n        display: \"inline-block\",\n        verticalAlign: \"-10px\",\n        backgroundColor: \"#333\",\n        width: props.width,\n        height: props.height,\n      }}>\n      <AutoSizingCanvas\n        draw={(context: CanvasRenderingContext2D, width: number, height: number) => {\n          draw(props.points, props.maximum || 0, props.timeRange, props.nowStamp || Date.now(), context, width, height);\n        }}\n      />\n    </div>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport buildSampleMessage from \"./buildSampleMessage\";\nimport { PanelToolbarInput, PanelToolbarLabel } from \"webviz-core/shared/panelToolbarStyles\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport Publisher from \"webviz-core/src/components/Publisher\";\nimport { PlayerCapabilities, type Topic } from \"webviz-core/src/players/types\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\n\ntype Config = {|\n  topicName: string,\n  datatype: string,\n  buttonText: string,\n  buttonTooltip: string,\n  buttonColor: string,\n  advancedView: boolean,\n  value: string,\n|};\n\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n\n  // player state\n  capabilities: string[],\n  topics: Topic[],\n  datatypes: RosDatatypes,\n};\n\ntype PanelState = {|\n  cachedProps: $Shape<Props>,\n  datatypeNames: string[],\n  parsedObject: ?any,\n  error: ?string,\n|};\n\nconst STextArea = styled.textarea`\n  width: 100%;\n  height: 100%;\n  resize: none;\n`;\n\nconst STextAreaContainer = styled.div`\n  flex-grow: 1;\n  padding: 12px 0;\n`;\n\nconst SErrorText = styled.div`\n  flex: 1 1 auto;\n  display: flex;\n  align-items: center;\n  padding: 4px;\n  color: ${colors.red};\n`;\n\nconst SSpan = styled.span`\n  opacity: 0.8;\n`;\nconst SRow = styled.div`\n  display: flex;\n  line-height: 24px;\n  flex-shrink: 0;\n`;\n\nfunction getTopicName(topic: Topic): string {\n  return topic.name;\n}\n\nfunction parseInput(value: string): $Shape<PanelState> {\n  let parsedObject;\n  let error = null;\n  try {\n    const parsedAny = JSON.parse(value);\n    if (Array.isArray(parsedAny)) {\n      error = \"Message content must be an object, not an array\";\n    } else if (parsedAny === null) {\n      error = \"Message content must be an object, not null\";\n    } else if (typeof parsedAny !== \"object\") {\n      error = `Message content must be an object, not ${typeof parsedAny}`;\n    } else {\n      parsedObject = parsedAny;\n    }\n  } catch (e) {\n    error = value ? e.message : \"\";\n  }\n  return { error, parsedObject };\n}\n\nclass Publish extends React.PureComponent<Props, PanelState> {\n  static panelType = \"Publish\";\n  static defaultConfig = {\n    topicName: \"\",\n    datatype: \"\",\n    buttonText: \"Publish\",\n    buttonTooltip: \"\",\n    buttonColor: \"#00A871\",\n    advancedView: true,\n    value: \"\",\n  };\n\n  _publisher = React.createRef<Publisher>();\n\n  state = {\n    cachedProps: {},\n    datatypeNames: [],\n    error: null,\n    parsedObject: undefined,\n  };\n\n  static getDerivedStateFromProps(props: Props, state: PanelState) {\n    const newState: $Shape<PanelState> = parseInput(props.config.value);\n    let changed = false;\n\n    if (props !== state.cachedProps) {\n      newState.cachedProps = props;\n      changed = true;\n    }\n\n    if (props.datatypes !== state.cachedProps.datatypes) {\n      newState.datatypeNames = Object.keys(props.datatypes).sort();\n      changed = true;\n    }\n\n    // when the selected datatype changes, replace the textarea contents with a sample message of the correct shape\n    // Make sure not to build a sample message on first load, though -- we don't want to overwrite\n    // the user's message just because state.cachedProps.config hasn't been initialized.\n    if (\n      props.config.datatype &&\n      state.cachedProps?.config?.datatype != null &&\n      props.config.datatype !== state.cachedProps?.config?.datatype &&\n      props.datatypes[props.config.datatype] != null\n    ) {\n      const sampleMessage = buildSampleMessage(props.datatypes, props.config.datatype);\n      if (sampleMessage) {\n        const stringifiedSampleMessage = JSON.stringify(sampleMessage, null, 2);\n        props.saveConfig({ value: stringifiedSampleMessage });\n        changed = true;\n      }\n    }\n\n    return changed ? newState : null;\n  }\n\n  _onChangeTopic = (event, topicName: string) => {\n    this.props.saveConfig({ topicName });\n  };\n\n  // when a known topic is selected, also fill in its datatype\n  _onSelectTopic = (topicName: string, topic: Topic, autocomplete: Autocomplete) => {\n    this.props.saveConfig({ topicName, datatype: topic.datatype });\n    autocomplete.blur();\n  };\n\n  _onSelectDatatype = (datatype: string, value: any, autocomplete: Autocomplete) => {\n    this.props.saveConfig({ datatype });\n    autocomplete.blur();\n  };\n\n  _publish = () => {\n    const { topicName } = this.props.config;\n    const { parsedObject } = this.state;\n    if (topicName && parsedObject && this._publisher.current) {\n      this._publisher.current.publish(parsedObject);\n    } else {\n      throw new Error(`called _publish() when input was invalid`);\n    }\n  };\n\n  _onChange = (event: SyntheticInputEvent<HTMLTextAreaElement>) => {\n    this.props.saveConfig({ value: event.target.value });\n  };\n\n  _renderMenuContent() {\n    const { config, saveConfig } = this.props;\n\n    return (\n      <>\n        <Item\n          icon={config.advancedView ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n          onClick={() => {\n            saveConfig({ advancedView: !config.advancedView });\n          }}>\n          <span>Advanced mode</span>\n        </Item>\n        <Item>\n          <PanelToolbarLabel>Button text</PanelToolbarLabel>\n          <PanelToolbarInput\n            type=\"text\"\n            value={config.buttonText}\n            onChange={(event) => {\n              saveConfig({ buttonText: event.target.value });\n            }}\n            placeholder=\"Publish\"\n          />\n        </Item>\n        <Item>\n          <PanelToolbarLabel>Button tooltip</PanelToolbarLabel>\n          <PanelToolbarInput\n            type=\"text\"\n            value={config.buttonTooltip}\n            onChange={(event) => {\n              saveConfig({ buttonTooltip: event.target.value });\n            }}\n          />\n        </Item>\n        <Item>\n          <PanelToolbarLabel>Button color (rgba or hex)</PanelToolbarLabel>\n          <PanelToolbarInput\n            type=\"text\"\n            value={config.buttonColor}\n            onChange={(event) => {\n              saveConfig({ buttonColor: event.target.value });\n            }}\n            placeholder=\"rgba(1,1,1,1) or #FFFFFF\"\n          />\n        </Item>\n      </>\n    );\n  }\n\n  render() {\n    const {\n      capabilities,\n      topics,\n      config: { topicName, datatype, buttonText, buttonTooltip, buttonColor, advancedView, value },\n    } = this.props;\n\n    const { datatypeNames, parsedObject, error } = this.state;\n    const canPublish = capabilities.includes(PlayerCapabilities.advertise);\n    const buttonRowStyle = advancedView ? { flex: \"0 0 auto\" } : { flex: \"0 0 auto\", justifyContent: \"center\" };\n\n    return (\n      <Flex col style={{ height: \"100%\", padding: \"12px\" }}>\n        {topicName && datatype && (\n          <Publisher ref={this._publisher} name=\"Publish\" topic={topicName} datatype={datatype} />\n        )}\n        <PanelToolbar floating menuContent={this._renderMenuContent()} />\n        {advancedView && (\n          <SRow>\n            <SSpan>Topic:</SSpan>\n            <Autocomplete\n              placeholder=\"Choose a topic\"\n              items={topics}\n              hasError={false}\n              onChange={this._onChangeTopic}\n              onSelect={this._onSelectTopic}\n              selectedItem={{ name: topicName }}\n              getItemText={getTopicName}\n              getItemValue={getTopicName}\n            />\n          </SRow>\n        )}\n        {advancedView && (\n          <SRow>\n            <PanelToolbarLabel>Datatype:</PanelToolbarLabel>\n            <Autocomplete\n              clearOnFocus\n              placeholder=\"Choose a datatype\"\n              items={datatypeNames}\n              onSelect={this._onSelectDatatype}\n              selectedItem={datatype}\n            />\n          </SRow>\n        )}\n        {advancedView && (\n          <STextAreaContainer>\n            <STextArea placeholder=\"Enter message content as JSON\" value={value || \"\"} onChange={this._onChange} />\n          </STextAreaContainer>\n        )}\n        <Flex row style={buttonRowStyle}>\n          {error && <SErrorText>{error}</SErrorText>}\n          <Button\n            style={canPublish ? { backgroundColor: buttonColor } : {}}\n            tooltip={canPublish ? buttonTooltip : \"Connect to ROS to publish data\"}\n            disabled={!canPublish || !parsedObject}\n            primary={canPublish && !!parsedObject}\n            onClick={this._publish}>\n            {buttonText}\n          </Button>\n        </Flex>\n      </Flex>\n    );\n  }\n}\n\nexport default hot(Panel<Config>(Publish));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\n\nexport const builtinSampleValues = {\n  bool: false,\n  int8: 0,\n  uint8: 0,\n  int16: 0,\n  uint16: 0,\n  int32: 0,\n  uint32: 0,\n  int64: 0,\n  uint64: 0,\n  float32: 0,\n  float64: 0,\n  string: \"\",\n  time: { sec: 0, nsec: 0 },\n  duration: { sec: 0, nsec: 0 },\n};\n\nexport default function buildSampleMessage(datatypes: RosDatatypes, datatype: string): ?any {\n  const builtin = builtinSampleValues[datatype];\n  if (builtin != null) {\n    return builtin;\n  }\n  const fields = datatypes[datatype].fields;\n  if (!fields) {\n    return null;\n  }\n  const obj = {};\n  for (const field of fields) {\n    if (field.isConstant) {\n      continue;\n    }\n    const sample = buildSampleMessage(datatypes, field.type);\n    if (field.isArray) {\n      if (field.arrayLength != null) {\n        obj[field.name] = new Array(field.arrayLength).fill(sample);\n      } else {\n        obj[field.name] = [sample];\n      }\n    } else {\n      obj[field.name] = sample;\n    }\n  }\n  return obj;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport * as React from \"react\";\nimport uuid from \"uuid\";\n\nimport { MessagePipelineConsumer, type MessagePipelineContext } from \"webviz-core/src/components/MessagePipeline\";\n\ntype Props = {|\n  topic: string,\n  datatype: string,\n  name: string,\n|};\n\n// Component that registers a publisher with the player and provides a publish() function to publish data.\nexport default class Publisher extends React.PureComponent<Props> {\n  _id: string = uuid.v4();\n  _context: ?MessagePipelineContext;\n\n  _getContext(): MessagePipelineContext {\n    if (!this._context) {\n      throw new Error(\"this._context is missing in <Publisher>\");\n    }\n    return this._context;\n  }\n\n  _setPublishers() {\n    const { topic, datatype, name } = this.props;\n    this._getContext().setPublishers(this._id, [{ topic, datatype, advertiser: { type: \"panel\", name } }]);\n  }\n\n  componentDidMount() {\n    this._setPublishers();\n  }\n\n  componentDidUpdate() {\n    this._setPublishers();\n  }\n\n  componentWillUnmount() {\n    this._getContext().setPublishers(this._id, []);\n  }\n\n  publish(msg: any) {\n    const { topic } = this.props;\n    this._getContext().publish({ topic, msg });\n  }\n\n  render() {\n    return (\n      <MessagePipelineConsumer>\n        {(context: MessagePipelineContext) => {\n          this._context = context;\n          return null;\n        }}\n      </MessagePipelineConsumer>\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ClipboardOutlineIcon from \"@mdi/svg/svg/clipboard-outline.svg\";\nimport cx from \"classnames\";\nimport React, { PureComponent } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { Creatable as ReactSelectCreatable } from \"react-select\";\nimport VirtualizedSelect from \"react-virtualized-select\";\nimport { createSelector } from \"reselect\";\n\nimport helpContent from \"./index.help.md\";\nimport styles from \"./index.module.scss\";\nimport LevelToString, { KNOWN_LOG_LEVELS } from \"./LevelToString\";\nimport LogMessage from \"./LogMessage\";\nimport logStyle from \"./LogMessage.module.scss\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport LogList from \"webviz-core/src/components/LogList\";\nimport MessageHistoryDEPRECATED, {\n  type MessageHistoryData,\n  type MessageHistoryItem,\n} from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport { cast, type ReflectiveMessage, type Topic } from \"webviz-core/src/players/types\";\nimport { type Header } from \"webviz-core/src/types/Messages\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { $ROSOUT } from \"webviz-core/src/util/globalConstants\";\n\n// Remove creatable warning https://github.com/JedWatson/react-select/issues/2181\nclass Creatable extends React.Component<{}, {}> {\n  render() {\n    return <ReactSelectCreatable {...this.props} />;\n  }\n}\n\ntype Option = {\n  value: any,\n  label: string,\n};\n\ntype Config = {\n  searchTerms: string[],\n  minLogLevel: number,\n  topicToRender: string,\n};\n\ntype Props = {\n  config: Config,\n  saveConfig: (Config) => void,\n  topics: Topic[],\n};\n\n// Create the log level options nodes once since they don't change per render.\nconst LOG_LEVEL_OPTIONS = KNOWN_LOG_LEVELS.map((level) => ({\n  label: `>= ${LevelToString(level)}`,\n  value: level,\n}));\n\n// Persist the identity of selectedOptions for React Creatable.\n// Without it, we can't create new options.\nexport const stringsToOptions = createSelector<*, *, *, _>(\n  (strs: string[]) => strs,\n  (strs: string[]): Option[] => strs.map((value) => ({ label: value, value }))\n);\n\ntype RosgraphMsgs$Log = $ReadOnly<{|\n  header: Header,\n  level: number,\n  name: string,\n  msg: string,\n  file: string,\n  function: string,\n  line: number,\n  topics: $ReadOnlyArray<string>,\n|}>;\n\nexport const getShouldDisplayMsg = (\n  message: ReflectiveMessage,\n  minLogLevel: number,\n  searchTerms: string[]\n): boolean => {\n  const logMessage = cast<RosgraphMsgs$Log>(message.message);\n  if (logMessage.level < minLogLevel) {\n    return false;\n  }\n\n  if (searchTerms.length < 1) {\n    // No search term filters so this message should be visible.\n    return true;\n  }\n  const searchTermsInLowerCase = searchTerms.map((term) => term.toLowerCase());\n  const { name, msg } = logMessage;\n  const lowerCaseName = name.toLowerCase();\n  const lowerCaseMsg = msg.toLowerCase();\n  return searchTermsInLowerCase.some((term) => lowerCaseName.includes(term) || lowerCaseMsg.includes(term));\n};\n\nclass RosoutPanel extends PureComponent<Props> {\n  static defaultConfig = { searchTerms: [], minLogLevel: 1, topicToRender: $ROSOUT };\n  static panelType = \"RosOut\";\n\n  _onNodeFilterChange = (selectedOptions: Option[]) => {\n    this.props.saveConfig({ ...this.props.config, searchTerms: selectedOptions.map((option) => option.value) });\n  };\n\n  _onLogLevelChange = (minLogLevel: number) => {\n    this.props.saveConfig({ ...this.props.config, minLogLevel });\n  };\n\n  _filterFn = (item: MessageHistoryItem) =>\n    getShouldDisplayMsg(item.message, this.props.config.minLogLevel, this.props.config.searchTerms);\n\n  _getFilteredMessages(items: $ReadOnlyArray<MessageHistoryItem>): $ReadOnlyArray<MessageHistoryItem> {\n    const { minLogLevel, searchTerms } = this.props.config;\n    const hasActiveFilters = minLogLevel > 1 || searchTerms.length > 0;\n    if (!hasActiveFilters) {\n      // This early return avoids looping over the full list with a filter that will always return true.\n      return items;\n    }\n    return items.filter(this._filterFn);\n  }\n\n  _renderFiltersBar = (seenNodeNames: Set<string>, msgs: $ReadOnlyArray<MessageHistoryItem>) => {\n    const { minLogLevel, searchTerms } = this.props.config;\n    const nodeNameOptions = Array.from(seenNodeNames).map((name) => ({ label: name, value: name }));\n\n    return (\n      <div className={styles.filtersBar}>\n        <VirtualizedSelect\n          className={cx(styles.severityFilter)}\n          clearable={false}\n          searchable={false}\n          value={minLogLevel}\n          optionHeight={parseInt(styles.optionHeight)}\n          maxHeight={parseInt(styles.optionHeight) * KNOWN_LOG_LEVELS.length}\n          options={LOG_LEVEL_OPTIONS}\n          optionRenderer={({ key, style: styleProp, option, focusedOption }) => (\n            <div\n              className={cx(logStyle[LevelToString(option.value).toLowerCase()], \"VirtualizedSelectOption\", {\n                VirtualizedSelectFocusedOption: focusedOption === option,\n              })}\n              style={styleProp}\n              onClick={() => this._onLogLevelChange(option.value)}\n              key={key}>\n              {option.label}\n            </div>\n          )}\n          valueComponent={(option) => <span>{`Min Severity: ${LevelToString(option.value.value)}`}</span>}\n        />\n        <VirtualizedSelect\n          className={styles.nodeFilter}\n          clearable\n          multi\n          closeOnSelect={false}\n          value={stringsToOptions(searchTerms)}\n          onChange={this._onNodeFilterChange}\n          options={nodeNameOptions}\n          optionHeight={parseInt(styles.optionHeight)}\n          placeholder=\"Filter by node name or message text\"\n          searchable\n          selectComponent={Creatable}\n          promptTextCreator={(label) => `Node names or msgs containing \"${label}\"`}\n        />\n        <div className={styles.itemsCountField}>\n          {msgs.length} {msgs.length === 1 ? \"item\" : \"items\"}\n          <Icon\n            style={{ padding: \"1px 0px 0px 6px\" }}\n            onClick={() => {\n              clipboard.copy(JSON.stringify(msgs, null, 2));\n            }}\n            tooltip=\"Copy rosout to clipboard\">\n            <ClipboardOutlineIcon />\n          </Icon>\n        </div>\n      </div>\n    );\n  };\n  _renderRow({ item, style, key, index }) {\n    return (\n      <div key={key} style={index === 0 ? { ...style, paddingTop: 36 } : style}>\n        <LogMessage msg={item.message.message} />\n      </div>\n    );\n  }\n\n  render() {\n    const { topics, config } = this.props;\n    const seenNodeNames = new Set();\n\n    const topicToRenderMenu = (\n      <TopicToRenderMenu\n        topicToRender={config.topicToRender}\n        onChange={(topicToRender) => this.props.saveConfig({ ...this.props.config, topicToRender })}\n        topics={topics}\n        singleTopicDatatype=\"rosgraph_msgs/Log\"\n        defaultTopicToRender={$ROSOUT}\n      />\n    );\n\n    return (\n      <MessageHistoryDEPRECATED paths={[config.topicToRender]} historySize={100000}>\n        {({ itemsByPath }: MessageHistoryData) => {\n          const msgs: $ReadOnlyArray<MessageHistoryItem> = itemsByPath[config.topicToRender];\n          msgs.forEach((msg) => seenNodeNames.add(cast<RosgraphMsgs$Log>(msg.message.message).name));\n\n          return (\n            <Flex col>\n              <PanelToolbar floating helpContent={helpContent} additionalIcons={topicToRenderMenu}>\n                {this._renderFiltersBar(seenNodeNames, msgs)}\n              </PanelToolbar>\n              <div className={styles.content}>\n                <LogList items={this._getFilteredMessages(msgs)} renderRow={this._renderRow} />\n              </div>\n            </Flex>\n          );\n        }}\n      </MessageHistoryDEPRECATED>\n    );\n  }\n}\n\nexport default hot(Panel<Config>(RosoutPanel));\n","module.exports = \"# rosout\\n\\nDisplays messages from the `/rosout` topic. The messages can be filtered using the filter dropdowns at the top of the panel. These hide away when unused, so you need to hover over the top section of the panel to reveal them. There are two filtering options:\\n\\n- Minimum Severity: The left dropdown lets you choose a severity below which to hide messages.\\n- Node Name/Message: The text field lets you add search terms by which to filter the log messages. The filter applies to both node names and message text.\\n\\nNode name and message filters are \\\"OR\\\"ed, so if you have two, it'll show messages that meet either. The severity is an \\\"AND\\\" with the node names / messages &mdash; if a message is below the minimum severity, it won't show up regardless of matching the name or content.\\n\"","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./index.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\nexports.i(require(\"-!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!react-virtualized/styles.css\"), \"\");\n\n// module\nexports.push([module.id, \"div.Select-menu-outer{background-color:#242429;border-radius:4px;padding:0;-webkit-box-shadow:0 0px 32px rgba(8,8,10,.6);box-shadow:0 0px 32px rgba(8,8,10,.6);overflow:hidden;pointer-events:auto;-ms-flex-negative:0;flex-shrink:0}.VirtualizedSelectOption{text-decoration:none;padding:8px 16px;cursor:pointer;color:rgba(247,247,243,.77);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.VirtualizedSelectSelectedOption,.VirtualizedSelectFocusedOption,.VirtualizedSelectOption:hover{color:#fff;background-color:#36363d}.packages-webviz-core-src-panels-Rosout-index-module-4nshd--content{font-family:\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace;-ms-flex:1 1 auto;flex:1 1 auto;display:-ms-flexbox;display:flex;position:relative}.packages-webviz-core-src-panels-Rosout-index-module-42gh9--filtersBar{background-color:#242429;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex:1 1 auto;flex:1 1 auto;left:0;width:100%}.packages-webviz-core-src-panels-Rosout-index-module-2nczq--severityFilter{-ms-flex:0 1 auto;flex:0 1 auto;min-width:120px;margin-left:10px;width:unset !important}.packages-webviz-core-src-panels-Rosout-index-module-3tekj--nodeFilter{-ms-flex:2 1 auto;flex:2 1 auto;min-width:200px;width:unset !important}.packages-webviz-core-src-panels-Rosout-index-module-hu4fx--itemsCountField{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-radius:4px;color:rgba(255,255,255,.5);padding:0px 8px}{}div.Select-menu{padding-bottom:5em !important}.Select-control{font-size:12px}.Select-control .Select-clear{line-height:24px;font-size:18px}@keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin{to{-webkit-transform:rotate(1turn)}}.Select{position:relative}.Select input::-webkit-contacts-auto-fill-button,.Select input::-webkit-credentials-auto-fill-button{display:none !important}.Select input::-ms-clear{display:none !important}.Select input::-ms-reveal{display:none !important}.Select,.Select div,.Select input,.Select span{-webkit-box-sizing:border-box;box-sizing:border-box}.Select.is-disabled .Select-arrow-zone{cursor:default;pointer-events:none}.Select.is-disabled>.Select-control{background-color:#f9f9f9}.Select.is-disabled>.Select-control:hover{-webkit-box-shadow:none;box-shadow:none}.Select.is-searchable.is-open>.Select-control{cursor:text}.Select.is-searchable.is-focused:not(.is-open)>.Select-control{cursor:text}.Select.is-open>.Select-control{border-bottom-right-radius:0;border-bottom-left-radius:0;background:#242429;border-color:rgba(0,0,0,0) transparent rgba(13,13,13,0)}.Select.is-open>.Select-control .Select-arrow{top:-2px;border-color:transparent transparent rgba(247,247,243,.77);border-width:0 5px 5px}.Select.is-focused>.Select-control{background:#242429}.Select.is-focused:not(.is-open)>.Select-control{border-color:transparent rgba(13,13,13,0) rgba(13,13,13,0);-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1),0 0 5px -1px fade(transparent, 50%);box-shadow:inset 0 1px 2px rgba(0,0,0,.1),0 0 5px -1px fade(transparent, 50%)}.Select.has-value.is-clearable.Select--single>.Select-control .Select-value{padding-right:38px}.Select.has-value.Select--single>.Select-control .Select-value .Select-value-label,.Select.has-value.is-pseudo-focused.Select--single>.Select-control .Select-value .Select-value-label{color:rgba(247,247,243,.77)}.Select.has-value.Select--single>.Select-control .Select-value a.Select-value-label,.Select.has-value.is-pseudo-focused.Select--single>.Select-control .Select-value a.Select-value-label{cursor:pointer;text-decoration:none}.Select.has-value.Select--single>.Select-control .Select-value a.Select-value-label:hover,.Select.has-value.Select--single>.Select-control .Select-value a.Select-value-label:focus,.Select.has-value.is-pseudo-focused.Select--single>.Select-control .Select-value a.Select-value-label:hover,.Select.has-value.is-pseudo-focused.Select--single>.Select-control .Select-value a.Select-value-label:focus{color:transparent;outline:none;text-decoration:underline}.Select.has-value.Select--single>.Select-control .Select-value a.Select-value-label:focus,.Select.has-value.is-pseudo-focused.Select--single>.Select-control .Select-value a.Select-value-label:focus{background:#242429}.Select.has-value.is-pseudo-focused .Select-input{opacity:0}.Select.is-open .Select-arrow,.Select .Select-arrow-zone:hover>.Select-arrow{border-top-color:#666}.Select.Select--rtl{direction:rtl;text-align:right}.Select-control{background-color:#242429;border-color:rgba(13,13,13,0) transparent rgba(0,0,0,0);border-radius:4px;border:1px solid transparent;color:rgba(247,247,243,.77);cursor:default;display:table;border-spacing:0;border-collapse:separate;height:24px;outline:none;overflow:hidden;position:relative;width:100%}.Select-control:hover{-webkit-box-shadow:0 1px 0 rgba(0,0,0,.06);box-shadow:0 1px 0 rgba(0,0,0,.06)}.Select-control .Select-input:focus{outline:none;background:#242429}.Select-placeholder,.Select--single>.Select-control .Select-value{bottom:0;color:rgba(247,247,243,.27);left:0;line-height:26px;padding-left:10px;padding-right:10px;position:absolute;right:0;top:0;max-width:100%;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.Select-input{height:26px;padding-left:10px;padding-right:10px;vertical-align:middle}.Select-input>input{width:100%;background:none transparent;border:0 none;-webkit-box-shadow:none;box-shadow:none;cursor:default;display:inline-block;font-family:inherit;font-size:inherit;margin:0;outline:none;line-height:17px;padding:4px 0 8px;-webkit-appearance:none}.packages-webviz-core-src-panels-Rosout-index-module-jr6wb--is-focused .Select-input>input{cursor:text}.Select-control:not(.is-searchable)>.Select-input{outline:none}.Select-loading-zone{cursor:pointer;display:table-cell;position:relative;text-align:center;vertical-align:middle;width:16px}.Select-loading{-webkit-animation:Select-animation-spin 400ms infinite linear;animation:Select-animation-spin 400ms infinite linear;width:16px;height:16px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:50%;border:2px solid transparent;border-right-color:rgba(247,247,243,.77);display:inline-block;position:relative;vertical-align:middle}.Select-clear-zone{-webkit-animation:Select-animation-fadeIn 200ms;animation:Select-animation-fadeIn 200ms;color:rgba(247,247,243,.77);cursor:pointer;display:table-cell;position:relative;text-align:center;vertical-align:middle;width:13px}.Select-clear-zone:hover{color:#d0021b}.Select-clear{display:inline-block;font-size:12px;line-height:1}.Select--multi .Select-clear-zone{width:13px}.Select--multi .Select-multi-value-wrapper{display:inline-block}.Select .Select-aria-only{position:absolute;display:inline-block;height:1px;width:1px;margin:-1px;clip:rect(0, 0, 0, 0);overflow:hidden;float:left}.Select-arrow-zone{cursor:pointer;display:table-cell;position:relative;text-align:center;vertical-align:middle;width:25px;padding-right:5px}.packages-webviz-core-src-panels-Rosout-index-module-33x8g--Select--rtl .Select-arrow-zone{padding-right:0;padding-left:5px}.Select-arrow{border-color:rgba(247,247,243,.77) transparent transparent;border-style:solid;border-width:5px 5px 2.5px;display:inline-block;height:0;width:0;position:relative}@-webkit-keyframes packages-webviz-core-src-panels-Rosout-index-module-2xhh8--Select-animation-fadeIn{from{opacity:0}to{opacity:1}}@keyframes packages-webviz-core-src-panels-Rosout-index-module-2xhh8--Select-animation-fadeIn{from{opacity:0}to{opacity:1}}.Select-menu-outer{border-bottom-right-radius:4px;border-bottom-left-radius:4px;background-color:#242429;border:1px solid transparent;border-top-color:rgba(36,36,41,.5);-webkit-box-shadow:0 1px 0 rgba(0,0,0,.06);box-shadow:0 1px 0 rgba(0,0,0,.06);-webkit-box-sizing:border-box;box-sizing:border-box;margin-top:-1px;max-height:200px;position:absolute;left:0;top:100%;width:100%;z-index:1000;-webkit-overflow-scrolling:touch}.Select-menu{max-height:198px;overflow-y:auto}.Select-option{-webkit-box-sizing:border-box;box-sizing:border-box;background-color:red;color:rgba(255,255,255,.77);cursor:pointer;display:block;padding:8px 10px}.Select-option:last-child{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.Select-option.is-selected{background-color:#f5faff;color:rgba(247,247,243,.77)}.Select-option.is-focused{background-color:#f2f9fc;color:rgba(247,247,243,.77)}.Select-option.is-disabled{color:rgba(255,255,255,.77);cursor:default}.Select-noresults{-webkit-box-sizing:border-box;box-sizing:border-box;color:rgba(255,255,255,.77);cursor:default;display:block;padding:8px 10px}.Select--multi .Select-input{vertical-align:middle;margin-left:10px;padding:0}.Select--multi.Select--rtl .Select-input{margin-left:0;margin-right:10px}.Select--multi.has-value .Select-input{margin-left:5px}.Select--multi .Select-value{background-color:#f2f9fc;border-radius:2px;border:1px solid #c9e6f2;color:#08c;display:inline-block;font-size:12px;margin-left:5px;margin-top:5px;vertical-align:top}.Select--multi .Select-value-icon,.Select--multi .Select-value-label{display:inline-block;vertical-align:middle}.Select--multi .Select-value-label{border-bottom-right-radius:2px;border-top-right-radius:2px;cursor:default;padding:2px 5px}.Select--multi a.Select-value-label{color:#08c;cursor:pointer;text-decoration:none}.Select--multi a.Select-value-label:hover{text-decoration:underline}.Select--multi .Select-value-icon{cursor:pointer;border-bottom-left-radius:2px;border-top-left-radius:2px;border-right:1px solid #c9e6f2;padding:1px 5px 3px}.Select--multi .Select-value-icon:hover,.Select--multi .Select-value-icon:focus{background-color:#ddeff7;color:#0077b3}.Select--multi .Select-value-icon:active{background-color:#c9e6f2}.Select--multi.Select--rtl .Select-value{margin-left:0;margin-right:5px}.Select--multi.Select--rtl .Select-value-icon{border-right:none;border-left:1px solid #c9e6f2}.Select--multi.is-disabled .Select-value{background-color:#fcfcfc;border:1px solid #e3e3e3;color:#333}.Select--multi.is-disabled .Select-value-icon{cursor:not-allowed;border-right:1px solid #e3e3e3}.Select--multi.is-disabled .Select-value-icon:hover,.Select--multi.is-disabled .Select-value-icon:focus,.Select--multi.is-disabled .Select-value-icon:active{background-color:#fcfcfc}@keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin{to{-webkit-transform:rotate(1turn)}}.VirtualizedSelectFocusedOption{background-color:#2d2d33 !important}.Select{width:100%}.Select-input>input{color:rgba(247,247,243,.77)}.Select-multi-value-wrapper{display:table-cell;position:relative}.Select--multi .Select-multi-value-wrapper{width:100%}.Select--multi .Select-arrow{opacity:.5}.Select--multi .Select-value{color:rgba(247,247,243,.88);background-color:#36363d;border:1px solid rgba(247,247,243,.1);margin:2px}.Select--multi .Select-value-icon{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;padding:0 0 0 4px;opacity:.5;border:0}.Select--multi .Select-value-icon:hover{color:inherit;background-color:transparent;opacity:1}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/index.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/node_modules/react-select/scss/spinner.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/node_modules/react-select/scss/control.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/node_modules/react-select/scss/mixins.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/node_modules/react-select/scss/select.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/node_modules/react-select/scss/menu.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/node_modules/react-select/scss/multi.scss\"],\"names\":[],\"mappings\":\"AA0BA,sBACE,yBACA,kBACA,UACA,8CAAA,sCACA,gBACA,oBACA,oBAAA,aAAA,CAGF,yBACE,qBACA,iBACA,eACA,4BACA,yBAAA,sBAAA,qBAAA,iBACA,oBAAA,aACA,sBAAA,kBAAA,CAuBF,gGAEE,WACA,wBCvBM,CD+CR,AE7EA,oEFiEE,4EE/DA,kBAAA,cACA,oBAAA,aACA,iBAAA,CAGF,uEACE,yBACA,oBAAA,aACA,mBAAA,eACA,kBAAA,cACA,OACA,UAAA,CAGF,2EACE,kBAAA,cACA,gBACA,iBACA,sBAAA,CAGF,uEACE,kBAAA,cACA,gBACA,sBAAA,CAGF,4EACE,oBAAA,aACA,sBAAA,mBACA,kBACA,2BACA,eAAA,CAGF,EAIE,gBACE,6BAAA,CAEF,gBACE,cFpDQ,CEqDR,8BACE,iBACA,cAAA,CC9CN,4FACC,GAAA,gCAAA,uBAAA,CAAA,CAED,oGACC,GAAA,+BAAA,CAAA,CCfD,QACC,iBAAA,CAGA,qGAEC,uBAAA,CAED,yBACC,uBAAA,CAED,0BACC,uBAAA,CAID,+CCyBA,8BACA,qBDtBqB,CAKpB,uCACC,eACA,mBAAA,CAGD,oCACC,wBEzBiC,CF0BjC,0CACC,wBAAA,eAAA,CAMF,8CACC,WAAA,CAGD,+DACC,WAAA,CAIF,gCC3BA,6BACA,4BD4BC,mBACA,uDAAA,CAGA,8CACC,SACA,2DACA,sBAAA,CAIF,mCACC,kBHzBM,CG4BP,iDACC,2DACA,sFAAA,6EExDkC,CF4DnC,4EACC,kBAAA,CAKA,wLACC,2BHzEW,CG2EZ,0LACC,eACA,oBAAA,CAEA,4YAEC,kBACA,aACA,yBAAA,CAGD,sMACC,kBHvDI,CG6DP,kDACC,SAAA,CAGD,6EAEC,qBE1DkC,CF4DnC,oBACC,cACA,gBAAA,CAMF,gBACC,yBACA,wDACA,kBACA,6BACA,4BACA,eACA,cACA,iBACA,yBACA,YACA,aACA,gBACA,kBACA,UAAA,CAEA,sBACC,2CAAA,kCEjHkC,CFoHnC,oCACC,aACA,kBHnGM,CGwGR,kEAEC,SACA,4BACA,OACA,iBACA,kBACA,mBACA,kBACA,QACA,MAGA,eACA,gBACA,0BAAA,uBACA,kBAAA,CAMD,cAEC,YACA,kBACA,mBACA,qBAAA,CAEA,oBACC,WACA,4BACA,cACA,wBAAA,gBACA,eACA,qBACA,oBACA,kBAEA,SACA,aAEA,iBACA,kBACA,uBAAA,CAEA,2FACC,WAAA,CAOH,kDACC,YAAA,CAID,qBACC,eACA,mBACA,kBACA,kBACA,sBACA,UE5JmC,CF8JpC,gBC7KC,8DACA,sDAlCA,WACA,YFDA,8BAAA,sBACA,kBACA,6BACA,yCACA,qBACA,kBC2MA,qBAAA,CAMD,mBCrLC,gDACA,wCDsLA,4BACA,eACA,mBACA,kBACA,kBACA,sBACA,UEtLmC,CFwLnC,yBACC,aE1LkC,CF6LpC,cACC,qBACA,eACA,aAAA,CAED,kCACC,UElMmC,CFqMpC,2CACE,oBAAA,CAEF,0BACC,kBACA,qBACA,WACA,UACA,YACA,sBACA,gBACA,UAAA,CAMD,mBACC,eACA,mBACA,kBACA,kBACA,sBACA,WACA,iBExNmC,CF0NnC,2FACC,gBACA,gBE5NkC,CFgOpC,cACC,2DACA,mBACA,2BACA,qBACA,SACA,QACA,iBAAA,CAWD,sGACC,KAAA,SAAA,CACA,GAAA,SAAA,CAAA,CAED,8FACC,KAAA,SAAA,CACA,GAAA,SAAA,CAAA,CGvSD,mBFqBC,+BACA,8BEhBA,yBACA,6BACA,mCACA,2CAAA,mCACA,8BAAA,sBACA,gBACA,iBACA,kBACA,OACA,SACA,WACA,aACA,gCAAA,CAMD,aACC,iBACA,eAAA,CAMD,eACC,8BAAA,sBACA,qBACA,4BACA,eACA,cACA,gBAAA,CAEA,0BFnBA,+BACA,6BCbmC,CCmCnC,2BACC,yBACA,2BNzCY,CM4Cb,0BACC,yBACA,2BN9CY,CMiDb,2BACC,4BACA,cAAA,CAQF,kBACC,8BAAA,sBACA,4BACA,eACA,cACA,gBAAA,CClEA,6BACC,sBAEA,iBACA,SAAA,CAED,yCACC,cACA,iBFUkC,CENnC,uCACC,eFwCkC,CEpCnC,6BACC,yBACA,kBACA,yBACA,WACA,qBACA,eACA,gBACA,eACA,kBAAA,CAID,qEAEC,qBACA,qBAAA,CAID,mCHxBA,+BACA,4BGyBC,eACA,eAAA,CAED,oCACC,WACA,eACA,oBAAA,CAEA,0CACC,yBAAA,CAKF,kCACC,eH/BD,8BACA,2BGgCC,+BAGA,mBAAA,CAEA,gFAEC,yBACA,aFJiC,CEMlC,yCACC,wBFRiC,CEalC,yCACE,cACA,gBFrBgC,CEuBlC,8CACC,kBACA,6BAAA,CAMF,yCACC,yBACA,yBACA,UFzBkC,CE4BnC,8CACC,mBACA,8BAAA,CAEA,6JAGC,wBFlCiC,CHvDpC,4FACC,GAAA,gCAAA,uBAAA,CAAA,CAED,oGACC,GAAA,+BAAA,CAAA,CDmEC,gCAGE,mCAAA,CAEF,QACE,UAAA,CAEF,oBACE,2BDtFU,CCwFZ,4BACE,mBACA,iBAAA,CAEF,2CACE,UAAA,CAEF,6BACE,UAAA,CAEF,6BACE,4BACA,yBACA,sCACA,UAAA,CAEF,kCACE,2BAAA,oBACA,sBAAA,mBACA,kBACA,WACA,QAAA,CACA,wCACE,cACA,6BACA,SAAA,CAAA\",\"file\":\"index.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n$option-height: 24;\\n$option-font-size: $text-size;\\n\\n:export {\\n  optionHeight: $option-height;\\n}\\n\\n.content {\\n  @include monospace;\\n  flex: 1 1 auto;\\n  display: flex;\\n  position: relative;\\n}\\n\\n.filtersBar {\\n  background-color: $dark3;\\n  display: flex;\\n  flex-wrap: wrap;\\n  flex: 1 1 auto;\\n  left: 0;\\n  width: 100%;\\n}\\n\\n.severityFilter {\\n  flex: 0 1 auto;\\n  min-width: 120px;\\n  margin-left: 10px;\\n  width: unset !important;\\n}\\n\\n.nodeFilter {\\n  flex: 2 1 auto;\\n  min-width: 200px;\\n  width: unset !important;\\n}\\n\\n.itemsCountField {\\n  display: flex;\\n  align-items: center;\\n  border-radius: 4px;\\n  color: rgba(255, 255, 255, 0.5);\\n  padding: 0px 8px;\\n}\\n\\n:global {\\n  div.Select-menu-outer {\\n    @extend %floating-box;\\n  }\\n  div.Select-menu {\\n    padding-bottom: 5em !important; // TODO(jacob): not working when there are enough items to scroll?\\n  }\\n  .Select-control {\\n    font-size: $option-font-size;\\n    .Select-clear {\\n      line-height: $option-font-size * 2;\\n      font-size: $option-font-size * 1.5;\\n    }\\n  }\\n  $select-item-font-size: $option-font-size;\\n  $select-input-bg: $dark3;\\n  $select-input-border-color: transparent;\\n  $select-input-border-focus: transparent;\\n  $select-input-height: $option-height * 1px;\\n  $select-input-internal-height: 26px;\\n  $select-text-color: $text-control;\\n  $select-input-placeholder: transparentize($text-control, 0.5);\\n  $select-option-bg: red;\\n  $select-clear-color: $text-control;\\n  $select-loading-color: $text-control;\\n  $select-arrow-color: $text-control;\\n\\n  @import \\\"~react-select/scss/default\\\";\\n  @import \\\"~react-virtualized/styles.css\\\";\\n\\n  .VirtualizedSelectOption {\\n    @extend %menu-item;\\n  }\\n  .VirtualizedSelectSelectedOption {\\n    @extend %menu-item-active;\\n  }\\n  .VirtualizedSelectFocusedOption {\\n    @extend %menu-item-hover;\\n    // TODO(jacob): doesn't override react-virtualized-select styles for some reason\\n    background-color: $dark4 !important;\\n  }\\n  .Select {\\n    width: 100%;\\n  }\\n  .Select-input > input {\\n    color: $select-text-color;\\n  }\\n  .Select-multi-value-wrapper {\\n    display: table-cell;\\n    position: relative;\\n  }\\n  .Select--multi .Select-multi-value-wrapper {\\n    width: 100%;\\n  }\\n  .Select--multi .Select-arrow {\\n    opacity: 0.5;\\n  }\\n  .Select--multi .Select-value {\\n    color: $text-bright;\\n    background-color: $dark5;\\n    border: 1px solid $background-control;\\n    margin: 2px;\\n  }\\n  .Select--multi .Select-value-icon {\\n    display: inline-flex;\\n    align-items: center;\\n    padding: 0 0 0 4px;\\n    opacity: 0.5;\\n    border: 0;\\n    &:hover {\\n      color: inherit;\\n      background-color: transparent;\\n      opacity: 1;\\n    }\\n  }\\n}\\n\",\"//\\n// Spinner\\n// ------------------------------\\n@import 'mixins';\\n\\n@mixin Select-spinner($size, $orbit, $satellite)\\n{\\n\\t@include animation( Select-animation-spin 400ms infinite linear );\\n\\t@include square($size);\\n\\tbox-sizing: border-box;\\n\\tborder-radius: 50%;\\n\\tborder: floor(($size / 8)) solid $orbit;\\n\\tborder-right-color: $satellite;\\n\\tdisplay: inline-block;\\n\\tposition: relative;\\n\\n}\\n\\n@keyframes Select-animation-spin {\\n\\tto { transform: rotate(1turn); }\\n}\\n@-webkit-keyframes Select-animation-spin {\\n\\tto { -webkit-transform: rotate(1turn); }\\n}\\n\",\"//\\n// Control\\n// ------------------------------\\n\\n@import 'spinner';\\n@import 'mixins';\\n\\n.Select {\\n\\tposition: relative;\\n\\n\\t// disable some browser-specific behaviours that break the input\\n\\tinput::-webkit-contacts-auto-fill-button,\\n\\tinput::-webkit-credentials-auto-fill-button {\\n\\t\\tdisplay: none !important;\\n\\t}\\n\\tinput::-ms-clear {\\n\\t\\tdisplay: none !important;\\n\\t}\\n\\tinput::-ms-reveal {\\n\\t\\tdisplay: none !important;\\n\\t}\\n\\n\\t// preferred box model\\n\\t&,\\n\\t& div,\\n\\t& input,\\n\\t& span {\\n\\t\\t@include box-sizing(border-box);\\n\\t}\\n\\n\\t// handle disabled state\\n\\t&.is-disabled {\\n\\t\\t.Select-arrow-zone {\\n\\t\\t\\tcursor: default;\\n\\t\\t\\tpointer-events: none;\\n\\t\\t}\\n\\n\\t\\t> .Select-control {\\n\\t\\t\\tbackground-color: $select-input-bg-disabled;\\n\\t\\t\\t&:hover {\\n\\t\\t\\t\\tbox-shadow: none;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n\\t&.is-searchable {\\n\\t\\t&.is-open > .Select-control {\\n\\t\\t\\tcursor: text;\\n\\t\\t}\\n\\n\\t\\t&.is-focused:not(.is-open) > .Select-control {\\n\\t\\t\\tcursor: text;\\n\\t\\t}\\n\\t}\\n\\n\\t&.is-open > .Select-control {\\n\\t\\t@include border-bottom-radius( 0 );\\n\\t\\tbackground: $select-input-bg;\\n\\t\\tborder-color: darken($select-input-border-color, 10%) $select-input-border-color lighten($select-input-border-color, 5%);\\n\\n\\t\\t// flip the arrow so its pointing up when the menu is open\\n\\t\\t.Select-arrow {\\n\\t\\t\\ttop: -2px;\\n\\t\\t\\tborder-color: transparent transparent $select-arrow-color;\\n\\t\\t\\tborder-width: 0 $select-arrow-width $select-arrow-width;\\n\\t\\t}\\n\\t}\\n\\n\\t&.is-focused > .Select-control {\\n\\t\\tbackground: $select-input-bg-focus;\\n\\t}\\n\\n\\t&.is-focused:not(.is-open) > .Select-control {\\n\\t\\tborder-color: $select-input-border-focus lighten($select-input-border-focus, 5%) lighten($select-input-border-focus, 5%);\\n\\t\\tbox-shadow: $select-input-box-shadow-focus;\\n\\t}\\n\\n\\n\\t&.has-value.is-clearable.Select--single > .Select-control .Select-value {\\n\\t\\tpadding-right: ($select-clear-width + $select-arrow-width * 5);\\n\\t}\\n\\n\\t&.has-value.Select--single > .Select-control .Select-value,\\n\\t&.has-value.is-pseudo-focused.Select--single > .Select-control .Select-value {\\n\\t\\t.Select-value-label {\\n\\t\\t\\tcolor: $select-text-color;\\n\\t\\t}\\n\\t\\ta.Select-value-label {\\n\\t\\t\\tcursor: pointer;\\n\\t\\t\\ttext-decoration: none;\\n\\n\\t\\t\\t&:hover,\\n\\t\\t\\t&:focus {\\n\\t\\t\\t\\tcolor: $select-link-hover-color;\\n\\t\\t\\t\\toutline: none;\\n\\t\\t\\t\\ttext-decoration: underline;\\n\\t\\t\\t}\\n\\n\\t\\t\\t&:focus {\\n\\t\\t\\t\\tbackground: $select-input-bg-focus;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n\\t// fake-hide the input when the control is pseudo-focused\\n\\t&.has-value.is-pseudo-focused .Select-input {\\n\\t\\topacity: 0;\\n\\t}\\n\\n\\t&.is-open .Select-arrow,\\n\\t.Select-arrow-zone:hover > .Select-arrow {\\n\\t\\tborder-top-color: $select-arrow-color-hover;\\n\\t}\\n\\t&.Select--rtl {\\n\\t\\tdirection: rtl;\\n\\t\\ttext-align: right;\\n\\t}\\n}\\n\\n// base\\n\\n.Select-control {\\n\\tbackground-color: $select-input-bg;\\n\\tborder-color: lighten($select-input-border-color, 5%) $select-input-border-color darken($select-input-border-color, 10%);\\n\\tborder-radius: $select-input-border-radius;\\n\\tborder: $select-input-border-width solid $select-input-border-color;\\n\\tcolor: $select-text-color;\\n\\tcursor: default;\\n\\tdisplay: table;\\n\\tborder-spacing: 0;\\n\\tborder-collapse: separate;\\n\\theight: $select-input-height;\\n\\toutline: none;\\n\\toverflow: hidden;\\n\\tposition: relative;\\n\\twidth: 100%;\\n\\n\\t&:hover {\\n\\t\\tbox-shadow: $select-input-hover-box-shadow;\\n\\t}\\n\\n\\t.Select-input:focus {\\n\\t\\toutline: none;\\n\\t\\tbackground: $select-input-bg-focus;\\n\\t}\\n}\\n\\n// placeholder\\n.Select-placeholder,\\n.Select--single > .Select-control .Select-value {\\n\\tbottom: 0;\\n\\tcolor: $select-input-placeholder;\\n\\tleft: 0;\\n\\tline-height: $select-input-internal-height;\\n\\tpadding-left: $select-padding-horizontal;\\n\\tpadding-right: $select-padding-horizontal;\\n\\tposition: absolute;\\n\\tright: 0;\\n\\ttop: 0;\\n\\n\\t// crop text\\n\\tmax-width: 100%;\\n\\toverflow: hidden;\\n\\ttext-overflow: ellipsis;\\n\\twhite-space: nowrap;\\n}\\n\\n\\n// the <input> element users type in\\n\\n.Select-input {\\n\\t// inherits `display: inline-block` from \\\"react-input-autosize\\\"\\n\\theight: $select-input-internal-height;\\n\\tpadding-left: $select-padding-horizontal;\\n\\tpadding-right: $select-padding-horizontal;\\n\\tvertical-align: middle;\\n\\n\\t> input {\\n\\t\\twidth: 100%;\\n\\t\\tbackground: none transparent;\\n\\t\\tborder: 0 none;\\n\\t\\tbox-shadow: none;\\n\\t\\tcursor: default;\\n\\t\\tdisplay: inline-block;\\n\\t\\tfont-family: inherit;\\n\\t\\tfont-size: inherit;\\n\\t\\t// height: $select-input-internal-height;\\n\\t\\tmargin: 0;\\n\\t\\toutline: none;\\n\\t\\t// padding: 0;\\n\\t\\tline-height: 17px;  /* For IE 8 compatibility */\\n\\t\\tpadding: (($select-input-internal-height - 14) / 2 - 2) 0 (($select-input-internal-height - 14) / 2 + 2);  /* For IE 8 compatibility */\\n\\t\\t-webkit-appearance: none;\\n\\n\\t\\t.is-focused & {\\n\\t\\t\\tcursor: text;\\n\\t\\t}\\n\\t}\\n\\n}\\n\\n// fake input\\n.Select-control:not(.is-searchable) > .Select-input {\\n\\toutline: none;\\n}\\n\\n// loading indicator\\n.Select-loading-zone {\\n\\tcursor: pointer;\\n\\tdisplay: table-cell;\\n\\tposition: relative;\\n\\ttext-align: center;\\n\\tvertical-align: middle;\\n\\twidth: $select-loading-size;\\n}\\n.Select-loading {\\n\\t@include Select-spinner($select-loading-size, $select-loading-color-bg, $select-loading-color);\\n\\tvertical-align: middle;\\n}\\n\\n\\n// the little cross that clears the field\\n\\n.Select-clear-zone {\\n\\t@include animation( Select-animation-fadeIn 200ms );\\n\\tcolor: $select-clear-color;\\n\\tcursor: pointer;\\n\\tdisplay: table-cell;\\n\\tposition: relative;\\n\\ttext-align: center;\\n\\tvertical-align: middle;\\n\\twidth: $select-clear-width;\\n\\n\\t&:hover {\\n\\t\\tcolor: $select-clear-hover-color;\\n\\t}\\n}\\n.Select-clear {\\n\\tdisplay: inline-block;\\n\\tfont-size: $select-clear-size;\\n\\tline-height: 1;\\n}\\n.Select--multi .Select-clear-zone {\\n\\twidth: $select-clear-width;\\n}\\n\\n.Select--multi .Select-multi-value-wrapper {\\n  display: inline-block;\\n}\\n.Select .Select-aria-only {\\n\\tposition: absolute;\\n\\tdisplay: inline-block;\\n\\theight: 1px;\\n\\twidth: 1px;\\n\\tmargin: -1px;\\n\\tclip: rect(0,0,0,0);\\n\\toverflow: hidden;\\n\\tfloat: left;\\n}\\n\\n\\n// arrow indicator\\n\\n.Select-arrow-zone {\\n\\tcursor: pointer;\\n\\tdisplay: table-cell;\\n\\tposition: relative;\\n\\ttext-align: center;\\n\\tvertical-align: middle;\\n\\twidth: ($select-arrow-width * 5);\\n\\tpadding-right: $select-arrow-width;\\n\\n\\t.Select--rtl & {\\n\\t\\tpadding-right: 0;\\n\\t\\tpadding-left: $select-arrow-width;\\n\\t}\\n}\\n\\n.Select-arrow {\\n\\tborder-color: $select-arrow-color transparent transparent;\\n\\tborder-style: solid;\\n\\tborder-width: $select-arrow-width $select-arrow-width ($select-arrow-width / 2);\\n\\tdisplay: inline-block;\\n\\theight: 0;\\n\\twidth: 0;\\n\\tposition: relative;\\n}\\n\\n\\n\\n\\n// Animation\\n// ------------------------------\\n\\n// fade in\\n\\n@-webkit-keyframes Select-animation-fadeIn {\\n\\tfrom { opacity: 0; }\\n\\tto { opacity: 1; }\\n}\\n@keyframes Select-animation-fadeIn {\\n\\tfrom { opacity: 0; }\\n\\tto { opacity: 1; }\\n}\\n\",\"//\\n// Mixins\\n// ------------------------------\\n\\n\\n// Utilities\\n\\n@mixin size($width, $height)\\n{\\n\\twidth: $width;\\n\\theight: $height;\\n}\\n@mixin square($size)\\n{\\n\\t@include size($size, $size);\\n}\\n@mixin border-top-radius($radius)\\n{\\n\\tborder-top-right-radius: $radius;\\n\\tborder-top-left-radius: $radius;\\n}\\n@mixin border-right-radius($radius)\\n{\\n\\tborder-bottom-right-radius: $radius;\\n\\tborder-top-right-radius: $radius;\\n}\\n@mixin border-bottom-radius($radius)\\n{\\n\\tborder-bottom-right-radius: $radius;\\n\\tborder-bottom-left-radius: $radius;\\n}\\n@mixin border-left-radius($radius)\\n{\\n\\tborder-bottom-left-radius: $radius;\\n\\tborder-top-left-radius: $radius;\\n}\\n\\n\\n// Vendor Prefixes\\n\\n@mixin animation($animation)\\n{\\n\\t-webkit-animation: $animation;\\n\\t-o-animation: $animation;\\n\\tanimation: $animation;\\n}\\n@mixin box-sizing($boxmodel)\\n{\\n\\t-webkit-box-sizing: $boxmodel;\\n\\t-moz-box-sizing: $boxmodel;\\n\\tbox-sizing: $boxmodel;\\n}\\n\",\"/**\\n * React Select\\n * ============\\n * Created by Jed Watson and Joss Mackison for KeystoneJS, http://www.keystonejs.com/\\n * https://twitter.com/jedwatson https://twitter.com/jossmackison https://twitter.com/keystonejs\\n * MIT License: https://github.com/JedWatson/react-select\\n*/\\n\\n// Variables\\n// ------------------------------\\n\\n// control options\\n$select-input-bg:                   #fff !default;\\n$select-input-bg-disabled:          #f9f9f9 !default;\\n$select-input-bg-focus:             $select-input-bg !default;\\n$select-input-border-color:         #ccc !default;\\n$select-input-border-radius:        4px !default;\\n$select-input-border-focus:         #08c !default; // blue\\n$select-input-box-shadow-focus:     inset 0 1px 2px rgba(0, 0, 0, 0.1), 0 0 5px -1px fade($select-input-border-focus, 50%) !default;\\n$select-input-border-width:         1px !default;\\n$select-input-height:               36px !default;\\n$select-input-internal-height:      ($select-input-height - ($select-input-border-width * 2)) !default;\\n$select-input-placeholder:          #aaa !default;\\n$select-text-color:                 #333 !default;\\n$select-link-hover-color:           $select-input-border-focus !default;\\n$select-input-hover-box-shadow:     0 1px 0 rgba(0, 0, 0, 0.06) !default;\\n\\n$select-padding-vertical:           8px !default;\\n$select-padding-horizontal:         10px !default;\\n\\n// menu options\\n$select-menu-zindex:                1000 !default;\\n$select-menu-max-height:            200px !default;\\n$select-menu-box-shadow:            $select-input-hover-box-shadow !default;\\n\\n$select-option-color:               lighten($select-text-color, 20%) !default;\\n$select-option-bg:                  $select-input-bg !default;\\n$select-option-focused-color:       $select-text-color !default;\\n$select-option-focused-bg:          #f2f9fc !default; // pale blue\\n$select-option-selected-color:      $select-text-color !default;\\n$select-option-selected-bg:         #f5faff !default; // lightest blue\\n$select-option-disabled-color:      lighten($select-text-color, 60%) !default;\\n\\n$select-noresults-color:            lighten($select-text-color, 40%) !default;\\n\\n// clear \\\"x\\\" button\\n$select-clear-size:                 floor(($select-input-height / 2)) !default;\\n$select-clear-color:                #999 !default;\\n$select-clear-hover-color:          #D0021B !default; // red\\n$select-clear-width:                ($select-input-internal-height / 2) !default;\\n\\n// arrow indicator\\n$select-arrow-color:                #999 !default;\\n$select-arrow-color-hover:          #666 !default;\\n$select-arrow-width:                5px !default;\\n\\n// loading indicator\\n$select-loading-size:               16px !default;\\n$select-loading-color:              $select-text-color !default;\\n$select-loading-color-bg:           $select-input-border-color !default;\\n\\n// multi-select item\\n$select-item-border-radius:         2px !default;\\n$select-item-gutter:                5px !default;\\n$select-item-padding-vertical:      2px !default;\\n$select-item-padding-horizontal:    5px !default;\\n$select-item-font-size:             .9em !default;\\n$select-item-color:                 #08c !default; // pale blue\\n$select-item-bg:                    #f2f9fc !default;\\n$select-item-border-color:          darken($select-item-bg, 10%) !default;\\n$select-item-hover-color:           darken($select-item-color, 5%) !default; // pale blue\\n$select-item-hover-bg:              darken($select-item-bg, 5%) !default;\\n$select-item-disabled-color:        #333 !default;\\n$select-item-disabled-bg:           #fcfcfc !default;\\n$select-item-disabled-border-color: darken($select-item-disabled-bg, 10%) !default;\\n\",\"//\\n// Select Menu\\n// ------------------------------\\n\\n\\n// wrapper around the menu\\n\\n.Select-menu-outer {\\n\\t// Unfortunately, having both border-radius and allows scrolling using overflow defined on the same\\n\\t// element forces the browser to repaint on scroll.  However, if these definitions are split into an\\n\\t// outer and an inner element, the browser is able to optimize the scrolling behavior and does not\\n\\t// have to repaint on scroll.\\n\\t@include border-bottom-radius( $select-input-border-radius );\\n\\tbackground-color: $select-input-bg;\\n\\tborder: 1px solid $select-input-border-color;\\n\\tborder-top-color: mix($select-input-bg, $select-input-border-color, 50%);\\n\\tbox-shadow: $select-menu-box-shadow;\\n\\tbox-sizing: border-box;\\n\\tmargin-top: -1px;\\n\\tmax-height: $select-menu-max-height;\\n\\tposition: absolute;\\n\\tleft: 0;\\n\\ttop: 100%;\\n\\twidth: 100%;\\n\\tz-index: $select-menu-zindex;\\n\\t-webkit-overflow-scrolling: touch;\\n}\\n\\n\\n// wrapper\\n\\n.Select-menu {\\n\\tmax-height: ($select-menu-max-height - 2px);\\n\\toverflow-y: auto;\\n}\\n\\n\\n// options\\n\\n.Select-option {\\n\\tbox-sizing: border-box;\\n\\tbackground-color: $select-option-bg;\\n\\tcolor: $select-option-color;\\n\\tcursor: pointer;\\n\\tdisplay: block;\\n\\tpadding: $select-padding-vertical $select-padding-horizontal;\\n\\n\\t&:last-child {\\n\\t\\t@include border-bottom-radius( $select-input-border-radius );\\n\\t}\\n\\n\\t&.is-selected {\\n\\t\\tbackground-color: $select-option-selected-bg;\\n\\t\\tcolor: $select-option-selected-color;\\n\\t}\\n\\n\\t&.is-focused {\\n\\t\\tbackground-color: $select-option-focused-bg;\\n\\t\\tcolor: $select-option-focused-color;\\n\\t}\\n\\n\\t&.is-disabled {\\n\\t\\tcolor: $select-option-disabled-color;\\n\\t\\tcursor: default;\\n\\t}\\n\\n}\\n\\n\\n// no results\\n\\n.Select-noresults {\\n\\tbox-sizing: border-box;\\n\\tcolor: $select-noresults-color;\\n\\tcursor: default;\\n\\tdisplay: block;\\n\\tpadding: $select-padding-vertical $select-padding-horizontal;\\n}\\n\",\"//\\n// Multi-Select\\n// ------------------------------\\n\\n\\n// Base\\n\\n.Select--multi {\\n\\n\\t// add margin to the input element\\n\\t.Select-input {\\n\\t\\tvertical-align: middle;\\n\\t\\t// border: 1px solid transparent;\\n\\t\\tmargin-left: $select-padding-horizontal;\\n\\t\\tpadding: 0;\\n\\t}\\n\\t&.Select--rtl .Select-input {\\n\\t\\tmargin-left: 0;\\n\\t\\tmargin-right: $select-padding-horizontal;\\n\\t}\\n\\n\\t// reduce margin once there is value\\n\\t&.has-value .Select-input {\\n\\t\\tmargin-left: $select-item-gutter;\\n\\t}\\n\\n\\t// Items\\n\\t.Select-value {\\n\\t\\tbackground-color: $select-item-bg;\\n\\t\\tborder-radius: $select-item-border-radius;\\n\\t\\tborder: 1px solid $select-item-border-color;\\n\\t\\tcolor: $select-item-color;\\n\\t\\tdisplay: inline-block;\\n\\t\\tfont-size: $select-item-font-size;\\n\\t\\tmargin-left: $select-item-gutter;\\n\\t\\tmargin-top: $select-item-gutter;\\n\\t\\tvertical-align: top;\\n\\t}\\n\\n\\t// common\\n\\t.Select-value-icon,\\n\\t.Select-value-label {\\n\\t\\tdisplay: inline-block;\\n\\t\\tvertical-align: middle;\\n\\t}\\n\\n\\t// label\\n\\t.Select-value-label {\\n\\t\\t@include border-right-radius( $select-item-border-radius );\\n\\t\\tcursor: default;\\n\\t\\tpadding: $select-item-padding-vertical $select-item-padding-horizontal;\\n\\t}\\n\\ta.Select-value-label {\\n\\t\\tcolor: $select-item-color;\\n\\t\\tcursor: pointer;\\n\\t\\ttext-decoration: none;\\n\\n\\t\\t&:hover {\\n\\t\\t\\ttext-decoration: underline;\\n\\t\\t}\\n\\t}\\n\\n\\t// icon\\n\\t.Select-value-icon {\\n\\t\\tcursor: pointer;\\n\\t\\t@include border-left-radius( $select-item-border-radius );\\n\\t\\tborder-right: 1px solid $select-item-border-color;\\n\\n\\t\\t// move the baseline up by 1px\\n\\t\\tpadding: ($select-item-padding-vertical - 1) $select-item-padding-horizontal ($select-item-padding-vertical + 1);\\n\\n\\t\\t&:hover,\\n\\t\\t&:focus {\\n\\t\\t\\tbackground-color: $select-item-hover-bg;\\n\\t\\t\\tcolor: $select-item-hover-color;\\n\\t\\t}\\n\\t\\t&:active {\\n\\t\\t\\tbackground-color: $select-item-border-color;\\n\\t\\t}\\n\\t}\\n\\n\\t&.Select--rtl {\\n\\t\\t.Select-value {\\n\\t\\t  margin-left: 0;\\n\\t\\t  margin-right: $select-item-gutter;\\n\\t\\t}\\n\\t\\t.Select-value-icon {\\n\\t\\t\\tborder-right: none;\\n\\t\\t\\tborder-left: 1px solid $select-item-border-color;\\n\\t\\t}\\n\\t}\\n}\\n\\n.Select--multi.is-disabled {\\n\\t.Select-value {\\n\\t\\tbackground-color: $select-item-disabled-bg;\\n\\t\\tborder: 1px solid $select-item-disabled-border-color;\\n\\t\\tcolor: $select-item-disabled-color;\\n\\t}\\n\\t// icon\\n\\t.Select-value-icon {\\n\\t\\tcursor: not-allowed;\\n\\t\\tborder-right: 1px solid $select-item-disabled-border-color;\\n\\n\\t\\t&:hover,\\n\\t\\t&:focus,\\n\\t\\t&:active {\\n\\t\\t\\tbackground-color: $select-item-disabled-bg;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"optionHeight\": \"24\",\n\t\"content\": \"packages-webviz-core-src-panels-Rosout-index-module-4nshd--content\",\n\t\"filtersBar\": \"packages-webviz-core-src-panels-Rosout-index-module-42gh9--filtersBar\",\n\t\"severityFilter\": \"packages-webviz-core-src-panels-Rosout-index-module-2nczq--severityFilter\",\n\t\"nodeFilter\": \"packages-webviz-core-src-panels-Rosout-index-module-3tekj--nodeFilter\",\n\t\"itemsCountField\": \"packages-webviz-core-src-panels-Rosout-index-module-hu4fx--itemsCountField\",\n\t\"is-focused\": \"packages-webviz-core-src-panels-Rosout-index-module-jr6wb--is-focused\",\n\t\"Select--rtl\": \"packages-webviz-core-src-panels-Rosout-index-module-33x8g--Select--rtl\",\n\t\"Select-animation-spin\": \"packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin\",\n\t\"Select-animation-fadeIn\": \"packages-webviz-core-src-panels-Rosout-index-module-2xhh8--Select-animation-fadeIn\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport _ from \"lodash\";\nimport React from \"react\";\nimport type { Time } from \"rosbag\";\n\nimport LevelToString from \"./LevelToString\";\nimport style from \"./LogMessage.module.scss\";\nimport { type Header } from \"webviz-core/src/types/Messages\";\n\n// pad the start of `val` with 0's to make the total string length `count` size\nfunction PadStart(val, count) {\n  return _.padStart(`${val}`, count, \"0\");\n}\n\nfunction Stamp(props: { stamp: Time }) {\n  const stamp = props.stamp;\n  return (\n    <span>\n      {PadStart(stamp.sec, 10)}.{PadStart(stamp.nsec, 9)}\n    </span>\n  );\n}\n\ntype Props = {|\n  msg: { file: string, line: string, level: number, name: string, msg: string, header: Header },\n|};\n\nexport default React.memo<Props>(function LogMessage({ msg }: Props) {\n  const altStr = `${msg.file}:${msg.line}`;\n\n  const strLevel = LevelToString(msg.level);\n\n  const levelClassName = style[strLevel.toLocaleLowerCase()];\n\n  // the first message line is rendered with the info/stamp/name\n  // following newlines are rendered on their own line\n  const lines = msg.msg.split(\"\\n\");\n  return (\n    <div title={altStr} className={`${style.container} ${levelClassName}`}>\n      <div>\n        <span>[{_.padStart(strLevel, 5, \" \")}]</span>\n        <span>\n          [<Stamp stamp={msg.header.stamp} />]\n        </span>\n        <span>\n          [{msg.name}\n          ]:\n        </span>\n        <span>&nbsp;</span>\n        <span>{lines[0]}</span>\n      </div>\n      {/* extra lines */}\n      <div>\n        {/* using array index as key is desired here since the index does not change */}\n        {lines.slice(1).map((line, idx) => {\n          return (\n            <div key={idx}>\n              &nbsp;&nbsp;&nbsp;&nbsp;\n              {line}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Rosout-LogMessage-module-3paw6--container{text-indent:-20px;padding-left:20px;white-space:pre-wrap;line-height:1.2}.packages-webviz-core-src-panels-Rosout-LogMessage-module-nvhh6--fatal{color:#ff7c96;font-weight:bold}.packages-webviz-core-src-panels-Rosout-LogMessage-module-5htzm--error{color:#ff7c96}.packages-webviz-core-src-panels-Rosout-LogMessage-module-rj2kj--warn{color:#ccb862}.packages-webviz-core-src-panels-Rosout-LogMessage-module-3zsp7--info{color:#586e75}.packages-webviz-core-src-panels-Rosout-LogMessage-module-4bs2y--debug{color:#93a1a1}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Rosout/LogMessage.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA,2EACE,kBACA,kBACA,qBACA,eAAA,CAGF,uEACE,cACA,gBAAA,CAGF,uEACE,aCiBI,CDdN,sEACE,aCYO,CDTT,sEACE,aAAA,CAGF,uEACE,aAAA,CAAA\",\"file\":\"LogMessage.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.container {\\n  text-indent: -20px;\\n  padding-left: 20px;\\n  white-space: pre-wrap;\\n  line-height: 1.2;\\n}\\n\\n.fatal {\\n  color: $red;\\n  font-weight: bold;\\n}\\n\\n.error {\\n  color: $red;\\n}\\n\\n.warn {\\n  color: $orange;\\n}\\n\\n.info {\\n  color: #586e75;\\n}\\n\\n.debug {\\n  color: #93a1a1;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"container\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-3paw6--container\",\n\t\"fatal\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-nvhh6--fatal\",\n\t\"error\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-5htzm--error\",\n\t\"warn\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-rj2kj--warn\",\n\t\"info\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-3zsp7--info\",\n\t\"debug\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-4bs2y--debug\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { List, AutoSizer, CellMeasurer, CellMeasurerCache } from \"react-virtualized\";\nimport uuid from \"uuid\";\n\nimport Button from \"webviz-core/src/components/Button\";\n\n// TODO(Audrey): import types from react-virtualized once they are available\n// RowRendererParams, CellMeasureCache\ntype RowRendererParams = {|\n  className: string,\n  columns: any[],\n  index: number,\n  isScrolling: boolean,\n  onRowClick: ?() => void,\n  onRowDoubleClick: ?() => void,\n  onRowMouseOver: ?() => void,\n  onRowMouseOut: ?() => void,\n  rowData: any,\n  style: StyleObj,\n  parent?: any,\n  key: number | string,\n|};\n\ntype RenderRowInput<Item> = {| ...RowRendererParams, item: Item |};\n\nexport type RenderRow<Item> = (RenderRowInput<Item>) => React.Node;\n\n// List for showing large number of items, which are expected to be appended to the end regularly.\n// Automatically scrolls to the bottom unless you explicitly scroll up.\nfunction LogList<Item>({ items, renderRow }: {| items: $ReadOnlyArray<Item>, renderRow: RenderRow<Item> |}) {\n  // Automatically scrolling to the bottom by default.\n  const [autoScroll, setAutoScroll] = React.useState(true);\n\n  // For keeping a reference to the container <div>. Unfortunately there don't seem to be other\n  // convenient ways to do this; e.g. `ref` doesn't work.\n  const listId = React.useRef<string>(uuid.v4());\n\n  // Cache for item heights.\n  const cache = React.useRef<CellMeasurerCache>(new CellMeasurerCache({ fixedWidth: true }));\n\n  // Keep track of the last width to see if we need to clear the cache.\n  const lastWidth = React.useRef<number>(-1);\n\n  // Keep track of the last items that we rendered to see if we need to clear the cache.\n  const lastItems = React.useRef<$ReadOnlyArray<Item>>([]);\n\n  // Last time we rendered; used in `onScroll`.\n  const lastRenderTime = React.useRef<number>(0);\n  lastRenderTime.current = Date.now();\n\n  // If we have fewer items now, or if any of the old items don't match any more, we have to clear\n  // the cache of heights.\n  if (items.length < lastItems.current.length || !lastItems.current.every((item, index) => item === items[index])) {\n    cache.current.clearAll();\n  }\n  lastItems.current = items;\n\n  // `onWheel` is only called when the user explicitly scrolls using the scroll wheel or track pad.\n  // This is reliable, so we don't need any buffers or checks. However, this doesn't cover all cases\n  // of users scrolling (e.g. keyboard or dragging the scroll bar) so we also need `onScroll` below.\n  const onWheel = React.useCallback(() => {\n    const containerEl = document.getElementById(listId.current);\n    if (!containerEl) {\n      return;\n    }\n    const newAutoScroll = containerEl.scrollHeight - containerEl.scrollTop <= containerEl.clientHeight;\n    if (newAutoScroll !== autoScroll) {\n      setAutoScroll(newAutoScroll);\n    }\n  }, [autoScroll]);\n\n  // As said above, we need `onScroll` to catch some of the user scroll events. However, it's also\n  // triggered when a scroll happens for a different reason, e.g. by the browser or initiated from\n  // our own code. There's unfortunately no easy way to differentiate between them, and often during\n  // rendering the `onScroll` events can't quite keep up with the actual rendering, so we require\n  // rendering to not have happened for a second, and we have a bit of a buffer for how much\n  // scrolling we require to have been done. In practice this seems to be working reasonably well.\n  const onScroll = React.useCallback(() => {\n    if (Date.now() - lastRenderTime.current < 1000) {\n      return;\n    }\n    const containerEl = document.getElementById(listId.current);\n    if (!containerEl) {\n      return;\n    }\n    const newAutoScroll = containerEl.scrollHeight - containerEl.scrollTop <= containerEl.clientHeight + 5;\n    if (newAutoScroll !== autoScroll) {\n      setAutoScroll(newAutoScroll);\n    }\n  }, [autoScroll]);\n\n  const onResetView = React.useCallback(() => {\n    setAutoScroll(true);\n  }, []);\n\n  return (\n    <AutoSizer>\n      {({ width, height }) => {\n        // If the width changed, row heights might have changed, so we need to clear the cache.\n        if (lastWidth.current !== width) {\n          cache.current.clearAll();\n        }\n        lastWidth.current = width;\n\n        return (\n          <div style={{ position: \"relative\", width, height }}>\n            <List\n              width={width}\n              height={height}\n              style={{ outline: \"none\" }}\n              deferredMeasurementCache={cache.current}\n              rowHeight={cache.current.rowHeight}\n              rowRenderer={(rowProps) => (\n                <CellMeasurer\n                  key={rowProps.key}\n                  cache={cache.current}\n                  parent={rowProps.parent}\n                  columnIndex={0}\n                  rowIndex={rowProps.index}>\n                  {renderRow({ ...rowProps, item: items[rowProps.index] })}\n                </CellMeasurer>\n              )}\n              rowCount={items.length}\n              overscanRowCount={10}\n              onScroll={onScroll}\n              id={listId.current}\n              containerProps={{ onWheel }}\n              {...(autoScroll ? { scrollToIndex: items.length - 1 } : undefined)}\n            />\n            {!autoScroll && (\n              <div style={{ position: \"absolute\", bottom: 5, right: 10 }}>\n                <Button tooltip=\"(shortcut: scroll down)\" onClick={onResetView}>\n                  reset view\n                </Button>\n              </div>\n            )}\n          </div>\n        );\n      }}\n    </AutoSizer>\n  );\n}\n\nexport default LogList;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { type Node, useCallback } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport SelectableTimestamp from \"webviz-core/src/components/SelectableTimestamp\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { formatDuration } from \"webviz-core/src/util/formatTime\";\nimport { subtractTimes, toSec } from \"webviz-core/src/util/time\";\n\nconst STableContainer = styled.div`\n  overflow-y: auto;\n  overflow-x: hidden;\n`;\n\nconst STable = styled.div`\n  max-width: 100%;\n  min-width: 400px;\n  overflow: auto;\n`;\n\nconst SRow = styled.div`\n  &:nth-child(even) {\n    background: #333;\n  }\n`;\n\nconst SCell = styled.div`\n  border: 0;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  font-size: 14px;\n  line-height: 1.6;\n  width: 33%;\n  display: inline-block;\n  padding: 2px 8px;\n  white-space: nowrap;\n`;\n\nconst SHeader = styled.div`\n  font-size: 14px;\n  border-bottom: #333 solid 2px;\n`;\n\nconst STitle = styled.div`\n  padding: 2px 8px;\n`;\n\nconst SHeaderItem = styled.div`\n  overflow: hidden;\n  white-space: nowrap;\n`;\n\nfunction SourceInfo(): Node {\n  const { topics, startTime, endTime } = useMessagePipeline(\n    useCallback(\n      ({ playerState: { activeData } }) =>\n        activeData\n          ? {\n              topics: activeData.topics,\n              startTime: activeData.startTime,\n              endTime: activeData.endTime,\n            }\n          : { topics: [], startTime: undefined, endTime: undefined },\n      []\n    )\n  );\n  if (!startTime || !endTime) {\n    return (\n      <>\n        <PanelToolbar floating />\n        <EmptyState>Waiting for player data...</EmptyState>\n      </>\n    );\n  }\n\n  const duration = subtractTimes(endTime, startTime);\n  return (\n    <>\n      <PanelToolbar floating />\n      <STableContainer>\n        <SHeader>\n          <SHeaderItem>\n            <STitle>Start time:</STitle>\n            <SelectableTimestamp\n              startTime={startTime}\n              endTime={endTime}\n              currentTime={startTime}\n              pausePlayback={() => {}}\n              seekPlayback={() => {}}\n            />\n          </SHeaderItem>\n          <SHeaderItem>\n            <STitle>End Time:</STitle>\n            <SelectableTimestamp\n              startTime={startTime}\n              endTime={endTime}\n              currentTime={endTime}\n              pausePlayback={() => {}}\n              seekPlayback={() => {}}\n            />\n          </SHeaderItem>\n          <SHeaderItem>\n            <STitle>Duration: {formatDuration(duration)}</STitle>\n          </SHeaderItem>\n        </SHeader>\n        <STable>\n          {topics.map((t) => (\n            <SRow key={t.name}>\n              <SCell\n                title={`Click to copy topic name ${t.name} to clipboard.`}\n                onClick={() => {\n                  clipboard.copy(t.name);\n                }}>\n                {t.name}\n              </SCell>\n              <SCell\n                title={`Click to copy topic type ${t.datatype} to clipboard.`}\n                onClick={() => {\n                  clipboard.copy(t.datatype);\n                }}>\n                {t.datatype}\n              </SCell>\n              {t.numMessages != null ? (\n                <SCell>\n                  {t.numMessages} msgs ({(t.numMessages / toSec(duration)).toFixed(2)} Hz)\n                </SCell>\n              ) : (\n                <SCell />\n              )}\n            </SRow>\n          ))}\n        </STable>\n      </STableContainer>\n    </>\n  );\n}\n\nSourceInfo.panelType = \"SourceInfo\";\nSourceInfo.defaultConfig = {};\n\nexport default hot(Panel<{}>(SourceInfo));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ChevronRightIcon from \"@mdi/svg/svg/chevron-right.svg\";\nimport React, { useEffect } from \"react\";\nimport { type Time } from \"rosbag\";\nimport styled from \"styled-components\";\n\nimport CopyText from \"webviz-core/src/components/CopyText\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport mixins from \"webviz-core/src/styles/mixins.module.scss\";\nimport { formatDate, formatTime, parseTimeStr } from \"webviz-core/src/util/formatTime\";\nimport { parseRosTimeStr, clampTime, formatTimeRaw } from \"webviz-core/src/util/time\";\n\nconst SRoot = styled.div`\n  display: flex;\n  flex: 0 0 auto;\n  align-items: center;\n`;\n\nconst DateWrapper = styled.div`\n  font-family: ${mixins.monospaceFont};\n  font-size: 14px;\n  font-weight: normal;\n  color: ${colors.grey};\n  margin-left: 8px;\n`;\n\nconst TimestampWrapper = styled.div`\n  display: flex;\n  font-family: ${mixins.monospaceFont};\n  font-size: 14px;\n  font-weight: normal;\n  color: ${colors.grey};\n  align-items: center;\n  flex: 0 0 auto;\n`;\n\nconst RosTimeWrapper = styled.div`\n  display: inline-block;\n  color: rgba(255, 255, 255, 0.5);\n  margin: 0 8px;\n`;\n\nconst TimeWrapper = styled.div`\n  display: inline-block;\n  margin: 0 8px;\n`;\n\nconst ROSText = styled.div`\n  color: rgba(255, 255, 255, 0.5);\n`;\n\nconst SInput = styled.input`\n  min-width: 160px;\n  padding: 2px 4px;\n  background-color: transparentize(${colors.textNormal}, 0.2);\n`;\n\ntype Props = {\n  currentTime: Time,\n  startTime: Time,\n  endTime: Time,\n  pausePlayback: () => void,\n  seekPlayback: (Time) => void,\n  timezone?: ?string,\n};\n\nfunction getValidTime(timeStr: string, start: Time, end: Time, isRosTime: boolean) {\n  const validTime = isRosTime ? parseRosTimeStr(timeStr) : parseTimeStr(timeStr);\n  return (validTime && clampTime(validTime, start, end)) || null;\n}\n\nexport default React.memo<Props>(function SelectableTimestamp({\n  currentTime,\n  startTime,\n  endTime,\n  seekPlayback,\n  pausePlayback,\n  timezone,\n}: Props) {\n  const [rosTimeStr, setRosTimeStr] = React.useState<string>(`${currentTime.sec}.${currentTime.nsec}`);\n  const currentTimeStr = formatTime(currentTime, timezone);\n  const [timeStr, setTimeStr] = React.useState<string>(currentTimeStr);\n  const [isEditingRosTime, setIsEditingRosTime] = React.useState<boolean>(false);\n  const [isEditingTime, setIsEditingTime] = React.useState<boolean>(false);\n  const [error, setError] = React.useState<boolean>(false);\n  const date = formatDate(currentTime, timezone);\n\n  useEffect(\n    () => {\n      // Reset the timeStr when timezone becomes available.\n      if (timezone) {\n        setTimeStr(currentTimeStr);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps, only need to reset timeStr when timezone becomes available\n    [timezone]\n  );\n\n  const rawTime = formatTimeRaw(currentTime);\n\n  function onSeekTime(ev, isRosTime) {\n    ev.preventDefault();\n    setIsEditingRosTime(false);\n    setIsEditingTime(false);\n\n    const str = isRosTime ? rosTimeStr : `${date} ${timeStr}`;\n    const validTime = getValidTime(str, startTime, endTime, isRosTime);\n    if (validTime) {\n      seekPlayback(validTime);\n    }\n  }\n\n  function onTimeChange(ev, isRosTime) {\n    const val = ev.target.value;\n    if (isRosTime) {\n      setRosTimeStr(val);\n    } else {\n      setTimeStr(val);\n    }\n    const str = isRosTime ? val : `${date} ${val}`;\n    const validTime = getValidTime(str, startTime, endTime, isRosTime);\n    setError(!validTime);\n  }\n\n  function onTimeTextClick(isRosTime) {\n    // pause playback to focus on editing\n    pausePlayback();\n    setError(false);\n    // reset the editing input value base on currentTime\n    if (isRosTime) {\n      setRosTimeStr(`${currentTime.sec}.${currentTime.nsec}`);\n    } else {\n      setTimeStr(formatTime(currentTime));\n    }\n    setIsEditingRosTime(isRosTime);\n    setIsEditingTime(!isRosTime);\n  }\n\n  return (\n    <SRoot>\n      <DateWrapper>{date}</DateWrapper>\n      <Icon style={{ margin: \"0 4px\", opacity: \"0.5\" }} medium clickable={false}>\n        <ChevronRightIcon />\n      </Icon>\n      <TimestampWrapper>\n        <TimeWrapper>\n          {isEditingTime ? (\n            <form onSubmit={(ev) => onSeekTime(ev, false)}>\n              <SInput\n                style={{ border: error ? \"1px solid red\" : \"none\" }}\n                value={timeStr}\n                onChange={(ev) => onTimeChange(ev, false)}\n              />\n            </form>\n          ) : (\n            <span onClick={() => onTimeTextClick(false)}>{currentTimeStr}</span>\n          )}\n        </TimeWrapper>\n\n        <RosTimeWrapper>\n          {isEditingRosTime ? (\n            <form onSubmit={(ev) => onSeekTime(ev, true)}>\n              <SInput\n                style={{ border: error ? \"1px solid red\" : \"none\" }}\n                value={rosTimeStr}\n                onChange={(ev) => onTimeChange(ev, true)}\n              />\n            </form>\n          ) : (\n            <span onClick={() => onTimeTextClick(true)}>{rawTime}</span>\n          )}\n        </RosTimeWrapper>\n        <CopyText copyText={rawTime} tooltip=\"Copy ROS time to clipboard\">\n          <ROSText>ROS</ROSText>\n        </CopyText>\n      </TimestampWrapper>\n    </SRoot>\n  );\n});\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ClipboardOutlineIcon from \"@mdi/svg/svg/clipboard-outline.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport Icon from \"webviz-core/src/components/Icon\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\n\nconst SCopyTextWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  .icon {\n    visibility: hidden;\n  }\n  :hover {\n    .icon {\n      visibility: visible;\n    }\n  }\n`;\n\ntype Props = {|\n  copyText: string,\n  tooltip: string,\n  children: React.Node,\n|};\n\nfunction CopyText({ copyText, tooltip, children }: Props) {\n  if (!copyText || !children) {\n    return null;\n  }\n  return (\n    <SCopyTextWrapper onClick={() => clipboard.copy(copyText)}>\n      {children ? children : copyText}\n      <Icon fade style={{ margin: \"0 8px\", verticalAlign: \"middle\" }} tooltip={tooltip}>\n        <ClipboardOutlineIcon />\n      </Icon>\n    </SCopyTextWrapper>\n  );\n}\n\nexport default CopyText;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\n\n// Little dummy panel that just subscribes to a bunch of topics. Doesn't actually\n// do anything with them.\n\ntype Config = { topics: string };\ntype Props = { config: Config, saveConfig: SaveConfig<Config> };\n\nfunction SubscribeToList({ config, saveConfig }: Props): React.Node {\n  const topics = config.topics.split(/\\s*(?:\\n|,|\\s)\\s*/);\n  const messagesSeen = PanelAPI.useMessageReducer<number>({\n    topics,\n    restore: React.useCallback(() => 0, []),\n    addMessage: React.useCallback((seenBefore) => seenBefore + 1, []),\n  });\n  return (\n    <Flex col>\n      <PanelToolbar floating />\n      <textarea\n        style={{ flexGrow: 1, border: \"none\" }}\n        placeholder=\"add /some/topics/here separated by newlines or commas or whitespace\"\n        value={config.topics}\n        onChange={React.useCallback((event) => saveConfig({ topics: event.target.value }), [saveConfig])}\n      />\n      <div style={{ position: \"absolute\", bottom: 8, right: 12 }}>messages seen: {messagesSeen}</div>\n    </Flex>\n  );\n}\n\nSubscribeToList.panelType = \"SubscribeToList\";\nSubscribeToList.defaultConfig = { topics: \"\" };\n\nexport default hot(Panel<Config>(SubscribeToList));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\n\nimport { savePanelConfigs } from \"webviz-core/src/actions/panels\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport { usePanelContext } from \"webviz-core/src/components/PanelContext\";\nimport { UnconnectedPanelLayout } from \"webviz-core/src/components/PanelLayout\";\nimport { EmptyDropTarget } from \"webviz-core/src/panels/Tab/EmptyDropTarget\";\nimport { TabbedToolbar } from \"webviz-core/src/panels/Tab/TabbedToolbar\";\nimport { type DraggingTabPanelState, TabDndContext } from \"webviz-core/src/panels/Tab/TabDndContext\";\nimport type { TabPanelConfig as Config } from \"webviz-core/src/types/layouts\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\nimport { TAB_PANEL_TYPE } from \"webviz-core/src/util/globalConstants\";\nimport { DEFAULT_TAB_PANEL_CONFIG, updateTabPanelLayout } from \"webviz-core/src/util/layout\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SPanelCover = styled.div`\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  background: ${colors.DARK};\n  position: absolute;\n`;\n\ntype Props = { config: Config, saveConfig: SaveConfig<Config> };\n\nfunction Tab({ config, saveConfig }: Props) {\n  const panelId = usePanelContext()?.id;\n  const dispatch = useDispatch();\n  const mosaicId = useSelector(({ mosaic }) => mosaic.mosaicId);\n  const savePanelConfigsFn = useCallback(dispatch(savePanelConfigs), [dispatch]);\n\n  const { tabs, activeTabIdx } = config;\n  const activeTab = tabs[activeTabIdx];\n  const activeLayout = activeTab?.layout;\n\n  // Holds the state of actively dragging tabs as they relate to this Tab Panel\n  const [draggingTabState, setDraggingTabState] = useState<DraggingTabPanelState>({\n    item: null,\n    isOver: false,\n  });\n\n  // Create the actions used by the tab\n  const selectTab = useCallback((idx) => {\n    saveConfig({ activeTabIdx: idx });\n  }, [saveConfig]);\n  const setTabTitle = useCallback((idx, title) => {\n    const newTabs = tabs.slice();\n    newTabs[idx] = { ...tabs[idx], title };\n    saveConfig({ tabs: newTabs });\n  }, [saveConfig, tabs]);\n  const removeTab = useCallback((idx) => {\n    const newTabs = tabs.slice(0, idx).concat(tabs.slice(idx + 1));\n    const lastIdx = tabs.length - 1;\n    saveConfig({ tabs: newTabs, activeTabIdx: activeTabIdx === lastIdx ? lastIdx - 1 : activeTabIdx });\n  }, [activeTabIdx, saveConfig, tabs]);\n  const addTab = useCallback(() => {\n    const newTab = { title: `${tabs.length + 1}`, layout: null };\n    saveConfig({ ...config, activeTabIdx: tabs.length, tabs: tabs.concat([newTab]) });\n  }, [config, saveConfig, tabs]);\n  const onChangeLayout = useCallback((layout: string) => {\n    saveConfig(updateTabPanelLayout(layout, config));\n  }, [config, saveConfig]);\n  const actions = useMemo(() => ({ addTab, removeTab, selectTab, setTabTitle }), [\n    addTab,\n    removeTab,\n    selectTab,\n    setTabTitle,\n  ]);\n\n  // If the user drags the active tab out of the toolbar, we'll hide the\n  // active layout in order to prevent tabs from dropping into child tabs.\n  const draggingTab = draggingTabState.item;\n  const preventTabDrop =\n    !!draggingTab &&\n    draggingTab.panelId === panelId &&\n    draggingTab.tabIndex === activeTabIdx &&\n    !draggingTabState.isOver;\n\n  return (\n    <Flex col>\n      <TabbedToolbar\n        panelId={panelId}\n        tabs={tabs}\n        actions={actions}\n        activeTabIdx={activeTabIdx}\n        setDraggingTabState={setDraggingTabState}\n      />\n      <Flex\n        style={{\n          position: \"relative\",\n        }}>\n        {activeLayout ? (\n          <TabDndContext.Provider value={{ preventTabDrop }}>\n            <UnconnectedPanelLayout\n              importHooks={false}\n              layout={activeLayout}\n              savePanelConfigs={savePanelConfigsFn}\n              onChange={onChangeLayout}\n              setMosaicId={() => {}}\n              mosaicId={mosaicId}\n              tabId={panelId}\n              removeRootDropTarget\n            />\n          </TabDndContext.Provider>\n        ) : (\n          <EmptyDropTarget mosaicId={mosaicId} tabId={panelId} />\n        )}\n        {preventTabDrop && <SPanelCover />}\n      </Flex>\n    </Flex>\n  );\n}\n\nTab.panelType = TAB_PANEL_TYPE;\nTab.defaultConfig = DEFAULT_TAB_PANEL_CONFIG;\n\nexport default hot(Panel<Config>(Tab));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport PlusIcon from \"@mdi/svg/svg/plus.svg\";\nimport React, { useContext, useEffect } from \"react\";\nimport { type DropTargetMonitor, useDrop } from \"react-dnd\";\nimport { useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\n\nimport { moveTab, type MoveTabPayload } from \"webviz-core/src/actions/panels\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport { DraggableToolbarTab } from \"webviz-core/src/panels/Tab/DraggableToolbarTab\";\nimport helpContent from \"webviz-core/src/panels/Tab/index.help.md\";\nimport {\n  type DraggingTabItem,\n  TAB_DRAG_TYPE,\n  type TabActions,\n  TabDndContext,\n} from \"webviz-core/src/panels/Tab/TabDndContext\";\nimport type { TabConfig } from \"webviz-core/src/types/layouts\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst STabbedToolbar = styled.div`\n  flex: 0 0;\n  display: flex;\n  position: relative;\n  flex-direction: column;\n\n  &:after {\n    border: 2px solid ${({ highlight }) => (highlight ? colors.DARK5 : \"transparent\")};\n    content: \"\";\n    height: 100%;\n    left: 0;\n    pointer-events: none;\n    position: absolute;\n    top: 0;\n    width: 100%;\n    z-index: 1;\n  }\n`;\nconst STabs = styled.div`\n  flex: 1 1;\n  display: flex;\n  align-items: flex-end;\n`;\n\ntype Props = {|\n  panelId: string,\n  actions: TabActions,\n  tabs: TabConfig[],\n  activeTabIdx: number,\n  setDraggingTabState: ({ isOver: boolean, item: ?DraggingTabItem }) => void,\n|};\n\nexport function TabbedToolbar(props: Props) {\n  const { panelId, actions, tabs, activeTabIdx, setDraggingTabState } = props;\n\n  const dispatch = useDispatch();\n  const { preventTabDrop } = useContext(TabDndContext);\n  const [{ isOver, item }, dropRef] = useDrop({\n    accept: TAB_DRAG_TYPE,\n    collect: (monitor) => ({\n      item: monitor.getItem(),\n      isOver: monitor.isOver(),\n    }),\n    canDrop: () => !preventTabDrop,\n    drop: (sourceItem: DraggingTabItem, monitor: DropTargetMonitor) => {\n      // Drop was already handled by DraggableToolTab, ignore here\n      if (monitor.didDrop()) {\n        return;\n      }\n      const source = {\n        panelId: sourceItem.panelId,\n        tabIndex: sourceItem.tabIndex,\n      };\n      const target = { panelId };\n      dispatch(moveTab(({ source, target }: MoveTabPayload)));\n    },\n  });\n  useEffect(() => {\n    setDraggingTabState({ item, isOver });\n  }, [item, isOver, setDraggingTabState]);\n\n  return (\n    <STabbedToolbar highlight={isOver}>\n      <PanelToolbar helpContent={helpContent} showHiddenControlsOnHover>\n        <STabs ref={dropRef} data-test=\"toolbar-droppable\">\n          {tabs.map((tab, i) => (\n            <DraggableToolbarTab\n              isActive={activeTabIdx === i}\n              key={i}\n              panelId={panelId}\n              setDraggingTabState={setDraggingTabState}\n              actions={actions}\n              tabCount={tabs.length}\n              tabIndex={i}\n              tabTitle={tab.title}\n            />\n          ))}\n          <Icon\n            small\n            fade\n            dataTest=\"add-tab\"\n            tooltip=\"Add tab\"\n            style={{\n              flexShrink: 0,\n              margin: \"0 8px\",\n              transition: \"opacity 0.2s\",\n            }}\n            onClick={actions.addTab}>\n            <PlusIcon onMouseDown={(e) => e.preventDefault()} />\n          </Icon>\n        </STabs>\n      </PanelToolbar>\n    </STabbedToolbar>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useRef } from \"react\";\nimport { useDrag, useDrop } from \"react-dnd\";\nimport { useDispatch } from \"react-redux\";\n\nimport { moveTab, type MoveTabPayload } from \"webviz-core/src/actions/panels\";\nimport { type DraggingTabItem, TAB_DRAG_TYPE, type TabActions } from \"webviz-core/src/panels/Tab/TabDndContext\";\nimport { ToolbarTab } from \"webviz-core/src/panels/Tab/ToolbarTab\";\n\ntype Props = {|\n  isActive: boolean,\n  panelId: string,\n  actions: TabActions,\n  tabCount: number,\n  tabIndex: number,\n  tabTitle: string,\n  setDraggingTabState: ({ isOver: boolean, item: ?DraggingTabItem }) => void,\n|};\n\nexport function DraggableToolbarTab(props: Props) {\n  const { isActive, tabCount, actions, panelId, tabTitle, tabIndex } = props;\n\n  const ref = useRef(null);\n  const dispatch = useDispatch();\n  const [{ isDragging }, dragRef] = useDrag({\n    item: { type: TAB_DRAG_TYPE, panelId, tabIndex },\n    collect: (monitor) => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n\n  const [{ isOver }, dropRef] = useDrop({\n    accept: TAB_DRAG_TYPE,\n    collect: (monitor) => ({\n      isOver: monitor.isOver(),\n    }),\n    drop: (sourceItem, _monitor) => {\n      const source = { panelId: sourceItem.panelId, tabIndex: sourceItem.tabIndex };\n      const target = { tabIndex, panelId };\n      dispatch(moveTab(({ source, target }: MoveTabPayload)));\n    },\n  });\n\n  dragRef(dropRef(ref)); // Combine drag and drop refs\n\n  const tabProps = {\n    tabTitle,\n    tabIndex,\n    isActive,\n    tabCount,\n    actions,\n    isDragging,\n    innerRef: ref,\n    hidden: isDragging,\n    highlight: isOver,\n  };\n  return <ToolbarTab {...tabProps} />;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CheckIcon from \"@mdi/svg/svg/check.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport cx from \"classnames\";\nimport React, { type Ref as ReactRef, useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport textWidth from \"text-width\";\n\nimport styles from \"./Tab.module.scss\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { type TabActions } from \"webviz-core/src/panels/Tab/TabDndContext\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst FONT_SIZE = 12;\nconst FONT_FAMILY = \"'Inter UI', -apple-system, BlinkMacSystemFont, sans-serif\";\n\nconst MAX_TAB_WIDTH = 100;\nconst MIN_ACTIVE_TAB_WIDTH = 40;\nconst MIN_OTHER_TAB_WIDTH = 14;\n\nfunction measureText(text: string): number {\n  return textWidth(text, { family: FONT_FAMILY, size: FONT_SIZE }) + 3;\n}\n\nconst STab = styled.div.attrs(({ isActive, value, tabCount, isDragging, hidden, highlight }) => ({\n  style: {\n    opacity: hidden ? 0 : 1,\n    borderColor: isDragging || highlight ? colors.DARK6 : \"transparent\",\n    boxShadow: isDragging ? `0px 2px 6px rgba(0, 0, 0, 0.2)` : \"none\",\n    backgroundColor: isActive ? colors.DARK4 : isDragging ? colors.DARK2 : \"transparent\",\n    minWidth: isActive\n      ? `calc(max(${MIN_ACTIVE_TAB_WIDTH}px,  min(${Math.ceil(\n          measureText(value) + 30\n        )}px, ${MAX_TAB_WIDTH}px, 100% - ${MIN_OTHER_TAB_WIDTH * (tabCount - 1)}px)))`\n      : undefined,\n  },\n}))`\n  max-width: ${MAX_TAB_WIDTH}px;\n`;\n\nconst SInput = styled.input.attrs(({ editable }) => ({\n  style: {\n    pointerEvents: editable ? \"all\" : \"none\",\n  },\n}))`\n  width: 100%;\n`;\nconst clearBgStyle = { backgroundColor: \"transparent\", padding: 0 };\n\ntype Props = {|\n  hidden: boolean,\n  highlight: boolean,\n  innerRef: ?ReactRef<*>,\n  isActive: boolean,\n  isDragging: boolean,\n  actions: TabActions,\n  tabCount: number,\n  tabIndex: number,\n  tabTitle: string,\n|};\n\nexport function ToolbarTab(props: Props) {\n  const { tabIndex, isActive, tabCount, tabTitle, isDragging, actions, innerRef, highlight, hidden } = props;\n\n  const inputRef = useRef<?HTMLInputElement>(null);\n  const [title, setTitle] = useState<string>(tabTitle || \"\");\n  const [editingTitle, setEditingTitle] = useState<boolean>(false);\n  const onChangeTitleInput = useCallback((ev) => setTitle(ev.target.value), []);\n\n  const { selectTab, removeTab } = useMemo(\n    () => ({\n      selectTab: () => actions.selectTab(tabIndex),\n      removeTab: () => actions.removeTab(tabIndex),\n    }),\n    [actions, tabIndex]\n  );\n  const setTabTitle = useCallback(() => actions.setTabTitle(tabIndex, title), [actions, tabIndex, title]);\n\n  const onClickTab = useCallback(() => {\n    if (!isActive) {\n      selectTab();\n    } else {\n      setEditingTitle(true);\n\n      setImmediate(() => {\n        if (inputRef.current) {\n          const inputEl: HTMLInputElement = inputRef.current;\n          inputEl.focus();\n          inputEl.select();\n        }\n      });\n    }\n  }, [isActive, selectTab, inputRef]);\n\n  const endTitleEditing = useCallback(() => {\n    setEditingTitle(false);\n    if (document.activeElement) {\n      document.activeElement.blur();\n    }\n  }, []);\n\n  const confirmNewTitle = useCallback(() => {\n    setTabTitle();\n    endTitleEditing();\n  }, [endTitleEditing, setTabTitle]);\n\n  const resetTitle = useCallback(() => {\n    setTitle(tabTitle || \"\");\n    endTitleEditing();\n  }, [endTitleEditing, tabTitle]);\n\n  const onKeyDown = useCallback((event: SyntheticKeyboardEvent<HTMLInputElement>) => {\n    if (event.key === \"Escape\") {\n      resetTitle();\n    } else if (event.key === \"Enter\") {\n      confirmNewTitle();\n    }\n  }, [confirmNewTitle, resetTitle]);\n\n  // If the tab is no longer active, stop editing the title\n  useEffect(() => {\n    if (!isActive) {\n      setEditingTitle(false);\n    }\n  }, [isActive]);\n\n  // Update the cached title if the tabTitle changes\n  useEffect(() => {\n    setTitle(tabTitle);\n  }, [tabTitle]);\n\n  return (\n    <STab\n      hidden={hidden}\n      isDragging={isDragging}\n      isActive={isActive}\n      highlight={highlight}\n      tabCount={tabCount}\n      value={tabTitle || \"\"}\n      onClick={onClickTab}\n      ref={innerRef}\n      className={cx(styles.tab, { [styles.active]: isActive })}>\n      <Tooltip contents={editingTitle ? \"\" : tabTitle || \"Enter tab name\"} placement=\"top\">\n        {/* This div has to be here because the <ToolTip> overwrites the ref of its child*/}\n        <div>\n          <SInput\n            readonly={!editingTitle}\n            editable={editingTitle}\n            placeholder=\"Enter tab name\"\n            style={clearBgStyle}\n            value={title}\n            onChange={onChangeTitleInput}\n            onBlur={setTabTitle}\n            onKeyDown={onKeyDown}\n            ref={(el) => (inputRef.current = el)}\n          />\n        </div>\n      </Tooltip>\n      {isActive ? (\n        <Icon\n          small\n          fade\n          dataTest=\"tab-icon\"\n          tooltip={editingTitle ? \"Set new name\" : \"Remove tab\"}\n          style={{ width: \"22px\" }}\n          onClick={editingTitle ? confirmNewTitle : removeTab}>\n          {editingTitle ? (\n            <CheckIcon onMouseDown={(e) => e.preventDefault()} />\n          ) : (\n            <CloseIcon onMouseDown={(e) => e.preventDefault()} />\n          )}\n        </Icon>\n      ) : null}\n    </STab>\n  );\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Tab.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Tab.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Tab.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Tab-Tab-module-2jeb8--iconContainer{padding-top:4px;display:-ms-flexbox;display:flex;-ms-flex:0 0 auto;flex:0 0 auto;-ms-flex-align:center;align-items:center;margin-left:4px;-ms-flex-direction:row;flex-direction:row;min-height:22px;padding:2px 2px 2px 6px}.packages-webviz-core-src-panels-Tab-Tab-module-2jeb8--iconContainer svg{font-size:14px}.packages-webviz-core-src-panels-Tab-Tab-module-2awv1--panelName{font-size:10px;opacity:.5;margin-right:4px}.packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer{-webkit-transition:opacity 80ms ease-in-out,-webkit-transform 80ms ease-in-out;transition:opacity 80ms ease-in-out,-webkit-transform 80ms ease-in-out;-o-transition:transform 80ms ease-in-out,opacity 80ms ease-in-out;transition:transform 80ms ease-in-out,opacity 80ms ease-in-out;transition:transform 80ms ease-in-out,opacity 80ms ease-in-out,-webkit-transform 80ms ease-in-out;display:-ms-flexbox;display:flex;-ms-flex:0 0 auto;flex:0 0 auto;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:end;justify-content:flex-end;background-color:#1f1e27;padding:4px}.packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer.packages-webviz-core-src-panels-Tab-Tab-module-a4u7s--floating{position:absolute;right:0;padding-right:8px;top:0;width:100%;z-index:5000;background-color:transparent;-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px);transform:translateY(-10px);pointer-events:none;opacity:0}.packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer.packages-webviz-core-src-panels-Tab-Tab-module-a4u7s--floating *{pointer-events:auto}.packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer.packages-webviz-core-src-panels-Tab-Tab-module-a4u7s--floating.packages-webviz-core-src-panels-Tab-Tab-module-ts63v--hasChildren{left:0;background-color:#1f1e27}.packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer.packages-webviz-core-src-panels-Tab-Tab-module-a4u7s--floating:not(.packages-webviz-core-src-panels-Tab-Tab-module-ts63v--hasChildren) .packages-webviz-core-src-panels-Tab-Tab-module-2jeb8--iconContainer{background-color:#242429;border-radius:4px;-webkit-box-shadow:0 6px 40px rgba(0,0,0,.5),0 0 0 1px rgba(0,0,0,.2);box-shadow:0 6px 40px rgba(0,0,0,.5),0 0 0 1px rgba(0,0,0,.2)}.packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer:not(.packages-webviz-core-src-panels-Tab-Tab-module-a4u7s--floating){min-height:30px}.packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer.packages-webviz-core-src-panels-Tab-Tab-module-4jkja--floatingShow{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);opacity:1}.packages-webviz-core-src-panels-Tab-Tab-module-adt4m--icon,.packages-webviz-core-src-panels-Tab-Tab-module-2m4es--dragIcon{font-size:14px;margin:0 .2em}.packages-webviz-core-src-panels-Tab-Tab-module-2m4es--dragIcon{cursor:move}.packages-webviz-core-src-panels-Tab-Tab-module-jv2mw--tab{position:relative;border-top-left-radius:4px;border-top-right-radius:4px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;width:100%;height:26px;padding:0 6px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid transparent;top:4px;margin-top:-4px}.packages-webviz-core-src-panels-Tab-Tab-module-jv2mw--tab .packages-webviz-core-src-panels-Tab-Tab-module-2fjty--active{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all}.packages-webviz-core-src-panels-Tab-Tab-module-jv2mw--tab:not(.packages-webviz-core-src-panels-Tab-Tab-module-2fjty--active)+.packages-webviz-core-src-panels-Tab-Tab-module-jv2mw--tab:not(.packages-webviz-core-src-panels-Tab-Tab-module-2fjty--active):before{border-left:1px solid #2d2d33;content:\\\"\\\";height:16px;left:0;position:absolute;top:4px;z-index:1}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/PanelToolbar/index.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/Tab/Tab.module.scss\"],\"names\":[],\"mappings\":\"AAWA,qEACE,gBACA,oBAAA,aACA,kBAAA,cACA,sBAAA,mBACA,gBACA,uBAAA,mBACA,gBACA,uBAAA,CACA,yEACE,cAAA,CAIJ,iEACE,eACA,WACA,gBAAA,CAGF,6EACE,+EAAA,uEAAA,kEAAA,+DAAA,kGACA,oBAAA,aACA,kBAAA,cACA,uBAAA,mBACA,kBAAA,yBACA,yBACA,WA7BoB,CA+BpB,4IACE,kBACA,QAEA,kBACA,MACA,WACA,aACA,6BACA,oCAAA,gCAAA,4BACA,oBACA,SAAA,CAEA,8IACE,mBAAA,CAGF,8MACE,OACA,wBCxBU,CD2BZ,yRACE,yBACA,kBACA,sEAAA,6DAAA,CAIJ,kJACE,eAAA,CAGF,gJACE,gCAAA,4BAAA,wBACA,SAAA,CAIJ,4HAEE,eACA,aAAA,CAGF,gEACE,WAAA,CE9EF,2DACE,kBACA,2BACA,4BACA,oBAAA,aACA,sBAAA,mBACA,WACA,YACA,cACA,yBAAA,sBAAA,qBAAA,iBACA,6BAGA,QACA,eAAA,CAEA,yHACE,wBAAA,qBAAA,oBAAA,eAAA,CAKA,mQACE,8BACA,WACA,YACA,OACA,kBACA,QACA,SAAA,CAAA\",\"file\":\"Tab.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n$panelToolbarHeight: 26px;\\n$panelToolbarSpacing: 4px;\\n\\n.iconContainer {\\n  padding-top: $panelToolbarSpacing;\\n  display: flex;\\n  flex: 0 0 auto;\\n  align-items: center;\\n  margin-left: $panelToolbarSpacing;\\n  flex-direction: row;\\n  min-height: $panelToolbarHeight - $panelToolbarSpacing;\\n  padding: 2px 2px 2px 6px;\\n  svg {\\n    font-size: 14px;\\n  }\\n}\\n\\n.panelName {\\n  font-size: 10px;\\n  opacity: 0.5;\\n  margin-right: 4px;\\n}\\n\\n.panelToolbarContainer {\\n  transition: transform 80ms ease-in-out, opacity 80ms ease-in-out;\\n  display: flex;\\n  flex: 0 0 auto;\\n  flex-direction: row;\\n  justify-content: flex-end;\\n  background-color: $toolbar-fixed;\\n  padding: $panelToolbarSpacing;\\n\\n  &.floating {\\n    position: absolute;\\n    right: 0;\\n    // leave some room for possible scrollbar\\n    padding-right: 8px;\\n    top: 0;\\n    width: 100%;\\n    z-index: 5000;\\n    background-color: transparent;\\n    transform: translateY(-10px);\\n    pointer-events: none;\\n    opacity: 0;\\n\\n    * {\\n      pointer-events: auto;\\n    }\\n\\n    &.hasChildren {\\n      left: 0;\\n      background-color: $toolbar-fixed;\\n    }\\n\\n    &:not(.hasChildren) .iconContainer {\\n      background-color: $dark3;\\n      border-radius: 4px;\\n      box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.2);\\n    }\\n  }\\n\\n  &:not(.floating) {\\n    min-height: $panelToolbarHeight + $panelToolbarSpacing;\\n  }\\n\\n  &.floatingShow {\\n    transform: translateY(0);\\n    opacity: 1;\\n  }\\n}\\n\\n.icon,\\n.dragIcon {\\n  font-size: 14px;\\n  margin: 0 0.2em;\\n}\\n\\n.dragIcon {\\n  cursor: move;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/components/PanelToolbar/index.module.scss\\\";\\n\\n.tab {\\n  position: relative;\\n  border-top-left-radius: 4px;\\n  border-top-right-radius: 4px;\\n  display: flex;\\n  align-items: center;\\n  width: 100%;\\n  height: $panelToolbarHeight;\\n  padding: 0 6px;\\n  user-select: none;\\n  border: 1px solid transparent;\\n\\n  // Shift the tab down so it's flush with the bottom of the PanelToolbar\\n  top: $panelToolbarSpacing;\\n  margin-top: -$panelToolbarSpacing;\\n\\n  .active {\\n    user-select: all;\\n  }\\n\\n  &:not(.active) + &:not(.active) {\\n    // Use a before to add a separator line that doesn't span the full height of the tab\\n    &:before {\\n      border-left: 1px solid rgb(45, 45, 51);\\n      content: \\\"\\\";\\n      height: 16px;\\n      left: 0;\\n      position: absolute; // within .draggableTab\\n      top: 4px;\\n      z-index: 1;\\n    }\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"iconContainer\": \"packages-webviz-core-src-panels-Tab-Tab-module-2jeb8--iconContainer\",\n\t\"panelName\": \"packages-webviz-core-src-panels-Tab-Tab-module-2awv1--panelName\",\n\t\"panelToolbarContainer\": \"packages-webviz-core-src-panels-Tab-Tab-module-3xub7--panelToolbarContainer\",\n\t\"floating\": \"packages-webviz-core-src-panels-Tab-Tab-module-a4u7s--floating\",\n\t\"hasChildren\": \"packages-webviz-core-src-panels-Tab-Tab-module-ts63v--hasChildren\",\n\t\"floatingShow\": \"packages-webviz-core-src-panels-Tab-Tab-module-4jkja--floatingShow\",\n\t\"icon\": \"packages-webviz-core-src-panels-Tab-Tab-module-adt4m--icon\",\n\t\"dragIcon\": \"packages-webviz-core-src-panels-Tab-Tab-module-2m4es--dragIcon\",\n\t\"tab\": \"packages-webviz-core-src-panels-Tab-Tab-module-jv2mw--tab\",\n\t\"active\": \"packages-webviz-core-src-panels-Tab-Tab-module-2fjty--active\"\n};","module.exports = \"# Tab\\n\\nAllows users to group multiple Webviz panels in a mini layout, each nested under a tab.\\n\\n## Selecting Panels to Group\\n\\nSelect the first panel with a click, and select subsequent panels via `Cmd` + click. To deselect a panel, use `Cmd` + click.\\n\\nTo quickly select all panels in a layout, use `Cmd` + `a`, or click on the \\\"Select all panels\\\" option in the app's \\\"Config\\\" menu in the top-right.\\n\\nUsers can group the selected panels in one of 2 ways:\\n\\n- Combine selected panels under a single tab in a new Tab panel\\n- Create a separate tab for each selected panel in a new Tab panel\\n\\nHovering over any selected panel will allow you to make your choice.\\n\"","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { flatten, pick, round, uniq } from \"lodash\";\nimport * as React from \"react\";\nimport DocumentEvents from \"react-document-events\";\nimport ReactDOM from \"react-dom\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport helpContent from \"./index.help.md\";\nimport { PanelToolbarLabel, PanelToolbarInput } from \"webviz-core/shared/panelToolbarStyles\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport GLChart from \"webviz-core/src/components/GLChart\";\nimport { SBar } from \"webviz-core/src/components/HoverBar\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport { Item } from \"webviz-core/src/components/Menu\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport { useLatestMessageDataItem } from \"webviz-core/src/components/MessagePathSyntax/useLatestMessageDataItem\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport ReactChartjs, {\n  type HoveredElement,\n  type ChartCallbacks,\n  DEFAULT_PROPS,\n} from \"webviz-core/src/components/ReactChartjs\";\nimport { type ScaleBounds } from \"webviz-core/src/components/ReactChartjs/zoomAndPanHelpers\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { cast } from \"webviz-core/src/players/types\";\nimport { deepParse, isBobject } from \"webviz-core/src/util/binaryObjects\";\nimport { useDeepChangeDetector, useShallowMemo } from \"webviz-core/src/util/hooks\";\nimport { colors, ROBOTO_MONO } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SResetZoom = styled.div`\n  position: absolute;\n  bottom: 15px;\n  right: 10px;\n`;\n\nconst SContainer = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  flex-direction: column;\n  height: 100%;\n`;\n\nconst SRoot = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  width: 100%;\n  overflow: hidden;\n  position: relative;\n`;\n\n// TODO: Autocomplete should only show paths that actually match the format this panel supports\nconst VALID_TYPES = [\"message\"];\nconst keysToPick = [\n  \"order\",\n  \"label\",\n  \"backgroundColor\",\n  \"borderColor\",\n  \"borderDash\",\n  \"borderWidth\",\n  \"pointBackgroundColor\",\n  \"pointBorderColor\",\n  \"pointBorderWidth\",\n  \"pointRadius\",\n  \"pointStyle\",\n  \"lineTension\",\n  \"data\",\n];\n\nconst messagePathInputStyle = { height: \"100%\" };\n\nconst isValidMinMaxVal = (val?: string) => {\n  return val == null || val === \"\" || !isNaN(parseFloat(val));\n};\n\ntype Path = { value: string };\ntype Config = {\n  path: Path,\n  minXVal?: string,\n  maxXVal?: string,\n  minYVal?: string,\n  maxYVal?: string,\n  pointRadiusOverride?: string,\n};\ntype Props = { config: Config, saveConfig: ($Shape<Config>) => void };\nexport type Line = {\n  order?: number,\n  label: string,\n  backgroundColor?: string,\n  borderColor?: string,\n  borderDash?: number[],\n  borderWidth?: number,\n  pointBackgroundColor?: string,\n  pointBorderColor?: string,\n  pointBorderWidth?: number,\n  pointRadius?: string,\n  pointStyle?:\n    | \"circle\"\n    | \"cross\"\n    | \"crossRot\"\n    | \"dash\"\n    | \"line\"\n    | \"rect\"\n    | \"rectRounded\"\n    | \"rectRot\"\n    | \"star\"\n    | \"triangle\",\n  lineTension?: number,\n  data: { x: number, y: number }[],\n};\n\nconst SWrapper = styled.div`\n  top: 0;\n  bottom: 0;\n  position: absolute;\n  pointer-events: none;\n  will-change: transform;\n  // \"visibility\" and \"transform\" are set by JS, but outside of React.\n  visibility: hidden;\n`;\n\ntype Position = { x: number, y: number };\n\ntype HoverBarProps = {\n  children?: React.Node,\n  mousePosition: ?Position,\n};\n\nfunction hideBar(wrapper) {\n  if (wrapper.style.visibility !== \"hidden\") {\n    wrapper.style.visibility = \"hidden\";\n  }\n}\n\nfunction showBar(wrapper, position: number) {\n  wrapper.style.visibility = \"visible\";\n  wrapper.style.transform = `translateX(${position}px)`;\n}\n\n// TODO: It'd be a lot more performant to draw directly to the canvas here\n// instead of using React state lifecycles to update the hover bar.\nconst HoverBar = React.memo<HoverBarProps>(({ children, mousePosition }: HoverBarProps) => {\n  const wrapper = React.useRef<?HTMLDivElement>(null);\n  // We avoid putting the visibility and transforms into react state to try to keep updates snappy.\n  // Mouse interactions are frequent, and adding/removing the bar from the DOM would slow things\n  // down a lot more than mutating the style props does.\n  if (wrapper.current != null) {\n    const { current } = wrapper;\n    if (mousePosition != null) {\n      showBar(current, mousePosition.x);\n    } else {\n      hideBar(current);\n    }\n  }\n\n  return <SWrapper ref={wrapper}>{children}</SWrapper>;\n});\n\ntype TooltipProps = {|\n  datapoints: { datapoint: Position, label: string, backgroundColor?: string }[],\n  xAxisLabel: ?string,\n  tooltipElement: ?HoveredElement,\n|};\n\nconst TwoDimensionalTooltip = ({ datapoints, xAxisLabel, tooltipElement }: TooltipProps) => {\n  if (!tooltipElement) {\n    return null;\n  }\n\n  const contents = (\n    <div style={{ fontFamily: ROBOTO_MONO }}>\n      <div style={{ color: colors.TEXT_MUTED, padding: \"4px 0\" }}>\n        {xAxisLabel}: {round(tooltipElement.data.x, 5)}\n      </div>\n      {datapoints\n        .sort((a, b) => b.datapoint.y - a.datapoint.y)\n        .map(({ datapoint, label, backgroundColor }, i) => {\n          return (\n            <div key={i} style={{ padding: \"4px 0\", display: \"flex\", alignItems: \"center\" }}>\n              <div\n                style={{\n                  width: \"8px\",\n                  height: \"8px\",\n                  backgroundColor: backgroundColor || colors.GRAY,\n                  marginRight: \"2px\",\n                }}\n              />\n              <div>\n                {label}: {round(datapoint.y, 5)}\n              </div>\n            </div>\n          );\n        })}\n    </div>\n  );\n  return (\n    <Tooltip defaultShown placement=\"top\" contents={contents}>\n      <div\n        style={{\n          position: \"absolute\",\n          left: 0,\n          top: 0,\n          transform: `translate(${tooltipElement.view.x}px, ${tooltipElement.view.y}px)`,\n        }}\n      />\n    </Tooltip>\n  );\n};\n\n// NOTE: Keep this type (and its dependencies) in sync with the corresponding\n// Node Playground types in 'userUtils'.\nexport type PlotMessage = {\n  lines: Line[],\n  points?: Line[],\n  polygons?: Line[],\n  title?: string,\n  yAxisLabel?: string,\n  xAxisLabel?: string,\n  gridColor?: string,\n};\n\ntype MenuContentProps = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n};\nfunction MenuContent({ config, saveConfig }: MenuContentProps) {\n  const { pointRadiusOverride, minXVal, maxXVal, minYVal, maxYVal } = config;\n  return (\n    <>\n      <Item>\n        <Flex>\n          <Flex col style={{ maxWidth: 100, marginRight: 5 }}>\n            <PanelToolbarLabel>Min X</PanelToolbarLabel>\n            <PanelToolbarInput\n              style={isValidMinMaxVal(minXVal) ? {} : { color: colors.REDL1 }}\n              value={minXVal}\n              onChange={({ target }) => saveConfig({ minXVal: target.value })}\n              onClick={(e) => e.stopPropagation()}\n              placeholder=\"auto\"\n            />\n          </Flex>\n          <Flex col style={{ maxWidth: 100 }}>\n            <PanelToolbarLabel>Max X</PanelToolbarLabel>\n            <PanelToolbarInput\n              style={isValidMinMaxVal(maxXVal) ? {} : { color: colors.REDL1 }}\n              value={maxXVal}\n              onChange={({ target }) => saveConfig({ maxXVal: target.value })}\n              onClick={(e) => e.stopPropagation()}\n              placeholder=\"auto\"\n            />\n          </Flex>\n        </Flex>\n      </Item>\n      <Item>\n        <Flex>\n          <Flex col style={{ maxWidth: 100, marginRight: 5 }}>\n            <PanelToolbarLabel>Min Y</PanelToolbarLabel>\n            <PanelToolbarInput\n              style={isValidMinMaxVal(minYVal) ? {} : { color: colors.REDL1 }}\n              value={minYVal}\n              onChange={({ target }) => saveConfig({ minYVal: target.value })}\n              onClick={(e) => e.stopPropagation()}\n              placeholder=\"auto\"\n            />\n          </Flex>\n          <Flex col style={{ maxWidth: 100 }}>\n            <PanelToolbarLabel>Max Y</PanelToolbarLabel>\n            <PanelToolbarInput\n              style={isValidMinMaxVal(maxYVal) ? {} : { color: colors.REDL1 }}\n              value={maxYVal}\n              onChange={({ target }) => saveConfig({ maxYVal: target.value })}\n              onClick={(e) => e.stopPropagation()}\n              placeholder=\"auto\"\n            />\n          </Flex>\n        </Flex>\n      </Item>\n      <Item>\n        <PanelToolbarLabel>Point Radius Override</PanelToolbarLabel>\n        <PanelToolbarInput\n          value={pointRadiusOverride}\n          onChange={({ target }) => saveConfig({ pointRadiusOverride: target.value })}\n          onClick={(e) => e.stopPropagation()}\n          placeholder=\"auto\"\n        />\n      </Item>\n    </>\n  );\n}\n\nfunction TwoDimensionalPlot(props: Props) {\n  const { config, saveConfig } = props;\n  const { path, minXVal, maxXVal, minYVal, maxYVal, pointRadiusOverride } = config;\n  const [hasUserPannedOrZoomed, setHasUserPannedOrZoomed] = React.useState<boolean>(false);\n  const [hasVerticalExclusiveZoom, setHasVerticalExclusiveZoom] = React.useState<boolean>(false);\n  const [hasBothAxesZoom, setHasBothAxesZoom] = React.useState<boolean>(false);\n  const tooltip = React.useRef<?HTMLDivElement>(null);\n  const chartCallbacks = React.useRef<?ChartCallbacks>(null);\n\n  const [mousePosition, updateMousePosition] = React.useState<?{ x: number, y: number }>(null);\n\n  const maybeBobject: mixed = useLatestMessageDataItem(path.value, \"bobjects\")?.queriedData[0]?.value;\n  const message: ?PlotMessage = isBobject(maybeBobject) ? deepParse(maybeBobject) : cast<PlotMessage>(maybeBobject);\n  const { title, yAxisLabel, xAxisLabel, gridColor, lines = [], points = [], polygons = [] } = message || {};\n  const datasets = React.useMemo(\n    () =>\n      message\n        ? [\n            ...lines.map((line) => {\n              const l = { ...pick(line, keysToPick), showLine: true, fill: false };\n              if (pointRadiusOverride) {\n                l.pointRadius = pointRadiusOverride;\n              }\n\n              return l;\n            }),\n            ...points.map((point) => {\n              const pt = pick(point, keysToPick);\n              if (pointRadiusOverride) {\n                pt.pointRadius = pointRadiusOverride;\n              }\n              return pt;\n            }),\n            ...polygons.map((polygon) => ({\n              ...pick(polygon, keysToPick),\n              data: polygon.data[0] ? polygon.data.concat([polygon.data[0]]) : polygon.data,\n              fill: true,\n              pointRadius: 0,\n              showLine: true,\n              lineTension: 0,\n            })),\n          ].sort((a, b) => (b.order || 0) - (a.order || 0))\n        : [],\n    [lines, message, pointRadiusOverride, points, polygons]\n  );\n\n  const { allXs, allYs } = React.useMemo(\n    () => ({\n      allXs: flatten(datasets.map((dataset) => (dataset.data ? dataset.data.map(({ x }) => x) : []))),\n      allYs: flatten(datasets.map((dataset) => (dataset.data ? dataset.data.map(({ y }) => y) : []))),\n    }),\n    [datasets]\n  );\n\n  const getBufferedMinMax = React.useCallback((allVals: number[]) => {\n    const minVal = Math.min(...allVals);\n    const maxVal = Math.max(...allVals);\n    const diff = maxVal - minVal;\n    return {\n      min: !diff ? minVal - 1 : minVal - diff * 0.05,\n      max: !diff ? maxVal + 1 : maxVal + diff * 0.05,\n    };\n  }, []);\n\n  const options = React.useMemo(\n    () => ({\n      title: { display: !!title, text: title },\n      scales: {\n        yAxes: [\n          {\n            gridLines: { color: gridColor },\n            scaleLabel: { display: !!yAxisLabel, labelString: yAxisLabel },\n            ticks: hasUserPannedOrZoomed\n              ? {}\n              : {\n                  min: parseFloat(minYVal) ? parseFloat(minYVal) : getBufferedMinMax(allYs).min,\n                  max: parseFloat(maxYVal) ? parseFloat(maxYVal) : getBufferedMinMax(allYs).max,\n                },\n          },\n        ],\n        xAxes: [\n          {\n            gridLines: { color: gridColor },\n            scaleLabel: { display: !!xAxisLabel, labelString: xAxisLabel },\n            ticks: hasUserPannedOrZoomed\n              ? {}\n              : {\n                  min: parseFloat(minXVal) ? parseFloat(minXVal) : getBufferedMinMax(allXs).min,\n                  max: parseFloat(maxXVal) ? parseFloat(maxXVal) : getBufferedMinMax(allXs).max,\n                },\n          },\n        ],\n      },\n      color: colors.GRAY,\n      animation: { duration: 0 },\n      legend: { display: false },\n      pan: { enabled: true },\n      zoom: { enabled: true },\n      plugins: {},\n    }),\n    [\n      allXs,\n      allYs,\n      getBufferedMinMax,\n      gridColor,\n      hasUserPannedOrZoomed,\n      maxXVal,\n      maxYVal,\n      minXVal,\n      minYVal,\n      title,\n      xAxisLabel,\n      yAxisLabel,\n    ]\n  );\n\n  const menuContent = React.useMemo(() => <MenuContent config={config} saveConfig={saveConfig} />, [\n    config,\n    saveConfig,\n  ]);\n\n  const removeTooltip = React.useCallback(() => {\n    if (tooltip.current) {\n      ReactDOM.unmountComponentAtNode(tooltip.current);\n    }\n    if (tooltip.current && tooltip.current.parentNode) {\n      // Satisfy flow.\n      tooltip.current.parentNode.removeChild(tooltip.current);\n      tooltip.current = null;\n    }\n  }, []);\n\n  const scaleBounds = React.useRef<?$ReadOnlyArray<ScaleBounds>>();\n  const hoverBar = React.useRef<?HTMLElement>();\n\n  const onScaleBoundsUpdate = React.useCallback((scales) => {\n    scaleBounds.current = scales;\n    const firstYScale = scales.find(({ axes }) => axes === \"yAxes\");\n    if (firstYScale != null && hoverBar.current != null) {\n      const { current } = hoverBar;\n      const topPx = Math.min(firstYScale.minAlongAxis, firstYScale.maxAlongAxis);\n      const bottomPx = Math.max(firstYScale.minAlongAxis, firstYScale.maxAlongAxis);\n      current.style.top = `${topPx}px`;\n      current.style.height = `${bottomPx - topPx}px`;\n    }\n  }, [scaleBounds]);\n\n  const onMouseMove = React.useCallback(async (event: MouseEvent) => {\n    const canvas = chartCallbacks.current && chartCallbacks.current.canvasRef.current;\n    if (!canvas) {\n      removeTooltip();\n      return;\n    }\n    const canvasRect = canvas.getBoundingClientRect();\n    const isTargetingCanvas = event.target === canvas;\n    const xMousePosition = event.pageX - canvasRect.left;\n    const yMousePosition = event.pageY - canvasRect.top;\n\n    if (\n      event.pageX < canvasRect.left ||\n      event.pageX > canvasRect.right ||\n      event.pageY < canvasRect.top ||\n      event.pageY > canvasRect.bottom ||\n      !isTargetingCanvas\n    ) {\n      removeTooltip();\n      updateMousePosition(null);\n      return;\n    }\n\n    const newMousePosition = { x: xMousePosition, y: yMousePosition };\n    updateMousePosition(newMousePosition);\n\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    const tooltipElement = await chartCallbacks.current?.getElementAtXAxis(event);\n    if (!tooltipElement) {\n      removeTooltip();\n      return;\n    }\n    const tooltipDatapoints = [];\n    for (const { data: dataPoints, label, backgroundColor } of datasets) {\n      const datapoint = dataPoints.find((_datapoint) => _datapoint.x === tooltipElement.data.x);\n      if (datapoint) {\n        tooltipDatapoints.push({\n          datapoint,\n          label,\n          backgroundColor,\n        });\n      }\n    }\n    if (!tooltipDatapoints.length) {\n      removeTooltip();\n      return;\n    }\n\n    if (!tooltip.current) {\n      tooltip.current = document.createElement(\"div\");\n      if (canvas.parentNode) {\n        canvas.parentNode.appendChild(tooltip.current);\n      }\n    }\n\n    const currentTooltip = tooltip.current;\n    if (currentTooltip) {\n      ReactDOM.render(\n        <TwoDimensionalTooltip\n          tooltipElement={tooltipElement}\n          datapoints={tooltipDatapoints}\n          xAxisLabel={xAxisLabel}\n        />,\n        currentTooltip\n      );\n    }\n  }, [datasets, removeTooltip, xAxisLabel]);\n\n  const onResetZoom = React.useCallback(() => {\n    if (chartCallbacks.current) {\n      chartCallbacks.current.resetZoom();\n      setHasUserPannedOrZoomed(false);\n    }\n  }, [setHasUserPannedOrZoomed]);\n\n  const onPanZoom = React.useCallback(() => {\n    if (!hasUserPannedOrZoomed) {\n      setHasUserPannedOrZoomed(true);\n    }\n  }, [hasUserPannedOrZoomed]);\n  if (useDeepChangeDetector([pick(props.config, [\"minXVal\", \"maxXVal\", \"minYVal\", \"maxYVal\"])], false)) {\n    // Reset the view to the default when the default changes.\n    if (hasUserPannedOrZoomed) {\n      setHasUserPannedOrZoomed(false);\n    }\n  }\n\n  let zoomMode = \"x\";\n  if (hasVerticalExclusiveZoom) {\n    zoomMode = \"y\";\n  } else if (hasBothAxesZoom) {\n    zoomMode = \"xy\";\n  }\n\n  const keyDownHandlers = React.useMemo(\n    () => ({\n      v: () => setHasVerticalExclusiveZoom(true),\n      b: () => setHasBothAxesZoom(true),\n    }),\n    [setHasVerticalExclusiveZoom, setHasBothAxesZoom]\n  );\n\n  const keyUphandlers = React.useMemo(\n    () => ({\n      v: () => setHasVerticalExclusiveZoom(false),\n      b: () => setHasBothAxesZoom(false),\n    }),\n    [setHasVerticalExclusiveZoom, setHasBothAxesZoom]\n  );\n\n  // Always clean up tooltips when unmounting.\n  React.useEffect(() => removeTooltip, [removeTooltip]);\n  const emptyMessage = !points.length && !lines.length && !polygons.length;\n\n  if (uniq(datasets.map(({ label }) => label)).length !== datasets.length) {\n    throw new Error(\"2D Plot datasets do not have unique labels\");\n  }\n\n  const zoomOptions = useShallowMemo({ ...DEFAULT_PROPS.zoomOptions, mode: zoomMode });\n\n  const onChange = React.useCallback((newValue) => saveConfig({ path: { value: newValue } }), [saveConfig]);\n\n  const ChartComponent = useExperimentalFeature(\"useGLChartIn2dPlot\") ? GLChart : ReactChartjs;\n\n  return (\n    <SContainer>\n      <PanelToolbar helpContent={helpContent} menuContent={menuContent}>\n        <MessagePathInput\n          path={path.value}\n          onChange={onChange}\n          inputStyle={messagePathInputStyle}\n          validTypes={VALID_TYPES}\n          placeholder=\"Select topic messages with 2D Plot data to visualize\"\n          autoSize\n        />\n      </PanelToolbar>\n      {!message ? (\n        <EmptyState>Waiting for next message</EmptyState>\n      ) : emptyMessage ? (\n        <EmptyState>No 2D Plot data (lines, points, polygons) to visualize</EmptyState>\n      ) : (\n        <SRoot onDoubleClick={onResetZoom}>\n          <Dimensions>\n            {({ width, height }) => (\n              <>\n                <HoverBar mousePosition={mousePosition}>\n                  <SBar xAxisIsPlaybackTime ref={hoverBar} />\n                </HoverBar>\n                <ChartComponent\n                  type=\"scatter\"\n                  width={width}\n                  height={height}\n                  key={`${width}x${height}`}\n                  options={options}\n                  onPanZoom={onPanZoom}\n                  onScaleBoundsUpdate={onScaleBoundsUpdate}\n                  data={{ datasets }}\n                  zoomOptions={zoomOptions}\n                  panOptions={DEFAULT_PROPS.panOptions}\n                  callbacksRef={chartCallbacks}\n                />\n                {hasUserPannedOrZoomed && (\n                  <SResetZoom>\n                    <Button tooltip=\"(shortcut: double-click)\" onClick={onResetZoom}>\n                      reset view\n                    </Button>\n                  </SResetZoom>\n                )}\n              </>\n            )}\n          </Dimensions>\n          <DocumentEvents capture onMouseDown={onMouseMove} onMouseUp={onMouseMove} onMouseMove={onMouseMove} />\n          <KeyListener global keyDownHandlers={keyDownHandlers} keyUpHandlers={keyUphandlers} />\n        </SRoot>\n      )}\n    </SContainer>\n  );\n}\n\nTwoDimensionalPlot.panelType = \"TwoDimensionalPlot\";\nTwoDimensionalPlot.defaultConfig = { path: { value: \"\" } };\nTwoDimensionalPlot.shortcuts = [\n  { description: \"Reset\", keys: [\"double click\"] },\n  { description: \"Pan\", keys: [\"drag\"] },\n  { description: \"Zoom\", keys: [\"scroll horizontally\"] },\n  { description: \"Zoom vertically\", keys: [\"v\" + \"scroll\"] },\n  { description: \"Zoom both vertically and horizontally\", keys: [\"b\" + \"scroll\"] },\n  { description: \"Zoom to percentage (10% - 100%)\", keys: [\"\", \"1|2|...|9|0\"] },\n];\nexport default hot(Panel<Config>(TwoDimensionalPlot));\n","module.exports = \"# 2D Plot\\n\\nThe 2D Plot panel allows users to define within their ROS messages the points, lines, and polygons they would like to visualize on an x- and y-axis.\\n\\nThe panel's API currently allows users to specify the plot's title and axes labels (`title`, `xAxisLabel`, and `yAxisLabel`), and supports the visualization of 3 marker types: `points`, `lines`, and `polygons`. Any incoming message with these 3 keys pointing to an array of API-conforming marker objects can be displayed in the 2D Plot panel.\\n\\nEach marker type can be constructed using the following options:\\n\\n- `order` - z-index\\n- `label` - unique ID\\n- `backgroundColor`\\n- `borderColor`\\n- `borderDash` - length and spacing of dashes - see [MDN](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash)\\n- `borderWidth`\\n- `pointBackgroundColor`\\n- `pointBorderColor`\\n- `pointBorderWidth`\\n- `pointRadius`\\n- `pointStyle` - can be 'circle', 'cross', 'crossRot', 'dash', 'line', 'rect', 'rectRounded', 'rectRot', or 'star'\\n- `data` - an array of coordinate objects, e.g. `[{x: 0, y: 1}, {x: 2, y: 5}]`\\n\\nOnly `label` and `data` are required - all other options have reasonable default values. For more info on these options, reference the [chart.js documentation](https://www.chartjs.org/docs/latest/charts/line.html#dataset-properties).\\n\\nBelow are the ROS message definitions needed for a 2D Plot message:\\n\\n```cpp\\n# webviz_msgs/TwoDimensionalPlot definition\\nstd_msgs/Header header\\nstring title\\nstring xAxisLabel\\nstring yAxisLabel\\nstring gridColor\\nwebviz_msgs/TwoDimensionalPlotDatapoint[] lines\\nwebviz_msgs/TwoDimensionalPlotDatapoint[] points\\nwebviz_msgs/TwoDimensionalPlotDatapoint[] polygons\\n\\n# webviz_msgs/TwoDimensionalPlotDatapoint definition\\nuint8 order\\nstring label\\nstring backgroundColor\\nstring borderColor\\nuint8[] borderDash\\nuint8 borderWidth\\nstring pointBackgroundColor\\nstring pointBorderColor\\nstring pointBorderWidth\\nstring pointRadius\\n# pointStyle can be 'circle', 'cross', 'crossRot', 'dash', 'line', 'rect', 'rectRounded', 'rectRot', or 'star'\\nstring pointStyle\\nfloat32 lineTension\\n# z field in geometry_msgs/Point is ignored\\ngeometry_msgs/Point[] data\\n```\\n\\nBelow is an example of an output message (in JavaScript) that could be consumed by the 2D Plot panel:\\n\\n```js\\n{\\n  topic: \\\"/plot_a\\\",\\n  datatype: \\\"webviz_msgs/TwoDimensionalPlot\\\",\\n  receiveTime: { sec: 1532375120, nsec: 317760607 },\\n  message: {\\n    title: \\\"This is Plot A\\\",\\n    xAxisLabel: \\\"This is my X axis label\\\",\\n    yAxisLabel: \\\"This is my Y axis label\\\",\\n    lines: [\\n      // 1 solid red line\\n      { label: \\\"solid-line\\\", borderColor: \\\"red\\\", backgroundColor: \\\"red\\\", data: [{ x: 0, y: 0 }, { x: 5, y: 5 }] },\\n      // 1 dashed pink line\\n      {\\n        label: \\\"dashed-line\\\",\\n        borderDash: [5, 5],\\n        borderColor: \\\"pink\\\",\\n        backgroundColor: \\\"pink\\\",\\n        data: [{ x: 1, y: 0.5 }, { x: 5, y: 3.5 }],\\n      },\\n    ],\\n    points: [\\n      // 3 circular blue points\\n      {\\n        label: \\\"circle-point\\\",\\n        pointBackgroundColor: \\\"blue\\\",\\n        data: [{ x: 1.5, y: 2.5 }, { x: 3, y: 4 }, { x: 4, y: 3.5 }],\\n      },\\n      // 2 teal Xs\\n      {\\n        label: \\\"cross-point\\\",\\n        pointBackgroundColor: \\\"teal\\\",\\n        pointBorderColor: \\\"teal\\\",\\n        pointStyle: \\\"crossRot\\\",\\n        pointRadius: 10,\\n        data: [{ x: 2, y: 1 }, { x: 4, y: 1 }],\\n      },\\n    ],\\n    polygons: [\\n      // 1 light gray triangle\\n      {\\n        label: \\\"polygon\\\",\\n        borderColor: \\\"lightgray\\\",\\n        backgroundColor: \\\"lightgray\\\",\\n        data: [{ x: 3, y: 1 }, { x: 4, y: 2 }, { x: 4.5, y: 1.5 }],\\n      },\\n    ],\\n  },\\n}\\n```\\n\\n## User Interactions\\n\\nYou can zoom by scrolling, and pan by dragging. Double-click to reset.\\n\\nBy default, scrolling will zoom horizontally only. To zoom vertically, hold the `v` key while scrolling. To zoom both horizontally and vertically at the same time, hold the `b` key while scrolling.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport hoistNonReactStatics from \"hoist-non-react-statics\";\nimport { groupBy, uniq } from \"lodash\";\nimport * as React from \"react\";\n\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message, Topic } from \"webviz-core/src/players/types\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\n\nconst useFrame = (topics: string[]): {| cleared: boolean, frame: { [topic: string]: $ReadOnlyArray<Message> } |} => {\n  // NOTE(JP): This is a huge abuse of the `useMessageReducer` API. Never use `useMessageReducer`\n  // in this way yourself!! `restore` and `addMessage` should be pure functions and not have\n  // side effects!\n  const frame = React.useRef<{ [topic: string]: $ReadOnlyArray<Message> }>({});\n  const lastClearTime = PanelAPI.useMessageReducer({\n    topics,\n    restore: React.useCallback(() => {\n      frame.current = {};\n      return Date.now();\n    }, [frame]),\n    addBobjects: React.useCallback((time, messages: $ReadOnlyArray<Message>) => {\n      // $FlowFixMe: groupBy results include mutable arrays.\n      frame.current = groupBy(messages, \"topic\");\n      return time;\n    }, [frame]),\n  });\n\n  const cleared = useChangeDetector([lastClearTime], false);\n  return { cleared, frame: frame.current };\n};\n\n// This higher-order component provides compatibility between the old way of Panels receiving\n// messages, using \"frames\" and keeping state themselves, and the new `useMessageReducer` API which\n// manages state for you and allows in the future for more flexibility in accessing messages.\n//\n// TODO(JP): Remove FrameCompatibilityDEPRECATED from the last panel where it's still used: the 3d panel!\n// This is the \"Scenebuilder refactor\" project.\nexport function FrameCompatibilityDEPRECATED<Props>(ChildComponent: React.ComponentType<Props>, baseTopics: string[]) {\n  function FrameCompatibilityComponent(props: Props & { forwardedRef: any, topics: Topic[] }) {\n    const { forwardedRef, ...childProps } = props;\n    const [topics, setTopics] = React.useState<string[]>(baseTopics);\n    const componentSetSubscriptions = React.useCallback((newTopics: string[]) => {\n      setTopics(uniq(newTopics.concat(baseTopics || [])));\n    }, []);\n    const { frame, cleared } = useFrame(topics);\n    return (\n      <ChildComponent\n        {...childProps}\n        ref={forwardedRef}\n        frame={frame}\n        setSubscriptions={componentSetSubscriptions}\n        cleared={cleared}\n      />\n    );\n  }\n\n  return hoistNonReactStatics(\n    React.forwardRef((props, ref) => {\n      return <FrameCompatibilityComponent {...props} forwardedRef={ref} />;\n    }),\n    ChildComponent\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { groupBy, isEqual, cloneDeep } from \"lodash\";\nimport React, { type Node, useCallback, useContext, useEffect, useMemo, useReducer, useRef, useState } from \"react\";\nimport {\n  Worldview,\n  PolygonBuilder,\n  type CameraState,\n  type ReglClickInfo,\n  type MouseEventObject,\n  type Polygon,\n  CameraListener,\n  DEFAULT_CAMERA_STATE,\n  CameraStore,\n  Ray,\n} from \"regl-worldview\";\nimport { type Time } from \"rosbag\";\nimport { useDebouncedCallback } from \"use-debounce\";\n\nimport Dimensions from \"webviz-core/src/components/Dimensions\";\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Modal from \"webviz-core/src/components/Modal\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport { RenderToBodyPortal } from \"webviz-core/src/components/renderToBody\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport useDataSourceInfo from \"webviz-core/src/PanelAPI/useDataSourceInfo\";\nimport { type Save3DConfig, type ThreeDimensionalVizConfig } from \"webviz-core/src/panels/ThreeDimensionalViz\";\nimport DebugStatsOverlay from \"webviz-core/src/panels/ThreeDimensionalViz/DebugStats/Overlay\";\nimport { POLYGON_TAB_TYPE, type DrawingTabType } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools\";\nimport MeasuringTool, { type MeasureInfo } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool\";\nimport IconOverlay from \"webviz-core/src/panels/ThreeDimensionalViz/IconOverlay\";\nimport {\n  InteractionContextMenu,\n  OBJECT_TAB_TYPE,\n  type Interactive,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions\";\nimport useLinkedGlobalVariables from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport { LayoutWorkerDataSender } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout/WorkerDataRpc\";\nimport LayoutToolbar from \"webviz-core/src/panels/ThreeDimensionalViz/LayoutToolbar\";\nimport PanelToolbarMenu from \"webviz-core/src/panels/ThreeDimensionalViz/PanelToolbarMenu\";\nimport { SearchCameraHandler, useSearchText } from \"webviz-core/src/panels/ThreeDimensionalViz/SearchText\";\nimport { useStoryEventsContext } from \"webviz-core/src/panels/ThreeDimensionalViz/stories/waitFor3dPanelEvents\";\nimport {\n  type MarkerMatcher,\n  ThreeDimensionalVizContext,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/ThreeDimensionalVizContext\";\nimport {\n  type TargetPose,\n  getInteractionData,\n  getObject,\n  getUpdatedGlobalVariablesBySelectedObject,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport { ColorPickerSettingsPanel } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/ColorPickerForTopicSettings\";\nimport TopicSettingsModal from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicSettingsModal\";\nimport TopicTree from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicTree\";\nimport { TOPIC_DISPLAY_MODES } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/TopicViewModeSelector\";\nimport useTopicTree, { TopicTreeContext } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useTopicTree\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport { useStructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport type { Frame, Topic } from \"webviz-core/src/players/types\";\nimport type { Color, OverlayIconMarker } from \"webviz-core/src/types/Messages\";\nimport { getField } from \"webviz-core/src/util/binaryObjects\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\nimport { useShallowMemo, useDeepMemo, useGetCurrentValue } from \"webviz-core/src/util/hooks\";\nimport { inVideoRecordingMode } from \"webviz-core/src/util/inAutomatedRunMode\";\nimport Rpc from \"webviz-core/src/util/Rpc\";\nimport { setupMainThreadRpc } from \"webviz-core/src/util/RpcMainThreadUtils\";\nimport { getTopicsByTopicName } from \"webviz-core/src/util/selectors\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\nimport supportsOffscreenCanvas from \"webviz-core/src/util/supportsOffscreenCanvas\";\nimport { joinTopics } from \"webviz-core/src/util/topicUtils\";\n\nconst { getLayoutWorker, useWorldContextValue } = getGlobalHooks().perPanelHooks().ThreeDimensionalViz;\nconst VIDEO_RECORDING_STYLE = { visibility: inVideoRecordingMode() ? \"hidden\" : \"visible\" };\nconst DEFAULT_SELECTION_STATE = {\n  clickedObjects: [],\n  clickedPosition: { clientX: 0, clientY: 0 },\n  selectedObject: null,\n};\n\ntype EventName = \"onDoubleClick\" | \"onMouseMove\" | \"onMouseDown\" | \"onMouseUp\";\nexport type ClickedPosition = {| clientX: number, clientY: number |};\n\nexport type LayoutToolbarSharedProps = {|\n  cameraState: $Shape<CameraState>,\n  followOrientation: boolean,\n  followTf?: string | false,\n  onAlignXYAxis: () => void,\n  onCameraStateChange: (CameraState) => void,\n  onFollowChange: (followTf?: string | false, followOrientation?: boolean) => void,\n  saveConfig: Save3DConfig,\n  targetPose: ?TargetPose,\n  transforms: Transforms,\n  isPlaying?: boolean,\n|};\n\nexport type LayoutTopicSettingsSharedProps = {|\n  transforms: Transforms,\n  topics: Topic[],\n  saveConfig: Save3DConfig,\n|};\n\ntype Props = {|\n  ...LayoutToolbarSharedProps,\n  ...LayoutTopicSettingsSharedProps,\n  children?: Node,\n  cleared?: boolean,\n  currentTime: Time,\n  frame?: Frame,\n  isPlaying?: boolean,\n  config: ThreeDimensionalVizConfig,\n  saveConfig: Save3DConfig,\n  setSubscriptions: (subscriptions: string[]) => void,\n  topics: Topic[],\n  transforms: Transforms,\n|};\n\nexport type UserSelectionState = {\n  // These objects are shown in the context menu\n  clickedObjects: MouseEventObject[],\n  // The x,y position used to position the context menu\n  clickedPosition: ClickedPosition,\n  // The object shown in the Interactions menu; also used to update global variables\n  selectedObject: MouseEventObject | null,\n};\n\nexport type EditTopicState = { tooltipPosX: number, topic: Topic };\n\ntype GlobalVariableName = string;\nexport type ColorOverride = {\n  color: Color,\n  active: boolean,\n};\nexport type ColorOverrideBySourceIdxByVariable = {\n  [GlobalVariableName]: ColorOverride[],\n};\n\nexport default function Layout({\n  cameraState,\n  children,\n  cleared,\n  currentTime,\n  followOrientation,\n  followTf,\n  frame,\n  isPlaying,\n  onAlignXYAxis,\n  onCameraStateChange,\n  onFollowChange,\n  saveConfig,\n  topics,\n  targetPose,\n  transforms,\n  setSubscriptions,\n  config: {\n    autoTextBackgroundColor,\n    checkedKeys,\n    expandedKeys,\n    flattenMarkers,\n    modifiedNamespaceTopics,\n    pinTopics,\n    diffModeEnabled,\n    selectedPolygonEditFormat = \"yaml\",\n    showCrosshair,\n    autoSyncCameraState,\n    topicDisplayMode = TOPIC_DISPLAY_MODES.SHOW_ALL.value,\n    settingsByKey,\n    colorOverrideBySourceIdxByVariable,\n    disableAutoOpenClickedObject,\n    sphericalRangeScale,\n    searchText: savedSearchText,\n  },\n}: Props) {\n  const getSaveConfig = useGetCurrentValue(saveConfig);\n  const [filterText, setFilterText] = useState(\"\"); // Topic tree text for filtering to see certain topics.\n  const containerRef = useRef<?HTMLDivElement>();\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n  const [debug, setDebug] = useState(false);\n  const [showTopicTree, setShowTopicTree] = useState<boolean>(false);\n  const [polygonBuilder, setPolygonBuilder] = useState(() => new PolygonBuilder());\n  const [measureInfo, setMeasureInfo] = useState<MeasureInfo>({\n    measureState: \"idle\",\n    measurePoints: { start: undefined, end: undefined },\n  });\n  const [currentEditingTopic, setCurrentEditingTopic] = useState<?Topic>(undefined);\n  const [editingNamespace, setEditingNamespace] = useState<?{\n    namespaceKey: string,\n    namespaceColor: ?string,\n  }>();\n\n  const rootTf = useMemo(\n    () =>\n      frame &&\n      transforms.rootOfTransform(followTf || getGlobalHooks().perPanelHooks().ThreeDimensionalViz.rootTransformFrame)\n        .id,\n    [frame, transforms, followTf]\n  );\n\n  const [availableNamespacesByTopic, setAvailableNamespacesByTopic] = useState({});\n  const [sceneErrorsByTopicKey, setSceneErrorsByTopicKey] = useState({});\n\n  const updateWorkerAvailableNamespacesByTopic = useCallback((newAvailableNamespacesByTopic) => {\n    setAvailableNamespacesByTopic((oldAvailableNamespacesByTopic) =>\n      isEqual(oldAvailableNamespacesByTopic, newAvailableNamespacesByTopic)\n        ? oldAvailableNamespacesByTopic\n        : newAvailableNamespacesByTopic\n    );\n  }, [setAvailableNamespacesByTopic]);\n\n  const updateWorkerErrorsByTopic = useCallback((newErrorsByTopic) => {\n    setSceneErrorsByTopicKey((oldErrorsByTopic) =>\n      isEqual(oldErrorsByTopic, newErrorsByTopic) ? oldErrorsByTopic : newErrorsByTopic\n    );\n  }, [setSceneErrorsByTopicKey]);\n\n  const searchTextProps = useSearchText({\n    initialSearchText: savedSearchText,\n    onSearchTextChanged: (newSearchText) => {\n      getSaveConfig()({ searchText: newSearchText });\n    },\n  });\n  const {\n    searchTextOpen,\n    searchTextWithInlinedVariables,\n    setSearchTextMatches,\n    searchTextMatches,\n    selectedMatchIndex,\n  } = searchTextProps;\n\n  const searchCameraHandler = useMemo(() => new SearchCameraHandler(), []);\n  searchCameraHandler.focusOnSearch(\n    cameraState,\n    onCameraStateChange,\n    rootTf,\n    transforms,\n    searchTextOpen,\n    searchTextMatches[selectedMatchIndex]\n  );\n  const updateSearchTextMatches = useCallback((newSearchMatches) => {\n    // In order to avoid re-renders, we make sure the new search matches are\n    // different than the existing ones. Also, use the functional type state\n    // setter to avoid `updateSearchTextMatches` to change if the search\n    // matches change.\n    setSearchTextMatches((oldSearchMatches) =>\n      isEqual(oldSearchMatches, newSearchMatches) ? oldSearchMatches : newSearchMatches\n    );\n  }, [setSearchTextMatches]);\n\n  // used for updating DrawPolygon during mouse move and scenebuilder namespace change.\n  const [forcedUpdate, forceUpdate] = useReducer((x) => x + 1, 0);\n  const measuringElRef = useRef<?MeasuringTool>(null);\n  const [drawingTabType, setDrawingTabType] = useState<?DrawingTabType>(undefined);\n  const [interactionsTabType, setInteractionsTabType] = useState<?DrawingTabType>(undefined);\n\n  const [selectionState, setSelectionState] = useState<UserSelectionState>(DEFAULT_SELECTION_STATE);\n  const { selectedObject, clickedObjects, clickedPosition } = selectionState;\n\n  // Since the highlightedMarkerMatchers are updated by mouse events, we wait\n  // a short amount of time to prevent excessive re-rendering of the 3D panel\n  const [hoveredMarkerMatchers, setHoveredMarkerMatchers] = useState<MarkerMatcher[]>([]);\n  const [setHoveredMarkerMatchersDebounced] = useDebouncedCallback(setHoveredMarkerMatchers, 100);\n\n  const isDrawing = useMemo(() => measureInfo.measureState !== \"idle\" || drawingTabType === POLYGON_TAB_TYPE, [\n    drawingTabType,\n    measureInfo.measureState,\n  ]);\n\n  const structuralDatatypes = useStructuralDatatypes();\n  const supportedMarkerDatatypesSet = useMemo(\n    () =>\n      new Set(\n        Object.values(getGlobalHooks().perPanelHooks().ThreeDimensionalViz.SUPPORTED_MARKER_DATATYPES).concat(\n          Object.keys(structuralDatatypes)\n        )\n      ),\n    [structuralDatatypes]\n  );\n  const {\n    blacklistTopicsSet,\n    topicTreeConfig,\n    staticallyAvailableNamespacesByTopic,\n    defaultTopicSettings,\n    uncategorizedGroupName,\n  } = useMemo(\n    () => ({\n      blacklistTopicsSet: new Set(getGlobalHooks().perPanelHooks().ThreeDimensionalViz.BLACKLIST_TOPICS),\n      topicTreeConfig: getGlobalHooks()\n        .startupPerPanelHooks()\n        .ThreeDimensionalViz.getDefaultTopicTree(),\n      staticallyAvailableNamespacesByTopic: getGlobalHooks()\n        .startupPerPanelHooks()\n        .ThreeDimensionalViz.getStaticallyAvailableNamespacesByTopic(),\n      defaultTopicSettings: getGlobalHooks()\n        .startupPerPanelHooks()\n        .ThreeDimensionalViz.getDefaultSettings(),\n      uncategorizedGroupName: getGlobalHooks().perPanelHooks().ThreeDimensionalViz.ungroupedNodesCategory,\n    }),\n    []\n  );\n\n  const { playerId } = useDataSourceInfo();\n\n  // Use deep compare so that we only regenerate rootTreeNode when topics change.\n  const memoizedTopics = useShallowMemo(topics);\n  // Only show topics with supported datatype and that are not blacklisted as available in topic tree.\n  const topicTreeTopics = useMemo(\n    () =>\n      memoizedTopics.filter(\n        (topic) => supportedMarkerDatatypesSet.has(topic.datatype) && !blacklistTopicsSet.has(topic.name)\n      ),\n    [blacklistTopicsSet, memoizedTopics, supportedMarkerDatatypesSet]\n  );\n\n  const topicTreeData = useTopicTree({\n    availableNamespacesByTopic,\n    checkedKeys,\n    defaultTopicSettings,\n    expandedKeys,\n    filterText,\n    modifiedNamespaceTopics: modifiedNamespaceTopics || [],\n    providerTopics: topicTreeTopics,\n    saveConfig,\n    sceneErrorsByTopicKey,\n    topicDisplayMode,\n    settingsByKey,\n    topicTreeConfig,\n    uncategorizedGroupName,\n    staticallyAvailableNamespacesByTopic,\n  });\n  const {\n    allKeys,\n    derivedCustomSettingsByKey,\n    getIsNamespaceCheckedByDefault,\n    getIsTreeNodeVisibleInScene,\n    getIsTreeNodeVisibleInTree,\n    hasFeatureColumn,\n    onNamespaceOverrideColorChange,\n    rootTreeNode,\n    sceneErrorsByKey,\n    selectedNamespacesByTopic,\n    selectedTopicNames,\n    shouldExpandAllKeys,\n    visibleTopicsCountByKey,\n    toggleNamespaceChecked,\n  } = topicTreeData;\n\n  useEffect(() => setSubscriptions(selectedTopicNames), [selectedTopicNames, setSubscriptions]);\n\n  // If a user selects a marker or hovers over a TopicPicker row, highlight relevant markers\n  const highlightMarkerMatchers = useMemo(() => {\n    if (isDrawing) {\n      return [];\n    }\n    if (hoveredMarkerMatchers.length > 0) {\n      return hoveredMarkerMatchers;\n    }\n    // Highlight the selected object if the interactionsTab popout is open\n    if (selectedObject && !!interactionsTabType) {\n      const marker = getObject(selectedObject);\n      const topic = getInteractionData(selectedObject)?.topic;\n      return marker && topic\n        ? [\n            {\n              topic,\n              checks: [\n                {\n                  markerKeyPath: [\"id\"],\n                  value: getField(marker, \"id\"),\n                },\n                {\n                  markerKeyPath: [\"ns\"],\n                  value: getField(marker, \"ns\"),\n                },\n              ],\n            },\n          ]\n        : [];\n    }\n    return [];\n  }, [hoveredMarkerMatchers, interactionsTabType, isDrawing, selectedObject]);\n\n  const colorOverrideMarkerMatchers = useMemo(() => {\n    // Transform linkedGlobalVariables and overridesByGlobalVariable into markerMatchers for SceneBuilder\n    const linkedGlobalVariablesByName = groupBy(linkedGlobalVariables, ({ name }) => name);\n    return Object.keys(colorOverrideBySourceIdxByVariable || {}).reduce((_activeColorOverrideMatchers, name) => {\n      return (colorOverrideBySourceIdxByVariable?.[name] || []).flatMap((override, i) =>\n        override?.active\n          ? [\n              ..._activeColorOverrideMatchers,\n              ...(linkedGlobalVariablesByName[name] || []).map(({ topic, markerKeyPath }) => {\n                const baseTopic = topic.replace($WEBVIZ_SOURCE_2, \"\");\n                return {\n                  topic: i === 0 ? baseTopic : joinTopics($WEBVIZ_SOURCE_2, baseTopic),\n                  checks: [\n                    {\n                      markerKeyPath,\n                      value: globalVariables[name],\n                    },\n                  ],\n                  color: override.color,\n                };\n              }),\n            ]\n          : _activeColorOverrideMatchers\n      );\n    }, []);\n  }, [colorOverrideBySourceIdxByVariable, globalVariables, linkedGlobalVariables]);\n\n  // Toggle scene builder topics based on visible topic nodes in the tree\n  const selectedTopics = useMemo(() => {\n    const topicsByTopicName = getTopicsByTopicName(topics);\n    return filterMap(selectedTopicNames, (name) => topicsByTopicName[name]);\n  }, [topics, selectedTopicNames]);\n\n  const handleDrawPolygons = useCallback((eventName: EventName, ev: MouseEvent, args: ?ReglClickInfo) => {\n    polygonBuilder[eventName](ev, args);\n    forceUpdate();\n  }, [polygonBuilder]);\n\n  // use callbackInputsRef to prevent unnecessary callback changes\n  const callbackInputsRef = useRef({\n    cameraState,\n    debug,\n    drawingTabType,\n    handleDrawPolygons,\n    showTopicTree,\n    saveConfig,\n    selectionState,\n    topics,\n    autoSyncCameraState: !!autoSyncCameraState,\n    isDrawing,\n  });\n  callbackInputsRef.current = {\n    cameraState,\n    debug,\n    drawingTabType,\n    handleDrawPolygons,\n    showTopicTree,\n    saveConfig,\n    selectionState,\n    topics,\n    autoSyncCameraState: !!autoSyncCameraState,\n    isDrawing,\n  };\n  const setColorOverrideBySourceIdxByVariable = useCallback((_colorOverrideBySourceIdxByVariable) => {\n    callbackInputsRef.current.saveConfig({ colorOverrideBySourceIdxByVariable: _colorOverrideBySourceIdxByVariable });\n  }, []);\n\n  const handleEvent = useCallback((eventName: EventName, ev: MouseEvent, args: ?ReglClickInfo) => {\n    if (!args) {\n      return;\n    }\n    const {\n      drawingTabType: currentDrawingTabType,\n      handleDrawPolygons: currentHandleDrawPolygons,\n    } = callbackInputsRef.current;\n    // $FlowFixMe get around index signature error\n    const measuringHandler = measuringElRef.current && measuringElRef.current[eventName];\n    const measureActive = measuringElRef.current && measuringElRef.current.measureActive;\n    if (measuringHandler && measureActive) {\n      return measuringHandler(ev, args);\n    } else if (currentDrawingTabType === POLYGON_TAB_TYPE) {\n      currentHandleDrawPolygons(eventName, ev, args);\n    }\n  }, []);\n\n  const updateGlobalVariablesFromSelection = useCallback((newSelectedObject: MouseEventObject) => {\n    if (newSelectedObject) {\n      const newGlobalVariables = getUpdatedGlobalVariablesBySelectedObject(newSelectedObject, linkedGlobalVariables);\n      if (newGlobalVariables) {\n        setGlobalVariables(newGlobalVariables);\n      }\n    }\n  }, [linkedGlobalVariables, setGlobalVariables]);\n\n  // Auto open/close the tab when the selectedObject changes as long as\n  // we aren't drawing or the disableAutoOpenClickedObject setting is enabled.\n  const updateInteractionsTabVisibility = useCallback((newSelectedObject: ?MouseEventObject) => {\n    if (!isDrawing) {\n      const shouldBeOpen = newSelectedObject && !disableAutoOpenClickedObject;\n      setInteractionsTabType(shouldBeOpen ? OBJECT_TAB_TYPE : null);\n    }\n  }, [disableAutoOpenClickedObject, isDrawing]);\n\n  const selectObject = useCallback((newSelectedObject: ?MouseEventObject) => {\n    setSelectionState({ ...callbackInputsRef.current.selectionState, selectedObject: newSelectedObject });\n    updateInteractionsTabVisibility(newSelectedObject);\n    updateGlobalVariablesFromSelection(newSelectedObject);\n  }, [updateInteractionsTabVisibility, updateGlobalVariablesFromSelection]);\n\n  const storyEvents = useStoryEventsContext();\n\n  const {\n    onClick,\n    onIconClick,\n    onControlsOverlayClick,\n    onDoubleClick,\n    onExitTopicTreeFocus,\n    onMouseDown,\n    onMouseMove,\n    onMouseUp,\n    onSetPolygons,\n    toggleCameraMode,\n    toggleDebug,\n  } = useMemo(() => {\n    return {\n      onClick: (ev: MouseEvent, args: ?ReglClickInfo) => {\n        if (storyEvents) {\n          storyEvents.selection.resolve();\n        }\n        // Don't set any clicked objects when measuring distance or drawing polygons.\n        if (callbackInputsRef.current.isDrawing) {\n          return;\n        }\n        const newClickedObjects = (args && args.objects) || [];\n        const newClickedPosition = { clientX: ev.clientX, clientY: ev.clientY };\n        const newSelectedObject = newClickedObjects.length === 1 ? newClickedObjects[0] : null;\n\n        // Select the object directly if there is only one or open up context menu if there are many.\n        setSelectionState({\n          ...callbackInputsRef.current.selectionState,\n          clickedObjects: newClickedObjects,\n          clickedPosition: newClickedPosition,\n        });\n        selectObject(newSelectedObject);\n      },\n      onIconClick: (iconMarker: Interactive<OverlayIconMarker>, newClickedPosition: ClickedPosition) => {\n        if (callbackInputsRef.current.isDrawing) {\n          return;\n        }\n        const object = { object: iconMarker, instanceIndex: undefined };\n        if (selectedObject && object.object.id != null && object.object.id === selectedObject.object.id) {\n          // Unselect the object when clicked the same object.\n          setSelectionState(DEFAULT_SELECTION_STATE);\n          return;\n        }\n        setSelectionState({\n          selectedObject: object,\n          clickedObjects: [object],\n          clickedPosition: newClickedPosition,\n        });\n        selectObject(object);\n      },\n      onControlsOverlayClick: (ev: SyntheticMouseEvent<HTMLDivElement>) => {\n        if (!containerRef.current) {\n          return;\n        }\n        const target = ((ev.target: any): HTMLElement);\n        // Only close if the click target is inside the panel, e.g. don't close when dropdown menus rendered in portals are clicked\n        if (containerRef.current.contains(target)) {\n          setShowTopicTree(false);\n        }\n      },\n      onDoubleClick: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onDoubleClick\", ev, args),\n      onExitTopicTreeFocus: () => {\n        if (containerRef.current) {\n          containerRef.current.focus();\n        }\n      },\n      onMouseDown: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onMouseDown\", ev, args),\n      onMouseMove: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onMouseMove\", ev, args),\n      onMouseUp: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onMouseUp\", ev, args),\n      onSetPolygons: (polygons: Polygon[]) => setPolygonBuilder(new PolygonBuilder(polygons)),\n      toggleDebug: () => setDebug(!callbackInputsRef.current.debug),\n      toggleCameraMode: () => {\n        const { cameraState: currentCameraState, saveConfig: currentSaveConfig } = callbackInputsRef.current;\n        const newPerspective = !currentCameraState.perspective;\n        currentSaveConfig({ cameraState: { ...currentCameraState, perspective: newPerspective } });\n        if (measuringElRef.current && currentCameraState.perspective) {\n          measuringElRef.current.reset();\n        }\n        // Automatically enable/disable map height based on 3D/2D mode\n        const mapHeightEnabled = (selectedNamespacesByTopic[\"/metadata\"] || []).includes(\"height\");\n        if (mapHeightEnabled !== newPerspective) {\n          toggleNamespaceChecked({\n            topicName: \"/metadata\",\n            namespace: \"height\",\n            columnIndex: 0,\n          });\n        }\n      },\n    };\n  }, [handleEvent, selectObject, selectedNamespacesByTopic, selectedObject, toggleNamespaceChecked, storyEvents]);\n\n  // When the TopicTree is hidden, focus the <World> again so keyboard controls continue to work\n  const worldRef = useRef<?typeof Worldview>(null);\n  useEffect(() => {\n    if (!showTopicTree && worldRef.current) {\n      worldRef.current.focus();\n    }\n  }, [showTopicTree]);\n\n  const keyDownHandlers = useMemo(() => {\n    const handlers: { [key: string]: (e: KeyboardEvent) => void } = {\n      \"3\": () => {\n        toggleCameraMode();\n      },\n      Escape: (e) => {\n        e.preventDefault();\n        setShowTopicTree(false);\n        setDrawingTabType(null);\n        searchTextProps.toggleSearchTextOpen(false);\n        if (document.activeElement && document.activeElement === containerRef.current) {\n          document.activeElement.blur();\n        }\n      },\n      t: (e) => {\n        e.preventDefault();\n        // Unpin before enabling keyboard toggle open/close.\n        if (pinTopics) {\n          saveConfig({ pinTopics: false });\n          return;\n        }\n        setShowTopicTree((shown) => !shown);\n      },\n      f: (e: KeyboardEvent) => {\n        if (e.ctrlKey || e.metaKey) {\n          e.preventDefault();\n          searchTextProps.toggleSearchTextOpen(true);\n          if (!searchTextProps.searchInputRef || !searchTextProps.searchInputRef.current) {\n            return;\n          }\n          searchTextProps.searchInputRef.current.select();\n        }\n      },\n    };\n    return handlers;\n  }, [pinTopics, saveConfig, searchTextProps, toggleCameraMode]);\n\n  const cursorType = isDrawing ? \"crosshair\" : \"\";\n  const { isHovered } = useContext(PanelContext) || {};\n  const isDemoMode = useExperimentalFeature(\"demoMode\");\n  const isHidden = isDemoMode && !isHovered;\n  const DemoModeComponent = getGlobalHooks().getDemoModeComponent();\n\n  // Memoize the threeDimensionalVizContextValue to avoid returning a new object every time\n  const threeDimensionalVizContextValue = useMemo(\n    () => ({\n      setColorOverrideBySourceIdxByVariable,\n      setHoveredMarkerMatchers: setHoveredMarkerMatchersDebounced,\n      colorOverrideBySourceIdxByVariable: colorOverrideBySourceIdxByVariable || {},\n    }),\n    [colorOverrideBySourceIdxByVariable, setColorOverrideBySourceIdxByVariable, setHoveredMarkerMatchersDebounced]\n  );\n\n  // TODO(steel/hernan): Keep context updated in 3D panel worker.\n  const worldContextValue = useWorldContextValue();\n  const stillMounted = useRef<boolean>(true); // To avoid late async updates.\n  useEffect(\n    () => () => {\n      stillMounted.current = false;\n    },\n    []\n  );\n\n  const frameIndexRef = useRef(0);\n  frameIndexRef.current += 1;\n  const resumeFrames = useRef(new Map<number, () => void>());\n  const rpc = useMemo(() => {\n    const ret = new Rpc(getLayoutWorker());\n    setupMainThreadRpc(ret);\n    ret.receive(\"onAvailableNsAndErrors\", async (props) => {\n      if (stillMounted.current) {\n        const { availableNamespacesByTopic: newAvailableNamespacesByTopic, errorsByTopic } = props;\n        updateWorkerAvailableNamespacesByTopic(newAvailableNamespacesByTopic);\n        updateWorkerErrorsByTopic(errorsByTopic);\n      }\n    });\n    ret.receive(\"finishFrame\", ({ frameIndex, frameIsEmpty, searchTextMatches: newSearchMatches }) => {\n      if (stillMounted.current) {\n        updateSearchTextMatches(newSearchMatches);\n        if (!frameIsEmpty && storyEvents) {\n          storyEvents.render.resolve();\n        }\n      }\n      const resumeFrame = resumeFrames.current.get(frameIndex);\n      if (resumeFrame) {\n        resumeFrame();\n        resumeFrames.current.delete(frameIndex);\n      }\n    });\n    return ret;\n  }, [storyEvents, updateSearchTextMatches, updateWorkerAvailableNamespacesByTopic, updateWorkerErrorsByTopic]);\n  // TODO (useWorkerIn3DPanel): Move worker releated objects and functions to a different file to reduce the complexity of this one.\n  const workerDataSender = useMemo(() => new LayoutWorkerDataSender(rpc), [rpc]);\n\n  const canvasRef = useRef();\n  const [initialized, setInitialized] = useState(false);\n\n  const [viewport, setViewport] = useState({ width: 0, height: 0 });\n  const updateViewport = useCallback((newViewport) => {\n    setViewport((oldViewport) => (isEqual(oldViewport, newViewport) ? oldViewport : newViewport));\n  }, [setViewport]);\n\n  const { pauseFrame } = useMessagePipeline(\n    useCallback((messagePipeline) => ({ pauseFrame: messagePipeline.pauseFrame }), [])\n  );\n\n  // Continues to return the same `polygons` instance as long as it's not changed by PolygonBuilder.\n  // PolygonBuilder mutates the `polygons` array whenever a new polygons is created.\n  // It also mutates the `points` array of the active polygon when adding new points.\n  // We use deep clone here to keep the polygons instance stable, so we can detect changes\n  // and send it across the worker boundary only when needed.\n  const polygons = useDeepMemo(cloneDeep(polygonBuilder.polygons));\n  useMemo(async () => {\n    const frameIndex = frameIndexRef.current;\n    if (canvasRef.current && initialized) {\n      // This process is async, so we must use message pipeline to pause/resume playback\n      if (!frame || !rootTf) {\n        return;\n      }\n\n      const resumeFrame = pauseFrame(\"3DPanel/Layout\");\n      resumeFrames.current.set(frameIndex, resumeFrame);\n      const { width, height } = viewport;\n      const frameSent = await workerDataSender.renderFrame({\n        cleared,\n        transformElements: transforms.rawTransforms,\n        frame,\n        frameIndex,\n        playerId,\n        rootTf,\n        flattenMarkers: !!flattenMarkers,\n        selectedNamespacesByTopic,\n        settingsByKey,\n        selectedTopics,\n        globalVariables,\n        linkedGlobalVariables,\n        highlightMarkerMatchers,\n        colorOverrideMarkerMatchers,\n        currentTime,\n        width,\n        height,\n        autoTextBackgroundColor: !!autoTextBackgroundColor,\n        cameraState,\n        isPlaying: !!isPlaying,\n        isDemoMode,\n        diffModeEnabled: hasFeatureColumn && diffModeEnabled,\n        searchTextOpen,\n        searchText: searchTextWithInlinedVariables,\n        selectedMatchIndex,\n        showCrosshair,\n        polygons,\n        forcedUpdate,\n        measurePoints: measureInfo.measurePoints,\n        structuralDatatypes,\n        worldContextValue,\n        debug,\n        sphericalRangeScale:\n          sphericalRangeScale ||\n          getGlobalHooks().perPanelHooks().ThreeDimensionalViz.sceneBuilderHooks.sphericalRangeScale,\n      });\n      if (!frameSent) {\n        // Frame was overridden by one coming later.\n        resumeFrame();\n        resumeFrames.current.delete(frameIndex);\n      }\n    }\n  }, [\n    initialized,\n    frame,\n    rootTf,\n    pauseFrame,\n    viewport,\n    workerDataSender,\n    cleared,\n    transforms.rawTransforms,\n    playerId,\n    flattenMarkers,\n    selectedNamespacesByTopic,\n    settingsByKey,\n    selectedTopics,\n    globalVariables,\n    linkedGlobalVariables,\n    highlightMarkerMatchers,\n    colorOverrideMarkerMatchers,\n    currentTime,\n    autoTextBackgroundColor,\n    cameraState,\n    isPlaying,\n    isDemoMode,\n    hasFeatureColumn,\n    diffModeEnabled,\n    searchTextOpen,\n    searchTextWithInlinedVariables,\n    selectedMatchIndex,\n    showCrosshair,\n    polygons,\n    forcedUpdate,\n    measureInfo.measurePoints,\n    structuralDatatypes,\n    worldContextValue,\n    debug,\n    sphericalRangeScale,\n  ]);\n\n  const setCanvasRef = useCallback((canvas) => {\n    if (canvas && !initialized) {\n      // $FlowFixMe: flow does not recognize `transferControlToOffscreen`\n      const transferableCanvas = supportsOffscreenCanvas() ? canvas.transferControlToOffscreen() : canvas;\n      rpc\n        .send<void>(\"initialize\", { canvas: transferableCanvas }, [transferableCanvas])\n        .then(() => {\n          if (stillMounted.current) {\n            setInitialized(true);\n            if (storyEvents) {\n              storyEvents.ready.resolve();\n            }\n          }\n        })\n        .catch((error) => {\n          sendNotification(\"Error initializing 3D Panel\", error, \"app\", \"error\");\n        });\n    } else {\n      // TODO: handle unmount with `canvas === undefined`\n    }\n    canvasRef.current = canvas;\n  }, [initialized, rpc, storyEvents]);\n\n  const mouseEventHandlers = useShallowMemo({\n    onMouseDown,\n    onMouseMove,\n    onMouseUp,\n    onClick,\n    onDoubleClick,\n  });\n\n  const sendMouseEvent = useCallback((e, mouseEventName) => {\n    if (!initialized) {\n      return;\n    }\n\n    if (!(e.target instanceof window.HTMLElement) || e.button !== 0) {\n      return;\n    }\n\n    const { top: clientTop, left: clientLeft } = e.target.getBoundingClientRect();\n    const { clientX, clientY, button, ctrlKey } = e;\n    rpc\n      .send<void>(\"onMouseEvent\", {\n        e: { button, clientX, clientY, clientTop, clientLeft, ctrlKey },\n        mouseEventName,\n      })\n      .then((props: any) => {\n        if (!props) {\n          return;\n        }\n        const { eventName, ev, args } = props;\n        if (args.ray) {\n          const {\n            ray: { dir, origin, point },\n          } = args;\n          // The `ray` member returned in the mause event response is a POJO, but event handlers\n          // need an actual Ray instance (i.e. polygon drawing requires a Ray to compute\n          // plane intersections).\n          args.ray = new Ray(origin, dir, point);\n        }\n        // `ev` is not an actual mouse event when returned from the worker\n        // so we need to decorate it with empty functions in order to prevent\n        // crashes later.\n        ev.preventDefault = () => {};\n        ev.stopPropagation = () => {};\n\n        // There's a chance the received response corresponds to a different event than the\n        // one that was originally sent (see comments in mouse event handlers in LayoutWorker.js).\n        mouseEventHandlers[eventName](ev, args);\n        if (eventName === \"onClick\") {\n          // Worker will send an \"onClick\" event if the mouse didn't move but in that\n          // case we will never get the \"onMouseUp\" one because of how promisses are handled.\n          // Therefore, we need to send the \"onMouseUp\" event manually.\n          mouseEventHandlers.onMouseUp(ev, args);\n        }\n      });\n  }, [initialized, mouseEventHandlers, rpc]);\n\n  const findTopicInTopicTree = React.useCallback((topicName) => {\n    setFilterText(topicName);\n    setShowTopicTree(true);\n  }, [setFilterText]);\n\n  const sendMouseUp = useCallback((e) => sendMouseEvent(e, \"onMouseUp\"), [sendMouseEvent]);\n  const sendMouseDown = useCallback((e) => sendMouseEvent(e, \"onMouseDown\"), [sendMouseEvent]);\n  const sendMouseMove = useCallback((e) => sendMouseEvent(e, \"onMouseMove\"), [sendMouseEvent]);\n  const sendDoubleClick = useCallback((e) => sendMouseEvent(e, \"onDoubleClick\"), [sendMouseEvent]);\n\n  const cameraListener = useRef();\n  const cameraStore = useMemo(() => {\n    return new CameraStore((newCameraState) => {\n      if (onCameraStateChange) {\n        onCameraStateChange(newCameraState);\n      }\n    }, cameraState || DEFAULT_CAMERA_STATE);\n  }, [cameraState, onCameraStateChange]);\n\n  return (\n    <ThreeDimensionalVizContext.Provider value={threeDimensionalVizContextValue}>\n      <TopicTreeContext.Provider value={topicTreeData}>\n        <div\n          ref={containerRef}\n          onClick={onControlsOverlayClick}\n          tabIndex={-1}\n          className={styles.container}\n          style={{ cursor: cursorType }}\n          data-test=\"3dviz-layout\">\n          <KeyListener keyDownHandlers={keyDownHandlers} />\n          <PanelToolbarMenu\n            autoTextBackgroundColor={!!autoTextBackgroundColor}\n            checkedKeys={checkedKeys}\n            flattenMarkers={!!flattenMarkers}\n            saveConfig={saveConfig}\n            settingsByKey={settingsByKey}\n          />\n          <div style={{ position: \"absolute\", width: \"100%\", height: \"100%\" }}>\n            {isDemoMode && DemoModeComponent && <DemoModeComponent />}\n            <div style={{ ...VIDEO_RECORDING_STYLE, position: \"relative\", width: \"100%\", height: \"100%\" }}>\n              {(!isDemoMode || (isDemoMode && isHovered)) && (\n                <Dimensions>\n                  {({ width: containerWidth, height: containerHeight }) => (\n                    <TopicTree\n                      allKeys={allKeys}\n                      availableNamespacesByTopic={availableNamespacesByTopic}\n                      checkedKeys={checkedKeys}\n                      containerHeight={containerHeight}\n                      containerWidth={containerWidth}\n                      derivedCustomSettingsByKey={derivedCustomSettingsByKey}\n                      expandedKeys={expandedKeys}\n                      filterText={filterText}\n                      getIsNamespaceCheckedByDefault={getIsNamespaceCheckedByDefault}\n                      getIsTreeNodeVisibleInScene={getIsTreeNodeVisibleInScene}\n                      getIsTreeNodeVisibleInTree={getIsTreeNodeVisibleInTree}\n                      hasFeatureColumn={hasFeatureColumn}\n                      isPlaying={isPlaying}\n                      onExitTopicTreeFocus={onExitTopicTreeFocus}\n                      onNamespaceOverrideColorChange={onNamespaceOverrideColorChange}\n                      pinTopics={pinTopics}\n                      diffModeEnabled={diffModeEnabled}\n                      rootTreeNode={rootTreeNode}\n                      saveConfig={saveConfig}\n                      sceneErrorsByKey={sceneErrorsByKey}\n                      setCurrentEditingTopic={setCurrentEditingTopic}\n                      setEditingNamespace={setEditingNamespace}\n                      setFilterText={setFilterText}\n                      setShowTopicTree={setShowTopicTree}\n                      shouldExpandAllKeys={shouldExpandAllKeys}\n                      showTopicTree={showTopicTree}\n                      structuralDatatypes={structuralDatatypes}\n                      topicDisplayMode={topicDisplayMode}\n                      visibleTopicsCountByKey={visibleTopicsCountByKey}\n                    />\n                  )}\n                </Dimensions>\n              )}\n              {currentEditingTopic && (\n                <TopicSettingsModal\n                  currentEditingTopic={currentEditingTopic}\n                  hasFeatureColumn={hasFeatureColumn}\n                  setCurrentEditingTopic={setCurrentEditingTopic}\n                  saveConfig={saveConfig}\n                  settingsByKey={settingsByKey}\n                  structuralDatatypes={structuralDatatypes}\n                />\n              )}\n              {editingNamespace && (\n                <RenderToBodyPortal>\n                  <Modal\n                    onRequestClose={() => setEditingNamespace(undefined)}\n                    contentStyle={{\n                      maxHeight: \"calc(100vh - 200px)\",\n                      maxWidth: 480,\n                      display: \"flex\",\n                      flexDirection: \"column\",\n                    }}>\n                    <ColorPickerSettingsPanel\n                      color={settingsByKey[editingNamespace.namespaceKey]?.overrideColor}\n                      onChange={(newColor) => onNamespaceOverrideColorChange(newColor, editingNamespace.namespaceKey)}\n                    />\n                  </Modal>\n                </RenderToBodyPortal>\n              )}\n            </div>\n          </div>\n          <div className={styles.world}>\n            <Dimensions>\n              {({ width, height }) => (\n                <Flex col style={{ position: \"relative\" }}>\n                  <>\n                    {updateViewport({ width, height })}\n                    <CameraListener cameraStore={cameraStore} shiftKeys={true} ref={cameraListener}>\n                      <canvas\n                        id=\"sceneViewerCanvas\"\n                        ref={setCanvasRef}\n                        style={{ width, height, maxWidth: \"100%\", maxHeight: \"100%\" }}\n                        width={width}\n                        height={height}\n                        onMouseUp={sendMouseUp}\n                        onMouseDown={sendMouseDown}\n                        onDoubleClick={sendDoubleClick}\n                        onMouseMove={sendMouseMove}\n                      />\n                    </CameraListener>\n                    {children}\n                    <IconOverlay\n                      onIconClick={onIconClick}\n                      rpc={rpc}\n                      cameraDistance={cameraState.distance || DEFAULT_CAMERA_STATE.distance}\n                    />\n                    <div style={VIDEO_RECORDING_STYLE}>\n                      <LayoutToolbar\n                        cameraState={cameraState}\n                        interactionsTabType={interactionsTabType}\n                        setInteractionsTabType={setInteractionsTabType}\n                        debug={debug}\n                        followOrientation={followOrientation}\n                        followTf={followTf}\n                        isPlaying={isPlaying}\n                        measureInfo={measureInfo}\n                        measuringElRef={measuringElRef}\n                        onAlignXYAxis={onAlignXYAxis}\n                        onCameraStateChange={onCameraStateChange}\n                        autoSyncCameraState={!!autoSyncCameraState}\n                        onFollowChange={onFollowChange}\n                        onSetDrawingTabType={setDrawingTabType}\n                        onSetPolygons={onSetPolygons}\n                        onToggleCameraMode={toggleCameraMode}\n                        onToggleDebug={toggleDebug}\n                        polygonBuilder={polygonBuilder}\n                        saveConfig={saveConfig}\n                        selectedObject={selectedObject}\n                        selectedPolygonEditFormat={selectedPolygonEditFormat}\n                        setMeasureInfo={setMeasureInfo}\n                        showCrosshair={showCrosshair}\n                        targetPose={targetPose}\n                        transforms={transforms}\n                        isHidden={isHidden}\n                        findTopicInTopicTree={findTopicInTopicTree}\n                        {...searchTextProps}\n                      />\n                    </div>\n                    {clickedObjects.length > 1 && !selectedObject && (\n                      <InteractionContextMenu\n                        clickedPosition={clickedPosition}\n                        clickedObjects={clickedObjects}\n                        selectObject={selectObject}\n                      />\n                    )}\n                    <DebugStatsOverlay debug={debug} rpc={rpc} />\n                  </>\n                </Flex>\n              )}\n            </Dimensions>\n          </div>\n        </div>\n      </TopicTreeContext.Provider>\n    </ThreeDimensionalVizContext.Provider>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport React from \"react\";\n\nimport { type DebugStats } from \"./types\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\nimport Rpc from \"webviz-core/src/util/Rpc\";\n\ntype Props = {\n  debug: boolean,\n  rpc: Rpc,\n};\n\nconst style = {\n  position: \"absolute\",\n  bottom: 5,\n  right: 5,\n  backgroundColor: \"rgba(1, 1, 1, 0.2)\",\n  padding: 5,\n  fontFamily: \"monospace\",\n};\n\n// Looks at the regl stats and throws errors if it seems we're going over acceptable (arbitrary) max ranges.\n// The maxes are arbitrarily set to be an order of magnitude higher than the 'steady state' of a pretty loaded webviz scene to\n// allow for plenty of headroom.\nfunction validate(stats) {\n  if (stats.bufferCount > 500) {\n    throw new Error(`Possible gl buffer leak detected. Buffer count: ${stats.bufferCount}`);\n  }\n  if (stats.elementsCount > 500) {\n    throw new Error(`Possible gl elements leak detected. Buffer count: ${stats.elementsCount}`);\n  }\n  if (stats.textureCount > 500) {\n    throw new Error(`Possible gl texture leak detected. Texture count: ${stats.textureCount}`);\n  }\n  // We should likely have far fewer than 100 shaders...they only get created when regl \"compiles\" a command.\n  // Nevertheless, we should check in case there's some wild code somewhere constantly recompiling a command.\n  if (stats.shaderCount > 100) {\n    throw new Error(`Possible gl shader leak detected. Shader count: ${stats.shaderCount}`);\n  }\n}\n\ntype RenderProps = {|\n  debugStats: DebugStats,\n|};\n\n// Shows debug regl stats in the 3d panel.  Crashes the panel if regl stats drift outside of acceptable ranges.\n// TODO(bmc): move to regl-worldview at some point\nfunction Renderer(props: RenderProps) {\n  const { debugStats } = props;\n  if (debugStats) {\n    validate(debugStats);\n    const {\n      renderCount,\n      bufferCount,\n      textureCount,\n      elementsCount,\n      shaderCount,\n      totalTextureSize,\n      totalBufferSize,\n    } = debugStats;\n    const textureSize = (totalTextureSize / (1024 * 1024)).toFixed(1);\n    const bufferSize = (totalBufferSize / (1024 * 1024)).toFixed(1);\n\n    return (\n      <div style={style}>\n        <div>renders: {renderCount}</div>\n        <div>\n          buffers: {bufferCount} ({bufferSize}) Mb\n        </div>\n        <div>\n          textures: {textureCount} ({textureSize}) Mb\n        </div>\n        <div>elements: {elementsCount}</div>\n        <div>shaders: {shaderCount}</div>\n      </div>\n    );\n  }\n  return null;\n}\nconst MemoizedRenderer = React.memo<RenderProps>(Renderer);\n\nfunction Overlay(props: Props) {\n  const { rpc, debug } = props;\n\n  const [debugStats, setDebugStats] = React.useState();\n\n  const updateDebugStats = React.useCallback((newStats: DebugStats) => {\n    setDebugStats((oldStats) => (isEqual(oldStats, newStats) ? oldStats : newStats));\n  }, [setDebugStats]);\n\n  if (useChangeDetector([rpc], true)) {\n    rpc.receive(\"updateDebugStats\", updateDebugStats);\n  }\n\n  if (process.env.NODE_ENV === \"production\" || inScreenshotTests() || !debug || !debugStats) {\n    return null;\n  }\n\n  return <MemoizedRenderer debugStats={debugStats} />;\n}\n\nexport default React.memo<Props>(Overlay);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { PolygonBuilder, Polygon } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport { polygonPointsValidator } from \"webviz-core/shared/validators\";\nimport Button from \"webviz-core/src/components/Button\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport ValidatedInput, { type EditFormat } from \"webviz-core/src/components/ValidatedInput\";\nimport { SValue, SLabel } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions\";\nimport {\n  polygonsToPoints,\n  getFormattedString,\n  pointsToPolygons,\n  getPolygonLineDistances,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/utils/drawToolUtils\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\n\nexport type Point2D = {| x: number, y: number |};\n\nexport const SRow = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 8px 0;\n`;\n\ntype Props = {\n  onSetPolygons: (polygons: Polygon[]) => void,\n  polygonBuilder: PolygonBuilder,\n  selectedPolygonEditFormat: EditFormat,\n};\n\nexport default function Polygons({ onSetPolygons, polygonBuilder, selectedPolygonEditFormat }: Props) {\n  const { saveConfig } = React.useContext(PanelContext) || {};\n  const [polygonPoints, setPolygonPoints] = React.useState<Point2D[][]>(() =>\n    polygonsToPoints(polygonBuilder.polygons)\n  );\n\n  polygonBuilder.onChange = () => setPolygonPoints(polygonsToPoints(polygonBuilder.polygons));\n\n  const onChangePolygonPoints = React.useCallback((newPolygonPoints) => {\n    if (newPolygonPoints) {\n      setPolygonPoints(newPolygonPoints);\n      onSetPolygons(pointsToPolygons(newPolygonPoints));\n    }\n  }, [onSetPolygons]);\n\n  const clearPolygons = React.useCallback(() => onChangePolygonPoints([]), [onChangePolygonPoints]);\n\n  const copyPolygons = React.useCallback(() => {\n    clipboard.copy(getFormattedString(polygonPoints, selectedPolygonEditFormat));\n  }, [polygonPoints, selectedPolygonEditFormat]);\n\n  return (\n    <>\n      <ValidatedInput\n        format={selectedPolygonEditFormat}\n        value={polygonPoints}\n        onSelectFormat={(selectedFormat) => saveConfig({ selectedPolygonEditFormat: selectedFormat })}\n        onChange={onChangePolygonPoints}\n        dataValidator={polygonPointsValidator}>\n        <Button small tooltip=\"Clear Polygons\" onClick={clearPolygons}>\n          Clear\n        </Button>\n        <Button small tooltip=\"Copy Polygons\" onClick={copyPolygons}>\n          Copy\n        </Button>\n      </ValidatedInput>\n      <SRow>\n        <SLabel>Total length:</SLabel>\n        <SValue>{getPolygonLineDistances(polygonPoints).toFixed(2)} m</SValue>\n      </SRow>\n      <p style={{ marginTop: 0 }}>\n        <em>\n          Start drawing by holding <b>ctrl</b> and clicking on the 3D panel.\n        </em>\n      </p>\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { Polygon, PolygonPoint } from \"regl-worldview\";\n\nimport { EDIT_FORMAT, type EditFormat } from \"webviz-core/src/components/ValidatedInput\";\nimport { type Point2D } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools\";\nimport YAML from \"webviz-core/src/util/yaml\";\n\nexport function polygonsToPoints(polygons: Polygon[]): Point2D[][] {\n  return polygons.map((poly) => {\n    return poly.points.map((point) => ({ x: point.point[0], y: point.point[1] }));\n  });\n}\n\nexport function pointsToPolygons(polygonPoints: Point2D[][]): Polygon[] {\n  // map the points back to polygons\n  return polygonPoints.map((pointsPerPolygon, idx) => {\n    const polygon = new Polygon(`${idx}`);\n    polygon.points = pointsPerPolygon.map(({ x, y }) => new PolygonPoint([x, y, 0]));\n    return polygon;\n  });\n}\n\nfunction pointsToYaml(polygonPoints: Point2D[][]): string {\n  if (!polygonPoints.length || !polygonPoints[0].length) {\n    return \"\";\n  }\n  return YAML.stringify(polygonPoints);\n}\n\nfunction pointsToJson(polygonPoints: Point2D[][]): string {\n  return JSON.stringify(polygonPoints, null, 2);\n}\n\nexport function getFormattedString(polygonPoints: Point2D[][], selectedPolygonEditFormat: EditFormat) {\n  return selectedPolygonEditFormat === EDIT_FORMAT.JSON ? pointsToJson(polygonPoints) : pointsToYaml(polygonPoints);\n}\n\n// calculate the sum of the line distances\nexport function getPolygonLineDistances(polygonPoints: Point2D[][]): number {\n  return polygonPoints.reduce((memo, polyPoints) => {\n    if (polyPoints.length > 1) {\n      for (let i = 0; i < polyPoints.length - 1; i++) {\n        memo += Math.hypot(polyPoints[i + 1].x - polyPoints[i].x, polyPoints[i + 1].y - polyPoints[i].y);\n      }\n    }\n    return memo;\n  }, 0);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport cx from \"classnames\";\nimport React, { useMemo } from \"react\";\nimport { PolygonBuilder, type MouseEventObject, type Polygon } from \"regl-worldview\";\n\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport CameraInfo from \"webviz-core/src/panels/ThreeDimensionalViz/CameraInfo\";\nimport DrawingTools, { type DrawingTabType } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools\";\nimport MeasuringTool, { type MeasureInfo } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool\";\nimport FollowTFControl from \"webviz-core/src/panels/ThreeDimensionalViz/FollowTFControl\";\nimport Interactions from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions\";\nimport type { TabType } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions\";\nimport { type LayoutToolbarSharedProps } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport MainToolbar from \"webviz-core/src/panels/ThreeDimensionalViz/MainToolbar\";\nimport SearchText, { type SearchTextProps } from \"webviz-core/src/panels/ThreeDimensionalViz/SearchText\";\n\ntype Props = {|\n  ...LayoutToolbarSharedProps,\n  autoSyncCameraState: boolean,\n  debug: boolean,\n  interactionsTabType: ?TabType,\n  measureInfo: MeasureInfo,\n  measuringElRef: { current: ?MeasuringTool },\n  onSetDrawingTabType: (?DrawingTabType) => void,\n  onSetPolygons: (polygons: Polygon[]) => void,\n  onToggleCameraMode: () => void,\n  onToggleDebug: () => void,\n  polygonBuilder: PolygonBuilder,\n  selectedObject: ?MouseEventObject,\n  selectedPolygonEditFormat: \"json\" | \"yaml\",\n  setInteractionsTabType: (?TabType) => void,\n  setMeasureInfo: (MeasureInfo) => void,\n  showCrosshair: ?boolean,\n  isHidden: boolean,\n  findTopicInTopicTree: (string) => void,\n  ...SearchTextProps,\n|};\n\nfunction LayoutToolbar({\n  autoSyncCameraState,\n  cameraState,\n  debug,\n  followOrientation,\n  followTf,\n  interactionsTabType,\n  isPlaying,\n  measureInfo,\n  measuringElRef,\n  onAlignXYAxis,\n  onCameraStateChange,\n  onFollowChange,\n  onSetDrawingTabType,\n  onSetPolygons,\n  onToggleCameraMode,\n  onToggleDebug,\n  polygonBuilder,\n  saveConfig,\n  searchInputRef,\n  searchText,\n  searchTextMatches,\n  searchTextOpen,\n  searchTextWithInlinedVariables,\n  selectedMatchIndex,\n  selectedObject,\n  selectedPolygonEditFormat,\n  findTopicInTopicTree,\n  setInteractionsTabType,\n  setMeasureInfo,\n  setSearchText,\n  setSearchTextMatches,\n  setSelectedMatchIndex,\n  showCrosshair,\n  isHidden,\n  targetPose,\n  toggleSearchTextOpen,\n  transforms,\n}: Props) {\n  const additionalToolbarItemsElem = useMemo(() => {\n    const AdditionalToolbarItems = getGlobalHooks().perPanelHooks().ThreeDimensionalViz.AdditionalToolbarItems;\n    return (\n      <div className={cx(styles.buttons, styles.cartographer)}>\n        <AdditionalToolbarItems transforms={transforms} />\n      </div>\n    );\n  }, [transforms]);\n\n  return isHidden ? null : (\n    <>\n      <MeasuringTool\n        ref={measuringElRef}\n        measureState={measureInfo.measureState}\n        measurePoints={measureInfo.measurePoints}\n        onMeasureInfoChange={setMeasureInfo}\n      />\n      <div className={cx(styles.toolbar, styles.right)}>\n        <div className={styles.buttons}>\n          <SearchText\n            searchTextOpen={searchTextOpen}\n            toggleSearchTextOpen={toggleSearchTextOpen}\n            searchTextWithInlinedVariables={searchTextWithInlinedVariables}\n            searchText={searchText}\n            setSearchText={setSearchText}\n            setSearchTextMatches={setSearchTextMatches}\n            searchTextMatches={searchTextMatches}\n            searchInputRef={searchInputRef}\n            setSelectedMatchIndex={setSelectedMatchIndex}\n            selectedMatchIndex={selectedMatchIndex}\n          />\n        </div>\n        <div className={styles.buttons}>\n          <FollowTFControl\n            transforms={transforms}\n            tfToFollow={followTf ? followTf : undefined}\n            followOrientation={followOrientation}\n            onFollowChange={onFollowChange}\n          />\n        </div>\n        <MainToolbar\n          measureInfo={measureInfo}\n          measuringTool={measuringElRef.current}\n          perspective={cameraState.perspective}\n          debug={debug}\n          onToggleCameraMode={onToggleCameraMode}\n          onToggleDebug={onToggleDebug}\n        />\n        {measuringElRef.current && measuringElRef.current.measureDistance}\n        <Interactions\n          findTopicInTopicTree={findTopicInTopicTree}\n          selectedObject={selectedObject}\n          interactionsTabType={interactionsTabType}\n          setInteractionsTabType={setInteractionsTabType}\n        />\n        <DrawingTools\n          onSetPolygons={onSetPolygons}\n          polygonBuilder={polygonBuilder}\n          saveConfig={saveConfig}\n          selectedPolygonEditFormat={selectedPolygonEditFormat}\n          onSetDrawingTabType={onSetDrawingTabType}\n        />\n        <CameraInfo\n          cameraState={cameraState}\n          targetPose={targetPose}\n          followOrientation={followOrientation}\n          followTf={followTf}\n          isPlaying={isPlaying}\n          onAlignXYAxis={onAlignXYAxis}\n          onCameraStateChange={onCameraStateChange}\n          showCrosshair={!!showCrosshair}\n          autoSyncCameraState={autoSyncCameraState}\n        />\n        {additionalToolbarItemsElem}\n      </div>\n    </>\n  );\n}\n\nexport default React.memo<Props>(LayoutToolbar);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CameraControlIcon from \"@mdi/svg/svg/camera-control.svg\";\nimport { vec3 } from \"gl-matrix\";\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport { type CameraState, cameraStateSelectors } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport { point2DValidator, cameraStateValidator } from \"webviz-core/shared/validators\";\nimport Button from \"webviz-core/src/components/Button\";\nimport ExpandingToolbar, { ToolGroup } from \"webviz-core/src/components/ExpandingToolbar\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { UncontrolledValidatedInput, YamlInput } from \"webviz-core/src/components/ValidatedInput\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport { Renderer, type ThreeDimensionalVizConfig } from \"webviz-core/src/panels/ThreeDimensionalViz\";\nimport { SValue, SLabel } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport {\n  getNewCameraStateOnFollowChange,\n  type TargetPose,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\n\nexport const CAMERA_TAB_TYPE = \"Camera\";\n\nconst LABEL_WIDTH = 112;\nconst TEMP_VEC3 = [0, 0, 0];\nconst ZERO_VEC3 = Object.freeze([0, 0, 0]);\nconst DEFAULT_CAMERA_INFO_WIDTH = 260;\n\nconst SRow = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\ntype CameraStateInfoProps = {\n  cameraState: $Shape<CameraState>,\n  onAlignXYAxis: () => void,\n};\n\nexport type CameraInfoPropsWithoutCameraState = {\n  followOrientation: boolean,\n  followTf?: string | false,\n  isPlaying?: boolean,\n  onAlignXYAxis: () => void,\n  onCameraStateChange: (CameraState) => void,\n  showCrosshair?: boolean,\n  autoSyncCameraState: boolean,\n  defaultSelectedTab?: string,\n};\n\ntype CameraInfoProps = {\n  cameraState: $Shape<CameraState>,\n  targetPose: ?TargetPose,\n} & CameraInfoPropsWithoutCameraState;\n\nfunction CameraStateInfo({ cameraState, onAlignXYAxis }: CameraStateInfoProps) {\n  return (\n    <>\n      {Object.keys(cameraState)\n        .sort()\n        .map((key) => {\n          let val = cameraState[key];\n          if (key === \"perspective\") {\n            val = cameraState[key] ? \"true\" : \"false\";\n          } else if (Array.isArray(cameraState[key])) {\n            val = cameraState[key].map((x) => x.toFixed(1)).join(\", \");\n          } else if (typeof cameraState[key] === \"number\") {\n            val = cameraState[key].toFixed(2);\n          }\n          return [key, val];\n        })\n        .map(([key, val]) => (\n          <SRow key={key}>\n            <SLabel width={LABEL_WIDTH}>{key}:</SLabel> <SValue>{val}</SValue>\n            {key === \"thetaOffset\" && (\n              <Button\n                onClick={onAlignXYAxis}\n                tooltip=\"Align XY axis by resetting thetaOffset to 0. Will no longer follow orientation.\">\n                RESET\n              </Button>\n            )}\n          </SRow>\n        ))}\n    </>\n  );\n}\n\nexport default function CameraInfo({\n  cameraState,\n  targetPose,\n  followOrientation,\n  followTf,\n  isPlaying,\n  onAlignXYAxis,\n  onCameraStateChange,\n  showCrosshair,\n  autoSyncCameraState,\n  defaultSelectedTab,\n}: CameraInfoProps) {\n  const [selectedTab, setSelectedTab] = React.useState(defaultSelectedTab);\n  const { updatePanelConfig, saveConfig } = React.useContext(PanelContext) || {};\n  const [edit, setEdit] = React.useState<boolean>(false);\n  const onEditToggle = React.useCallback(() => setEdit((currVal) => !currVal), []);\n\n  const { target, targetOffset } = cameraState;\n  const targetHeading = cameraStateSelectors.targetHeading(cameraState);\n  const camPos2D = vec3.add(TEMP_VEC3, target, vec3.rotateZ(TEMP_VEC3, targetOffset, ZERO_VEC3, -targetHeading));\n  const camPos2DTrimmed = camPos2D.map((num) => +num.toFixed(2));\n\n  const syncCameraState = () => {\n    updatePanelConfig(Renderer.panelType, (config: ThreeDimensionalVizConfig) => {\n      // Transform the camera state by whichever TF or orientation the other panels are following.\n      const newCameraState = getNewCameraStateOnFollowChange({\n        prevCameraState: cameraState,\n        prevTargetPose: targetPose,\n        prevFollowTf: followTf,\n        prevFollowOrientation: followOrientation,\n        newFollowTf: config.followTf,\n        newFollowOrientation: config.followOrientation,\n      });\n      return { ...config, cameraState: newCameraState };\n    });\n  };\n\n  return (\n    <ExpandingToolbar\n      tooltip=\"Camera\"\n      icon={\n        <Icon style={{ color: autoSyncCameraState ? colors.accent : \"white\" }}>\n          <CameraControlIcon />\n        </Icon>\n      }\n      className={styles.buttons}\n      selectedTab={selectedTab}\n      onSelectTab={(newSelectedTab) => setSelectedTab(newSelectedTab)}>\n      <ToolGroup name={CAMERA_TAB_TYPE}>\n        <Flex col style={{ minWidth: DEFAULT_CAMERA_INFO_WIDTH }}>\n          <Flex row reverse>\n            <Button\n              tooltip=\"Copy cameraState\"\n              small\n              onClick={() => {\n                clipboard.copy(JSON.stringify(cameraState, null, 2));\n              }}>\n              Copy\n            </Button>\n            <Button\n              disabled={!!isPlaying}\n              tooltip={isPlaying ? \"Pause player to edit raw camera state object\" : \"Edit raw camera state object\"}\n              onClick={onEditToggle}>\n              {edit ? \"Done\" : \"Edit\"}\n            </Button>\n            <Button tooltip=\"Sync camera state across all 3D panels\" onClick={syncCameraState}>\n              Sync\n            </Button>\n          </Flex>\n          {edit && !isPlaying ? (\n            <UncontrolledValidatedInput\n              format=\"yaml\"\n              value={cameraState}\n              onChange={(newCameraState) => saveConfig({ cameraState: newCameraState })}\n              dataValidator={cameraStateValidator}\n            />\n          ) : (\n            <Flex col>\n              <CameraStateInfo cameraState={cameraState} onAlignXYAxis={onAlignXYAxis} />\n              <Flex col>\n                <SRow style={{ marginBottom: 8 }}>\n                  <Tooltip placement=\"top\" contents=\"Automatically sync camera across all 3D panels\">\n                    <SLabel>Auto sync:</SLabel>\n                  </Tooltip>\n                  <SValue>\n                    <input\n                      type=\"checkbox\"\n                      checked={autoSyncCameraState}\n                      onChange={() =>\n                        updatePanelConfig(Renderer.panelType, (config) => ({\n                          ...config,\n                          cameraState,\n                          autoSyncCameraState: !autoSyncCameraState,\n                        }))\n                      }\n                    />\n                  </SValue>\n                </SRow>\n                <SRow style={{ marginBottom: 8 }}>\n                  <SLabel style={cameraState.perspective ? { color: colors.textMuted } : {}}>Show crosshair:</SLabel>\n                  <SValue>\n                    <input\n                      type=\"checkbox\"\n                      disabled={cameraState.perspective}\n                      checked={showCrosshair}\n                      onChange={() => saveConfig({ showCrosshair: !showCrosshair })}\n                    />\n                  </SValue>\n                </SRow>\n                {showCrosshair && !cameraState.perspective && (\n                  <SRow style={{ paddingLeft: LABEL_WIDTH, marginBottom: 8 }}>\n                    <SValue>\n                      <YamlInput\n                        inputStyle={{ width: 140 }}\n                        value={{ x: camPos2DTrimmed[0], y: camPos2DTrimmed[1] }}\n                        onChange={(data) => {\n                          const newPos = [data.x, data.y, 0];\n                          // extract the targetOffset by subtracting from the target and un-rotating by heading\n                          const newTargetOffset = vec3.rotateZ(\n                            [0, 0, 0],\n                            vec3.sub(TEMP_VEC3, newPos, cameraState.target),\n                            ZERO_VEC3,\n                            cameraStateSelectors.targetHeading(cameraState)\n                          );\n                          if (!isEqual(cameraState.targetOffset, newTargetOffset)) {\n                            onCameraStateChange({ ...cameraState, targetOffset: newTargetOffset });\n                          }\n                        }}\n                        dataValidator={point2DValidator}\n                      />\n                    </SValue>\n                  </SRow>\n                )}\n              </Flex>\n              {followTf ? (\n                <SRow>\n                  <SLabel>Following frame:</SLabel>\n                  <SValue>\n                    <code>{followTf}</code>\n                    {followOrientation && \" with orientation\"}\n                  </SValue>\n                </SRow>\n              ) : (\n                <p>Locked to map ({getGlobalHooks().perPanelHooks().ThreeDimensionalViz.rootTransformFrame})</p>\n              )}\n            </Flex>\n          )}\n        </Flex>\n      </ToolGroup>\n    </ExpandingToolbar>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CrosshairsGpsIcon from \"@mdi/svg/svg/crosshairs-gps.svg\";\nimport MenuDownIcon from \"@mdi/svg/svg/menu-down.svg\";\nimport MenuLeftIcon from \"@mdi/svg/svg/menu-left.svg\";\nimport CompassOutlineIcon from \"@mdi/svg/svg/navigation.svg\";\nimport { sortBy, debounce } from \"lodash\";\nimport React, { memo, createRef, useCallback, useState } from \"react\";\nimport shallowequal from \"shallowequal\";\nimport styled from \"styled-components\";\n\nimport { type Transform } from \"./Transforms\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport { objectValues } from \"webviz-core/src/util\";\n\ntype TfTreeNode = {\n  tf: Transform,\n  children: TfTreeNode[],\n  depth: number,\n};\n\ntype TfTree = {\n  roots: TfTreeNode[],\n  nodes: { [string]: TfTreeNode },\n};\n\nconst treeNodeToTfId = (node) => node.tf.id;\n\nconst buildTfTree = (transforms: Transform[]): TfTree => {\n  const tree: TfTree = {\n    roots: [],\n    nodes: {},\n  };\n  // Create treeNodes for all tfs.\n  for (const tf of transforms) {\n    if (tree.nodes[tf.id]) {\n      continue;\n    }\n    tree.nodes[tf.id] = {\n      tf,\n      children: [],\n      depth: 0,\n    };\n  }\n\n  // Now add children to their parents treenode.\n  for (const tf of transforms) {\n    if (tf.parent) {\n      const parentTreeNode = tree.nodes[tf.parent.id];\n      parentTreeNode.children.push(tree.nodes[tf.id]);\n    } else {\n      tree.roots.push(tree.nodes[tf.id]);\n    }\n  }\n\n  // Do a final pass sorting all the children lists.\n  for (const node of objectValues(tree.nodes)) {\n    node.children = sortBy(node.children, treeNodeToTfId);\n  }\n  tree.roots = sortBy(tree.roots, treeNodeToTfId);\n\n  // Calculate depths\n  const setDepth = (node: TfTreeNode, depth: number) => {\n    node.depth = depth;\n    node.children.forEach((child) => setDepth(child, depth + 1));\n  };\n  tree.roots.forEach((root) => setDepth(root, 0));\n\n  return tree;\n};\n\ntype Props = {\n  transforms: any,\n  tfToFollow?: string,\n  followOrientation?: boolean,\n  onFollowChange: (tfId?: string | false, followOrientation?: boolean) => void,\n};\n\nfunction* getDescendants(nodes: TfTreeNode[]) {\n  for (const node of nodes) {\n    yield node;\n    yield* getDescendants(node.children);\n  }\n}\n\nfunction getItemText(node: TfTreeNode | { tf: { id: string }, depth: number }) {\n  return \"\".padEnd(node.depth * 4) + node.tf.id;\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  align-items: center;\n  position: relative;\n`;\n\nconst defaultFollowTfFrame = getGlobalHooks().perPanelHooks().ThreeDimensionalViz.defaultFollowTransformFrame;\n\nconst arePropsEqual = (prevProps, nextProps) => {\n  if (!nextProps.tfToFollow) {\n    const tfTree = buildTfTree(nextProps.transforms.values());\n    const allNodes = Array.from(getDescendants(tfTree.roots));\n    const nodesWithoutDefaultFollowTfFrame = allNodes && allNodes.length && !defaultFollowTfFrame;\n    if (nodesWithoutDefaultFollowTfFrame) {\n      return false;\n    }\n  }\n  return shallowequal(prevProps, nextProps);\n};\n\nconst FollowTFControl = memo<Props>((props: Props) => {\n  const { transforms, tfToFollow, followOrientation, onFollowChange } = props;\n  const [forceShowFrameList, setForceShowFrameList] = useState(false);\n  const [hovering, setHovering] = useState(false);\n  const [lastSelectedFrame, setLastSelectedFrame] = useState(undefined);\n\n  const tfTree = buildTfTree(transforms.values());\n  const allNodes = Array.from(getDescendants(tfTree.roots));\n  const nodesWithoutDefaultFollowTfFrame = allNodes && allNodes.length && !defaultFollowTfFrame;\n  const newFollowTfFrame = allNodes && allNodes[0] && allNodes[0].tf && allNodes[0].tf.id;\n\n  const autocomplete = createRef<Autocomplete>();\n\n  const getDefaultFollowTransformFrame = useCallback(() => {\n    return nodesWithoutDefaultFollowTfFrame ? newFollowTfFrame : defaultFollowTfFrame;\n  }, [nodesWithoutDefaultFollowTfFrame, newFollowTfFrame]);\n\n  const getFollowButtonTooltip = useCallback(() => {\n    if (!tfToFollow) {\n      if (lastSelectedFrame) {\n        return `Follow ${lastSelectedFrame}`;\n      }\n      return `Follow ${getDefaultFollowTransformFrame()}`;\n    } else if (!followOrientation) {\n      return \"Follow Orientation\";\n    }\n    return \"Unfollow\";\n  }, [tfToFollow, followOrientation, lastSelectedFrame, getDefaultFollowTransformFrame]);\n\n  const onClickFollowButton = useCallback(() => {\n    if (!tfToFollow) {\n      if (lastSelectedFrame) {\n        return onFollowChange(lastSelectedFrame);\n      }\n      return onFollowChange(getDefaultFollowTransformFrame());\n    } else if (!followOrientation) {\n      return onFollowChange(tfToFollow, true);\n    }\n    return onFollowChange(false);\n  }, [tfToFollow, lastSelectedFrame, onFollowChange, getDefaultFollowTransformFrame, followOrientation]);\n\n  const onSelectFrame = useCallback((id: string, item: mixed, autocompleteNode: Autocomplete) => {\n    setLastSelectedFrame(id === getDefaultFollowTransformFrame() ? undefined : id);\n    onFollowChange(id, followOrientation);\n    autocompleteNode.blur();\n  }, [setLastSelectedFrame, getDefaultFollowTransformFrame, onFollowChange, followOrientation]);\n\n  const openFrameList = useCallback((event: SyntheticEvent<Element>) => {\n    event.preventDefault();\n    setForceShowFrameList(true);\n    if (autocomplete.current) {\n      autocomplete.current.focus();\n    }\n  }, [setForceShowFrameList, autocomplete]);\n\n  // slight delay to prevent the arrow from disappearing when you're trying to click it\n  const onMouseLeaveDebounced = useCallback(\n    debounce(() => {\n      setHovering(false);\n    }, 200),\n    [setHovering]\n  );\n\n  const onMouseEnter = useCallback(() => {\n    onMouseLeaveDebounced.cancel();\n    setHovering(true);\n  }, [onMouseLeaveDebounced, setHovering]);\n\n  const followingCustomFrame = tfToFollow && tfToFollow !== getDefaultFollowTransformFrame();\n  const showFrameList = lastSelectedFrame != null || forceShowFrameList || followingCustomFrame;\n  const selectedFrameId = tfToFollow || lastSelectedFrame;\n  const selectedItem = selectedFrameId ? { tf: { id: selectedFrameId }, depth: 0 } : undefined;\n\n  return (\n    <Container\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeaveDebounced}\n      style={{ color: tfToFollow ? undefined : colors.textMuted }}>\n      {showFrameList && (\n        <Autocomplete\n          ref={autocomplete}\n          items={allNodes}\n          getItemValue={treeNodeToTfId}\n          getItemText={getItemText}\n          selectedItem={selectedItem}\n          placeholder={selectedItem ? getItemText(selectedItem) : \"choose a target frame\"}\n          onSelect={onSelectFrame}\n          sortWhenFiltering={false}\n          minWidth={0}\n          clearOnFocus\n          autoSize\n          menuStyle={{\n            // bump the menu down to reduce likelihood of it appearing while the mouse is\n            // already over it, which causes onMouseEnter not to be delivered correctly and\n            // breaks selection\n            marginTop: 4,\n          }}\n          onBlur={() => {\n            setForceShowFrameList(false);\n            setHovering(false);\n          }}\n        />\n      )}\n      {showFrameList ? (\n        <Icon onClick={openFrameList}>\n          <MenuDownIcon />\n        </Icon>\n      ) : hovering ? (\n        <Icon\n          tooltip={\"Select Another Frame\\u2026\"}\n          onClick={openFrameList}\n          tooltipProps={{ placement: \"top\" }}\n          style={{ color: \"white\" }}>\n          <MenuLeftIcon />\n        </Icon>\n      ) : null}\n      <Button tooltipProps={{ placement: \"top\" }} onClick={onClickFollowButton} tooltip={getFollowButtonTooltip()}>\n        <Icon style={{ color: tfToFollow ? colors.accent : \"white\" }}>\n          {followOrientation ? <CompassOutlineIcon /> : <CrosshairsGpsIcon />}\n        </Icon>\n      </Button>\n    </Container>\n  );\n}, arePropsEqual);\nexport default FollowTFControl;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport BugIcon from \"@mdi/svg/svg/bug.svg\";\nimport RulerIcon from \"@mdi/svg/svg/ruler.svg\";\nimport Video3dIcon from \"@mdi/svg/svg/video-3d.svg\";\nimport * as React from \"react\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport MeasuringTool, { type MeasureInfo } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\ntype Props = {\n  measuringTool: ?MeasuringTool,\n  measureInfo: MeasureInfo,\n  perspective: boolean,\n  debug: boolean,\n  onToggleCameraMode: () => void,\n  onToggleDebug: () => void,\n};\n\nfunction MainToolbar({\n  measuringTool,\n  measureInfo: { measureState },\n  debug,\n  onToggleCameraMode,\n  onToggleDebug,\n  perspective = false,\n}: Props) {\n  const cameraModeTip = perspective ? \"Switch to 2D camera\" : \"Switch to 3D camera\";\n  const measureActive = measureState === \"place-start\" || measureState === \"place-finish\";\n  return (\n    <div className={styles.buttons}>\n      <Button tooltip={cameraModeTip} onClick={onToggleCameraMode}>\n        <Icon style={{ color: perspective ? colors.accent : \"white\" }} dataTest={`MainToolbar-toggleCameraMode`}>\n          <Video3dIcon />\n        </Icon>\n      </Button>\n      <Button\n        disabled={perspective}\n        tooltip={\n          perspective\n            ? \"Switch to 2D Camera to Measure Distance\"\n            : measureActive\n            ? \"Cancel Measuring\"\n            : \"Measure Distance\"\n        }\n        onClick={measuringTool ? measuringTool.toggleMeasureState : undefined}>\n        <Icon\n          style={{\n            color: measureActive ? colors.accent : perspective ? undefined : \"white\",\n          }}>\n          <RulerIcon />\n        </Icon>\n      </Button>\n      {process.env.NODE_ENV === \"development\" && (\n        <Button tooltip=\"Debug\" onClick={onToggleDebug}>\n          <Icon style={{ color: debug ? colors.accent : \"white\" }}>\n            <BugIcon />\n          </Icon>\n        </Button>\n      )}\n    </div>\n  );\n}\n\nexport default React.memo<Props>(MainToolbar);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowLeftIcon from \"@mdi/svg/svg/arrow-left.svg\";\nimport ArrowRightIcon from \"@mdi/svg/svg/arrow-right.svg\";\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport SwapHorizontalIcon from \"@mdi/svg/svg/swap-horizontal.svg\";\nimport SyncIcon from \"@mdi/svg/svg/sync.svg\";\nimport React, { memo } from \"react\";\n\nimport { Item, SubMenu } from \"webviz-core/src/components/Menu\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport { type Save3DConfig } from \"webviz-core/src/panels/ThreeDimensionalViz\";\nimport helpContent from \"webviz-core/src/panels/ThreeDimensionalViz/index.help.md\";\nimport type { TopicSettingsCollection } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\n\nexport const SYNC_OPTIONS = {\n  bag1ToBag2: \"bag1ToBag2\",\n  bag2ToBag1: \"bag2ToBag1\",\n  swapBag1AndBag2: \"swapBag1AndBag2\",\n};\n\ntype Props = {\n  saveConfig: Save3DConfig,\n  flattenMarkers: boolean,\n  autoTextBackgroundColor: boolean,\n  checkedKeys: string[],\n  settingsByKey: TopicSettingsCollection,\n};\n\ntype BagSyncData = {| checkedKeys: string[], settingsByKey: TopicSettingsCollection |};\ntype SyncOption = $Keys<typeof SYNC_OPTIONS>;\ntype Keys = {| bag1: string[], bag2: [] |};\n\nfunction bag2KeyToBag1Key(bag2Key: string) {\n  if (bag2Key.startsWith(`t:${$WEBVIZ_SOURCE_2}`)) {\n    return bag2Key.replace(`t:${$WEBVIZ_SOURCE_2}`, \"t:\");\n  }\n  if (bag2Key.startsWith(\"name_2:\")) {\n    return bag2Key.replace(\"name_2:\", \"name:\");\n  }\n  return bag2Key.replace(`ns:${$WEBVIZ_SOURCE_2}`, \"ns:\");\n}\nfunction bag1KeyToBag2Key(bag1Key: string) {\n  if (bag1Key.startsWith(\"t:\")) {\n    return bag1Key.replace(\"t:\", `t:${$WEBVIZ_SOURCE_2}`);\n  }\n  if (bag1Key.startsWith(\"name:\")) {\n    return bag1Key.replace(\"name:\", \"name_2:\");\n  }\n  return bag1Key.replace(\"ns:\", `ns:${$WEBVIZ_SOURCE_2}`);\n}\n\nfunction partitionKeys(\n  keys: string[]\n): {|\n  groupKeys: Keys,\n  topicKeys: Keys,\n  namespaceKeys: Keys,\n|} {\n  const result = {\n    groupKeys: { bag1: [], bag2: [] },\n    topicKeys: { bag1: [], bag2: [] },\n    namespaceKeys: { bag1: [], bag2: [] },\n  };\n  keys.forEach((key) => {\n    if (key.startsWith(`t:${$WEBVIZ_SOURCE_2}`)) {\n      result.topicKeys.bag2.push(key);\n    } else if (key.startsWith(\"t:\")) {\n      result.topicKeys.bag1.push(key);\n    } else if (key.startsWith(\"name_2:\")) {\n      result.groupKeys.bag2.push(key);\n    } else if (key.startsWith(\"name:\")) {\n      result.groupKeys.bag1.push(key);\n    } else if (key.startsWith(`ns:${$WEBVIZ_SOURCE_2}`)) {\n      result.namespaceKeys.bag2.push(key);\n    } else if (key.startsWith(\"ns:\")) {\n      result.namespaceKeys.bag1.push(key);\n    }\n  });\n  return result;\n}\n\nexport function syncBags({ checkedKeys, settingsByKey }: BagSyncData, syncOption: SyncOption): BagSyncData {\n  const { groupKeys, topicKeys, namespaceKeys } = partitionKeys(checkedKeys);\n  const bag1CheckedKeys = [...groupKeys.bag1, ...topicKeys.bag1, ...namespaceKeys.bag1];\n  const bag2CheckedKeys = [...groupKeys.bag2, ...topicKeys.bag2, ...namespaceKeys.bag2];\n  const settingKeys = Object.keys(settingsByKey);\n  const { topicKeys: topicKeys1, namespaceKeys: namespaceKeys1 } = partitionKeys(settingKeys);\n  const bag1SettingKeys = [...topicKeys1.bag1, ...namespaceKeys1.bag1];\n  const bag2SettingKeys = [...topicKeys1.bag2, ...namespaceKeys1.bag2];\n\n  const result = { checkedKeys: { bag1: [], bag2: [] }, settingsByKey: {} };\n  const newSettingsByKey = {};\n\n  switch (syncOption) {\n    case \"bag1ToBag2\":\n      result.checkedKeys = { bag1: bag1CheckedKeys, bag2: bag1CheckedKeys.map(bag1KeyToBag2Key) };\n      bag1SettingKeys.forEach((bag1Key) => (newSettingsByKey[bag1Key] = settingsByKey[bag1Key]));\n      bag1SettingKeys.forEach((bag1Key) => (newSettingsByKey[bag1KeyToBag2Key(bag1Key)] = settingsByKey[bag1Key]));\n      break;\n    case \"bag2ToBag1\":\n      result.checkedKeys = { bag1: bag2CheckedKeys.map(bag2KeyToBag1Key), bag2: bag2CheckedKeys };\n      bag2SettingKeys.forEach((bag2Key) => (newSettingsByKey[bag2Key] = settingsByKey[bag2Key]));\n      bag2SettingKeys.forEach((bag2Key) => (newSettingsByKey[bag2KeyToBag1Key(bag2Key)] = settingsByKey[bag2Key]));\n      break;\n    case \"swapBag1AndBag2\":\n      result.checkedKeys = { bag1: bag2CheckedKeys.map(bag2KeyToBag1Key), bag2: bag1CheckedKeys.map(bag1KeyToBag2Key) };\n      bag2SettingKeys.forEach((bag2Key) => (newSettingsByKey[bag2KeyToBag1Key(bag2Key)] = settingsByKey[bag2Key]));\n      bag1SettingKeys.forEach((bag1Key) => (newSettingsByKey[bag1KeyToBag2Key(bag1Key)] = settingsByKey[bag1Key]));\n      break;\n    default:\n      (syncOption: empty);\n      throw new Error(`Unsupported sync option ${syncOption}`);\n  }\n\n  return { checkedKeys: [...result.checkedKeys.bag1, ...result.checkedKeys.bag2], settingsByKey: newSettingsByKey };\n}\n\nexport default memo<Props>(function PanelToolbarMenu({\n  checkedKeys,\n  settingsByKey,\n  saveConfig,\n  flattenMarkers,\n  autoTextBackgroundColor,\n}: Props) {\n  return (\n    <PanelToolbar\n      floating\n      helpContent={helpContent}\n      menuContent={\n        <>\n          <Item\n            tooltip=\"Marker poses / points with a z-value of 0 are updated to have the flattened base frame's z-value.\"\n            icon={flattenMarkers ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n            onClick={() => saveConfig({ flattenMarkers: !flattenMarkers })}>\n            Flatten markers\n          </Item>\n          <Item\n            tooltip=\"Automatically apply dark/light background color to text.\"\n            icon={autoTextBackgroundColor ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n            onClick={() => saveConfig({ autoTextBackgroundColor: !autoTextBackgroundColor })}>\n            Auto text background\n          </Item>\n          <SubMenu checked={false} text=\"Sync settings\" icon={<SyncIcon />}>\n            <Item\n              icon={<ArrowRightIcon />}\n              tooltip=\"Set bag 2's topic settings and selected topics to bag 1's\"\n              onClick={() => saveConfig(syncBags({ checkedKeys, settingsByKey }, SYNC_OPTIONS.bag1ToBag2))}>\n              Sync bag 1 to bag 2\n            </Item>\n            <Item\n              icon={<ArrowLeftIcon />}\n              tooltip=\"Set bag 1's topic settings and selected topics to bag 2's\"\n              onClick={() => saveConfig(syncBags({ checkedKeys, settingsByKey }, SYNC_OPTIONS.bag2ToBag1))}>\n              Sync bag 2 to bag 1\n            </Item>\n            <Item\n              icon={<SwapHorizontalIcon />}\n              tooltip=\"Swap topic settings and selected topics between bag 1 and bag 2\"\n              onClick={() => saveConfig(syncBags({ checkedKeys, settingsByKey }, SYNC_OPTIONS.swapBag1AndBag2))}>\n              Swap bags 1 and 2\n            </Item>\n          </SubMenu>\n        </>\n      }\n    />\n  );\n});\n","module.exports = \"# 3D\\n\\nPlots visualization messages in a 3D scene.  You can select topics using the left-hand topic list; you can toggle the ability to follow orientation and manually select the frame you follow in the right-hand controls.  Selected topics will have their messages visualized within the 3D scene.  Topic selection is part of the configuration and will be saved between reloads and can be shared with `Import / Export Layout`.  This panel can be expanded / collapsed by clicking on the caret icon to the left of it.\\n\\nBy default the scene will follow the center of a frame.  When you move the camera, the camera will be offset from the center of that frame, but stay relative to that center.\\n\\nYou can toggle between a 3D perspective camera and a top-down, 2D orthographic camera of the scene by clicking on the _toggle 2D / 3D_ button in the top left of the 3D view panel.\\n\\n`Left-click + drag` on the scene to move the camera position parallel to the ground.  If 'follow' mode is on this will disengage it.\\n\\n`Right-click + drag` on the scene to pan and rotate the camera.  Dragging left/right will rotate the camera around the Z axis, and in 3D camera mode dragging top/bottom will pan the camera around the world's x/y axis.\\n\\n`Mouse-wheel` controls the 'zoom' of the camera.  Wheeling \\\"up\\\" will zoom the camera closer in while wheeling \\\"down\\\" will zoom the camera farther away.\\n\\nHolding down `shift` in while performing any interaction with the camera will adjust values by 1/10th of their normal adjustments.  This allows precision movements and adjustments to the camera.\\n\\n_tip: If you get 'lost' in the scene and end up looking into infinite blank space and can't find your way back try clicking on 'follow' to snap the camera back to the default position._\\n\\n## Keyboard shortcuts\\n\\nIn 3D camera mode, you can also use \\\"shooter controls\\\" (like those found in most popular desktop first-person shooter games) of `w` `a` `s` `d` to move the camera forward / left / backwards / right respective to the camera's position, and use `z` `x` to zoom in and out.  It's easy to get lost when using these controls as there is nothing anchoring the camera to the scene.\\n\\nYou can use `t` to open the Topic Tree and `Esc` to close it again.\\n\\n## Interacting with markers\\n\\nMarkers can be selected to see details about them. Open the \\\"Interactions\\\" panel from the right-side controls and click a marker to see information such as the topic name and marker contents.\\n\\nClicking on a point in a point cloud offers additional information, such as the color and coordinates of the point clicked. Selecting a point cloud also allows exporting all points from the point cloud message as a CSV.\\n\\n### Linking selected markers to global variables\\n\\nIt's possible to link fields from a selected marker to global variables. In the \\\"Clicked object\\\" tab of the \\\"Interactions\\\" panel, hover over a key in the JSON view of the marker. A button should appear that, when clicked, opens a dialog box that allows linking the field to a global variable.\\n\\nWhen a global variable is linked, selecting another marker that contains the same key will update the global variable. For example, with the tracked object \\\"id\\\" field linked to the global variable \\\"$trackedObjectId\\\", clicking another tracked object will update the \\\"$trackedObjectId\\\" field. This makes it easy to use the information about selected markers in other panels.\\n\\n## Drawing Polygons\\n\\n- To start a drawing, hold `ctrl` and click on the canvas. This will place the first point of the polygon. Continue holding ctrl and click as may times as you want to create a `string` of points connected by lines. To terminate your drawing release `ctrl` and click a final time. This will place one final point at the mouse location and 'close' the polygon. The polygon will still be selected until you click \\\"off\\\" of the polygon to anywhere else on the canvas.\\n- To select a polygon, click it once.\\n- To select a point within a polygon click it once.\\n- To move a polygon you have drawn you can click + drag on the polygon.\\n- To resize a polygon you can click + drag on an individual point within the polygon to move it. This will resize the polygon: all the points will remain connected to one another.\\n- To place a new point within an existing polygon, double click on a line within the polygon. This will bisect the line at the current double-click position, inserting a new point you may drag around to move.\\n- To delete the entire polygon, press the `delete` key when the polygon is selected.\\n- To delete an existing point in a polygon, double-click it, or press `delete` with a point selected.\\n\"","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport delay from \"webviz-core/shared/delay\";\nimport signal, { type Signal } from \"webviz-core/shared/signal\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\n\nexport type StoryEventsContextType = $ReadOnly<{\n  ready: Signal<void>,\n  render: Signal<void>,\n  selection: Signal<void>,\n\n  // Manually resolved by stories (optional)\n  storyCompleted: Signal<void>,\n}>;\n\nconst StoryEventsContext = React.createContext<?StoryEventsContextType>();\n\nexport function useStoryEventsContext(): ?StoryEventsContextType {\n  return React.useContext(StoryEventsContext);\n}\n\n// If we're running screenshot tests, we need to increase the delay times in order to\n// ensure that everything is rendered correctly. Otherwise, be as fast as possible\nconst DEFAULT_DELAY_AFTER_WAIT = inScreenshotTests() ? 2000 : 100;\n\nexport const waitFor3dPanelEvent = (eventName: string, delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  const worldEvents = {};\n\n  const withStoryEventContext = (StoryType: any) => {\n    // Create signals here because `waitFor3dPanelEvent` is called only once during story setup.\n    // Otherwise, switching stories in Storyboard is not possible.\n    worldEvents.ready = signal<void>();\n    worldEvents.render = signal<void>();\n    worldEvents.selection = signal<void>();\n    worldEvents.storyCompleted = signal<void>();\n\n    return (\n      <StoryEventsContext.Provider value={worldEvents}>\n        <StoryType />\n      </StoryEventsContext.Provider>\n    );\n  };\n\n  return {\n    decorators: [withStoryEventContext],\n    screenshot: {\n      waitFor: () => worldEvents[eventName].then(() => delay(delayMs)),\n    },\n  };\n};\n\nexport const waitFor3dPanelReadyEvent = (delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  return waitFor3dPanelEvent(\"ready\", delayMs);\n};\n\nexport const waitFor3dPanelRenderEvent = (delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  return waitFor3dPanelEvent(\"render\", delayMs);\n};\n\nexport const waitFor3dPanelSelectionEvent = (delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  return waitFor3dPanelEvent(\"selection\", delayMs);\n};\n\nexport const waitForStoryCompletedEvent = (delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  return waitFor3dPanelEvent(\"storyCompleted\", delayMs);\n};\n\nexport const use3dPanelEvent = (eventName: string, delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  const worldEvents = useStoryEventsContext();\n  return React.useMemo(() => {\n    if (!worldEvents) {\n      return Promise.reject();\n    }\n    const event = worldEvents[eventName];\n    return delayMs === 0 ? event : event.then(() => delay(delayMs));\n  }, [delayMs, eventName, worldEvents]);\n};\n\nexport const use3dPanelReadyEvent = (delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  return use3dPanelEvent(\"ready\", delayMs);\n};\n\nexport const use3dPanelRenderEvent = (delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  return use3dPanelEvent(\"render\", delayMs);\n};\n\nexport const use3dPanelSelectionEvent = (delayMs: number = DEFAULT_DELAY_AFTER_WAIT) => {\n  return use3dPanelEvent(\"selection\", delayMs);\n};\n\nexport const useStoryCompletedEvent = (): Signal<void> => {\n  const worldEvents = useStoryEventsContext();\n  if (!worldEvents) {\n    throw new Error(\"Attempting to use world events outside of context provider\");\n  }\n  return worldEvents.storyCompleted;\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEmpty, omit } from \"lodash\";\nimport Tabs, { TabPane } from \"rc-tabs\";\nimport React, { useCallback } from \"react\";\nimport styled from \"styled-components\";\n\nimport { type Save3DConfig } from \"../index\";\nimport Button from \"webviz-core/src/components/Button\";\nimport ErrorBoundary from \"webviz-core/src/components/ErrorBoundary\";\nimport Modal from \"webviz-core/src/components/Modal\";\nimport { RenderToBodyPortal } from \"webviz-core/src/components/renderToBody\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport { useArbitraryTopicMessage } from \"webviz-core/src/PanelAPI\";\nimport { topicSettingsEditorForDatatype } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor\";\nimport type { StructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst STopicSettingsEditor = styled.div`\n  background: ${colors.DARK2};\n  color: ${colors.TEXT};\n  padding: 16px;\n`;\nconst STitle = styled.h3`\n  font-size: 20px;\n  font-size: 20px;\n  margin-right: 36px;\n  word-break: break-all;\n  line-height: 1.3;\n`;\n\nconst SDatatype = styled.p`\n  padding-bottom: 12px;\n`;\n\nconst SEditorWrapper = styled.div`\n  color: ${colors.TEXT};\n  width: 400px;\n`;\n\nconst STabWrapper = styled.div`\n  .rc-tabs-nav-list {\n    display: flex;\n  }\n  .rc-tabs-tab {\n    margin-right: 16px;\n    padding-bottom: 6px;\n    margin-bottom: 8px;\n    color: ${colors.TEXT};\n    font-size: 14px;\n    cursor: pointer;\n  }\n  .rc-tabs-tab-active {\n    border-bottom: 2px solid ${colors.BLUEL1};\n  }\n  .rc-tabs-nav-operations {\n    display: none;\n  }\n`;\n\nfunction getSettingsByColumnWithDefaults(topicName: string, settingsByColumn: ?(any[])): ?{ settingsByColumn: any[] } {\n  const defaultTopicSettingsByColumn = getGlobalHooks()\n    .startupPerPanelHooks()\n    .ThreeDimensionalViz.getDefaultTopicSettingsByColumn(topicName);\n\n  if (defaultTopicSettingsByColumn) {\n    const newSettingsByColumn = settingsByColumn || [undefined, undefined];\n    newSettingsByColumn.forEach((settings, columnIndex) => {\n      if (settings === undefined) {\n        // Only apply default settings if there are no settings present.\n        newSettingsByColumn[columnIndex] = defaultTopicSettingsByColumn[columnIndex];\n      }\n    });\n    return { settingsByColumn: newSettingsByColumn };\n  }\n  return settingsByColumn ? { settingsByColumn } : undefined;\n}\n\nfunction MainEditor({\n  datatype,\n  message,\n  columnIndex,\n  onFieldChange,\n  onSettingsChange,\n  settings,\n  structuralDatatypes,\n  topicName,\n}: {|\n  datatype: string,\n  message: any,\n  columnIndex: number,\n  onFieldChange: (fieldName: string, value: any) => void,\n  onSettingsChange: (settings: any | ((prevSettings: {}) => {})) => void,\n  settings: any,\n  structuralDatatypes: StructuralDatatypes,\n  topicName: string,\n|}) {\n  const Editor = topicSettingsEditorForDatatype(datatype, structuralDatatypes);\n  if (!Editor) {\n    throw new Error(`No topic settings editor available for ${datatype}`);\n  }\n\n  return (\n    <ErrorBoundary>\n      <SEditorWrapper>\n        <Editor\n          message={message}\n          onFieldChange={onFieldChange}\n          settings={settings}\n          onSettingsChange={onSettingsChange}\n        />\n        <Button\n          className=\"test-reset-settings-btn\"\n          style={{ marginTop: 8 }}\n          onClick={() => {\n            const defaultSettingsByColumn = getSettingsByColumnWithDefaults(topicName)?.settingsByColumn || [];\n            onSettingsChange(defaultSettingsByColumn[columnIndex]);\n          }}>\n          Reset to defaults\n        </Button>\n      </SEditorWrapper>\n    </ErrorBoundary>\n  );\n}\n\ntype Props = {|\n  currentEditingTopic: Topic,\n  hasFeatureColumn: boolean,\n  saveConfig: Save3DConfig,\n  setCurrentEditingTopic: (?Topic) => void,\n  settingsByKey: { [topic: string]: any },\n  structuralDatatypes: StructuralDatatypes,\n|};\n\nfunction TopicSettingsModal({\n  currentEditingTopic,\n  currentEditingTopic: { datatype, name: topicName },\n  hasFeatureColumn,\n  saveConfig,\n  setCurrentEditingTopic,\n  settingsByKey,\n  structuralDatatypes,\n}: Props) {\n  const topicSettingsKey = `t:${topicName}`;\n  const onSettingsChange = useCallback((settings: any | ((prevSettings: {}) => {})) => {\n    if (typeof settings !== \"function\" && isEmpty(settings)) {\n      // Remove the field if the topic settings are empty to prevent the panelConfig from every growing.\n      saveConfig({ settingsByKey: omit(settingsByKey, [topicSettingsKey]) });\n      return;\n    }\n    saveConfig({\n      settingsByKey: {\n        ...settingsByKey,\n        [topicSettingsKey]: typeof settings === \"function\" ? settings(settingsByKey[topicSettingsKey] || {}) : settings,\n      },\n    });\n  }, [saveConfig, settingsByKey, topicSettingsKey]);\n\n  const onFieldChange = useCallback((fieldName: string, value: any) => {\n    onSettingsChange((newSettings) => ({ ...newSettings, [fieldName]: value }));\n  }, [onSettingsChange]);\n\n  const columnIndex = topicName.startsWith($WEBVIZ_SOURCE_2) ? 1 : 0;\n  const nonPrefixedTopic = columnIndex === 1 ? topicName.substr($WEBVIZ_SOURCE_2.length) : topicName;\n  const message = useArbitraryTopicMessage(topicName);\n\n  const editorElem = (\n    <MainEditor\n      columnIndex={columnIndex}\n      datatype={datatype}\n      message={message}\n      onFieldChange={onFieldChange}\n      onSettingsChange={onSettingsChange}\n      settings={settingsByKey[topicSettingsKey] || {}}\n      structuralDatatypes={structuralDatatypes}\n      topicName={nonPrefixedTopic}\n    />\n  );\n  return (\n    <RenderToBodyPortal>\n      <Modal\n        onRequestClose={() => setCurrentEditingTopic(undefined)}\n        contentStyle={{\n          maxHeight: \"calc(100vh - 200px)\",\n          maxWidth: 480,\n          display: \"flex\",\n          flexDirection: \"column\",\n          overflow: \"auto\",\n        }}>\n        <STopicSettingsEditor>\n          <STitle>{currentEditingTopic.name}</STitle>\n          <SDatatype>{currentEditingTopic.datatype}</SDatatype>\n          {hasFeatureColumn ? (\n            <STabWrapper>\n              <Tabs\n                activeKey={`${columnIndex}`}\n                onChange={(newKey) => {\n                  const newEditingTopicName =\n                    newKey === \"0\" ? nonPrefixedTopic : `${$WEBVIZ_SOURCE_2}${nonPrefixedTopic}`;\n                  setCurrentEditingTopic({ datatype, name: newEditingTopicName });\n                }}>\n                <TabPane tab={\"base\"} key={\"0\"}>\n                  {editorElem}\n                </TabPane>\n                <TabPane tab={$WEBVIZ_SOURCE_2} key={\"1\"}>\n                  {editorElem}\n                </TabPane>\n              </Tabs>\n            </STabWrapper>\n          ) : (\n            editorElem\n          )}\n        </STopicSettingsEditor>\n      </Modal>\n    </RenderToBodyPortal>\n  );\n}\n\nexport default React.memo<Props>(TopicSettingsModal);\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport { type Color } from \"regl-worldview\";\n\nimport { CommonPointSettings, CommonDecaySettings, type TopicSettingsEditorProps } from \".\";\nimport ColorPickerForTopicSettings from \"./ColorPickerForTopicSettings\";\nimport { SLabel } from \"./common\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport type { LaserScan } from \"webviz-core/src/types/Messages\";\n\ntype LaserScanSettings = {|\n  pointSize?: ?number,\n  pointShape?: ?string,\n  decayTime?: ?number,\n  overrideColor: ?Color,\n|};\n\nexport default function LaserScanSettingsEditor(props: TopicSettingsEditorProps<LaserScan, LaserScanSettings>) {\n  const { settings, onFieldChange } = props;\n\n  return (\n    <Flex col>\n      <CommonPointSettings\n        settings={settings}\n        defaultPointSize={4}\n        defaultPointShape=\"square\"\n        onFieldChange={onFieldChange}\n      />\n      <CommonDecaySettings settings={settings} onFieldChange={onFieldChange} />\n\n      <SLabel>Color</SLabel>\n      <ColorPickerForTopicSettings\n        color={settings.overrideColor}\n        onChange={(newColor) => onFieldChange(\"overrideColor\", newColor)}\n      />\n    </Flex>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport type { Color } from \"regl-worldview\";\n\nimport { type TopicSettingsEditorProps } from \".\";\nimport ColorPickerForTopicSettings from \"./ColorPickerForTopicSettings\";\nimport { SLabel, SDescription } from \"./common\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport type { Marker, MarkerArray } from \"webviz-core/src/types/Messages\";\n\ntype MarkerSettings = {|\n  overrideColor?: ?Color,\n|};\n\nexport default function MarkerOverrideColorSettingsEditor(\n  props: TopicSettingsEditorProps<Marker | MarkerArray, MarkerSettings>\n) {\n  const { settings = {}, onFieldChange } = props;\n  return (\n    <Flex col>\n      <SLabel>Color</SLabel>\n      <SDescription>\n        Overrides <code>color</code>/<code>colors</code> for all markers on this topic.\n      </SDescription>\n      <ColorPickerForTopicSettings\n        color={settings.overrideColor}\n        onChange={(newColor) => onFieldChange(\"overrideColor\", newColor)}\n      />\n    </Flex>\n  );\n}\n\nMarkerOverrideColorSettingsEditor.canEditNamespaceOverrideColor = true;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport type { Color } from \"regl-worldview\";\n\nimport { type TopicSettingsEditorProps } from \".\";\nimport ColorPickerForTopicSettings from \"./ColorPickerForTopicSettings\";\nimport { SLabel, SDescription } from \"./common\";\nimport Checkbox from \"webviz-core/src/components/Checkbox\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { IconTextTemplateEdit } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/IconMarkerSettingsEditor\";\nimport type { Marker, MarkerArray } from \"webviz-core/src/types/Messages\";\nimport { LINED_CONVEX_HULL_RENDERING_SETTING } from \"webviz-core/src/util/globalConstants\";\n\ntype MarkerSettings = {|\n  overrideColor?: ?Color,\n  overrideCommand?: ?string,\n  iconTextTemplate?: ?string,\n|};\n\nexport default function MarkerSettingsEditor(props: TopicSettingsEditorProps<Marker | MarkerArray, MarkerSettings>) {\n  const { settings = {}, onFieldChange } = props;\n  return (\n    <Flex col>\n      <SLabel>Color</SLabel>\n      <SDescription>\n        Overrides <code>color</code>/<code>colors</code> for all markers on this topic.\n      </SDescription>\n      <ColorPickerForTopicSettings\n        color={settings.overrideColor}\n        onChange={(newColor) => onFieldChange(\"overrideColor\", newColor)}\n      />\n      <SLabel>Line marker click events override</SLabel>\n      <SDescription>\n        {`\n        Optionally allow treating line markers as polygons, so that clicking inside the lines in the line marker selects\n        the marker. The default behavior for line markers requires the user to click exactly on the line to select the\n        line marker. This option can reduce performance and will not work on instanced line markers (those with \"type\":\n        105).\n        `}\n      </SDescription>\n      <Checkbox\n        checked={settings.overrideCommand === LINED_CONVEX_HULL_RENDERING_SETTING}\n        label=\"Allow clicking inside line markers that form polygons\"\n        onChange={(checked) => onFieldChange(\"overrideCommand\", checked ? LINED_CONVEX_HULL_RENDERING_SETTING : null)}\n        style={{ marginBottom: 12 }}\n        labelStyle={{ lineHeight: 1.2 }}\n      />\n      <IconTextTemplateEdit iconTextTemplate={settings.iconTextTemplate || \"\"} onFieldChange={onFieldChange} />\n    </Flex>\n  );\n}\n\nMarkerSettingsEditor.canEditNamespaceOverrideColor = true;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useCallback, useMemo } from \"react\";\nimport styled from \"styled-components\";\n\nimport { CommonPointSettings, CommonDecaySettings, type TopicSettingsEditorProps } from \".\";\nimport ColorPickerForTopicSettings from \"./ColorPickerForTopicSettings\";\nimport { SLabel, SInput } from \"./common\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport GradientPicker from \"webviz-core/src/components/GradientPicker\";\nimport Radio from \"webviz-core/src/components/Radio\";\nimport SegmentedControl from \"webviz-core/src/components/SegmentedControl\";\nimport { Select, Option } from \"webviz-core/src/components/Select\";\nimport {\n  type ColorMode,\n  DEFAULT_FLAT_COLOR,\n  DEFAULT_MIN_COLOR,\n  DEFAULT_MAX_COLOR,\n  type PointCloudSettings,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/types\";\nimport type { PointCloud2 } from \"webviz-core/src/types/Messages\";\nimport { deepParse, getField, isBobject } from \"webviz-core/src/util/binaryObjects\";\n\nconst SValueRangeInput = styled(SInput).attrs({ type: \"number\", placeholder: \"auto\" })`\n  width: 0px;\n  margin-left: 8px;\n  flex: 1 1 auto;\n`;\n\nconst SegmentedControlWrapper = styled.div`\n  min-width: 152px;\n  display: flex;\n  align-items: center;\n`;\n\nconst RainbowText = React.memo(function RainbowText({ children: text }: { children: string }) {\n  const result = [];\n  for (let i = 0; i < text.length; i++) {\n    result.push(\n      // Rainbow gradient goes from magenta (300) to red (0)\n      <span key={i} style={{ color: `hsl(${300 - 300 * (i / (text.length - 1))}, 100%, 60%)` }}>\n        {text[i]}\n      </span>\n    );\n  }\n  return result;\n});\n\nexport default function PointCloudSettingsEditor(props: TopicSettingsEditorProps<PointCloud2, PointCloudSettings>) {\n  const { message, settings = {}, onFieldChange, onSettingsChange } = props;\n\n  const onColorModeChange = useCallback((newValue: ?ColorMode | ((?ColorMode) => ?ColorMode)) => {\n    onSettingsChange((newSettings) => ({\n      ...newSettings,\n      colorMode: typeof newValue === \"function\" ? newValue(newSettings.colorMode) : newValue,\n    }));\n  }, [onSettingsChange]);\n\n  const fields =\n    useMemo(() => {\n      if (!message) {\n        return;\n      }\n      const maybeBobjectFields = getField(message, \"fields\");\n      return isBobject(maybeBobjectFields) ? deepParse(maybeBobjectFields) : maybeBobjectFields;\n    }, [message]) ?? [];\n  const hasRGB = fields.some(({ name }) => name === \"rgb\");\n  const defaultColorField = fields.find(({ name }) => name !== \"rgb\")?.name;\n  const colorMode: ColorMode = settings.colorMode\n    ? settings.colorMode\n    : hasRGB\n    ? { mode: \"rgb\" }\n    : { mode: \"flat\", flatColor: DEFAULT_FLAT_COLOR };\n\n  return (\n    <Flex col>\n      <CommonPointSettings settings={settings} defaultPointSize={2} onFieldChange={onFieldChange} />\n      <CommonDecaySettings settings={settings} onFieldChange={onFieldChange} />\n\n      <SLabel>Color by</SLabel>\n      <Flex row style={{ justifyContent: \"space-between\", marginBottom: \"8px\" }}>\n        <SegmentedControlWrapper>\n          <SegmentedControl\n            selectedId={colorMode.mode === \"flat\" ? \"flat\" : \"data\"}\n            onChange={(id) =>\n              onColorModeChange((newColorMode) => {\n                if (id === \"flat\") {\n                  return {\n                    mode: \"flat\",\n                    flatColor:\n                      newColorMode && newColorMode.mode === \"gradient\" ? newColorMode.minColor : DEFAULT_FLAT_COLOR,\n                  };\n                }\n                if (hasRGB) {\n                  return { mode: \"rgb\" };\n                }\n                return defaultColorField ? { mode: \"rainbow\", colorField: defaultColorField } : null;\n              })\n            }\n            options={[{ id: \"flat\", label: \"Flat\" }, { id: \"data\", label: \"Point data\" }]}\n          />\n        </SegmentedControlWrapper>\n        <Flex row style={{ margin: \"2px 0 2px 12px\", alignItems: \"center\" }}>\n          {colorMode.mode === \"flat\" ? (\n            // For flat mode, pick a single color\n            <ColorPickerForTopicSettings\n              color={colorMode.flatColor}\n              onChange={(flatColor) => onColorModeChange({ mode: \"flat\", flatColor })}\n            />\n          ) : (\n            // Otherwise, choose a field from the point cloud to color by\n            <Select\n              text={colorMode.mode === \"rgb\" ? \"rgb\" : colorMode.colorField}\n              value={colorMode.mode === \"rgb\" ? \"rgb\" : colorMode.colorField}\n              onChange={(value) =>\n                onColorModeChange(\n                  (newColorMode): ColorMode => {\n                    if (value === \"rgb\") {\n                      return { mode: \"rgb\" };\n                    }\n                    if (newColorMode && newColorMode.mode === \"gradient\") {\n                      return { ...newColorMode, colorField: value };\n                    }\n                    if (newColorMode && newColorMode.mode === \"rainbow\") {\n                      return { ...newColorMode, colorField: value };\n                    }\n                    return { mode: \"rainbow\", colorField: value };\n                  }\n                )\n              }>\n              {fields.map(({ name }) => (\n                <Option key={name} value={name}>\n                  {name}\n                </Option>\n              ))}\n            </Select>\n          )}\n        </Flex>\n      </Flex>\n\n      {(colorMode.mode === \"gradient\" || colorMode.mode === \"rainbow\") && (\n        <Flex col style={{ marginBottom: \"8px\" }}>\n          <SLabel>Value range</SLabel>\n          <Flex row style={{ marginLeft: \"8px\" }}>\n            <Flex row style={{ flex: \"1 1 100%\", alignItems: \"baseline\", marginRight: \"20px\" }}>\n              Min\n              <SValueRangeInput\n                value={colorMode.minValue ?? \"\"}\n                onChange={({ target: { value } }) =>\n                  onColorModeChange((newColorMode: any) => ({\n                    ...newColorMode,\n                    minValue: value === \"\" ? null : +value,\n                  }))\n                }\n              />\n            </Flex>\n            <Flex row style={{ flex: \"1 1 100%\", alignItems: \"baseline\" }}>\n              Max\n              <SValueRangeInput\n                value={colorMode.maxValue ?? \"\"}\n                onChange={({ target: { value } }) =>\n                  onColorModeChange((newColorMode: any) => ({\n                    ...newColorMode,\n                    maxValue: value === \"\" ? null : +value,\n                  }))\n                }\n              />\n            </Flex>\n          </Flex>\n          <Radio\n            selectedId={colorMode.mode}\n            onChange={(id) =>\n              onColorModeChange(({ colorField, minValue, maxValue }: any) =>\n                id === \"rainbow\"\n                  ? { mode: \"rainbow\", colorField, minValue, maxValue }\n                  : {\n                      mode: \"gradient\",\n                      colorField,\n                      minValue,\n                      maxValue,\n                      minColor: DEFAULT_MIN_COLOR,\n                      maxColor: DEFAULT_MAX_COLOR,\n                    }\n              )\n            }\n            options={[\n              {\n                id: \"rainbow\",\n                label: colorMode.mode === \"rainbow\" ? <RainbowText>Rainbow</RainbowText> : \"Rainbow\",\n              },\n              { id: \"gradient\", label: \"Custom gradient\" },\n            ]}\n          />\n        </Flex>\n      )}\n      {colorMode.mode === \"gradient\" && (\n        <div style={{ margin: \"8px\" }}>\n          <GradientPicker\n            minColor={colorMode.minColor || DEFAULT_MIN_COLOR}\n            maxColor={colorMode.maxColor || DEFAULT_MAX_COLOR}\n            onChange={({ minColor, maxColor }) =>\n              onColorModeChange((newColorMode) => ({\n                mode: \"gradient\",\n                ...newColorMode,\n                minColor,\n                maxColor,\n              }))\n            }\n          />\n        </div>\n      )}\n    </Flex>\n  );\n}\n\nPointCloudSettingsEditor.canEditNamespaceOverrideColor = true;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useCallback } from \"react\";\nimport { type Color } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport AutoSizingCanvas from \"webviz-core/src/components/AutoSizingCanvas\";\nimport ColorPickerForTopicSettings, {\n  PICKER_SIZE,\n  getHexFromColorSettingWithDefault,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/ColorPickerForTopicSettings\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst COLOR_PICKER_SIZE = PICKER_SIZE.NORMAL.size;\nconst GRADIENT_BAR_INSET = Math.floor(COLOR_PICKER_SIZE / 2);\nconst GRADIENT_BAR_HEIGHT = 10;\nconst GRADIENT_LINE_HEIGHT = 6;\n\nconst SPickerWrapper = styled.div`\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n`;\nconst SBarWrapper = styled.div`\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-end;\n  margin-left: ${GRADIENT_BAR_INSET}px;\n  margin-right: ${GRADIENT_BAR_INSET}px;\n`;\nconst SLine = styled.div`\n  flex: 0 0 auto;\n  width: 1px;\n  height: ${GRADIENT_BAR_HEIGHT + GRADIENT_LINE_HEIGHT}px;\n  background-color: ${colors.LIGHT2};\n`;\nconst SBar = styled.div`\n  flex: 1 1 auto;\n  height: ${GRADIENT_BAR_HEIGHT}px;\n`;\n\nexport default function GradientPicker({\n  minColor,\n  maxColor,\n  onChange,\n}: {\n  minColor: Color,\n  maxColor: Color,\n  onChange: ({ minColor: Color, maxColor: Color }) => void,\n}) {\n  const hexMinColor = getHexFromColorSettingWithDefault(minColor);\n  const hexMaxColor = getHexFromColorSettingWithDefault(maxColor);\n\n  const drawGradient = useCallback((ctx, width, height) => {\n    const gradient = ctx.createLinearGradient(0, 0, width, 0);\n    gradient.addColorStop(0, hexMinColor);\n    gradient.addColorStop(1, hexMaxColor);\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, 0, width, height);\n  }, [hexMaxColor, hexMinColor]);\n\n  return (\n    <>\n      <SPickerWrapper>\n        <ColorPickerForTopicSettings\n          color={minColor}\n          onChange={(newColor) => onChange({ minColor: newColor, maxColor })}\n        />\n        <ColorPickerForTopicSettings\n          color={maxColor}\n          onChange={(newColor) => onChange({ minColor, maxColor: newColor })}\n        />\n      </SPickerWrapper>\n      <SBarWrapper>\n        <SLine />\n        <SBar>\n          <AutoSizingCanvas draw={drawGradient} />\n        </SBar>\n        <SLine />\n      </SBarWrapper>\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport cx from \"classnames\";\nimport * as React from \"react\";\n\nimport styles from \"./Option.module.scss\";\nimport Icon from \"webviz-core/src/components/Icon\";\n\ntype Props = {\n  // value is used by the Select component\n  value?: any, // eslint-disable-line\n  children: React.Node,\n  onClick?: (e: SyntheticMouseEvent<HTMLDivElement>) => void,\n  disabled: boolean,\n  active: boolean,\n  rightIcon?: React.Node,\n};\n\nexport default class Option extends React.Component<Props> {\n  static defaultProps = {\n    disabled: false,\n    active: false,\n  };\n\n  renderRightIcon() {\n    const { rightIcon } = this.props;\n    if (!rightIcon) {\n      return;\n    }\n    return (\n      <span style={{ float: \"right\" }}>\n        <Icon>{rightIcon}</Icon>\n      </span>\n    );\n  }\n\n  render() {\n    const { onClick, active, disabled, children } = this.props;\n    const className = cx(styles.container, {\n      [styles.active]: active,\n      [styles.disabled]: disabled,\n    });\n    return (\n      <div className={className} onClick={onClick}>\n        {children}\n        {this.renderRightIcon()}\n      </div>\n    );\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Option.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Option.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Option.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-Select-Option-module-234wh--container{text-decoration:none;padding:8px 16px;cursor:pointer;color:rgba(247,247,243,.77);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.packages-webviz-core-src-components-Select-Option-module-234wh--container.packages-webviz-core-src-components-Select-Option-module-387jk--active,.packages-webviz-core-src-components-Select-Option-module-234wh--container:hover{color:#fff;background-color:#36363d}.packages-webviz-core-src-components-Select-Option-module-234wh--container.packages-webviz-core-src-components-Select-Option-module-fytwj--disabled{color:rgba(247,247,243,.15);cursor:not-allowed}.packages-webviz-core-src-components-Select-Option-module-234wh--container.packages-webviz-core-src-components-Select-Option-module-fytwj--disabled:hover{background-color:transparent;color:rgba(247,247,243,.15)}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/Select/Option.module.scss\"],\"names\":[],\"mappings\":\"AAoCA,2EACE,qBACA,iBACA,eACA,4BACA,yBAAA,sBAAA,qBAAA,iBACA,oBAAA,aACA,sBAAA,kBAAA,CAuBF,mOAEE,WACA,wBCvBM,CD+CR,AEpFE,oJACE,4BACA,kBAAA,CACA,0JACE,6BACA,2BDDU,CAAA\",\"file\":\"Option.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\",\"@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n.container {\\n  @extend %menu-item;\\n  $height: 14px;\\n\\n  &.active {\\n    @extend %menu-item-active;\\n  }\\n\\n  &.disabled {\\n    color: $text-disabled;\\n    cursor: not-allowed;\\n    &:hover {\\n      background-color: transparent;\\n      color: $text-disabled;\\n    }\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"container\": \"packages-webviz-core-src-components-Select-Option-module-234wh--container\",\n\t\"active\": \"packages-webviz-core-src-components-Select-Option-module-387jk--active\",\n\t\"disabled\": \"packages-webviz-core-src-components-Select-Option-module-fytwj--disabled\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport MenuDownIcon from \"@mdi/svg/svg/menu-down.svg\";\nimport * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport styled from \"styled-components\";\n\nimport styles from \"./Select.module.scss\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\nconst SEmpty = styled.div`\n  padding: 8px 12px;\n  color: ${colors.textMuted};\n  font-style: italic;\n`;\n\ntype Props = {\n  children: React.Node,\n  // specify text specifically if the value is not a string\n  text?: ?string,\n  value: any,\n  icon: React.Node,\n  onChange: (value: any) => void,\n};\n\ntype State = {\n  isOpen: boolean,\n};\n\nexport default class Select extends React.Component<Props, State> {\n  static defaultProps = {\n    icon: <MenuDownIcon />,\n  };\n\n  el: ?HTMLDivElement;\n\n  state = {\n    isOpen: false,\n  };\n\n  close = () => {\n    this.setState({ isOpen: false });\n    window.removeEventListener(\"click\", this.close);\n  };\n\n  open = (e: SyntheticEvent<HTMLDivElement>) => {\n    e.stopPropagation();\n    this.setState({ isOpen: true });\n    // let this event hit the window before adding close listener\n    setImmediate(() => {\n      window.addEventListener(\"click\", this.close);\n    });\n  };\n\n  renderOpen() {\n    const { value, children, onChange } = this.props;\n    const mappedChildren = React.Children.map(children, (child) => {\n      // if the child does not have a value prop, just return it\n      // e.g. <hr />\n      if (!child.props.value) {\n        return child;\n      }\n      const onClick = (e: SyntheticEvent<HTMLDivElement>) => {\n        e.stopPropagation();\n        e.preventDefault();\n        if (child.props.disabled) {\n          return;\n        }\n        const childValue = child.props.value;\n        // don't allow <hr /> clicks to close\n        if (!childValue) {\n          return;\n        }\n        this.close();\n        onChange(child.props.value);\n      };\n      const active = value === child.props.value;\n      return React.cloneElement(child, { onClick, active });\n    });\n    const { body } = document;\n    const { el } = this;\n    // satisfy flow\n    if (!body || !el) {\n      return;\n    }\n    const box = el.getBoundingClientRect();\n    const style = {\n      top: box.top,\n      left: box.left,\n      width: box.width,\n    };\n    return createPortal(\n      <div style={style} className={styles.menu}>\n        {mappedChildren && mappedChildren.length ? mappedChildren : <SEmpty>No options available</SEmpty>}\n      </div>,\n      body\n    );\n  }\n\n  render() {\n    const { isOpen } = this.state;\n    const { text, value, icon } = this.props;\n    return (\n      <div ref={(el) => (this.el = el)} className={styles.container} onClick={this.open}>\n        <div className={styles.select}>\n          <span className={styles.value}>{text || value}</span>\n          <span className={styles.icon}>\n            <Icon>{icon}</Icon>\n          </span>\n        </div>\n        {isOpen && this.renderOpen()}\n      </div>\n    );\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Select.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Select.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./Select.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-Select-Select-module-mhyf6--menu,.packages-webviz-core-src-components-Select-Select-module-37tcd--select.packages-webviz-core-src-components-Select-Select-module-g37t1--open,.packages-webviz-core-src-components-Select-Select-module-4ymxb--container.packages-webviz-core-src-components-Select-Select-module-g37t1--open{background-color:#242429;border-radius:4px;padding:0;-webkit-box-shadow:0 0px 32px rgba(8,8,10,.6);box-shadow:0 0px 32px rgba(8,8,10,.6);overflow:hidden;pointer-events:auto;-ms-flex-negative:0;flex-shrink:0}.packages-webviz-core-src-components-Select-Select-module-4ymxb--container{position:relative;margin:0 .2em;-ms-flex:1 1 auto;flex:1 1 auto;display:-ms-flexbox;display:flex}.packages-webviz-core-src-components-Select-Select-module-37tcd--select{-ms-flex:1 1 auto;flex:1 1 auto;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;background-color:rgba(255,255,255,.5);background-color:rgba(247,247,243,.57);border-radius:4px;height:auto;min-height:26px;border:none;padding:8px 8px 8px 16px;cursor:pointer;color:rgba(0,0,0,.8)}.packages-webviz-core-src-components-Select-Select-module-37tcd--select .packages-webviz-core-src-components-Select-Select-module-5hn5t--value{font-family:\\\"Inter UI\\\",-apple-system,BlinkMacSystemFont,sans-serif;-webkit-font-feature-settings:\\\"tnum\\\";font-feature-settings:\\\"tnum\\\";-ms-flex:1 1 auto;flex:1 1 auto}.packages-webviz-core-src-components-Select-Select-module-37tcd--select.packages-webviz-core-src-components-Select-Select-module-g37t1--open{border-bottom-left-radius:0px;border-bottom-right-radius:0px;padding:8px 8px 8px 16px;padding-right:20px;color:rgba(247,247,243,.77)}.packages-webviz-core-src-components-Select-Select-module-37tcd--select .packages-webviz-core-src-components-Select-Select-module-4xkst--icon{font-size:14px}.packages-webviz-core-src-components-Select-Select-module-mhyf6--menu{position:absolute;top:0;left:0;width:100%;z-index:999999999}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/components/Select/Select.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AA0BA,mWACE,yBACA,kBACA,UACA,8CAAA,sCACA,gBACA,oBACA,oBAAA,aAAA,CA4DF,AC5FA,2EACE,kBACA,cACA,kBAAA,cACA,oBAAA,YAAA,CAOF,wEACE,kBAAA,cACA,oBAAA,aACA,sBAAA,mBACA,sCACA,uCACA,kBACA,YACA,gBACA,YACA,yBACA,eACA,oBCNW,CDQX,+IDiDA,mEACA,qCAAA,6BChDE,kBAAA,aAAA,CAGF,6IAEE,8BACA,+BACA,yBACA,mBACA,2BCzBU,CD4BZ,8IACE,cAAA,CAIJ,sEAEE,kBACA,MACA,OACA,WACA,iBAAA,CAAA\",\"file\":\"Select.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n.container {\\n  position: relative;\\n  margin: $control-margin;\\n  flex: 1 1 auto;\\n  display: flex;\\n\\n  &.open {\\n    @extend %floating-box;\\n  }\\n}\\n\\n.select {\\n  flex: 1 1 auto;\\n  display: flex;\\n  align-items: center;\\n  background-color: rgba(255, 255, 255, 0.5);\\n  background-color: transparentize($text-normal, 0.2);\\n  border-radius: 4px;\\n  height: auto;\\n  min-height: 26px;\\n  border: none;\\n  padding: $control-padding;\\n  cursor: pointer;\\n  color: $text-input;\\n\\n  .value {\\n    @include sans-serif;\\n    flex: 1 1 auto;\\n  }\\n\\n  &.open {\\n    @extend %floating-box;\\n    border-bottom-left-radius: 0px;\\n    border-bottom-right-radius: 0px;\\n    padding: $control-padding;\\n    padding-right: 20px;\\n    color: $text-control;\\n  }\\n\\n  .icon {\\n    font-size: 14px;\\n  }\\n}\\n\\n.menu {\\n  @extend %floating-box;\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  z-index: 999999999;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: rgba(45, 45, 51, 1);\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$light1: #f0f0f0;\\n$dark2: #1a1a1f;\\n$dark4: #2d2d33;\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$toolbar-fixed: #1f1e27;\\n$accent: #248eff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n// Robot styles colors\\n$light: #ffffff;\\n$dark: #08080a;\\n$dark2: #1a1a1f;\\n$dark3: #242429;\\n$dark4: #2d2d33;\\n$dark5: #36363d;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  orange: $orange;\\n  red: $red;\\n  divider: $divider;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"menu\": \"packages-webviz-core-src-components-Select-Select-module-mhyf6--menu\",\n\t\"select\": \"packages-webviz-core-src-components-Select-Select-module-37tcd--select\",\n\t\"open\": \"packages-webviz-core-src-components-Select-Select-module-g37t1--open\",\n\t\"container\": \"packages-webviz-core-src-components-Select-Select-module-4ymxb--container\",\n\t\"value\": \"packages-webviz-core-src-components-Select-Select-module-5hn5t--value\",\n\t\"icon\": \"packages-webviz-core-src-components-Select-Select-module-4xkst--icon\"\n};","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport { type TopicSettingsEditorProps } from \".\";\nimport ColorPickerForTopicSettings from \"./ColorPickerForTopicSettings\";\nimport { SLabel, SInput } from \"./common\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport type { PoseStamped } from \"webviz-core/src/types/Messages\";\n\ntype PoseSettings = {|\n  overrideColor?: ?string,\n  alpha?: number,\n  size?: {\n    headLength: number,\n    headWidth: number,\n    shaftWidth: number,\n  },\n  modelType?: \"car-model\" | \"arrow\",\n|};\n\nexport default function PoseSettingsEditor(props: TopicSettingsEditorProps<PoseStamped, PoseSettings>) {\n  const { settings, onFieldChange, onSettingsChange } = props;\n\n  const settingsByCarType = React.useMemo(() => {\n    switch (settings.modelType) {\n      case \"car-model\": {\n        const alpha = settings.alpha != null ? settings.alpha : 1;\n        return (\n          <Flex col>\n            <SLabel>Alpha</SLabel>\n            <SInput\n              type=\"number\"\n              value={alpha.toString()}\n              min={0}\n              max={1}\n              step={0.1}\n              onChange={(e) => onSettingsChange({ ...settings, alpha: parseFloat(e.target.value) })}\n            />\n          </Flex>\n        );\n      }\n      case \"arrow\":\n      default: {\n        const currentShaftWidth = settings.size?.shaftWidth ?? 2;\n        const currentHeadWidth = settings.size?.headWidth ?? 2;\n        const currentHeadLength = settings.size?.headLength ?? 0.1;\n        return (\n          <Flex col>\n            <SLabel>Color</SLabel>\n            <ColorPickerForTopicSettings\n              color={settings.overrideColor}\n              onChange={(newColor) => onFieldChange(\"overrideColor\", newColor)}\n            />\n            <SLabel>Shaft width</SLabel>\n            <SInput\n              type=\"number\"\n              value={currentShaftWidth}\n              placeholder=\"2\"\n              onChange={(e) =>\n                onSettingsChange({ ...settings, size: { ...settings.size, shaftWidth: parseFloat(e.target.value) } })\n              }\n            />\n            <SLabel>Head width</SLabel>\n            <SInput\n              type=\"number\"\n              value={currentHeadWidth}\n              placeholder=\"2\"\n              onChange={(e) =>\n                onSettingsChange({ ...settings, size: { ...settings.size, headWidth: parseFloat(e.target.value) } })\n              }\n            />\n            <SLabel>Head length</SLabel>\n            <SInput\n              type=\"number\"\n              value={currentHeadLength}\n              placeholder=\"0.1\"\n              onChange={(e) =>\n                onSettingsChange({ ...settings, size: { ...settings.size, headLength: parseFloat(e.target.value) } })\n              }\n            />\n          </Flex>\n        );\n      }\n    }\n  }, [onFieldChange, onSettingsChange, settings]);\n\n  const badModelTypeSetting = React.useMemo(() => ![\"car-model\", \"arrow\"].includes(settings.modelType), [settings]);\n\n  return (\n    <Flex col>\n      <SLabel>Rendered Car</SLabel>\n      <div\n        style={{ display: \"flex\", margin: \"4px\", flexDirection: \"column\" }}\n        onChange={(e) => {\n          onSettingsChange({ ...settings, modelType: e.target.value, alpha: undefined });\n        }}>\n        {[{ value: \"car-model\", title: \"Car Model\" }, { value: \"arrow\", title: \"Arrow\" }].map(({ value, title }) => (\n          <div key={value} style={{ marginBottom: \"4px\", display: \"flex\" }}>\n            <input\n              type=\"radio\"\n              value={value}\n              checked={settings.modelType === value || (value === \"arrow\" && badModelTypeSetting)}\n            />\n            <label>{title}</label>\n          </div>\n        ))}\n      </div>\n      {settingsByCarType}\n    </Flex>\n  );\n}\n\nPoseSettingsEditor.canEditNamespaceOverrideColor = true;\n","\nvar content = require(\"!!../../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./TopicSettingsEditor.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./TopicSettingsEditor.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--16!./TopicSettingsEditor.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-ck4v1--container .packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-vwvj4--topicName{color:rgba(247,247,243,.88);font-size:16px;line-height:20px}.packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-44muf--dropdown .packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-2d8pe--button{width:100%}.packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-ck4v1--container{font-family:\\\"Inter UI\\\",-apple-system,BlinkMacSystemFont,sans-serif;-webkit-font-feature-settings:\\\"tnum\\\";font-feature-settings:\\\"tnum\\\"}.packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-ck4v1--container .packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-vwvj4--topicName{word-wrap:break-word}.packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-ck4v1--container .packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-2neuz--datatype{padding-bottom:20px}\", \"\", {\"version\":3,\"sources\":[\"/Users/cloud/develop/webviz/packages/webviz-core/src/styles/mixins.module.scss\",\"/Users/cloud/develop/webviz/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/TopicSettingsEditor.module.scss\"],\"names\":[],\"mappings\":\"AAkDA,0OACE,4BACA,eACA,gBAAA,CAwCF,ACzFE,sOACE,UAAA,CAIJ,qHDkEE,mEACA,qCAAA,4BAAA,CChEA,0OAEE,oBAAA,CAGF,yOACE,mBAAA,CAAA\",\"file\":\"TopicSettingsEditor.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: 8px 8px 8px 16px;\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $dark3;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 0px 32px rgba(8, 8, 10, 0.6);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: 8px 16px;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active,\\n%menu-item-hover {\\n  color: rgba(255, 255, 255, 1);\\n  background-color: $dark5;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.dropdown {\\n  .button {\\n    width: 100%;\\n  }\\n}\\n\\n.container {\\n  @include sans-serif;\\n\\n  .topicName {\\n    @extend %modal-subtitle;\\n    word-wrap: break-word;\\n  }\\n\\n  .datatype {\\n    padding-bottom: 20px;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#248eff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"orange\": \"#ccb862\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247,247,243,.1)\",\n\t\"textMuted\": \"rgba(247,247,243,.3)\",\n\t\"textBright\": \"rgba(247,247,243,.88)\",\n\t\"textDisabled\": \"rgba(247,247,243,.15)\",\n\t\"backgroundControl\": \"rgba(247,247,243,.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\",Menlo,Inconsolata,\\\"Courier New\\\",Courier,monospace\",\n\t\"container\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-ck4v1--container\",\n\t\"topicName\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-vwvj4--topicName\",\n\t\"dropdown\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-44muf--dropdown\",\n\t\"button\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-2d8pe--button\",\n\t\"datatype\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-TopicSettingsEditor-TopicSettingsEditor-module-2neuz--datatype\"\n};","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport { type Save3DConfig } from \"../index\";\nimport Switch from \"webviz-core/src/components/Switch\";\nimport { logEventAction, getEventInfos } from \"webviz-core/src/util/logEvent\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\ntype Props = {|\n  enabled: boolean,\n  saveConfig: Save3DConfig,\n|};\n\nconst SDiffModeWrapper = styled.div`\n  display: flex;\n  padding: 8px 8px 8px 16px;\n  height: 42px;\n  align-items: center;\n`;\n\nconst SDiffModeIcon = styled.div`\n  display: flex;\n  margin: 0 30px 0 auto;\n  width: 20px;\n  height: 20px;\n`;\n\nconst STitle = styled.div`\n  font-size: 13px;\n  line-height: 1.4;\n  user-select: none;\n  vertical-align: middle;\n  margin-left: 8px;\n`;\n\nfunction DiffModeIconEnabled() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" height=\"100%\" width=\"100%\" viewBox=\"0 0 300 200\">\n      <defs>\n        <circle r=\"100\" id=\"circle_left\" cy=\"100\" cx=\"100\" />\n        <circle r=\"100\" id=\"circle_right\" cy=\"100\" cx=\"200\" />\n        <mask id=\"mask_left\">\n          <use xlinkHref=\"#circle_right\" fill=\"white\" />\n        </mask>\n      </defs>\n      <g>\n        <use xlinkHref=\"#circle_left\" strokeWidth=\"1.5\" stroke=\"none\" fill={colors.DIFF_MODE_SOURCE_1} />\n        <use xlinkHref=\"#circle_right\" strokeWidth=\"1.5\" stroke=\"none\" fill={colors.DIFF_MODE_SOURCE_2} />\n        <use xlinkHref=\"#circle_left\" id=\"center\" fill={colors.DIFF_MODE_SOURCE_BOTH} mask=\"url(#mask_left)\" />\n      </g>\n    </svg>\n  );\n}\n\nexport default function DiffModeSettings({ enabled, saveConfig }: Props) {\n  const updateDiffModeFlag = () => {\n    saveConfig({ diffModeEnabled: !enabled });\n    logEventAction(getEventInfos()[\"3D_PANEL.DIFF_MODE_TOGGLED\"], {\n      enabled: !enabled,\n    });\n  };\n\n  return (\n    <SDiffModeWrapper>\n      <Switch onChange={updateDiffModeFlag} isChecked={enabled} />\n      <STitle>Show diff</STitle>\n      <SDiffModeIcon>{enabled && <DiffModeIconEnabled />}</SDiffModeIcon>\n    </SDiffModeWrapper>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nconst SSwitch = styled.label(\n  ({ disabled }) => `\n  position: relative;\n  vertical-align: top;\n  display: inline-flex;\n  width: 28px;\n  height: 16px;\n  outline: 0;\n\n\n  input {\n    opacity: 0;\n    width: 0;\n    height: 0;\n  }\n\n  .circle {\n    position: absolute;\n    cursor: ${disabled ? \"not-allowed\" : \"pointer\"};\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(255, 255, 255, 0.15);\n    transition: all 80ms ease-in-out;\n    border-radius: 18px;\n    opacity: ${disabled ? 0.5 : 1};\n  }\n\n  .circle:before {\n    position: absolute;\n    content: \"\";\n    height: 12px;\n    width: 12px;\n    left: 2px;\n    bottom: 2px;\n    background-color: white;\n    transition: all 80ms ease-in-out;\n    border-radius: 50%;\n  }\n\n  input:checked + .circle {\n    background-color: #2196f3;\n  }\n\n  input:checked + .circle:before {\n    transform: translateX(12px);\n  }\n`\n);\n\ntype Props = {|\n  disabled?: boolean,\n  isChecked: boolean,\n  onChange: () => void,\n|};\n\nexport default function Switch({ disabled, isChecked, onChange }: Props) {\n  return (\n    <SSwitch className=\"switch\" disabled={disabled}>\n      <input type=\"checkbox\" checked={isChecked} onChange={onChange} disabled={disabled} />\n      <span className=\"circle\" />\n    </SSwitch>\n  );\n}\n","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport React from \"react\";\nexport default ((_ref) => {\n  let {\n    styles = {}\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"styles\"]);\n\n  return React.createElement(\n    \"svg\",\n    _extends({ width: \"167\", height: \"162\", viewBox: \"0 0 167 162\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" }, props),\n    React.createElement(\"ellipse\", { cx: \"104.564\", cy: \"145.327\", rx: \"58.694\", ry: \"16.38\", fill: \"#242429\" }),\n    React.createElement(\"path\", { d: \"M16.2 5.82a4 4 0 0 1 4-4H36.25l6.398 8.046h49.452a6 6 0 0 1 6 6v5.064H16.2V5.82z\", fill: \"#36363D\" }),\n    React.createElement(\n      \"mask\",\n      { id: \"a\", fill: \"#fff\" },\n      React.createElement(\"path\", { d: \"M14.38 6a6 6 0 0 1 6-6h12.826a6 6 0 0 1 4.877 2.505l2.67 3.725a6 6 0 0 0 4.877 2.506H92.1a6 6 0 0 1 6 6v44.783a6 6 0 0 1-6 6H20.38a6 6 0 0 1-6-6V6z\" })\n    ),\n    React.createElement(\"path\", { d: \"M14.38 21.53H98.1v-2H14.38v2zM38.084 2.504L36.458 3.67l1.625-1.165zM92.1 63.52H20.381v4h71.718v-4zM20.381 2h12.825v-4H20.381v4zm16.077 1.67l2.669 3.725 3.251-2.33-2.669-3.724-3.251 2.33zm9.172 7.066H92.1v-4H45.63v4zM16.38 59.519v-38.99h-4v38.99h4zm0-38.99V6h-4v14.53h4zm79.72-5.793v5.793h3.999v-5.793h-4zm0 5.793v38.99h3.999v-38.99h-4zM39.126 7.395a8 8 0 0 0 6.503 3.34v-4a4 4 0 0 1-3.252-1.67l-3.251 2.33zM33.207 2a4 4 0 0 1 3.25 1.67l3.252-2.33A8 8 0 0 0 33.206-2v4zM20.38 63.519a4 4 0 0 1-4-4h-4a8 8 0 0 0 8 8v-4zm71.718 4a8 8 0 0 0 8-8h-4a4 4 0 0 1-4 4v4zm0-56.783a4 4 0 0 1 4 4h4a8 8 0 0 0-8-8v4zM20.381-2a8 8 0 0 0-8 8h4a4 4 0 0 1 4-4v-4z\", fill: \"#606066\", mask: \"url(#a)\" }),\n    React.createElement(\"circle\", { cx: \"98.649\", cy: \"77.989\", r: \"38.129\", fill: \"#19181C\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"circle\", { cx: \"98.649\", cy: \"77.989\", r: \"29.939\", fill: \"#2D2D33\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"rect\", { x: \"125.831\", y: \"113.941\", width: \"12.56\", height: \"43.173\", rx: \"6.28\", transform: \"rotate(-43.636 125.831 113.941)\", fill: \"#19181C\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"path\", { d: \"M127.615 103.532l5.185 5.185M123.844 107.303l5.185 5.185\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\n      \"mask\",\n      { id: \"b\", fill: \"#fff\" },\n      React.createElement(\"path\", { d: \"M13.499 89.226a3 3 0 0 1 3.92-1.828l18.742 7.238 5.13 13.009-8.891 26.026a3 3 0 0 1-3.838 1.859l-24.761-8.74a3 3 0 0 1-1.84-3.799l11.538-33.765z\" })\n    ),\n    React.createElement(\"path\", { d: \"M32.704 104.276l-.941-.338-.328.914.904.355.365-.931zm2.516-9.978l-3.457 9.64 1.882.675 3.458-9.64-1.883-.675zm-2.881 10.909l8.586 3.369.73-1.862-8.586-3.369-.73 1.862zm8.951 2.438l1.893.647.238-.696-.27-.685-1.86.734zm-5.129-13.01l1.861-.733-.322-.816-.818-.316-.72 1.866zM3.801 126.79l-.666 1.886.666-1.886zm24.761 8.74l.666-1.886-.666 1.886zm3.838-1.859l-1.893-.647 1.893.647zm-3.172-.027l-24.761-8.74-1.332 3.772 24.762 8.74 1.33-3.772zM3.853 123.638l11.538-33.765-3.785-1.294L.068 122.345l3.785 1.293zm35.545-16.64l-8.89 26.026 3.784 1.293 8.89-26.025-3.784-1.294zm-22.7-17.735l18.743 7.239 1.44-3.732-18.742-7.238-1.441 3.731zM34.3 95.37l5.129 13.01 3.72-1.468-5.128-13.009-3.721 1.467zM4.467 124.904a1 1 0 0 1-.614-1.266l-3.785-1.293a5 5 0 0 0 3.067 6.331l1.332-3.772zm23.43 12.512a5 5 0 0 0 6.395-3.099l-3.785-1.293a1 1 0 0 1-1.28.62l-1.33 3.772zM15.39 89.873a1 1 0 0 1 1.307-.61l1.44-3.731a5 5 0 0 0-6.532 3.047l3.785 1.294z\", fill: \"#606066\", mask: \"url(#b)\" }),\n    React.createElement(\"path\", { d: \"M14.937 105l17.004 5.905M12.969 110.668l17.003 5.905M11 116.336l17.004 5.905\", stroke: \"#606066\", strokeWidth: \"2\", strokeLinecap: \"round\" })\n  );\n});","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useCallback, useContext, useMemo } from \"react\";\n\nimport NamespaceMenu from \"./NamespaceMenu\";\nimport NodeName from \"./NodeName\";\nimport { TooltipRow, TooltipTable, type TreeUINode } from \"./renderTreeNodes\";\nimport { TREE_SPACING } from \"./TopicTree\";\nimport { SToggles, STreeNodeRow, SLeft, SRightActions, ICON_SIZE } from \"./TreeNodeRow\";\nimport type {\n  GetIsTreeNodeVisibleInTree,\n  OnNamespaceOverrideColorChange,\n  SetEditingNamespace,\n  TreeTopicNode,\n} from \"./types\";\nimport VisibilityToggle, { TOGGLE_WRAPPER_SIZE } from \"./VisibilityToggle\";\nimport { ThreeDimensionalVizContext } from \"webviz-core/src/panels/ThreeDimensionalViz/ThreeDimensionalVizContext\";\nimport { TopicTreeContext } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useTopicTree\";\nimport { $WEBVIZ_SOURCE_2, $TF } from \"webviz-core/src/util/globalConstants\";\nimport { useGuaranteedContext } from \"webviz-core/src/util/hooks\";\nimport { joinTopics } from \"webviz-core/src/util/topicUtils\";\n\nconst OUTER_LEFT_MARGIN = 12;\nconst INNER_LEFT_MARGIN = 8;\n\nexport type NamespaceNode = {|\n  availableByColumn: boolean[],\n  checkedByColumn: boolean[],\n  featureKey: string,\n  hasNamespaceOverrideColorChangedByColumn: boolean[],\n  key: string,\n  namespace: string,\n  overrideColorByColumn: ?((?string)[]),\n  visibleInSceneByColumn: boolean[],\n|};\n\ntype Props = {|\n  children: NamespaceNode[],\n  filterText: string,\n  getIsTreeNodeVisibleInTree: GetIsTreeNodeVisibleInTree,\n  hasFeatureColumn: boolean,\n  isXSWidth: boolean,\n  onNamespaceOverrideColorChange: OnNamespaceOverrideColorChange,\n  setEditingNamespace: SetEditingNamespace,\n  topicNode: TreeTopicNode,\n  width: number,\n  diffModeEnabled: boolean,\n|};\n\nfunction NamespaceNodeRow({\n  nodeKey,\n  featureKey,\n  hasNamespaceOverrideColorChangedByColumn,\n  namespace,\n  checkedByColumn,\n  availableByColumn,\n  overrideColorByColumn,\n  visibleInSceneByColumn,\n  rowWidth,\n  isXSWidth,\n  maxNodeNameLen,\n  filterText,\n  topicNodeAvailable,\n  unavailableTooltip,\n  hasFeatureColumn,\n  topicName,\n  onNamespaceOverrideColorChange,\n  setEditingNamespace,\n  diffModeEnabled,\n}: {\n  nodeKey: string,\n  featureKey: string,\n  hasNamespaceOverrideColorChangedByColumn: boolean[],\n  namespace: string,\n  availableByColumn: boolean[],\n  checkedByColumn: boolean[],\n  overrideColorByColumn: ?((?string)[]),\n  visibleInSceneByColumn: boolean[],\n  rowWidth: number,\n  isXSWidth: boolean,\n  maxNodeNameLen: number,\n  filterText: string,\n  topicNodeAvailable: boolean,\n  setEditingNamespace: SetEditingNamespace,\n  unavailableTooltip: string,\n  hasFeatureColumn: boolean,\n  topicName: string,\n  diffModeEnabled: boolean,\n  onNamespaceOverrideColorChange: OnNamespaceOverrideColorChange,\n}) {\n  const nodeVisibleInScene = !!(visibleInSceneByColumn[0] || visibleInSceneByColumn[1]);\n\n  const { setHoveredMarkerMatchers } = useContext(ThreeDimensionalVizContext);\n  const { toggleCheckAllAncestors, toggleNamespaceChecked } = useGuaranteedContext(\n    TopicTreeContext,\n    \"TopicTreeContext\"\n  );\n\n  const updateHoveredMarkerMatchers = useCallback((columnIndex, visible) => {\n    if (visible) {\n      const topic = [topicName, joinTopics($WEBVIZ_SOURCE_2, topicName)][columnIndex];\n      setHoveredMarkerMatchers([{ topic, checks: [{ markerKeyPath: [\"ns\"], value: namespace }] }]);\n    }\n  }, [namespace, setHoveredMarkerMatchers, topicName]);\n\n  const onMouseLeave = useCallback(() => setHoveredMarkerMatchers([]), [setHoveredMarkerMatchers]);\n  const mouseEventHandlersByColumnIdx = useMemo(() => {\n    return new Array(2).fill().map((topic, columnIndex) => ({\n      onMouseEnter: () => updateHoveredMarkerMatchers(columnIndex, true),\n      onMouseLeave,\n    }));\n  }, [updateHoveredMarkerMatchers, onMouseLeave]);\n\n  const onToggle = useCallback((columnIndex) => {\n    toggleNamespaceChecked({ topicName, namespace, columnIndex });\n    updateHoveredMarkerMatchers(columnIndex, !visibleInSceneByColumn[columnIndex]);\n  }, [toggleNamespaceChecked, topicName, namespace, updateHoveredMarkerMatchers, visibleInSceneByColumn]);\n  const onAltToggle = useCallback((columnIndex) => {\n    toggleCheckAllAncestors(nodeKey, columnIndex, topicName);\n    updateHoveredMarkerMatchers(columnIndex, !visibleInSceneByColumn[columnIndex]);\n  }, [toggleCheckAllAncestors, nodeKey, topicName, updateHoveredMarkerMatchers, visibleInSceneByColumn]);\n\n  return (\n    <STreeNodeRow\n      visibleInScene={nodeVisibleInScene}\n      style={{\n        width: rowWidth,\n        marginLeft: `-${OUTER_LEFT_MARGIN}px`,\n      }}>\n      <SLeft data-test={`ns~${namespace}`}>\n        <NodeName\n          isXSWidth={isXSWidth}\n          maxWidth={maxNodeNameLen}\n          displayName={namespace}\n          topicName={\"\"}\n          tooltips={[\n            <TooltipRow key={namespace}>\n              <TooltipTable>\n                <tbody>\n                  <tr>\n                    <th>Namespace:</th>\n                    <td>\n                      <tt>{namespace}</tt>\n                    </td>\n                  </tr>\n                </tbody>\n              </TooltipTable>\n            </TooltipRow>,\n          ]}\n          searchText={filterText}\n        />\n      </SLeft>\n      <SRightActions>\n        <SToggles>\n          {availableByColumn.map((available, columnIndex) => (\n            <VisibilityToggle\n              // Some namespaces are statically available. But we want to make sure the parent topic is also available\n              // before showing it as available.\n              available={topicNodeAvailable && available}\n              checked={checkedByColumn[columnIndex]}\n              dataTest={`visibility-toggle~${nodeKey}~column${columnIndex}`}\n              key={columnIndex}\n              onAltToggle={() => onAltToggle(columnIndex)}\n              onToggle={() => onToggle(columnIndex)}\n              overrideColor={overrideColorByColumn && overrideColorByColumn[columnIndex]}\n              size=\"SMALL\"\n              unavailableTooltip={unavailableTooltip}\n              visibleInScene={!!visibleInSceneByColumn[columnIndex]}\n              {...mouseEventHandlersByColumnIdx[columnIndex]}\n              diffModeEnabled={diffModeEnabled}\n              columnIndex={columnIndex}\n            />\n          ))}\n        </SToggles>\n        <NamespaceMenu\n          disableBaseColumn={!availableByColumn[0]}\n          disableFeatureColumn={!availableByColumn[1]}\n          featureKey={featureKey}\n          hasFeatureColumn={hasFeatureColumn && availableByColumn[1]}\n          hasNamespaceOverrideColorChangedByColumn={hasNamespaceOverrideColorChangedByColumn}\n          namespace={namespace}\n          nodeKey={nodeKey}\n          onNamespaceOverrideColorChange={onNamespaceOverrideColorChange}\n          overrideColorByColumn={overrideColorByColumn}\n          providerAvailable={topicNodeAvailable}\n          setEditingNamespace={setEditingNamespace}\n          topicName={topicName}\n        />\n      </SRightActions>\n    </STreeNodeRow>\n  );\n}\n\n// Must use function instead of React component as Tree/TreeNode can only accept TreeNode as children.\nexport default function renderNamespaceNodes({\n  children,\n  filterText,\n  getIsTreeNodeVisibleInTree,\n  hasFeatureColumn,\n  isXSWidth,\n  onNamespaceOverrideColorChange,\n  setEditingNamespace,\n  topicNode,\n  width,\n  diffModeEnabled,\n}: Props): TreeUINode[] {\n  const rowWidth = width - (isXSWidth ? 0 : TREE_SPACING * 2) - OUTER_LEFT_MARGIN;\n  const topicNodeAvailable = topicNode.availableByColumn[0] || topicNode.availableByColumn[1];\n  const togglesWidth = hasFeatureColumn ? TOGGLE_WRAPPER_SIZE * 2 : TOGGLE_WRAPPER_SIZE;\n  const rightActionWidth = topicNodeAvailable ? togglesWidth + ICON_SIZE : ICON_SIZE;\n  const maxNodeNameLen = rowWidth - rightActionWidth - INNER_LEFT_MARGIN * 2;\n\n  // TODO(Audrey): remove the special tooltip once we add 2nd bag support for map and tf namespaces.\n  const unavailableTooltip =\n    topicNode.topicName === $TF || topicNode.topicName === \"/metadata\" ? \"Unsupported\" : \"Unavailable\";\n\n  const commonRowProps = {\n    rowWidth,\n    isXSWidth,\n    maxNodeNameLen,\n    filterText,\n    topicNodeAvailable,\n    onNamespaceOverrideColorChange,\n    setEditingNamespace,\n    unavailableTooltip,\n    hasFeatureColumn,\n    topicName: topicNode.topicName,\n    diffModeEnabled,\n  };\n\n  return children\n    .filter(({ key }) => getIsTreeNodeVisibleInTree(key))\n    .map(\n      ({\n        key,\n        featureKey,\n        hasNamespaceOverrideColorChangedByColumn,\n        namespace,\n        checkedByColumn,\n        availableByColumn,\n        overrideColorByColumn,\n        visibleInSceneByColumn,\n      }) => {\n        const title = (\n          <NamespaceNodeRow\n            {...{\n              featureKey,\n              hasNamespaceOverrideColorChangedByColumn,\n              namespace,\n              checkedByColumn,\n              availableByColumn,\n              overrideColorByColumn,\n              visibleInSceneByColumn,\n              nodeKey: key,\n              ...commonRowProps,\n            }}\n          />\n        );\n        return { key, title };\n      }\n    );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport DotsVerticalIcon from \"@mdi/svg/svg/dots-vertical.svg\";\nimport UndoVariantIcon from \"@mdi/svg/svg/undo-variant.svg\";\nimport React, { useCallback, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { ROW_HEIGHT, SDotMenuPlaceholder } from \"./TreeNodeRow\";\nimport type { OnNamespaceOverrideColorChange, SetEditingNamespace } from \"./types\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport KeyboardShortcut from \"webviz-core/src/components/KeyboardShortcut\";\nimport Menu, { Item } from \"webviz-core/src/components/Menu\";\nimport {\n  getHexFromColorSettingWithDefault,\n  PICKER_SIZE,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/ColorPickerForTopicSettings\";\nimport { TopicTreeContext } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useTopicTree\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { useGuaranteedContext } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst DISABLED_STYLE = { cursor: \"not-allowed\", color: colors.TEXT_MUTED };\nconst ICON_SIZE = 18; // The width of the small icon.\nconst COLOR_PIKCER_ICON_SPACING = 4;\nexport const DOT_MENU_WIDTH = ICON_SIZE; // The width of the small icon.\nconst COLOR_PICKER_SIZE = PICKER_SIZE.SMALL.size;\nconst COLOR_PICKER_AND_ICON_WIDTH = COLOR_PICKER_SIZE + ICON_SIZE + COLOR_PIKCER_ICON_SPACING;\n\nconst SItemContent = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\nconst SColorPickerWrapper = styled.span`\n  display: inline-flex;\n  align-items: center;\n`;\n\nconst SColorTrigger = styled.span`\n  display: inline-block;\n  cursor: pointer;\n  background: ${({ hexColor }) => hexColor};\n  width: ${PICKER_SIZE.SMALL.size}px;\n  height: ${PICKER_SIZE.SMALL.size}px;\n  border-radius: ${PICKER_SIZE.SMALL.size / 2}px;\n`;\n\ntype Props = {|\n  disableBaseColumn: boolean,\n  disableFeatureColumn: boolean,\n  featureKey: string,\n  hasFeatureColumn: boolean,\n  hasNamespaceOverrideColorChangedByColumn: boolean[],\n  namespace: string,\n  nodeKey: string,\n  onNamespaceOverrideColorChange: OnNamespaceOverrideColorChange,\n  overrideColorByColumn: ?((?string)[]),\n  providerAvailable: boolean,\n  setEditingNamespace: SetEditingNamespace,\n  topicName: string,\n|};\n\nconst overrideColorChangedIconStyle = {\n  color: colors.HIGHLIGHT,\n  marginLeft: COLOR_PIKCER_ICON_SPACING,\n  height: ROW_HEIGHT,\n  display: \"inline-flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n};\n\nexport default function NamespaceMenu({\n  disableBaseColumn,\n  disableFeatureColumn,\n  featureKey,\n  hasFeatureColumn,\n  hasNamespaceOverrideColorChangedByColumn,\n  namespace,\n  nodeKey,\n  onNamespaceOverrideColorChange,\n  overrideColorByColumn,\n  providerAvailable,\n  setEditingNamespace,\n  topicName,\n}: Props) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const onToggle = useCallback(() => {\n    setIsOpen((prevIsOpen) => !prevIsOpen);\n  }, []);\n\n  // Render with extra space for the reset icon if any column has the override color.\n  const showResetOverrideColor =\n    hasNamespaceOverrideColorChangedByColumn[0] || hasNamespaceOverrideColorChangedByColumn[1];\n  const colorPickerWrapperStyle = showResetOverrideColor ? { width: COLOR_PICKER_AND_ICON_WIDTH } : {};\n\n  const { toggleCheckAllAncestors } = useGuaranteedContext(TopicTreeContext, \"TopicTreeContext\");\n  // Don't render the dot menu if the datasources are unavailable.\n  if (!providerAvailable) {\n    return <SDotMenuPlaceholder />;\n  }\n\n  return (\n    <ChildToggle\n      position=\"below\"\n      isOpen={isOpen}\n      onToggle={onToggle}\n      dataTest={`namespace-row-menu~${topicName}~${namespace}`}>\n      <Icon\n        small\n        fade\n        onClick={onToggle}\n        style={{\n          padding: \"4px 0px\",\n          height: ROW_HEIGHT,\n          display: \"inline-flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}>\n        <DotsVerticalIcon />\n      </Icon>\n      <Menu>\n        {providerAvailable && (\n          <>\n            <Item\n              style={{ padding: \"0 12px\", ...(disableBaseColumn ? DISABLED_STYLE : undefined) }}\n              onClick={() => {\n                if (disableBaseColumn) {\n                  return;\n                }\n                toggleCheckAllAncestors(nodeKey, 0, topicName);\n                setIsOpen(false);\n              }}>\n              <SItemContent>\n                <span style={{ paddingRight: 8 }}>Toggle ancestors</span>\n                <KeyboardShortcut keys={[\"Alt\", \"Enter\"]} />\n              </SItemContent>\n            </Item>\n            {hasFeatureColumn && (\n              <Item\n                style={disableFeatureColumn ? DISABLED_STYLE : {}}\n                onClick={() => {\n                  if (disableFeatureColumn) {\n                    return;\n                  }\n                  toggleCheckAllAncestors(nodeKey, 1, topicName);\n                  setIsOpen(false);\n                }}>\n                Toggle feature ancestors\n              </Item>\n            )}\n            {overrideColorByColumn && (\n              <>\n                <Item\n                  onClick={() =>\n                    setEditingNamespace({ namespaceColor: overrideColorByColumn[0], namespaceKey: nodeKey })\n                  }\n                  style={{ padding: \"0 12px\", height: 28, ...(disableBaseColumn ? DISABLED_STYLE : undefined) }}>\n                  <SItemContent>\n                    <span style={{ paddingRight: 8 }}>Marker color</span>\n                    <SColorPickerWrapper style={colorPickerWrapperStyle}>\n                      <SColorTrigger hexColor={getHexFromColorSettingWithDefault(overrideColorByColumn[0])} />\n                      {hasNamespaceOverrideColorChangedByColumn && hasNamespaceOverrideColorChangedByColumn[0] && (\n                        <Icon\n                          dataTest=\"reset-override-color-icon\"\n                          small\n                          fade\n                          tooltipProps={{ placement: \"top\", contents: \"Reset to default\" }}\n                          onClick={() => onNamespaceOverrideColorChange(undefined, nodeKey)}\n                          style={overrideColorChangedIconStyle}>\n                          <UndoVariantIcon />\n                        </Icon>\n                      )}\n                    </SColorPickerWrapper>\n                  </SItemContent>\n                </Item>\n                {hasFeatureColumn && (\n                  <Item\n                    onClick={() =>\n                      setEditingNamespace({ namespaceColor: overrideColorByColumn[1], namespaceKey: featureKey })\n                    }\n                    style={{ padding: \"0 12px\", height: 28, ...(disableBaseColumn ? DISABLED_STYLE : undefined) }}>\n                    <SItemContent>\n                      <span style={{ paddingRight: 8 }}>Feature marker color</span>\n                      <SColorPickerWrapper style={colorPickerWrapperStyle}>\n                        <SColorTrigger hexColor={getHexFromColorSettingWithDefault(overrideColorByColumn[1])} />\n                        {hasNamespaceOverrideColorChangedByColumn && hasNamespaceOverrideColorChangedByColumn[1] && (\n                          <Icon\n                            dataTest=\"reset-override-color-icon\"\n                            small\n                            fade\n                            tooltipProps={{ placement: \"top\", contents: \"Reset color to default.\" }}\n                            onClick={() => onNamespaceOverrideColorChange(undefined, featureKey)}\n                            style={overrideColorChangedIconStyle}>\n                            <UndoVariantIcon />\n                          </Icon>\n                        )}\n                      </SColorPickerWrapper>\n                    </SItemContent>\n                  </Item>\n                )}\n              </>\n            )}\n          </>\n        )}\n        <Item\n          onClick={() => {\n            clipboard.copy(namespace);\n            setIsOpen(false);\n          }}>\n          Copy name\n        </Item>\n      </Menu>\n    </ChildToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport Highlighter from \"react-highlight-words\";\nimport styled from \"styled-components\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst HIGHLIGHT_CLASSNAME = \"rc-TextHighlight-highlight\";\nconst STextHighlight = styled.span`\n  .${HIGHLIGHT_CLASSNAME} {\n    color: ${colors.BLUE};\n    background: none;\n    padding: 0;\n  }\n`;\n\ntype Props = {|\n  targetStr: string,\n  searchText?: string,\n|};\n\nexport default function TextHighlight({ targetStr = \"\", searchText = \"\" }: Props) {\n  if (!searchText) {\n    return targetStr;\n  }\n\n  return (\n    <STextHighlight>\n      <Highlighter\n        autoEscape\n        highlightClassName={HIGHLIGHT_CLASSNAME}\n        searchWords={[searchText]}\n        textToHighlight={targetStr}\n      />\n    </STextHighlight>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\n\nexport const DEFAULT_END_TEXT_LENGTH = 16;\n\nexport const STextMiddleTruncate = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n`;\n\nconst SStart = styled.div`\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex-shrink: 1;\n`;\n\nconst SEnd = styled.div`\n  white-space: nowrap;\n  flex-basis: content;\n  flex-grow: 0;\n  flex-shrink: 0;\n  max-width: 100%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\ntype Props = {|\n  tooltips?: React.Node[],\n  text: string,\n  endTextLength?: number,\n  style?: { [attr: string]: string | number },\n  testShowTooltip?: boolean,\n|};\n\nexport default function TextMiddleTruncate({ tooltips, text, endTextLength, style, testShowTooltip }: Props) {\n  const startTextLen = Math.max(0, text.length - (endTextLength || DEFAULT_END_TEXT_LENGTH));\n  const startText = text.substr(0, startTextLen);\n  const endText = text.substr(startTextLen);\n\n  const elem = (\n    <STextMiddleTruncate style={style}>\n      <SStart>{startText}</SStart>\n      <SEnd>{endText}</SEnd>\n    </STextMiddleTruncate>\n  );\n  return tooltips ? (\n    <Tooltip contents={tooltips} placement=\"top\" defaultShown={testShowTooltip}>\n      {elem}\n    </Tooltip>\n  ) : (\n    elem\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport DotsVerticalIcon from \"@mdi/svg/svg/dots-vertical.svg\";\nimport React, { useCallback, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { ROW_HEIGHT } from \"./TreeNodeRow\";\nimport type { SetCurrentEditingTopic } from \"./types\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport KeyboardShortcut from \"webviz-core/src/components/KeyboardShortcut\";\nimport Menu, { Item } from \"webviz-core/src/components/Menu\";\nimport { TopicTreeContext } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useTopicTree\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { useGuaranteedContext } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst DISABLED_STYLE = { cursor: \"not-allowed\", color: colors.TEXT_MUTED };\n\nconst SItemContent = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\ntype Props = {|\n  datatype?: string,\n  disableBaseColumn: boolean,\n  disableFeatureColumn: boolean,\n  hasFeatureColumn: boolean,\n  nodeKey: string,\n  providerAvailable: boolean,\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  topicName: string,\n|};\n\nexport const DOT_MENU_WIDTH = 18; // The width of the small icon.\n\nexport default function TreeNodeMenu({\n  datatype,\n  disableBaseColumn,\n  disableFeatureColumn,\n  hasFeatureColumn,\n  nodeKey,\n  providerAvailable,\n  setCurrentEditingTopic,\n  topicName,\n}: Props) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const { toggleCheckAllAncestors, toggleCheckAllDescendants } = useGuaranteedContext(\n    TopicTreeContext,\n    \"TopicTreeContext\"\n  );\n  const onToggle = useCallback(() => setIsOpen((prevIsOpen) => !prevIsOpen), []);\n\n  // Don't render the dot menu if the datasources are unavailable and the node is group node (topic node has option to copy topicName).\n  if (!providerAvailable && !topicName) {\n    return null;\n  }\n  return (\n    <ChildToggle position=\"below\" isOpen={isOpen} onToggle={onToggle} dataTest={`topic-row-menu-${topicName}`}>\n      <Icon\n        small\n        fade\n        onClick={onToggle}\n        style={{\n          padding: \"4px 0px\",\n          height: ROW_HEIGHT,\n          display: \"inline-flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}>\n        <DotsVerticalIcon />\n      </Icon>\n      <Menu>\n        {providerAvailable && (\n          <>\n            <Item\n              style={{ padding: \"0 12px\", ...(disableBaseColumn ? DISABLED_STYLE : undefined) }}\n              onClick={() => {\n                if (disableBaseColumn) {\n                  return;\n                }\n                toggleCheckAllAncestors(nodeKey, 0);\n                setIsOpen(false);\n              }}>\n              <SItemContent>\n                <span style={{ paddingRight: 8 }}>Toggle ancestors</span>\n                <KeyboardShortcut keys={[\"Alt\", \"Enter\"]} />\n              </SItemContent>\n            </Item>\n            <Item\n              style={{ padding: \"0 12px\", ...(disableBaseColumn ? DISABLED_STYLE : undefined) }}\n              onClick={() => {\n                if (disableBaseColumn) {\n                  return;\n                }\n                toggleCheckAllDescendants(nodeKey, 0);\n                setIsOpen(false);\n              }}>\n              <SItemContent>\n                <span style={{ paddingRight: 8 }}>Toggle descendants</span>\n                <KeyboardShortcut keys={[\"Shift\", \"Enter\"]} />\n              </SItemContent>\n            </Item>\n            {hasFeatureColumn && (\n              <>\n                <Item\n                  style={disableFeatureColumn ? DISABLED_STYLE : {}}\n                  onClick={() => {\n                    if (disableFeatureColumn) {\n                      return;\n                    }\n                    toggleCheckAllAncestors(nodeKey, 1);\n                    setIsOpen(false);\n                  }}>\n                  Toggle feature ancestors\n                </Item>\n                <Item\n                  style={disableFeatureColumn ? DISABLED_STYLE : {}}\n                  onClick={() => {\n                    if (disableFeatureColumn) {\n                      return;\n                    }\n                    toggleCheckAllDescendants(nodeKey, 1);\n                    setIsOpen(false);\n                  }}>\n                  Toggle feature descendants\n                </Item>\n              </>\n            )}\n          </>\n        )}\n        {topicName && (\n          <Item\n            onClick={() => {\n              clipboard.copy(topicName);\n              setIsOpen(false);\n            }}>\n            Copy topic name\n          </Item>\n        )}\n        {datatype && (\n          <Item\n            dataTest={`topic-row-menu-edit-settings-${topicName}`}\n            onClick={() => {\n              setCurrentEditingTopic({ name: topicName, datatype });\n              setIsOpen(false);\n            }}>\n            Edit topic settings\n          </Item>\n        )}\n      </Menu>\n    </ChildToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport DotsVerticalIcon from \"@mdi/svg/svg/dots-vertical.svg\";\nimport EarthIcon from \"@mdi/svg/svg/earth.svg\";\nimport { groupBy, defaults } from \"lodash\";\nimport React, { useCallback, useContext, useMemo, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { TREE_SPACING } from \"./TopicTree\";\nimport { ROW_HEIGHT, SLeft, SRightActions, SToggles, STreeNodeRow } from \"./TreeNodeRow\";\nimport VisibilityToggle from \"./VisibilityToggle\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Menu, { Item } from \"webviz-core/src/components/Menu\";\nimport Modal from \"webviz-core/src/components/Modal\";\nimport { RenderToBodyPortal } from \"webviz-core/src/components/renderToBody\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { getDefaultColorOverrideBySourceIdx } from \"webviz-core/src/panels/ThreeDimensionalViz/GlobalVariableStyles\";\nimport type { LinkedGlobalVariable } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport { ThreeDimensionalVizContext } from \"webviz-core/src/panels/ThreeDimensionalViz/ThreeDimensionalVizContext\";\nimport {\n  ColorPickerSettingsPanel,\n  PICKER_SIZE,\n  getHexFromColorSettingWithDefault,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/ColorPickerForTopicSettings\";\nimport {\n  type TreeUINode,\n  TooltipRow,\n  TooltipTable,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/renderTreeNodes\";\nimport type { Color } from \"webviz-core/src/types/Messages\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\nimport { joinTopics } from \"webviz-core/src/util/topicUtils\";\n\n// TODO: Dedupe from renderNamespaceNodes\nconst OUTER_LEFT_MARGIN = 12;\n\nexport const SDisplayName = styled.div`\n  font-size: 13px;\n  line-height: 1.4;\n  margin: 0 4px;\n  word-break: break-word;\n  /* disallow selection to prevent shift + click from accidentally select */\n  user-select: none;\n  width: 100%;\n`;\n\nexport function renderStyleExpressionNodes({\n  width,\n  isXSWidth,\n  topicName,\n  hasFeatureColumn,\n  linkedGlobalVariablesByTopic,\n  visible,\n}: {\n  hasFeatureColumn: boolean,\n  isXSWidth: boolean,\n  linkedGlobalVariablesByTopic: { [string]: LinkedGlobalVariable[] },\n  topicName: string,\n  width: number,\n  visible: boolean,\n}): TreeUINode[] {\n  const rowWidth = width - (isXSWidth ? 0 : TREE_SPACING * 2) - OUTER_LEFT_MARGIN;\n  const linkedGlobalVariablesByVariableName = groupBy(\n    linkedGlobalVariablesByTopic[topicName] || [],\n    ({ name }) => name\n  );\n  return Object.keys(linkedGlobalVariablesByVariableName).map((variableName, rowIndex) => {\n    const title = (\n      <StyleExpressionNode\n        linkedGlobalVariables={linkedGlobalVariablesByVariableName[variableName]}\n        topic={topicName}\n        hasFeatureColumn={hasFeatureColumn}\n        rowWidth={rowWidth}\n        rowIndex={rowIndex}\n        variableName={variableName}\n        visible={visible}\n      />\n    );\n    return { key: `${topicName}~${variableName}`, title };\n  });\n}\n\nconst SItemContent = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\nconst SColorPickerWrapper = styled.span`\n  display: inline-flex;\n  align-items: center;\n`;\n\nconst SColorTrigger = styled.span`\n  display: inline-block;\n  cursor: pointer;\n  background: ${({ hexColor }) => hexColor};\n  width: ${PICKER_SIZE.SMALL.size}px;\n  height: ${PICKER_SIZE.SMALL.size}px;\n  border-radius: ${PICKER_SIZE.SMALL.size / 2}px;\n`;\n\nfunction StyleExpressionNode(props) {\n  const { topic, rowWidth, rowIndex, hasFeatureColumn, linkedGlobalVariables, visible } = props;\n  const [isOpen, setIsOpen] = useState(false);\n  const [editingColorForSourceIdx, setEditingColorForSourceIdx] = useState(false);\n\n  const {\n    colorOverrideBySourceIdxByVariable,\n    setColorOverrideBySourceIdxByVariable,\n    setHoveredMarkerMatchers,\n  } = useContext(ThreeDimensionalVizContext);\n\n  const { globalVariables } = useGlobalVariables();\n  const { markerKeyPath, name } = linkedGlobalVariables[0];\n\n  const value = globalVariables[name];\n  const colorOverridesByColumnIdx = defaults(\n    [],\n    colorOverrideBySourceIdxByVariable[name],\n    getDefaultColorOverrideBySourceIdx(rowIndex)\n  );\n  const activeRowActive = colorOverridesByColumnIdx.some((colorOverride) => colorOverride?.active);\n\n  // Callbacks\n  const onToggleMenu = useCallback(() => setIsOpen((prevIsOpen) => !prevIsOpen), []);\n  const updateSettingsForGlobalVariable = useCallback((\n    globalVariableName,\n    settings: { active: boolean, color: Color },\n    sourceIdx = 0\n  ) => {\n    const updatedSettings = new Array(2)\n      .fill()\n      .map((_, i) => colorOverrideBySourceIdxByVariable[globalVariableName]?.[i]);\n    updatedSettings[sourceIdx] = settings;\n    setColorOverrideBySourceIdxByVariable({\n      ...colorOverrideBySourceIdxByVariable,\n      [globalVariableName]: updatedSettings,\n    });\n  }, [colorOverrideBySourceIdxByVariable, setColorOverrideBySourceIdxByVariable]);\n\n  // Mouse-hover handlers\n  const onMouseLeave = useCallback(() => setHoveredMarkerMatchers([]), [setHoveredMarkerMatchers]);\n  const mouseEventHandlersByColumnIdx = useMemo(() => {\n    const topicNameByColumnIdx = [topic, joinTopics($WEBVIZ_SOURCE_2, topic)];\n    return topicNameByColumnIdx.map((_topic) => ({\n      onMouseEnter: () => setHoveredMarkerMatchers([{ topic: _topic, checks: [{ markerKeyPath, value }] }]),\n      onMouseLeave,\n    }));\n  }, [markerKeyPath, onMouseLeave, setHoveredMarkerMatchers, topic, value]);\n\n  const tooltipContent = (\n    <TooltipRow>\n      <TooltipTable>\n        <tbody>\n          <tr>\n            <th>Topic:</th>\n            <td>\n              <tt>{topic}</tt>\n            </td>\n          </tr>\n          <tr>\n            <th>Expression:</th>\n            <td>\n              <tt>\n                .{markerKeyPath.join(\".\")} == {value}\n              </tt>\n            </td>\n          </tr>\n        </tbody>\n      </TooltipTable>\n    </TooltipRow>\n  );\n\n  return (\n    <STreeNodeRow\n      visibleInScene={activeRowActive && visible}\n      style={{\n        width: rowWidth,\n        marginLeft: `-${OUTER_LEFT_MARGIN}px`,\n      }}>\n      <SLeft data-test={`ns~${name}`}>\n        <Icon style={{ color: \"rgba(255,255,255, 0.3)\" }}>\n          <EarthIcon style={{ width: 16, height: 16 }} />\n        </Icon>\n        <Tooltip contents={tooltipContent} placement=\"top\">\n          <SDisplayName>\n            .{markerKeyPath.join(\".\")} == ${name}\n          </SDisplayName>\n        </Tooltip>\n      </SLeft>\n      <SRightActions>\n        {colorOverridesByColumnIdx && (\n          <SToggles>\n            {filterMap(colorOverridesByColumnIdx, (override, sourceIdx) => {\n              if (!hasFeatureColumn && sourceIdx === 1) {\n                return null;\n              }\n              const { active, color } = override || { active: false, color: null };\n              return (\n                <VisibilityToggle\n                  available={true}\n                  checked={active}\n                  dataTest={`visibility-toggle T:${topic} ${name} ${sourceIdx}`}\n                  key={sourceIdx}\n                  onAltToggle={() => updateSettingsForGlobalVariable(name, { active: !active, color }, sourceIdx)}\n                  onToggle={() => updateSettingsForGlobalVariable(name, { active: !active, color }, sourceIdx)}\n                  overrideColor={color}\n                  size=\"SMALL\"\n                  unavailableTooltip={\"\"}\n                  visibleInScene={visible && active}\n                  diffModeEnabled={false}\n                  columnIndex={sourceIdx}\n                  {...mouseEventHandlersByColumnIdx[sourceIdx]}\n                />\n              );\n            })}\n          </SToggles>\n        )}\n        <ChildToggle position=\"below\" isOpen={isOpen} onToggle={onToggleMenu} dataTest={`topic-row-menu-${topic}`}>\n          <Icon\n            small\n            fade\n            onClick={onToggleMenu}\n            style={{\n              padding: \"4px 0px\",\n              height: ROW_HEIGHT,\n              display: \"inline-flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n            }}>\n            <DotsVerticalIcon />\n          </Icon>\n          <Menu>\n            <Item onClick={() => setEditingColorForSourceIdx(0)} style={{ padding: \"0 12px\", height: 28 }}>\n              <SItemContent>\n                <span style={{ paddingRight: 8 }}>Marker color</span>\n                <SColorPickerWrapper>\n                  <SColorTrigger hexColor={getHexFromColorSettingWithDefault(colorOverridesByColumnIdx[0]?.color)} />\n                </SColorPickerWrapper>\n                {editingColorForSourceIdx === 0 && (\n                  <ColorPickerOverlay\n                    color={colorOverridesByColumnIdx[0]?.color}\n                    onChangeColor={(color) => {\n                      updateSettingsForGlobalVariable(name, { color, active: colorOverridesByColumnIdx[0].active }, 0);\n                    }}\n                    onRequestClose={() => setEditingColorForSourceIdx(-1)}\n                  />\n                )}\n              </SItemContent>\n            </Item>\n            {hasFeatureColumn && (\n              <Item onClick={() => setEditingColorForSourceIdx(1)} style={{ padding: \"0 12px\", height: 28 }}>\n                <SItemContent>\n                  <span style={{ paddingRight: 8 }}>Feature marker color</span>\n                  <SColorPickerWrapper>\n                    <SColorTrigger hexColor={getHexFromColorSettingWithDefault(colorOverridesByColumnIdx[1]?.color)} />\n                  </SColorPickerWrapper>\n                  {editingColorForSourceIdx === 1 && (\n                    <ColorPickerOverlay\n                      color={colorOverridesByColumnIdx[1]?.color}\n                      onChangeColor={(color) => {\n                        const active = colorOverridesByColumnIdx[1].active;\n                        updateSettingsForGlobalVariable(name, { color, active }, 1);\n                      }}\n                      onRequestClose={() => setEditingColorForSourceIdx(-1)}\n                    />\n                  )}\n                </SItemContent>\n              </Item>\n            )}\n          </Menu>\n        </ChildToggle>\n      </SRightActions>\n    </STreeNodeRow>\n  );\n}\n\nfunction ColorPickerOverlay({\n  onChangeColor,\n  onRequestClose,\n  color,\n}: {\n  color: Color,\n  onChangeColor: (color: Color) => void,\n  onRequestClose: () => void,\n}) {\n  return (\n    <RenderToBodyPortal>\n      <Modal\n        onRequestClose={onRequestClose}\n        contentStyle={{\n          maxHeight: \"calc(100vh - 200px)\",\n          maxWidth: 480,\n          display: \"flex\",\n          flexDirection: \"column\",\n        }}>\n        <ColorPickerSettingsPanel color={color} onChange={onChangeColor} />\n      </Modal>\n    </RenderToBodyPortal>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport EarthIcon from \"@mdi/svg/svg/earth.svg\";\nimport { defaults, groupBy, noop } from \"lodash\";\nimport React, { useCallback } from \"react\";\nimport styled from \"styled-components\";\nimport tinyColor from \"tinycolor2\";\n\nimport Checkbox from \"webviz-core/src/components/Checkbox\";\nimport ExpandingToolbar, { ToolGroup, ToolGroupFixedSizePane } from \"webviz-core/src/components/ExpandingToolbar\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { JSONInput } from \"webviz-core/src/components/input/JSONInput\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport useLinkedGlobalVariables from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport type {\n  ColorOverride,\n  ColorOverrideBySourceIdxByVariable,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport ColorPickerForTopicSettings, {\n  PICKER_SIZE,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/ColorPickerForTopicSettings\";\nimport type { Color } from \"webviz-core/src/types/Messages\";\nimport { hexToColorObj } from \"webviz-core/src/util/colorUtils\";\nimport { lineColors } from \"webviz-core/src/util/plotColors\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SRow = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 2px 8px;\n\n  &:hover {\n    background-color: ${colors.DARK4};\n  }\n`;\n\nexport const SInput = styled.div`\n  input {\n    background: none !important;\n    color: inherit;\n    width: 100%;\n    padding-left: 0;\n    padding-right: 0;\n    min-width: 40px;\n    text-align: right;\n  }\n`;\n\nexport const SColorPicker = styled.div`\n  margin-left: 8px;\n  white-space: nowrap;\n\n  > * {\n    margin-left: 4px;\n  }\n`;\n\nexport const SName = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  user-select: none;\n  align-items: center;\n`;\n\nexport function getDefaultColorOverrideBySourceIdx(defaultColorIndex: number): ColorOverride[] {\n  return [\n    {\n      active: false,\n      color: hexToColorObj(lineColors[defaultColorIndex % lineColors.length], 1),\n    },\n    {\n      active: false,\n      color: hexToColorObj(\n        tinyColor(lineColors[defaultColorIndex % lineColors.length])\n          .spin(90) // We change the default color a bit for the second bag. Spin(90) seemed to produce nice results\n          .toHexString(),\n        1 // Alpha: 1\n      ),\n    },\n  ];\n}\n\nexport const TAB_TYPE_VARIABLES = \"Global Variables\";\nexport type TabType = typeof TAB_TYPE_VARIABLES;\n\ntype Props = {\n  defaultSelectedTab?: ?TabType, // for UI testing\n  colorOverrideBySourceIdxByVariable: ColorOverrideBySourceIdxByVariable,\n  setColorOverrideBySourceIdxByVariable: (ColorOverrideBySourceIdxByVariable) => void,\n};\n\nexport default function GlobalVariableStyles(props: Props) {\n  const { defaultSelectedTab, colorOverrideBySourceIdxByVariable = {}, setColorOverrideBySourceIdxByVariable } = props;\n  const [selectedTab, setSelectedTab] = React.useState<any>(defaultSelectedTab);\n\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  const linkedGlobalVariablesByName = groupBy(linkedGlobalVariables, ({ name }) => name);\n\n  const updateSettingsForGlobalVariable = useCallback((\n    globalVariableName,\n    settings: { active: boolean, color: Color },\n    sourceIdx = 0\n  ) => {\n    const updatedSettings = new Array(2)\n      .fill()\n      .map((_, i) => colorOverrideBySourceIdxByVariable[globalVariableName]?.[i]);\n    updatedSettings[sourceIdx] = settings;\n    setColorOverrideBySourceIdxByVariable({\n      ...colorOverrideBySourceIdxByVariable,\n      [globalVariableName]: updatedSettings,\n    });\n  }, [colorOverrideBySourceIdxByVariable, setColorOverrideBySourceIdxByVariable]);\n\n  return (\n    <ExpandingToolbar\n      tooltip=\"Global Variables\"\n      style={{ padding: 0 }}\n      icon={\n        <Icon style={{ color: \"white\" }}>\n          <EarthIcon />\n        </Icon>\n      }\n      className={styles.buttons}\n      selectedTab={selectedTab}\n      onSelectTab={setSelectedTab}>\n      <ToolGroup name={TAB_TYPE_VARIABLES}>\n        <ToolGroupFixedSizePane>\n          {Object.keys(linkedGlobalVariablesByName).map((name, i) => (\n            <GlobalVariableStylesRow\n              key={name}\n              name={name}\n              rowIndex={i}\n              overrides={defaults([], colorOverrideBySourceIdxByVariable[name], getDefaultColorOverrideBySourceIdx(i))}\n              linkedGlobalVariablesForRow={linkedGlobalVariablesByName[name]}\n              updateSettingsForGlobalVariable={updateSettingsForGlobalVariable}\n            />\n          ))}\n        </ToolGroupFixedSizePane>\n      </ToolGroup>\n    </ExpandingToolbar>\n  );\n}\n\nfunction GlobalVariableStylesRow({\n  name,\n  overrides,\n  linkedGlobalVariablesForRow,\n  updateSettingsForGlobalVariable,\n}: {\n  name: string,\n  rowIndex: number,\n  overrides: ColorOverride[],\n  linkedGlobalVariablesForRow: any,\n  updateSettingsForGlobalVariable: (string, settings: ColorOverride, number) => void,\n}) {\n  const { globalVariables } = useGlobalVariables();\n  const value = globalVariables[name];\n\n  const { topic, markerKeyPath } = linkedGlobalVariablesForRow[0];\n  const tooltip = `${topic}.${markerKeyPath.join(\".\")} ${\n    linkedGlobalVariablesForRow.length > 1 ? `and ${linkedGlobalVariablesForRow.length - 1} more...` : \"\"\n  }`;\n\n  return (\n    <Tooltip contents={tooltip} placement=\"top\" key={name}>\n      <SRow>\n        <Checkbox\n          label={\"\"}\n          checked={overrides[0]?.active}\n          dataTest={`GlobalVariableStylesRow ${name}`}\n          onChange={(_active) =>\n            updateSettingsForGlobalVariable(name, { active: _active, color: overrides[0]?.color }, 0)\n          }\n        />\n        <Checkbox\n          label={\"\"}\n          checked={overrides[1]?.active}\n          dataTest={`GlobalVariableStylesRow ${name}`}\n          onChange={(_active) =>\n            updateSettingsForGlobalVariable(name, { active: _active, color: overrides[1]?.color }, 1)\n          }\n        />\n        <SName>{name}</SName>\n        <SInput>\n          <JSONInput value={JSON.stringify(value ?? \"\")} onChange={noop} />\n        </SInput>\n        <SColorPicker>\n          <ColorPickerForTopicSettings\n            size={PICKER_SIZE.SMALL.name}\n            color={overrides[0]?.color}\n            onChange={(_color) =>\n              updateSettingsForGlobalVariable(name, { color: _color, active: overrides[0]?.active }, 0)\n            }\n          />\n          <ColorPickerForTopicSettings\n            size={PICKER_SIZE.SMALL.name}\n            color={overrides[1]?.color}\n            onChange={(_color) =>\n              updateSettingsForGlobalVariable(name, { color: _color, active: overrides[1]?.active }, 1)\n            }\n          />\n        </SColorPicker>\n      </SRow>\n    </Tooltip>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LayersIcon from \"@mdi/svg/svg/layers.svg\";\nimport PinIcon from \"@mdi/svg/svg/pin.svg\";\nimport React, { useCallback } from \"react\";\nimport styled from \"styled-components\";\n\nimport { type Save3DConfig } from \"../index\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport KeyboardShortcut from \"webviz-core/src/components/KeyboardShortcut\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SWITCHER_HEIGHT = 30;\nconst STopicTreeSwitcher = styled.div`\n  width: 28px;\n  display: flex;\n  height: ${SWITCHER_HEIGHT}px;\n  position: relative;\n\n  // We have to re-enable pointer-events here because they are disabled in STopicTreeWrapper\n  pointer-events: auto;\n`;\n\nconst SErrorsBadge = styled.div`\n  position: absolute;\n  top: -4px;\n  left: 24px;\n  width: 10px;\n  height: 10px;\n  border-radius: 5px;\n  background-color: ${colors.RED};\n`;\n\n/* TODO(Audrey): stay consistent with other buttons in the 3D panel, will consolidate later. */\nconst SIconWrapper = styled.div`\n  width: 28px;\n  border-radius: 4px;\n  padding: 4px;\n  position: absolute;\n  top: 0;\n  left: 0;\n`;\n\ntype Props = {|\n  pinTopics: boolean,\n  renderTopicTree: boolean,\n  saveConfig: Save3DConfig,\n  setShowTopicTree: (boolean | ((boolean) => boolean)) => void,\n  showErrorBadge: boolean,\n|};\n\nexport default function TopicTreeSwitcher({\n  pinTopics,\n  renderTopicTree,\n  saveConfig,\n  setShowTopicTree,\n  showErrorBadge,\n}: Props) {\n  const onClick = useCallback(() => setShowTopicTree((shown) => !shown), [setShowTopicTree]);\n  return (\n    <STopicTreeSwitcher>\n      <SIconWrapper\n        style={{\n          backgroundColor: \"#2d2c33\",\n          opacity: renderTopicTree ? 0 : 1,\n          transition: `all 0.15s ease-out ${renderTopicTree ? 0 : 0.2}s`,\n        }}>\n        <Icon\n          tooltipProps={{ placement: \"top\", contents: <KeyboardShortcut keys={[\"T\"]} /> }}\n          dataTest=\"open-topic-picker\"\n          active={renderTopicTree}\n          medium\n          onClick={onClick}\n          style={{ color: colors.LIGHT }}>\n          <LayersIcon />\n        </Icon>\n      </SIconWrapper>\n      <SIconWrapper\n        style={{\n          transform: `translate(0px,${renderTopicTree ? 0 : -28}px)`,\n          opacity: renderTopicTree ? 1 : 0,\n          transition: `all 0.25s ease-in-out`,\n          pointerEvents: renderTopicTree ? \"unset\" : \"none\",\n        }}>\n        <Icon\n          tooltipProps={{ placement: \"top\", contents: \"Pin topic picker\" }}\n          small\n          active={pinTopics}\n          onClick={() => {\n            // Keep TopicTree open after unpin.\n            setShowTopicTree(true);\n            saveConfig({ pinTopics: !pinTopics });\n          }}\n          style={{ color: pinTopics ? colors.HIGHLIGHT : colors.LIGHT }}>\n          <PinIcon />\n        </Icon>\n      </SIconWrapper>\n      {showErrorBadge && (\n        <Tooltip contents=\"Errors found in selected topics/namespaces\" placement=\"top\">\n          <SErrorsBadge />\n        </Tooltip>\n      )}\n    </STopicTreeSwitcher>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { isNumberType } from \"webviz-core/src/util/binaryObjects/messageDefinitionUtils\";\nimport {\n  RADAR_POINT_CLOUD,\n  SENSOR_MSGS$POINT_CLOUD_2,\n  WRAPPED_POINT_CLOUD,\n} from \"webviz-core/src/util/globalConstants\";\n\nexport type StructuralDatatypes = { [topicName: string]: \"radarPointCloud\" };\n\nfunction getDatatypesFromContext(context) {\n  return { datatypes: context.datatypes };\n}\n\nfunction isRadarPointCloud(typeName, datatypes) {\n  const datatype = datatypes[typeName];\n  if (!datatype) {\n    return false;\n  }\n  const pointsField = datatype.fields.find((f) => f.name === \"points\");\n  if (!pointsField || !pointsField.isArray) {\n    return false;\n  }\n  const pointDatatype = datatypes[pointsField.type];\n  if (!pointDatatype) {\n    return false;\n  }\n  return [\"range\", \"azimuth_angle_0\", \"elevation_angle\", \"radial_vel\"].every((fieldName) => {\n    const field = pointDatatype.fields.find((f) => f.name === fieldName);\n    return field && isNumberType(field.type) && !field.isArray;\n  });\n}\n\nfunction isWrappedPointCloud(typeName, datatypes) {\n  const datatype = datatypes[typeName];\n  if (!datatype) {\n    return false;\n  }\n  const cloudField = datatype.fields.find((f) => f.name === \"cloud\");\n  return cloudField && !cloudField.isArray && cloudField.type === SENSOR_MSGS$POINT_CLOUD_2;\n}\n\n// Exported for tests\nexport function getStructuralDatatypes(datatypes: RosDatatypes) {\n  const ret = {};\n  Object.keys(datatypes).forEach((datatype) => {\n    if (isRadarPointCloud(datatype, datatypes)) {\n      ret[datatype] = RADAR_POINT_CLOUD;\n    } else if (isWrappedPointCloud(datatype, datatypes)) {\n      ret[datatype] = WRAPPED_POINT_CLOUD;\n    }\n  });\n  return ret;\n}\n\nexport function useStructuralDatatypes(): StructuralDatatypes {\n  const { datatypes } = useMessagePipeline(getDatatypesFromContext);\n  return React.useMemo(() => getStructuralDatatypes(datatypes), [datatypes]);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { minBy, sortedLastIndexBy } from \"lodash\";\nimport memoizeWeak from \"memoize-weak\";\nimport * as React from \"react\";\nimport { type Time } from \"rosbag\";\n\nimport type { TransformElement } from \".\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport useBlocksByTopicWithFallback, {\n  type BlocksForTopics,\n} from \"webviz-core/src/PanelAPI/useBlocksByTopicWithFallback\";\nimport { makeTransformElement } from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms/utils\";\nimport type { TypedMessage } from \"webviz-core/src/players/types\";\nimport type { BinaryTfMessage, BinaryTransformStamped } from \"webviz-core/src/types/BinaryMessages\";\nimport { deepParse } from \"webviz-core/src/util/binaryObjects\";\nimport { $TF_STATIC, $TF } from \"webviz-core/src/util/globalConstants\";\nimport { toSec } from \"webviz-core/src/util/time\";\n\nconst {\n  skipTransformFrame,\n  useDynamicTransformsData,\n  useStaticTransformsData,\n} = getGlobalHooks().perPanelHooks().ThreeDimensionalViz;\n\nconst NO_HOOK_TRANSFORMS = [];\n\ntype ProcessedBlock = { [frameId: string]: BinaryTransformStamped[] };\n\n// Index a ROS block's TF data by child_frame_id\nconst getTransformElementBlock = memoizeWeak(\n  (tfMessages: TypedMessage<BinaryTfMessage>[], framesToIgnore: Set<string>): ProcessedBlock => {\n    const transformsByFrameId = {};\n    for (const tfMessage of tfMessages) {\n      for (const transform of tfMessage.message.transforms()) {\n        const childFrameId = transform.child_frame_id();\n        if (framesToIgnore.has(childFrameId)) {\n          continue;\n        }\n        const frameTransforms = (transformsByFrameId[childFrameId] = transformsByFrameId[childFrameId] ?? []);\n        frameTransforms.push(transform);\n      }\n    }\n    return transformsByFrameId;\n  }\n);\n\ntype FrameIndex = { [frameId: string]: BinaryTransformStamped[][] };\n// Index all transform data from all blocks by child_frame_id\nconst getBlockFrameIndex = (blocks: BlocksForTopics, framesToIgnore: Set<string>): FrameIndex => {\n  const ret = {};\n  for (const block of blocks) {\n    [block[$TF], block[$TF_STATIC]]\n      .filter(Boolean)\n      .map((topicBlock) => getTransformElementBlock(topicBlock, framesToIgnore))\n      .forEach((processedBlock) => {\n        Object.keys(processedBlock).forEach((childFrameId) => {\n          const frameBlocks = (ret[childFrameId] = ret[childFrameId] ?? []);\n          frameBlocks.push(processedBlock[childFrameId]);\n        });\n      });\n  }\n  return ret;\n};\n\n// Find the ROS transforms in the indexed blocks with header stamps closest to the input timestamp.\n// Notes:\n// - frameBlocks and all contained arrays must be non-empty.\n// - sortedLastIndexBy expects `value` to have the same type as the elements of `array`, but that\n//   doesn't quite work for us, so we use `any` and make the callback work for both types.\n// - toSec might lose precision here, but we probably don't need it to be exact.\n// - The \"nearest\" transform might be after `timeSecs`. Ideally we'd interpolate/extrapolate, but\n//   there probably isn't a philosophical issue with looking into the future a bit.\nconst findNearestTransformInBlocks = (\n  frameBlocks: BinaryTransformStamped[][],\n  timeSecs: number\n): BinaryTransformStamped => {\n  const candidateNearestTransforms = [];\n  // Find the index of the first block whose first element is >= `time`.\n  // If such a block exists, its first transform might be nearest to `time`.\n  const firstBlockAfterIndex = sortedLastIndexBy(frameBlocks, (timeSecs: any), (block) =>\n    typeof block === \"number\" ? block : toSec(deepParse(block[0].header().stamp()))\n  );\n  candidateNearestTransforms.push(frameBlocks[firstBlockAfterIndex]?.[0]); // maybe null\n\n  // In the block before (if it exists), find the index of the first transform >= `time`.\n  // That message and the one before it (either may not exist) might be nearest to `time`.\n  const blockBefore = frameBlocks[firstBlockAfterIndex - 1] ?? [];\n  const firstMessageAfterIndex = sortedLastIndexBy(blockBefore, (timeSecs: any), (tf) =>\n    typeof tf === \"number\" ? tf : toSec(deepParse(tf.header().stamp()))\n  );\n  candidateNearestTransforms.push(blockBefore[firstMessageAfterIndex]); // maybe null\n  candidateNearestTransforms.push(blockBefore[firstMessageAfterIndex - 1]); // not null\n\n  // Filter out nulls, and find the closest.\n  return minBy(candidateNearestTransforms.filter(Boolean), (tf) =>\n    Math.abs(timeSecs - toSec(deepParse(tf.header().stamp())))\n  );\n};\n\n// Exported for tests.\nexport const findNearestTransformElementInBlocks = (\n  frameBlocks: BinaryTransformStamped[][],\n  timeSecs: number\n): TransformElement => makeTransformElement(deepParse(findNearestTransformInBlocks(frameBlocks, timeSecs)));\n\nconst useDynamicTransformsNear = (time: Time, framesToIgnore: Set<string>): $ReadOnlyArray<TransformElement> => {\n  const blocks = useBlocksByTopicWithFallback([$TF_STATIC, $TF]);\n  const blockFrameIndex = React.useMemo(() => getBlockFrameIndex(blocks, framesToIgnore), [blocks, framesToIgnore]);\n  const timeSecs = toSec(time);\n  return React.useMemo(\n    () =>\n      Object.keys(blockFrameIndex).map((frameId) =>\n        findNearestTransformElementInBlocks(blockFrameIndex[frameId], timeSecs)\n      ),\n    [blockFrameIndex, timeSecs]\n  );\n};\n\n// Given a timestamp, find relevant transforms. Assumes transforms with a given frame id have\n// monotonically increasing header stamps.\nconst useTransformsNear = (time: Time, staticTransformPath: ?string): TransformElement[] => {\n  const hookStaticTransforms: TransformElement[] = useStaticTransformsData(staticTransformPath);\n  const framesToIgnore = React.useMemo(\n    () =>\n      new Set(\n        hookStaticTransforms\n          .map((t) => t.childFrame)\n          .concat(skipTransformFrame?.frameId)\n          .filter(Boolean)\n      ),\n    [hookStaticTransforms]\n  );\n  const hookDynamicTransforms = useDynamicTransformsData() ?? NO_HOOK_TRANSFORMS;\n  const dynamicTransforms = useDynamicTransformsNear(time, framesToIgnore);\n  return React.useMemo(() => dynamicTransforms.concat(hookStaticTransforms, hookDynamicTransforms), [\n    dynamicTransforms,\n    hookStaticTransforms,\n    hookDynamicTransforms,\n  ]);\n};\n\nexport default useTransformsNear;\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { groupBy } from \"lodash\";\nimport { useMemo, useCallback } from \"react\";\n\nimport { useBlocksByTopic, type BlocksForTopics as ImportedBlocksForTopics } from \"./useBlocksByTopic\";\nimport { useMessageReducer } from \"./useMessageReducer\";\nimport { useShallowMemo } from \"webviz-core/src/util/hooks\";\n\nexport type BlocksForTopics = ImportedBlocksForTopics;\n\n// useBlocksByTopic, but falls back if blocks are not available (ex: Websocket).\n// Does not yet work with built-in or user node topics, use a different solution if those topics are required.\nexport default function useBlocksByTopicWithFallback(topics: $ReadOnlyArray<string>): BlocksForTopics {\n  const requestedTopics = useShallowMemo(topics);\n  const blocks = useBlocksByTopic(requestedTopics);\n\n  const nonPreloadedBlocks =\n    useMessageReducer({\n      topics: requestedTopics,\n      restore: useCallback(() => [], []),\n      addBobjects: useCallback((arr, bobjects) => {\n        const block = groupBy(bobjects, (bobject) => bobject.topic);\n        // Ensure that each topic is represented in the block.\n        requestedTopics.forEach((topic) => {\n          block[topic] = block[topic] || [];\n        });\n        return [...arr, block];\n      }, [requestedTopics]),\n      preloadingFallback: true,\n    }) || [];\n\n  return useMemo(() => {\n    if (!blocks.length) {\n      return nonPreloadedBlocks;\n    }\n    return blocks;\n  }, [blocks, nonPreloadedBlocks]);\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { TF } from \"webviz-core/src/types/Messages\";\n\nexport const makeTransformElement = (tf: TF) => ({\n  childFrame: tf.child_frame_id,\n  parentFrame: tf.header.frame_id,\n  pose: { position: tf.transform.translation, orientation: tf.transform.rotation },\n});\n","module.exports = \"# Table\\n\\nDisplays data similar to `RawMessages` but in a tabular format. If you have a table that you'd tweaked to perfection and want to share as a panel, please reach out to the Webviz team.\\n\\nEach column header dropdown has options depending on the kind of data underneath, including expanding, hiding, sorting, filtering, and conditional formatting. You can also navigate to the pencil icon in the top left corner to edit the full list of shown/hidden columns. For big topics, it is strongly recommended you only show the columns you need! Besides de-cluttering things, it'll also help a lot with how quickly Webviz plays back.\\n\\nSince ROS data can be nested, you'll often see ellipses (`...`) where you'd expect to see data. To expand complex columns, either click the ellipses or column header and choose the option `Expand`. You should now see multiple columns nested under the parent column you clicked on. To collapse an expanded column, click on the parent and choose `Collapse`. Since filtering/sorting are only available for primitive ROS values, you won't see these options for complex types or nested arrays.\\n\\nNote that we currently only allow one level of expansion underneath parent columns. If this is limiting to you, please reach out to the Webviz team and describe to us your use case!\\n\"","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowRightIcon from \"@mdi/svg/svg/arrow-right.svg\";\nimport DeleteIcon from \"@mdi/svg/svg/delete.svg\";\nimport PencilIcon from \"@mdi/svg/svg/pencil.svg\";\nimport PlusIcon from \"@mdi/svg/svg/plus.svg\";\nimport ColorPicker from \"rc-color-picker\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\nimport uuid from \"uuid\";\n\nimport Checkbox from \"webviz-core/src/components/Checkbox\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { ConfigContext, TableContext, useColumnConfigValue, SHeaderDropdownItem } from \"webviz-core/src/panels/Table\";\nimport type { ConditionalFormat, ColumnInstance } from \"webviz-core/src/panels/Table/types\";\nimport { COMPARATOR_LIST } from \"webviz-core/src/panels/Table/utils\";\nimport { useContextSelector } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst RemoveButton = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst SConditionalFormatInput = styled.div`\n  display: flex;\n  align-items: center;\n  width: 100%;\n  > * {\n    flex-grow: unset;\n    margin-right: 4px;\n  }\n`;\n\nconst SColorPickerWrapper = styled.div`\n  .rc-color-picker-trigger {\n    border: none;\n    box-shadow: none;\n    display: inline-block;\n    width: 24px;\n    height: 24px;\n    border-radius: 2px;\n  }\n`;\n\ntype ConditionalFormatInputProps = {\n  ...ConditionalFormat,\n  setConditionalFormat: (conditionalFormat: ConditionalFormat) => void,\n  removeConditionalFormat: (conditionalFormatId: string) => void,\n};\n\nconst formatPrimitive = (value: any) => {\n  if (/^\\d+$/.test(value)) {\n    return Number(value);\n  }\n  if (/true/.test(value)) {\n    return true;\n  }\n  if (/false/.test(value)) {\n    return false;\n  }\n  return value;\n};\n\nconst ColumnCheckbox = ({\n  setHideColumn,\n  columnId,\n}: {\n  setHideColumn: (id: string, hide: boolean) => void,\n  columnId: string,\n}) => {\n  const isHidden = useContextSelector(\n    ConfigContext,\n    React.useCallback((config) => {\n      const columnConfig = config.columnConfigs?.[columnId] || {};\n      return !!columnConfig.hidden;\n    }, [columnId])\n  );\n\n  return (\n    <Checkbox\n      label={columnId}\n      checked={!isHidden}\n      onChange={(shown) => {\n        setHideColumn(columnId, !shown);\n      }}\n    />\n  );\n};\ntype ColumnDropdownProps = {\n  setHideColumn: (columnId: string, hide?: boolean) => void,\n  toggleAllColumns: (hidden: boolean) => void,\n  columns: ColumnInstance[],\n};\nexport const ColumnDropdown = React.memo<ColumnDropdownProps>(\n  ({ setHideColumn, toggleAllColumns, columns }: ColumnDropdownProps) => {\n    return (\n      <Dropdown\n        dataTest=\"column-dropdown\"\n        style={{\n          position: \"absolute\",\n          top: \"9px\",\n          left: \"8px\",\n          zIndex: 1,\n        }}\n        menuStyle={{\n          padding: \"8px\",\n        }}\n        toggleComponent={\n          <Icon tooltip=\"Show/hide columns\">\n            <PencilIcon />\n          </Icon>\n        }>\n        <Flex row>\n          <button onClick={() => toggleAllColumns(true)} data-test=\"hide-all-columns\">\n            Hide all\n          </button>\n          <button onClick={() => toggleAllColumns(false)} data-test=\"show-all-columns\">\n            Show all\n          </button>\n        </Flex>\n        {columns.map(({ id }) => (\n          <ColumnCheckbox columnId={id} key={id} setHideColumn={setHideColumn} />\n        ))}\n      </Dropdown>\n    );\n  }\n);\n\nconst ConditionalFormatInput = ({\n  id,\n  comparator,\n  primitive,\n  color,\n  removeConditionalFormat,\n  setConditionalFormat,\n}: ConditionalFormatInputProps) => {\n  const colorPickerRef = React.useRef();\n  return (\n    <SConditionalFormatInput>\n      <span style={{ color: colors.TEXT_MUTED }}>if value</span>\n      <Dropdown\n        value={comparator}\n        key={`comparator-${id}`}\n        // Because the parent `ConditionalFormatInput` is rendered inside a\n        // portal, meaning that calls to `node.contains` on click will fail and\n        // close the entire dropdown.\n        noPortal\n        onChange={(newComparator) => {\n          setConditionalFormat({\n            id,\n            color,\n            comparator: newComparator,\n            primitive,\n          });\n        }}>\n        {COMPARATOR_LIST.map((field) => (\n          <option value={field} key={field}>\n            {field}\n          </option>\n        ))}\n      </Dropdown>\n      <input\n        type=\"text\"\n        value={primitive}\n        placeholder=\"primitive value\"\n        key={`primitive-${id}`}\n        onChange={(e) => {\n          setConditionalFormat({\n            id,\n            color,\n            comparator,\n            primitive: formatPrimitive(e.target.value),\n          });\n        }}\n      />\n      <Icon style={{ color: colors.TEXT_MUTED }}>\n        <ArrowRightIcon />\n      </Icon>\n      <SColorPickerWrapper ref={colorPickerRef}>\n        <ColorPicker\n          color={color}\n          getCalendarContainer={() => {\n            // Because the parent `ConditionalFormatInput` is rendered inside a\n            // portal, meaning that calls to `node.contains` on click will fail and\n            // close the entire dropdown.\n            return colorPickerRef.current;\n          }}\n          onChange={(newColor: { color: string, alpha: number }) => {\n            setConditionalFormat({\n              id,\n              color: newColor.color,\n              comparator,\n              primitive,\n            });\n          }}\n        />\n      </SColorPickerWrapper>\n\n      <RemoveButton>\n        <Icon large onClick={() => removeConditionalFormat(id)}>\n          <DeleteIcon />\n        </Icon>\n      </RemoveButton>\n    </SConditionalFormatInput>\n  );\n};\n\nexport const ConditionaFormatsInput = ({ columnId }: {| columnId: string |}) => {\n  const { updateConditionalFormats } = React.useContext(TableContext);\n  const conditionalFormats = useColumnConfigValue<\"conditionalFormats\">(columnId, \"conditionalFormats\") || [];\n  const addConditionalFormat = React.useCallback(() => {\n    updateConditionalFormats(columnId, [\n      ...conditionalFormats,\n      {\n        id: uuid.v4(),\n        primitive: \"\",\n        color: \"#ffffff\",\n        comparator: \"<\",\n      },\n    ]);\n  }, [columnId, conditionalFormats, updateConditionalFormats]);\n  const setConditionalFormat = React.useCallback((updatedConditionalFormat) => {\n    updateConditionalFormats(\n      columnId,\n      conditionalFormats.map((conditionalFormat) => {\n        if (conditionalFormat.id === updatedConditionalFormat.id) {\n          return updatedConditionalFormat;\n        }\n        return conditionalFormat;\n      })\n    );\n  }, [columnId, conditionalFormats, updateConditionalFormats]);\n\n  const removeConditionalFormat = React.useCallback((conditionalFormatId: string) => {\n    updateConditionalFormats(\n      columnId,\n      conditionalFormats.filter((conditionalFormat) => {\n        return conditionalFormat.id !== conditionalFormatId;\n      })\n    );\n  }, [columnId, conditionalFormats, updateConditionalFormats]);\n\n  return (\n    <>\n      <SHeaderDropdownItem onClick={addConditionalFormat}>\n        <Icon className=\"menu-item\">\n          <PlusIcon />\n        </Icon>\n        Add formatting\n      </SHeaderDropdownItem>\n      {conditionalFormats.map((conditionalFormat) => {\n        return (\n          <SHeaderDropdownItem key={conditionalFormat.id}>\n            <ConditionalFormatInput\n              columnId={columnId}\n              {...conditionalFormat}\n              setConditionalFormat={setConditionalFormat}\n              removeConditionalFormat={removeConditionalFormat}\n            />\n          </SHeaderDropdownItem>\n        );\n      })}\n    </>\n  );\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { ThreeDimensionalVizHooks } from \"./types\";\nimport PoseMarkers from \"webviz-core/src/panels/ThreeDimensionalViz/commands/PoseMarkers\";\nimport { defaultMapPalette } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/utils\";\nimport LaserScanVert from \"webviz-core/src/panels/ThreeDimensionalViz/LaserScanVert\";\nimport { TF2_MSGS$TF_MESSAGE } from \"webviz-core/src/util/globalConstants\";\n\nconst sceneBuilderHooks: ThreeDimensionalVizHooks = {\n  getSelectionState: () => {},\n  getTopicsToRender: () => new Set(),\n  consumeBobject: (topic, datatype, msg, consumeMethods, { errors }) => {\n    // TF messages are consumed by TransformBuilder, not SceneBuilder.\n    if (datatype === TF2_MSGS$TF_MESSAGE) {\n      return;\n    }\n    errors.topicsWithError.set(topic, `Unrecognized topic datatype for scene: ${datatype}`);\n  },\n  addMarkerToCollector: () => false,\n  getSyntheticArrowMarkerColor: () => ({ r: 0, g: 0, b: 1, a: 0.5 }),\n  getFlattenedPose: () => undefined,\n  getOccupancyGridValues: (_topic) => [0.5, \"map\"],\n  getMarkerColor: (topic, markerColor) => markerColor,\n\n  // Duplicated in top-level 3D panel hooks\n  skipTransformFrame: null,\n  MapComponent: null,\n  renderAdditionalMarkers: () => {},\n  LaserScanVert,\n  getMapPalette() {\n    return defaultMapPalette;\n  },\n  useWorldspacePointSize: true,\n  sphericalRangeScale: 1,\n  allSupportedMarkers: [\n    \"arrow\",\n    \"cube\",\n    \"cubeList\",\n    \"cylinder\",\n    \"filledPolygon\",\n    \"grid\",\n    \"instancedLineList\",\n    \"laserScan\",\n    \"linedConvexHull\",\n    \"lineList\",\n    \"lineStrip\",\n    \"overlayIcon\",\n    \"radarPointCluster\",\n    \"pointcloud\",\n    \"points\",\n    \"poseMarker\",\n    \"sphere\",\n    \"sphereList\",\n    \"text\",\n    \"triangleList\",\n  ],\n  PoseMarkers,\n  rootTransformFrame: \"map\",\n  getStaticallyAvailableNamespacesByTopic: () => ({}),\n};\n\nexport default sceneBuilderHooks;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { vec3 } from \"gl-matrix\";\nimport React from \"react\";\nimport { GLTFScene, parseGLB, type Pose, type Scale, type CommonCommandProps } from \"regl-worldview\";\n\nimport carModelURL from \"webviz-core/src/panels/ThreeDimensionalViz/commands/CarModel/carModel.glb\";\nimport { type InteractionData } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\n\nasync function loadCarModel() {\n  const response = await fetch(carModelURL);\n  if (!response.ok) {\n    throw new Error(`unable to load car model: ${response.status}`);\n  }\n  const model = await parseGLB(await response.arrayBuffer());\n  const nodes = [...model.json.nodes];\n\n  // overwrite the translation component of the root node so the car's center is its rear axle\n  const translation = [0, 0, 0];\n  vec3.lerp(translation, model.json.accessors[1].min, model.json.accessors[1].max, 0.5);\n  vec3.scale(translation, translation, -nodes[0].scale[0]);\n  translation[1] += 56.075834;\n  translation[2] += 136.19549;\n  nodes[0] = { ...nodes[0], translation };\n\n  return {\n    ...model,\n    json: {\n      ...model.json,\n      nodes,\n\n      // change sampler minFilter to avoid blurry textures\n      samplers: model.json.samplers.map((sampler) => ({\n        ...sampler,\n        minFilter: WebGLRenderingContext.LINEAR,\n      })),\n    },\n  };\n}\n\ntype Props = {|\n  children: {|\n    pose: Pose,\n    scale?: Scale,\n    alpha?: number,\n    interactionData?: InteractionData,\n  |},\n  ...CommonCommandProps,\n|};\n\n// default scale is 0.01 because the model's units are centimeters\nexport default function CarModel({\n  children: { pose, alpha = 1, scale = { x: 0.01, y: 0.01, z: 0.01 }, interactionData },\n  layerIndex,\n}: Props) {\n  return (\n    <GLTFScene layerIndex={layerIndex} model={loadCarModel}>\n      {{ pose, alpha, scale, interactionData }}\n    </GLTFScene>\n  );\n}\n","module.exports = __webpack_public_path__ + \"6a934943c1d8e69a6799d947c1987ac2.glb\";","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport default `\n  precision mediump float;\n\n  uniform mat4 projection, view;\n\n  #WITH_POSE\n\n  uniform float pointSize;\n  uniform float angle_min;\n  uniform float angle_increment;\n  uniform float range_min;\n  uniform float range_max;\n  uniform bool isHitmap;\n  uniform vec4 color;\n\n  attribute float index;\n  attribute float range;\n  attribute float intensity;\n  attribute vec4 hitmapColor;\n\n  varying vec4 vColor;\n\n  void main () {\n    float angle = angle_min + index * angle_increment;\n    vec3 p = applyPose(vec3(range * cos(angle), range * sin(angle), 0));\n\n    gl_Position = projection * view * vec4(p, 1);\n    gl_PointSize = pointSize;\n\n    if (range < range_min || range > range_max || intensity == 0.0) {\n      gl_PointSize = 0.;\n    }\n    vColor = isHitmap ? hitmapColor : color;\n  }\n`;\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useEffect, useMemo, useCallback } from \"react\";\nimport { type CameraState, type Polygon, DrawPolygons } from \"regl-worldview\";\nimport type { Time } from \"rosbag\";\nimport shallowequal from \"shallowequal\";\n\nimport type { RenderResult } from \"./types\";\nimport signal, { type Signal } from \"webviz-core/shared/signal\";\nimport type { GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { getIconName } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/OverlayProjector\";\nimport DebugStatsCollector from \"webviz-core/src/panels/ThreeDimensionalViz/DebugStats/Collector\";\nimport type { DebugStats } from \"webviz-core/src/panels/ThreeDimensionalViz/DebugStats/types\";\nimport { type LinkedGlobalVariables } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport { LayoutWorkerDataReceiver } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout/WorkerDataRpc\";\nimport { type MeasurePoints } from \"webviz-core/src/panels/ThreeDimensionalViz/MeasureMarker\";\nimport SceneBuilder, {\n  type SelectedNamespacesByTopic,\n  type TopicSettingsCollection,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder\";\nimport type { ThreeDimensionalVizHooks } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/types\";\nimport { normalizeMouseEventObject } from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport useSceneBuilderAndTransformsData from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTree/useSceneBuilderAndTransformsData\";\nimport Transforms, { type TransformElement } from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport TransformsBuilder from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms/TransformsBuilder\";\nimport type { StructuralDatatypes } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/datatypes\";\nimport { type GLTextMarker } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/searchTextUtils\";\nimport World from \"webviz-core/src/panels/ThreeDimensionalViz/World\";\nimport WorldContext, { type WorldContextType } from \"webviz-core/src/panels/ThreeDimensionalViz/WorldContext\";\nimport type { Frame, Topic } from \"webviz-core/src/players/types\";\nimport { $METADATA, $TF } from \"webviz-core/src/util/globalConstants\";\nimport { useShallowMemo, useChangeDetector } from \"webviz-core/src/util/hooks\";\nimport render from \"webviz-core/src/util/NoopReactRenderer\";\nimport Rpc, { createLinkedChannels, type Channel } from \"webviz-core/src/util/Rpc\";\nimport { setupWorker } from \"webviz-core/src/util/RpcWorkerUtils\";\n\nexport type OffscreenCanvas = HTMLCanvasElement;\n\ntype WorldRendererState = $ReadOnly<{|\n  cameraState: CameraState,\n  cleared: boolean,\n  frame: Frame,\n  isPlaying: boolean,\n  isDemoMode: boolean,\n  autoTextBackgroundColor: boolean,\n  colorOverrideMarkerMatchers: any,\n  currentTime: Time,\n  diffModeEnabled: boolean,\n  flattenMarkers: boolean,\n  globalVariables: GlobalVariables,\n  highlightMarkerMatchers: any,\n  linkedGlobalVariables: LinkedGlobalVariables,\n  playerId: string,\n  resolveRenderSignal: () => void,\n  rootTf: string,\n  searchTextOpen: boolean,\n  searchText: string,\n  searchTextMatches: GLTextMarker[],\n  selectedMatchIndex: number,\n  selectedNamespacesByTopic: SelectedNamespacesByTopic,\n  selectedTopics: Topic[],\n  settingsByKey: TopicSettingsCollection,\n  showCrosshair: boolean,\n  transformElements: $ReadOnlyArray<TransformElement>,\n  polygons: Polygon[],\n  measurePoints: MeasurePoints,\n  structuralDatatypes: StructuralDatatypes,\n  worldContextValue: WorldContextType,\n  debug: boolean,\n  sphericalRangeScale: number,\n|}>;\n\ntype WorldRendererCallbacks = $ReadOnly<{|\n  setState: (WorldRendererState) => void,\n  onMouseEvent: ({ e: any, mouseEventName: string }) => Promise<any>,\n|}>;\n\ntype WorldInterfaceProps = $ReadOnly<{|\n  canvas: OffscreenCanvas,\n  registerCallbacks: (callbacks: WorldRendererCallbacks) => void,\n  hooks: ThreeDimensionalVizHooks,\n  onClick: any,\n  onDoubleClick: any,\n  onMouseDown: any,\n  onMouseMove: any,\n  onMouseUp: any,\n  setOverlayIcons: any,\n  setSearchTextMatches: any,\n  setAvailableNsAndErrors: any,\n  setDebugStats: (DebugStats) => void,\n|}>;\n\n// Sets up props/state and communication callbacks between react and the imperative worker code.\nfunction ReactWorldInterface(props: WorldInterfaceProps) {\n  const worldRef = React.useRef();\n  const [state, setState] = React.useState<?WorldRendererState>();\n  const onMouseEvent = React.useCallback(({ e, mouseEventName }: { e: any, mouseEventName: string }) => {\n    const world = worldRef.current;\n    if (!world) {\n      // The initial render is async, and sometimes an event gets sent before it's fully done.\n      // We could tell the main thread not to send events until everything is done, but easier to\n      // just ignore events until we're ready.\n      return Promise.resolve();\n    }\n\n    return new Promise((resolve) => {\n      // Make a fake mouse event so Worldview can handle it correctly\n      world.handleOffscreenMouseEvent(\n        {\n          ...e,\n          target: {\n            ...props.canvas,\n            getBoundingClientRect: () => ({\n              top: e.clientTop,\n              left: e.clientLeft,\n            }),\n          },\n          persist: () => {},\n          isPropagationStopped: () => false,\n          resolve,\n        },\n        mouseEventName\n      );\n    });\n  }, [props.canvas]);\n\n  useEffect(() => {\n    props.registerCallbacks({ setState, onMouseEvent });\n  }, [props.registerCallbacks, setState, onMouseEvent, props]);\n\n  if (!state) {\n    return null;\n  }\n  return <WorldRenderer worldRef={worldRef} {...{ ...state, ...props }} />;\n}\n\ntype WorldRendererProps = {|\n  ...WorldInterfaceProps,\n  ...WorldRendererState,\n  worldRef: { current: any },\n|};\n\nfunction useMapElement(sceneBuilder: SceneBuilder, props: WorldRendererProps) {\n  const { MapComponent } = props.hooks;\n  const memoizedScene = useShallowMemo(sceneBuilder.getScene());\n  const metadataTopicNamespaces = useShallowMemo(props.selectedNamespacesByTopic[$METADATA] ?? []);\n\n  const onMapTileError = useCallback((error: Error) => {\n    sceneBuilder.setTopicError($METADATA, error.message);\n  }, [sceneBuilder]);\n\n  return React.useMemo(\n    () =>\n      MapComponent && (\n        <MapComponent\n          onMapTileError={onMapTileError}\n          metadataTopicNamespaces={metadataTopicNamespaces}\n          scene={memoizedScene}\n          debug={props.debug}\n          perspective={!!props.cameraState.perspective}\n          isDemoMode={props.isDemoMode}\n        />\n      ),\n    [\n      MapComponent,\n      metadataTopicNamespaces,\n      memoizedScene,\n      props.debug,\n      props.cameraState.perspective,\n      props.isDemoMode,\n      onMapTileError,\n    ]\n  );\n}\n\nfunction WorldRenderer(props: WorldRendererProps) {\n  const {\n    hooks,\n    cleared,\n    playerId,\n    flattenMarkers,\n    selectedNamespacesByTopic,\n    settingsByKey,\n    selectedTopics,\n    globalVariables,\n    linkedGlobalVariables,\n    highlightMarkerMatchers,\n    colorOverrideMarkerMatchers,\n    currentTime,\n    transformElements,\n    rootTf,\n    frame,\n    setAvailableNsAndErrors,\n    structuralDatatypes,\n    debug,\n  } = props;\n\n  const transforms = useMemo(() => new Transforms(transformElements), [transformElements]);\n  const { sceneBuilder, transformsBuilder } = useMemo(\n    () => ({\n      sceneBuilder: new SceneBuilder(hooks),\n      transformsBuilder: new TransformsBuilder(),\n    }),\n    [hooks]\n  );\n\n  if (cleared) {\n    sceneBuilder.clear();\n  }\n\n  useMemo(() => {\n    sceneBuilder.setPlayerId(playerId);\n    sceneBuilder.setTransforms(transforms, rootTf);\n    sceneBuilder.setFlattenMarkers(!!flattenMarkers);\n    sceneBuilder.setSelectedNamespacesByTopic(selectedNamespacesByTopic);\n    sceneBuilder.setSettingsByKey(settingsByKey);\n    sceneBuilder.setTopics(selectedTopics);\n    sceneBuilder.setGlobalVariables({ globalVariables, linkedGlobalVariables });\n    sceneBuilder.setHighlightedMatchers(highlightMarkerMatchers);\n    sceneBuilder.setColorOverrideMatchers(colorOverrideMarkerMatchers);\n    sceneBuilder.setFrame(frame);\n    sceneBuilder.setCurrentTime(currentTime);\n    sceneBuilder.setStructuralDatatypes(structuralDatatypes);\n    sceneBuilder.render();\n\n    // update the transforms and set the selected ones to render\n    transformsBuilder.setTransforms(transforms, rootTf);\n    transformsBuilder.setSelectedTransforms(selectedNamespacesByTopic[$TF] || []);\n  }, [\n    colorOverrideMarkerMatchers,\n    currentTime,\n    flattenMarkers,\n    frame,\n    globalVariables,\n    highlightMarkerMatchers,\n    linkedGlobalVariables,\n    playerId,\n    rootTf,\n    sceneBuilder,\n    selectedNamespacesByTopic,\n    selectedTopics,\n    settingsByKey,\n    structuralDatatypes,\n    transforms,\n    transformsBuilder,\n  ]);\n\n  const staticallyAvailableNamespacesByTopic = useMemo(() => hooks.getStaticallyAvailableNamespacesByTopic(), [hooks]);\n  const { availableNamespacesByTopic, sceneErrorsByKey } = useSceneBuilderAndTransformsData({\n    playerId,\n    sceneBuilder,\n    staticallyAvailableNamespacesByTopic,\n    transforms,\n  });\n\n  if (useChangeDetector([availableNamespacesByTopic, sceneErrorsByKey], true)) {\n    setAvailableNsAndErrors(availableNamespacesByTopic, sceneErrorsByKey);\n  }\n\n  const mapElement = useMapElement(sceneBuilder, props);\n  return (\n    <WorldContext.Provider value={props.worldContextValue}>\n      <World\n        ref={props.worldRef}\n        autoTextBackgroundColor={!!props.autoTextBackgroundColor}\n        cameraState={props.cameraState}\n        isPlaying={!!props.isPlaying}\n        isDemoMode={props.isDemoMode}\n        diffModeEnabled={props.diffModeEnabled}\n        searchTextOpen={props.searchTextOpen}\n        searchText={props.searchText}\n        searchTextMatches={props.searchTextMatches}\n        selectedMatchIndex={props.selectedMatchIndex}\n        setSearchTextMatches={props.setSearchTextMatches}\n        showCrosshair={props.showCrosshair}\n        markerProviders={[sceneBuilder, transformsBuilder]}\n        sphericalRangeScale={props.sphericalRangeScale}\n        {...props}>\n        {mapElement}\n        <DrawPolygons>{props.polygons}</DrawPolygons>\n        {debug && <DebugStatsCollector setDebugStats={props.setDebugStats} />}\n      </World>\n    </WorldContext.Provider>\n  );\n}\n\nclass LayoutWorker {\n  canvas: OffscreenCanvas;\n  hooks: any;\n  playerId: string;\n  hasChangedPlayerId: boolean;\n  rendererCallbacks: WorldRendererCallbacks;\n  searchTextMatches: GLTextMarker[];\n  availableTfs: any[];\n  _renderSignals: Signal<void>[] = [];\n  _hasOffscreenCanvas: boolean;\n\n  constructor(canvas, hooks, rpc) {\n    this.canvas = canvas;\n    this.hooks = hooks;\n    this.playerId = \"\";\n    this.hasChangedPlayerId = true;\n    this.searchTextMatches = [];\n    this.availableTfs = [];\n    let iconDrawables = [];\n    this._hasOffscreenCanvas = canvas.clientWidth == null;\n    render(\n      <ReactWorldInterface\n        registerCallbacks={(callbacks) => {\n          this.rendererCallbacks = callbacks;\n        }}\n        hooks={this.hooks}\n        canvas={canvas}\n        onClick={this._mouseEventHandler(\"onClick\")}\n        onDoubleClick={this._mouseEventHandler(\"onDoubleClick\")}\n        onMouseDown={this._mouseEventHandler(\"onMouseDown\")}\n        onMouseMove={this._mouseEventHandler(\"onMouseMove\")}\n        onMouseUp={this._mouseEventHandler(\"onMouseUp\")}\n        setOverlayIcons={({ renderItems, sceneBuilderDrawables }) => {\n          iconDrawables = sceneBuilderDrawables;\n          return rpc.send<void>(\"updateOverlayIcons\", renderItems);\n        }}\n        setDebugStats={(stats: DebugStats) => {\n          rpc.send<void>(\"updateDebugStats\", stats);\n        }}\n        setSearchTextMatches={this.setSearchTextMatches}\n        setAvailableNsAndErrors={(availableNamespacesByTopic, errorsByTopic) =>\n          rpc.send<void>(\"onAvailableNsAndErrors\", { availableNamespacesByTopic, errorsByTopic })\n        }\n      />\n    );\n    new LayoutWorkerDataReceiver(rpc, this.renderFrame);\n    rpc.receive(\"onMouseEvent\", this.onMouseEvent);\n    rpc.receive(\"getIconData\", (name) => {\n      const icon = iconDrawables.find((i) => getIconName(i) === name);\n      if (!icon) {\n        return;\n      }\n      return normalizeMouseEventObject({ object: icon }).object;\n    });\n  }\n\n  resolveRenderSignal = (renderSignal: Signal<void>) => {\n    // React may combine state updates. Resolve renders that have been superseded.\n    while (this._renderSignals.length > 0) {\n      const queuedSignal = this._renderSignals.shift();\n      queuedSignal.resolve();\n      if (queuedSignal === renderSignal) {\n        break;\n      }\n    }\n  };\n\n  setSearchTextMatches = (markers: GLTextMarker[]) => {\n    this.searchTextMatches = markers;\n  };\n\n  onMouseEvent = (props) => {\n    return this.rendererCallbacks.onMouseEvent(props);\n  };\n\n  renderFrame = async ({\n    cleared,\n    rootTf,\n    playerId,\n    transformElements,\n    flattenMarkers,\n    frame,\n    selectedNamespacesByTopic,\n    settingsByKey,\n    selectedTopics,\n    globalVariables,\n    linkedGlobalVariables,\n    highlightMarkerMatchers,\n    colorOverrideMarkerMatchers,\n    currentTime,\n    width,\n    height,\n    cameraState,\n    isPlaying,\n    isDemoMode,\n    autoTextBackgroundColor,\n    diffModeEnabled,\n    searchTextOpen,\n    searchText,\n    selectedMatchIndex,\n    showCrosshair,\n    polygons,\n    measurePoints,\n    structuralDatatypes,\n    worldContextValue,\n    debug,\n    sphericalRangeScale,\n  }: $ReadOnly<{\n    cleared: boolean,\n    rootTf: string,\n    playerId: string,\n    transformElements: $ReadOnlyArray<TransformElement>,\n    flattenMarkers: boolean,\n    frame: Frame,\n    selectedNamespacesByTopic: SelectedNamespacesByTopic,\n    settingsByKey: TopicSettingsCollection,\n    selectedTopics: Topic[],\n    globalVariables: GlobalVariables,\n    linkedGlobalVariables: LinkedGlobalVariables,\n    highlightMarkerMatchers: any,\n    colorOverrideMarkerMatchers: any,\n    currentTime: Time,\n    width: number,\n    height: number,\n    cameraState: CameraState,\n    isPlaying: boolean,\n    isDemoMode: boolean,\n    autoTextBackgroundColor: boolean,\n    diffModeEnabled: boolean,\n    searchTextOpen: boolean,\n    searchText: string,\n    selectedMatchIndex: number,\n    showCrosshair: boolean,\n    polygons: Polygon[],\n    measurePoints: MeasurePoints,\n    structuralDatatypes: StructuralDatatypes,\n    worldContextValue: WorldContextType,\n    debug: boolean,\n    sphericalRangeScale: number,\n  }>): Promise<RenderResult> => {\n    this.hasChangedPlayerId = !shallowequal(this.playerId, playerId);\n    this.playerId = playerId;\n\n    if (this._hasOffscreenCanvas) {\n      // These attributes exist already (and are read-only) in HTMLCanvasElement.\n      this.canvas.width = width;\n      this.canvas.height = height;\n      this.canvas.clientWidth = width;\n      this.canvas.clientHeight = height;\n    }\n    const renderSignal = signal<void>();\n    this._renderSignals.push(renderSignal);\n    const resolveRenderSignal = () => {\n      this.resolveRenderSignal(renderSignal);\n    };\n\n    this.rendererCallbacks.setState({\n      cameraState,\n      cleared,\n      colorOverrideMarkerMatchers,\n      currentTime,\n      flattenMarkers,\n      frame,\n      globalVariables,\n      highlightMarkerMatchers,\n      isPlaying,\n      isDemoMode,\n      linkedGlobalVariables,\n      autoTextBackgroundColor,\n      diffModeEnabled,\n      playerId,\n      resolveRenderSignal,\n      rootTf,\n      searchTextOpen,\n      searchText,\n      searchTextMatches: this.searchTextMatches,\n      selectedMatchIndex,\n      selectedNamespacesByTopic,\n      selectedTopics,\n      settingsByKey,\n      showCrosshair,\n      transformElements,\n      polygons,\n      measurePoints,\n      structuralDatatypes,\n      worldContextValue,\n      debug,\n      sphericalRangeScale,\n    });\n    await renderSignal;\n\n    return {\n      searchTextMatches: this.searchTextMatches,\n    };\n  };\n\n  _mouseEventHandler = (eventName: string) => (e: any, inputArgs: any) => {\n    const args =\n      !inputArgs || !inputArgs.objects\n        ? inputArgs\n        : { ...inputArgs, objects: inputArgs.objects.map(normalizeMouseEventObject) };\n    const { clientX, clientY, resolve, ctrlKey } = e;\n    const payload = { eventName, ev: { clientX, clientY, ctrlKey }, args };\n    if (eventName === \"onMouseUp\") {\n      // Worldview creates an additional `onClick` event if the mouse did not move in\n      // between `mouseDown`/`mouseUp` events. In that case, we want to defer the\n      // resolution for `onMouseUp` since `onClick` might include selected objects\n      // and should be one resolving the promise.\n      setTimeout(() => resolve(payload), 0);\n    } else {\n      resolve(payload);\n    }\n  };\n}\n\nfunction setupLayoutRenderer(hooks: ThreeDimensionalVizHooks, rpc: Rpc) {\n  rpc.receive(\"initialize\", ({ canvas }: { canvas: OffscreenCanvas }) => {\n    new LayoutWorker(canvas, hooks, rpc);\n  });\n}\n\nexport default function initLayoutWorker(hooks: ThreeDimensionalVizHooks) {\n  if (global.postMessage && !global.onmessage) {\n    const rpc = new Rpc(global);\n    setupWorker(rpc);\n    setupLayoutRenderer(hooks, rpc);\n  }\n}\n\nexport function initLayoutNonWorker(hooks: ThreeDimensionalVizHooks): Channel {\n  const { local, remote } = createLinkedChannels();\n  const remoteRpc = new Rpc(remote);\n  setupLayoutRenderer(hooks, remoteRpc);\n  return local;\n}\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { WorldviewReactContext, type WorldviewContextType } from \"regl-worldview\";\n\nimport { type DebugStats } from \"./types\";\n\ntype Props = {\n  setDebugStats: (DebugStats) => void,\n};\n\nfunction useDebugStats(): ?DebugStats {\n  const context = React.useContext<WorldviewContextType>(WorldviewReactContext);\n  const renderCount = React.useRef(0);\n  renderCount.current = renderCount.current + 1;\n  if (context.initializedData.regl) {\n    const { stats } = context.initializedData.regl;\n    const { bufferCount, elementsCount, textureCount, shaderCount } = stats;\n    const totalTextureSize = stats.getTotalTextureSize();\n    const totalBufferSize = stats.getTotalBufferSize();\n    return {\n      renderCount: renderCount.current,\n      bufferCount,\n      elementsCount,\n      textureCount,\n      shaderCount,\n      totalTextureSize,\n      totalBufferSize,\n    };\n  }\n}\n\nexport default function Collector(props: Props) {\n  const { setDebugStats } = props;\n  const debugStats = useDebugStats();\n  if (debugStats) {\n    setDebugStats(debugStats);\n  }\n  return null;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mapKeys, difference } from \"lodash\";\nimport { useMemo, useRef } from \"react\";\n\nimport generateNodeKey from \"./generateNodeKey\";\nimport type { UseSceneBuilderAndTransformsDataInput, UseSceneBuilderAndTransformsDataOutput } from \"./types\";\nimport { $TF } from \"webviz-core/src/util/globalConstants\";\nimport { useChangeDetector, useDeepMemo } from \"webviz-core/src/util/hooks\";\n\n// Derived namespace and error information for TopicTree from sceneBuilder and transforms.\nexport default function useSceneBuilderAndTransformsData({\n  playerId,\n  sceneBuilder,\n  transforms,\n  staticallyAvailableNamespacesByTopic,\n}: UseSceneBuilderAndTransformsDataInput): UseSceneBuilderAndTransformsDataOutput {\n  const hasChangedPlayerId = useChangeDetector([playerId], false);\n\n  const newAvailableTfs = transforms\n    .values()\n    .map(({ id }) => id)\n    .filter(Boolean);\n  const availableTfsRef = useRef<string[]>(newAvailableTfs);\n  if (hasChangedPlayerId) {\n    // If we have changed the playerId - meaning that we've added or removed a source - recalculate the available TFs\n    // from scratch.\n    availableTfsRef.current = newAvailableTfs;\n  } else {\n    const tfsNotYetAdded = difference(newAvailableTfs, availableTfsRef.current);\n    // Only add TFs, never remove them. If we've seen them once in the bag, they may re-appear.\n    // NOTE: changing this to instead show the exact TFs available at this point in time is NOT advisable. There is a\n    // subtle bug that will lead to the topic tree \"jumping\" in position as TFs are quickly removed and then re-added\n    // whenever a topic is added.\n    if (tfsNotYetAdded.length) {\n      availableTfsRef.current = [...availableTfsRef.current, ...tfsNotYetAdded];\n    }\n  }\n  const availableTfs = availableTfsRef.current;\n\n  const allNamespaces = sceneBuilder ? sceneBuilder.allNamespaces : [];\n\n  const availableNamespacesByTopic = useMemo(() => {\n    const result = { ...staticallyAvailableNamespacesByTopic };\n    for (const { name, topic } of allNamespaces) {\n      result[topic] = result[topic] || [];\n      result[topic].push(name);\n    }\n    if (availableTfs.length) {\n      result[$TF] = availableTfs;\n    }\n    return result;\n  }, [availableTfs, allNamespaces, staticallyAvailableNamespacesByTopic]);\n\n  const errorsByTopic = sceneBuilder ? sceneBuilder.errorsByTopic : {};\n\n  const sceneErrorsByKey = useMemo(() => mapKeys(errorsByTopic, (value, topicName) => generateNodeKey({ topicName })), [\n    errorsByTopic,\n  ]);\n\n  const sceneErrorsByKeyMemo = useDeepMemo(sceneErrorsByKey);\n\n  return { availableNamespacesByTopic, sceneErrorsByKey: sceneErrorsByKeyMemo };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4, quat, vec3 } from \"gl-matrix\";\nimport type { Vec3 } from \"gl-matrix\";\n\nimport Transforms, { Transform } from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport type { Marker, ArrowMarker, Color, MutablePose } from \"webviz-core/src/types/Messages\";\nimport type { MarkerProvider, MarkerCollector } from \"webviz-core/src/types/Scene\";\nimport { MARKER_MSG_TYPES } from \"webviz-core/src/util/globalConstants\";\n\nconst originPosition = { x: 0, y: 0, z: 0 };\nconst originOrientation = { x: 0, y: 0, z: 0, w: 1 };\n\nconst defaultArrowMarker = {\n  id: \"\",\n  header: {\n    frame_id: \"\",\n    stamp: {\n      sec: 0,\n      nsec: 0,\n    },\n  },\n  ns: \"tf-axes\",\n  type: 0,\n  action: 0,\n};\n\nconst defaultArrowScale = { x: 0.2, y: 0.02, z: 0.02 };\n\nconst getOriginPose = (): MutablePose => ({\n  position: { ...originPosition },\n  orientation: { ...originOrientation },\n});\n\nconst unitXVector = vec3.fromValues(1, 0, 0);\n\ntype Axis = ArrowMarker & {\n  id: string,\n  color: Color,\n  unitVector: Vec3,\n};\n\nconst originAxes: Array<Axis> = [\n  {\n    ...defaultArrowMarker,\n    scale: { ...defaultArrowScale },\n    pose: {\n      position: { ...originPosition },\n      orientation: { ...originOrientation },\n    },\n    id: \"X\",\n    color: { r: 1, g: 0, b: 0, a: 1 },\n    unitVector: vec3.fromValues(1, 0, 0),\n  },\n  {\n    ...defaultArrowMarker,\n    scale: { ...defaultArrowScale },\n    pose: {\n      position: { ...originPosition },\n      orientation: { ...originOrientation },\n    },\n    id: \"Y\",\n    color: { r: 0, g: 1, b: 0, a: 1 },\n    unitVector: vec3.fromValues(0, 1, 0),\n  },\n  {\n    ...defaultArrowMarker,\n    scale: { ...defaultArrowScale },\n    pose: {\n      position: { ...originPosition },\n      orientation: { ...originOrientation },\n    },\n    id: \"Z\",\n    color: { r: 0, g: 0, b: 1, a: 1 },\n    unitVector: vec3.fromValues(0, 0, 1),\n  },\n];\n\nconst tempOrientation = [0, 0, 0, 0];\n\nconst getTransformedAxisArrowMarker = (id: string, transform: Transform, axis: Axis, rootTransformID: string) => {\n  const { unitVector, id: axisId } = axis;\n  quat.rotationTo(tempOrientation, unitXVector, unitVector);\n  const pose = {\n    position: { ...originPosition },\n    orientation: { x: tempOrientation[0], y: tempOrientation[1], z: tempOrientation[2], w: tempOrientation[3] },\n  };\n\n  transform.apply(pose, pose, rootTransformID);\n\n  return {\n    ...axis,\n    id: `${id}-${axisId}axis`,\n    name: `${id}-${axisId}axis`,\n    pose,\n  };\n};\n\nconst getAxesArrowMarkers = (id: string, transform: Transform, rootTransformID: string): ArrowMarker[] => {\n  return originAxes.map((axis) => getTransformedAxisArrowMarker(id, transform, axis, rootTransformID));\n};\n\nconst getAxisTextMarker = (id: string, transform: Transform, rootTransformID: string): Marker => {\n  const textPose = getOriginPose();\n  transform.apply(textPose, textPose, rootTransformID);\n  // Lower it a little in world coordinates so it appears slightly below the axis origin (like in rviz).\n  textPose.position.z = textPose.position.z - 0.02;\n  return {\n    header: {\n      frame_id: \"\",\n      stamp: {\n        sec: 0,\n        nsec: 0,\n      },\n    },\n    ns: \"tf-axes\",\n    action: 0,\n    scale: { x: 1, y: 1, z: 1 },\n    color: { r: 1, g: 1, b: 1, a: 1 },\n    id: `${id}-name`,\n    name: `${id}-name`,\n    pose: textPose,\n    type: MARKER_MSG_TYPES.TEXT_VIEW_FACING,\n    text: id,\n  };\n};\n\nconst tempTranslation = [0, 0, 0];\n// So we don't create a lot of effectively unused vectors / quats.\nconst throwawayQuat = { ...originOrientation };\n\n// Exported for tests\nexport const getArrowToParentMarkers = (id: string, transform: Transform, rootTransformID: string): ArrowMarker[] => {\n  const { parent } = transform;\n  if (!parent) {\n    return [];\n  }\n\n  // If the distance between the parent and child is 0, skip drawing an arrow between them.\n  mat4.getTranslation(tempTranslation, transform.matrix);\n  if (vec3.length(tempTranslation) <= 0) {\n    return [];\n  }\n\n  let childPose = { position: { ...originPosition }, orientation: throwawayQuat };\n  childPose = transform.apply(childPose, childPose, rootTransformID);\n\n  let parentPose = { position: { ...originPosition }, orientation: throwawayQuat };\n  parentPose = parent && parent.apply(parentPose, parentPose, rootTransformID);\n\n  if (!childPose || !parentPose) {\n    return [];\n  }\n\n  return [\n    {\n      ...defaultArrowMarker,\n      pose: {\n        position: { ...originPosition },\n        orientation: { ...originOrientation },\n      },\n      id: `${id}-childToParentArrow`,\n      color: { r: 1, g: 1, b: 0, a: 1 },\n      points: [childPose.position, parentPose.position],\n      scale: {\n        // Intentionally different scale from the other arrows, to make the arrow head reasonable.\n        x: 0.02,\n        y: 0.01,\n        z: 0.05,\n      },\n    },\n  ];\n};\n\nexport default class TransformsBuilder implements MarkerProvider {\n  transforms: Transforms;\n  rootTransformID: string;\n  selections: string[] = [];\n\n  setTransforms = (transforms: Transforms, rootTransformID: string) => {\n    this.transforms = transforms;\n    this.rootTransformID = rootTransformID;\n  };\n\n  addMarkersForTransform(add: MarkerCollector, id: string, transform: Transform, rootTransformID: string) {\n    if (!transform.isChildOfTransform(rootTransformID)) {\n      return;\n    }\n    const markersForTransform: Marker[] = [\n      ...getAxesArrowMarkers(id, transform, rootTransformID),\n      ...getArrowToParentMarkers(id, transform, rootTransformID),\n      getAxisTextMarker(id, transform, rootTransformID),\n    ];\n    for (const marker of markersForTransform) {\n      switch (marker.type) {\n        case 0:\n          add.arrow(marker);\n          break;\n        case 9:\n          add.text(marker);\n          break;\n        default:\n          console.warn(\"Marker for transform not supported\", marker);\n      }\n    }\n  }\n\n  setSelectedTransforms(selections: string[]) {\n    this.selections = selections;\n  }\n\n  renderMarkers = (add: MarkerCollector) => {\n    const { selections, transforms } = this;\n    if (!transforms) {\n      return;\n    }\n    for (const key of selections) {\n      const transform = this.transforms.get(key);\n      if (!transform.isValid(this.rootTransformID)) {\n        // If a marker doesn't exist yet, skip rendering for now, we might get the\n        // transform in a later message, so we still want to keep it in selections.\n        continue;\n      }\n      this.addMarkersForTransform(add, key, transform, this.rootTransformID);\n    }\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { type Node, forwardRef } from \"react\";\nimport {\n  OffscreenWorldview,\n  type CameraState,\n  type MouseHandler,\n  DEFAULT_CAMERA_STATE,\n  WorldviewReactContext,\n} from \"regl-worldview\";\n\nimport OverlayProjector from \"webviz-core/src/panels/ThreeDimensionalViz/commands/OverlayProjector\";\nimport { LAYER_INDEX_DEFAULT_BASE } from \"webviz-core/src/panels/ThreeDimensionalViz/constants\";\nimport Crosshair from \"webviz-core/src/panels/ThreeDimensionalViz/Crosshair\";\nimport MeasureMarker, { type MeasurePoints } from \"webviz-core/src/panels/ThreeDimensionalViz/MeasureMarker\";\nimport type { ThreeDimensionalVizHooks } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/types\";\nimport { withDiffMode } from \"webviz-core/src/panels/ThreeDimensionalViz/utils/diffModeUtils\";\nimport {\n  TextHighlighter,\n  type WorldSearchTextProps,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/utils/searchTextUtils\";\nimport withHighlights from \"webviz-core/src/panels/ThreeDimensionalViz/withWorldMarkerHighlights.js\";\nimport WorldMarkers, { type InteractiveMarkersByType } from \"webviz-core/src/panels/ThreeDimensionalViz/WorldMarkers\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\nimport type { MarkerCollector, MarkerProvider } from \"webviz-core/src/types/Scene\";\nimport { useChangeDetector, useGetCurrentValue } from \"webviz-core/src/util/hooks\";\n\ntype Props = {|\n  autoTextBackgroundColor: boolean,\n  cameraState: CameraState,\n  children?: Node,\n  hooks: ThreeDimensionalVizHooks,\n  isPlaying: boolean,\n  isDemoMode: boolean,\n  markerProviders: MarkerProvider[],\n  onCameraStateChange: (CameraState) => void,\n  onClick: MouseHandler,\n  onDoubleClick: MouseHandler,\n  onMouseDown?: MouseHandler,\n  onMouseMove?: MouseHandler,\n  onMouseUp?: MouseHandler,\n  diffModeEnabled: boolean,\n  canvas: HTMLCanvasElement,\n  setOverlayIcons: (any) => void,\n  showCrosshair: ?boolean,\n  measurePoints: MeasurePoints,\n  resolveRenderSignal: () => void,\n  sphericalRangeScale: number,\n  ...WorldSearchTextProps,\n|};\n\nfunction getMarkers(markerProviders: MarkerProvider[], hooks: ThreeDimensionalVizHooks): InteractiveMarkersByType {\n  const markers: InteractiveMarkersByType = {\n    arrow: [],\n    cube: [],\n    cubeList: [],\n    cylinder: [],\n    filledPolygon: [],\n    glText: [],\n    grid: [],\n    instancedLineList: [],\n    laserScan: [],\n    linedConvexHull: [],\n    lineList: [],\n    lineStrip: [],\n    overlayIcon: [],\n    radarPointCluster: [],\n    pointcloud: [],\n    points: [],\n    poseMarker: [],\n    sphere: [],\n    sphereList: [],\n    text: [],\n    triangleList: [],\n  };\n\n  const collector = {};\n  hooks.allSupportedMarkers.forEach((field) => {\n    if (!markers[field]) {\n      markers[field] = [];\n    }\n    collector[field] = (o) => markers[field].push(o);\n  });\n\n  markerProviders.forEach((provider) => {\n    if (provider) {\n      provider.renderMarkers(((collector: any): MarkerCollector));\n    }\n  });\n\n  return markers;\n}\n\n// When rendering in a worker, we wait until worldview paints before calling resumeFrame.\nfunction RenderSignalResolver({ resolveRenderSignal }: { resolveRenderSignal: () => void }) {\n  const getResolveRenderSignal = useGetCurrentValue(resolveRenderSignal);\n  const resolveLatestSignal = React.useCallback(() => {\n    getResolveRenderSignal()();\n  }, [getResolveRenderSignal]);\n\n  const worldviewContext = React.useContext(WorldviewReactContext);\n  if (useChangeDetector([resolveRenderSignal], true) && worldviewContext) {\n    // If the 3D panel is completely empty, we don't want to block playback if worldview doesn't\n    // paint. Force a worldview paint to occur for every frame, even if it wouldn't normally\n    // schedule one.\n    worldviewContext.onDirty();\n  }\n\n  React.useEffect(() => {\n    if (worldviewContext) {\n      worldviewContext.registerPaintCallback(resolveLatestSignal);\n      return () => {\n        worldviewContext.unregisterPaintCallback(resolveLatestSignal);\n      };\n    }\n  }, [resolveLatestSignal, worldviewContext]);\n  return null;\n}\n\n// Wrap the WorldMarkers in HoC(s)\nconst WrappedWorldMarkers = withHighlights(withDiffMode(WorldMarkers));\n\nfunction World(\n  {\n    onClick,\n    autoTextBackgroundColor,\n    children,\n    onCameraStateChange,\n    diffModeEnabled,\n    cameraState,\n    hooks,\n    isPlaying,\n    isDemoMode,\n    markerProviders,\n    onDoubleClick,\n    onMouseDown,\n    onMouseMove,\n    onMouseUp,\n    setSearchTextMatches,\n    searchText,\n    searchTextOpen,\n    selectedMatchIndex,\n    searchTextMatches,\n    canvas,\n    setOverlayIcons,\n    showCrosshair,\n    measurePoints,\n    resolveRenderSignal,\n    sphericalRangeScale,\n  }: Props,\n  ref: OffscreenWorldview\n) {\n  const markersByType = getMarkers(markerProviders, hooks);\n  const { text = [], overlayIcon } = markersByType;\n  const textHighlighter = React.useMemo(() => new TextHighlighter(setSearchTextMatches), [setSearchTextMatches]);\n  const processedMarkersByType = {\n    ...markersByType,\n    text: [],\n    glText: textHighlighter.highlightText({\n      text,\n      searchText,\n      searchTextOpen,\n      selectedMatchIndex,\n      searchTextMatches,\n    }),\n  };\n\n  const cameraDistance = cameraState.distance || DEFAULT_CAMERA_STATE.distance;\n\n  return (\n    <OffscreenWorldview\n      cameraState={cameraState}\n      enableStackedObjectEvents={!isPlaying}\n      hideDebug={inScreenshotTests()}\n      onCameraStateChange={onCameraStateChange}\n      // Rendering the hitmap is an expensive operation and we want to avoid\n      // doing it when the user is dragging the view with the mouse. By ignoring\n      // these events, the only way to select an object is when receiving an \"onClick\" event.\n      disableHitmapForEvents={[\"onMouseDown\", \"onMouseMove\", \"onMouseUp\"]}\n      onClick={onClick}\n      onDoubleClick={onDoubleClick}\n      onMouseDown={onMouseDown}\n      onMouseMove={onMouseMove}\n      onMouseUp={onMouseUp}\n      resolutionScale={isDemoMode ? 2 : 1}\n      ref={ref}\n      contextAttributes={{ preserveDrawingBuffer: true }}\n      canvas={canvas}\n      width={canvas.width}\n      height={canvas.height}\n      top={0}\n      left={0}>\n      {children}\n      <RenderSignalResolver resolveRenderSignal={resolveRenderSignal} />\n      <WrappedWorldMarkers\n        {...{\n          autoTextBackgroundColor,\n          markersByType: processedMarkersByType,\n          layerIndex: LAYER_INDEX_DEFAULT_BASE,\n          clearCachedMarkers: false,\n          diffModeEnabled,\n          hooks,\n          sphericalRangeScale,\n        }}\n      />\n      <OverlayProjector setOverlayIcons={setOverlayIcons}>{overlayIcon}</OverlayProjector>\n      {!cameraState.perspective && showCrosshair && <Crosshair cameraState={cameraState} hooks={hooks} />}\n      <MeasureMarker measurePoints={measurePoints} cameraDistance={cameraDistance} />\n    </OffscreenWorldview>\n  );\n}\n\nexport default forwardRef<typeof OffscreenWorldview, _>(World);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat } from \"gl-matrix\";\nimport React from \"react\";\nimport { cameraStateSelectors, Lines, type CameraState } from \"regl-worldview\";\n\nimport type { ThreeDimensionalVizHooks } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/types\";\n\ntype Props = {\n  cameraState: CameraState,\n  hooks: ThreeDimensionalVizHooks,\n};\n\nexport default function Crosshair({ cameraState, hooks }: Props) {\n  const { target, targetOffset, distance, thetaOffset } = cameraState;\n  const targetHeading = cameraStateSelectors.targetHeading(cameraState);\n  // move the crosshair to the center of the camera's viewport: the target + targetOffset rotated by heading\n  const crosshairPoint = [0, 0, 0];\n  vec3.add(crosshairPoint, vec3.rotateZ(crosshairPoint, targetOffset, [0, 0, 0], -targetHeading), target);\n\n  // orient and size the crosshair so it remains visually fixed in the center\n  const length = 0.02 * distance;\n  const orientation = [0, 0, 0, 1];\n  const theta = targetHeading + thetaOffset;\n\n  quat.rotateZ(orientation, orientation, -theta);\n\n  const crosshair = (z, extraThickness) => {\n    const thickness = 0.004 * distance * (1 + extraThickness);\n    return {\n      header: {\n        frame_id: hooks.rootTransformFrame,\n        stamp: { sec: 0, nsec: 0 },\n      },\n      type: 5,\n      action: 0,\n      id: \"\",\n      ns: \"\",\n      pose: {\n        position: { x: crosshairPoint[0], y: crosshairPoint[1], z },\n        orientation: {\n          x: orientation[0],\n          y: orientation[1],\n          z: orientation[2],\n          w: orientation[3],\n        },\n      },\n      points: [\n        { x: -length * (1 + 0.1 * extraThickness), y: 0, z: 0 },\n        { x: length * (1 + 0.1 * extraThickness), y: 0, z: 0 },\n        { x: 0, y: -length * (1 + 0.1 * extraThickness), z: 0 },\n        { x: 0, y: length * (1 + 0.1 * extraThickness), z: 0 },\n      ],\n      scale: { x: thickness, y: thickness, z: thickness },\n    };\n  };\n\n  return (\n    <Lines>\n      {[\n        {\n          ...crosshair(1000, 0.6),\n          color: { r: 0, g: 0, b: 0, a: 1 },\n        },\n        {\n          ...crosshair(1001, 0),\n          color: { r: 1, g: 1, b: 1, a: 1 },\n        },\n      ]}\n    </Lines>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport { Lines, Spheres, WorldviewReactContext, type Point } from \"regl-worldview\";\n\nexport type MeasurePoints = {|\n  start: ?Point,\n  end: ?Point,\n|};\n\ntype Props = {|\n  measurePoints: MeasurePoints,\n  cameraDistance: number,\n|};\n\nconst SPHERE_SIZE_PX = 13;\n\nconst defaultPose: any = Object.freeze({ orientation: { x: 0, y: 0, z: 0, w: 1 } });\nconst defaultSphere: any = Object.freeze({\n  type: 2,\n  action: 0,\n  color: { r: 1, g: 0.2, b: 0, a: 0.75 },\n});\n\nexport default function MeasureMarker({ measurePoints: { start, end }, cameraDistance }: Props) {\n  const { dimension } = React.useContext(WorldviewReactContext);\n  const sphere = React.useMemo(() => {\n    const size = (cameraDistance / dimension.height) * SPHERE_SIZE_PX;\n    return {\n      ...defaultSphere,\n      scale: { x: size, y: size, z: 0.1 },\n    };\n  }, [cameraDistance, dimension]);\n  const lineSize: number = sphere.scale.x / 3;\n\n  const spheres = [];\n  const lines = [];\n  if (start) {\n    spheres.push({\n      ...sphere,\n      id: \"_measure_start\",\n      pose: { position: start, ...defaultPose },\n    });\n\n    if (end) {\n      const endPoint = { ...end };\n      lines.push({\n        ...sphere,\n        id: \"_measure_line\",\n        points: [start, end],\n        pose: { ...defaultPose, position: { x: 0, y: 0, z: 0 } },\n        scale: { x: lineSize, y: 1, z: 1 },\n        type: 4,\n      });\n\n      spheres.push({\n        ...sphere,\n        id: \"_measure_end\",\n        pose: { position: endPoint, ...defaultPose },\n      });\n    }\n  }\n\n  return (\n    <>\n      {lines.length > 0 && <Lines>{lines}</Lines>}\n      {spheres.length > 0 && <Spheres>{spheres}</Spheres>}\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { partition } from \"lodash\";\nimport React, { type ComponentType } from \"react\";\nimport { vec4ToRGBA } from \"regl-worldview\";\n\nimport { LAYER_INDEX_DIFF_MODE_BASE_PER_PASS } from \"webviz-core/src/panels/ThreeDimensionalViz/constants\";\nimport type {\n  InteractiveMarkersByType,\n  WorldMarkerProps,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/WorldMarkers\";\nimport { $WEBVIZ_SOURCE_2 } from \"webviz-core/src/util/globalConstants\";\n\nexport const BASE_COLOR = [0.5, 0.5, 0.5, 1.0];\nexport const SOURCE_1_COLOR = [1, 0, 1, 1];\nexport const SOURCE_2_COLOR = [0, 1, 1, 1];\n\nexport const BASE_COLOR_RGBA = vec4ToRGBA(BASE_COLOR);\nexport const SOURCE_1_COLOR_RGBA = vec4ToRGBA(SOURCE_1_COLOR);\nexport const SOURCE_2_COLOR_RGBA = vec4ToRGBA(SOURCE_2_COLOR);\n\n// Group markers into different collections in order to render them with different colors\n// based on their source.\nexport function getDiffBySource(markers: InteractiveMarkersByType): InteractiveMarkersByType[] {\n  const ret = [{}, {}, {}];\n\n  // Look for each marker type, spliting them into two sets if possible (one for each source)\n  // Then, modify the markers so they're rendered based on their source.\n  for (const key of Object.keys(markers)) {\n    const value = markers[key];\n    const elems = Array.isArray(value) ? value : [value];\n    const [source1, source2] = partition(elems, (m) => {\n      const { interactionData } = m;\n      return !interactionData || !interactionData.topic.startsWith($WEBVIZ_SOURCE_2);\n    });\n\n    // Format markers. This results in three render passes:\n    // 1. Render Source 1 markers in red\n    // 2. Render Source 2 markers in gray, disabling depth checking.\n    // 3. Render Source 2 markers in green, with depth checking enabled (written in step 1).\n    ret[0][key] = source1.map((m) => ({\n      ...m,\n      colors: [],\n      color: SOURCE_1_COLOR_RGBA,\n      depth: {\n        enable: true,\n        mask: true,\n      },\n      blend: {\n        enable: true,\n        func: {\n          src: \"constant color\",\n          dst: \"src alpha\",\n        },\n        color: SOURCE_1_COLOR,\n      },\n    }));\n    ret[1][key] = source2.map((m) => ({\n      ...m,\n      colors: [],\n      color: BASE_COLOR_RGBA,\n      depth: {\n        enable: false,\n      },\n      blend: {\n        enable: true,\n        func: {\n          src: \"constant color\",\n          dst: \"zero\",\n        },\n        color: BASE_COLOR,\n      },\n    }));\n    ret[2][key] = source2.map((m) => ({\n      ...m,\n      colors: [],\n      color: SOURCE_2_COLOR_RGBA,\n      depth: {\n        enable: true,\n      },\n      blend: {\n        enable: true,\n        func: {\n          src: \"constant color\",\n          dst: \"one\",\n        },\n        color: SOURCE_2_COLOR,\n      },\n    }));\n  }\n  return ret;\n}\n\nexport const withDiffMode = (BaseWorldMarkers: ComponentType<WorldMarkerProps>) => {\n  const WorldMarkersWithDiffMode = (props: WorldMarkerProps) => {\n    const { diffModeEnabled } = props;\n    if (diffModeEnabled) {\n      return (\n        <>\n          {getDiffBySource(props.markersByType).map((markersByRenderPass, i) => (\n            <BaseWorldMarkers\n              key={i}\n              {...{\n                ...props,\n                clearCachedMarkers: true,\n                layerIndex: props.layerIndex + i * LAYER_INDEX_DIFF_MODE_BASE_PER_PASS,\n                markersByType: markersByRenderPass,\n              }}\n            />\n          ))}\n        </>\n      );\n    }\n    return <BaseWorldMarkers {...props} />;\n  };\n  return WorldMarkersWithDiffMode;\n};\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { range, throttle } from \"lodash\";\n\nimport type { Interactive } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\nimport type { TextMarker, Color } from \"webviz-core/src/types/Messages\";\n\nexport const YELLOW = { r: 1, b: 0, g: 1, a: 1 };\nexport const ORANGE = { r: 0.97, g: 0.58, b: 0.02, a: 1 };\n\n// $FlowFixMe - Can't figure this one out.\nexport type GLTextMarker = TextMarker & {\n  highlightedIndices?: number[],\n  highlightColor?: Color,\n};\n\nexport type SetSearchTextMatches = (((GLTextMarker[]) => GLTextMarker[]) | GLTextMarker[]) => void;\n\nexport type WorldSearchTextProps = {|\n  searchTextOpen: boolean,\n  searchText: string,\n  searchTextWithInlinedVariables: string,\n  setSearchTextMatches: SetSearchTextMatches,\n  searchTextMatches: GLTextMarker[],\n  selectedMatchIndex: number,\n|};\n\nexport type SearchTextProps = {|\n  ...WorldSearchTextProps,\n  toggleSearchTextOpen: (bool: boolean) => void,\n  setSearchText: (searchText: string) => void,\n  setSelectedMatchIndex: (index: number) => void,\n  searchInputRef: {| current: ?HTMLInputElement |},\n|};\n\nexport const getHighlightedIndices = (text?: string, searchText: string): number[] => {\n  const highlightedIndicesSet = new Set();\n  let match;\n  let startingIndex = 0;\n  const lowerCaseSearchText = searchText.toLowerCase();\n  const lowerCaseText = text ? text.toLowerCase() : \"\";\n  while ((match = lowerCaseText.indexOf(lowerCaseSearchText, startingIndex)) !== -1) {\n    range(match, match + searchText.length).forEach((index) => {\n      highlightedIndicesSet.add(index);\n    });\n    startingIndex = match + 1;\n  }\n\n  const highlightedIndices = Array.from(highlightedIndicesSet);\n  return highlightedIndices;\n};\n\nexport class TextHighlighter {\n  _throttledSetSearchTextMatches: (markers: GLTextMarker[]) => void;\n  constructor(setSearchTextMatches: (markers: GLTextMarker[]) => void) {\n    this._throttledSetSearchTextMatches = throttle(setSearchTextMatches, 200, { trailing: true });\n  }\n\n  highlightText({\n    text,\n    searchText,\n    searchTextOpen,\n    selectedMatchIndex,\n    searchTextMatches,\n  }: {|\n    searchTextOpen: boolean,\n    searchText: string,\n    searchTextMatches: GLTextMarker[],\n    selectedMatchIndex: number,\n    text: Interactive<TextMarker>[],\n  |}): Interactive<GLTextMarker>[] {\n    let numMatches = 0;\n    const glText: Interactive<GLTextMarker>[] = text.map((marker) => {\n      const scale = {\n        // RViz ignores scale.x/y for text and only uses z\n        x: marker.scale.z,\n        y: marker.scale.z,\n        z: marker.scale.z,\n      };\n\n      if (!searchText || !searchTextOpen) {\n        return { ...marker, scale };\n      }\n\n      const highlightedIndices = getHighlightedIndices(marker.text, searchText);\n\n      if (highlightedIndices.length) {\n        numMatches += 1;\n        const highlightedMarker = {\n          ...marker,\n          scale,\n          highlightColor: selectedMatchIndex + 1 === numMatches ? ORANGE : YELLOW,\n          highlightedIndices,\n        };\n        return highlightedMarker;\n      }\n\n      return { ...marker, scale };\n    });\n    if (searchTextOpen || searchTextMatches.length) {\n      const matches = glText.filter((marker) => marker.highlightedIndices && marker.highlightedIndices.length);\n      if (matches.length) {\n        this._throttledSetSearchTextMatches(matches);\n      } else if (!matches.length && searchTextMatches.length) {\n        this._throttledSetSearchTextMatches([]);\n      }\n    }\n    return glText;\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { partition } from \"lodash\";\nimport React, { type ComponentType } from \"react\";\n\nimport Cover from \"webviz-core/src/panels/ThreeDimensionalViz/commands/Cover\";\nimport {\n  LAYER_INDEX_HIGHLIGHT_OVERLAY,\n  LAYER_INDEX_HIGHLIGHT_BASE,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/constants\";\nimport { type WorldMarkerProps } from \"webviz-core/src/panels/ThreeDimensionalViz/WorldMarkers\";\n\nconst withHighlights = (BaseWorldMarkers: ComponentType<WorldMarkerProps>) => {\n  const WorldMarkersWithHighlights = (props: WorldMarkerProps) => {\n    const { markersByType } = props;\n\n    // We only want to render the dim <Cover> overlay if there's at least one highlighted marker in the scene.\n    let hasHighlightedMarkers = false;\n    const highlightedMarkersByType = {};\n    const nonHighlightedMarkersByType = {};\n\n    // Partition the markersByType into two sets: highlighted and non-highlighted\n    Object.keys(markersByType).forEach((type) => {\n      const [highlightedMarkers, nonHighlightedMarkers] = partition(\n        markersByType[type],\n        ({ interactionData }) => interactionData?.highlighted\n      );\n\n      highlightedMarkersByType[type] = highlightedMarkers;\n      nonHighlightedMarkersByType[type] = nonHighlightedMarkers;\n      hasHighlightedMarkers = hasHighlightedMarkers || highlightedMarkers.length > 0;\n    });\n\n    return (\n      <>\n        <BaseWorldMarkers {...{ ...props, markersByType: nonHighlightedMarkersByType }} />\n        <Cover\n          color={[0, 0, 0, hasHighlightedMarkers ? 0.6 : 0]}\n          layerIndex={LAYER_INDEX_HIGHLIGHT_OVERLAY}\n          overwriteDepthBuffer\n        />\n        <BaseWorldMarkers\n          {...{\n            ...props,\n            layerIndex: LAYER_INDEX_HIGHLIGHT_BASE,\n            markersByType: highlightedMarkersByType,\n          }}\n        />\n      </>\n    );\n  };\n  WorldMarkersWithHighlights.displayName = \"WorldMarkersWithHighlights\";\n  return WorldMarkersWithHighlights;\n};\n\nexport default withHighlights;\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport memoize from \"lodash/memoize\";\nimport React from \"react\";\nimport { Command } from \"regl-worldview\";\n\nimport type { ReglColor } from \"webviz-core/src/util/colorUtils\";\n\nconst makeReglCommand = memoize(\n  ({ overwriteDepthBuffer }: { overwriteDepthBuffer?: boolean }) => (regl) => ({\n    vert: `\n      precision mediump float;\n      attribute vec2 position;\n      void main () {\n        gl_Position = vec4(position, 1, 1);\n      }\n    `,\n\n    frag: `\n      precision mediump float;\n      uniform vec4 color;\n      void main () {\n        gl_FragColor = color;\n    }`,\n\n    attributes: {\n      position: regl.prop(\"points\"),\n    },\n\n    uniforms: {\n      color: regl.prop(\"color\"),\n    },\n\n    count: regl.prop(\"points.length\"),\n\n    blend: {\n      enable: true,\n      func: {\n        src: \"src alpha\",\n        dst: \"one minus src alpha\",\n      },\n    },\n\n    depth: {\n      // If overwriteDepthBuffer is enabled, we will always\n      // write to the depth buffer with a \"far away\" value of 1.\n      // The result is similar to calling regl.clear({ depth: 1 }).\n      enable: overwriteDepthBuffer ?? false,\n      func: \"always\",\n    },\n  }),\n  (...args) => JSON.stringify(args)\n);\n\nexport default function Cover({\n  color,\n  layerIndex,\n  overwriteDepthBuffer,\n}: {\n  color: ReglColor,\n  layerIndex?: number,\n\n  // When enabled, the cover will overwrite the depth buffer when it is drawn.\n  // This is useful if you'd like to draw new content on top of the Cover.\n  overwriteDepthBuffer?: boolean,\n}) {\n  // Two triangles covering the entire screen\n  const points = [[-1, -1], [-1, 1], [1, 1], [-1, -1], [1, -1], [1, 1]];\n  return (\n    <Command reglCommand={makeReglCommand({ overwriteDepthBuffer })} layerIndex={layerIndex}>\n      {{ color, points }}\n    </Command>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useMemo, useState, useEffect } from \"react\";\nimport {\n  Arrows,\n  Cubes,\n  Cylinders,\n  GLText,\n  Points,\n  Spheres,\n  Triangles,\n  Lines,\n  FilledPolygons,\n  createInstancedGetChildrenForHitmap,\n} from \"regl-worldview\";\n\nimport glTextAtlasLoader, { type TextAtlas } from \"./utils/glTextAtlasLoader\";\nimport { groupLinesIntoInstancedLineLists } from \"./utils/groupingUtils\";\nimport {\n  OccupancyGrids,\n  LaserScans,\n  PointClouds,\n  LinedConvexHulls,\n  RadarPointClusters,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/commands\";\nimport { LAYER_INDEX_TEXT, LAYER_INDEX_OCCUPANCY_GRIDS } from \"webviz-core/src/panels/ThreeDimensionalViz/constants\";\nimport type { Interactive } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\nimport type { ThreeDimensionalVizHooks } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/types\";\nimport { type GLTextMarker } from \"webviz-core/src/panels/ThreeDimensionalViz/SearchText\";\nimport type {\n  BaseMarker,\n  CubeListMarker,\n  CubeMarker,\n  CylinderMarker,\n  LineListMarker,\n  LineStripMarker,\n  PointsMarker,\n  SphereListMarker,\n  SphereMarker,\n  TextMarker,\n  OverlayIconMarker,\n  RadarPointCluster,\n} from \"webviz-core/src/types/Messages\";\n\nexport type MarkerWithInteractionData = Interactive<any>;\nexport type InteractiveMarkersByType = {\n  arrow: MarkerWithInteractionData[],\n  cube: Interactive<CubeMarker>[],\n  cubeList: Interactive<CubeListMarker>[],\n  cylinder: Interactive<CylinderMarker>[],\n  filledPolygon: Interactive<SphereMarker>[],\n  glText: Interactive<GLTextMarker>[],\n  grid: Interactive<BaseMarker>[],\n  instancedLineList: Interactive<BaseMarker>[],\n  laserScan: Interactive<BaseMarker>[],\n  linedConvexHull: Interactive<BaseMarker>[],\n  lineList: Interactive<LineListMarker>[],\n  lineStrip: Interactive<LineStripMarker>[],\n  overlayIcon: Interactive<OverlayIconMarker>[],\n  radarPointCluster: Interactive<RadarPointCluster>[],\n  pointcloud: Interactive<SphereMarker>[],\n  points: Interactive<PointsMarker>[],\n  poseMarker: Interactive<BaseMarker>[],\n  sphere: Interactive<SphereMarker>[],\n  sphereList: Interactive<SphereListMarker>[],\n  text: Interactive<TextMarker>[],\n  triangleList: MarkerWithInteractionData[],\n};\n\n// Generate an alphabet for text makers with the most\n// used ASCII characters to prevent recreating the texture\n// atlas too many times for dynamic texts.\nconst ALPHABET = (() => {\n  const start = 32; // SPACE\n  const end = 125; // \"}\"\n  return new Array(end - start + 1).fill().map((_, i) => String.fromCodePoint(start + i));\n})();\n\nconst glTextAtlasPromise = glTextAtlasLoader();\n\ntype GLTextAtlasStatus = {\n  status: \"LOADING\" | \"LOADED\",\n  glTextAtlas: ?TextAtlas,\n};\n\nexport type WorldMarkerProps = {|\n  autoTextBackgroundColor: boolean,\n  layerIndex?: number,\n  markersByType: InteractiveMarkersByType,\n  clearCachedMarkers: boolean,\n  diffModeEnabled: boolean,\n  hooks: ThreeDimensionalVizHooks,\n  sphericalRangeScale: number,\n|};\n\nexport default function WorldMarkers({\n  autoTextBackgroundColor,\n  layerIndex,\n  markersByType,\n  clearCachedMarkers,\n  hooks,\n  sphericalRangeScale,\n}: WorldMarkerProps) {\n  const getChildrenForHitmap = useMemo(() => createInstancedGetChildrenForHitmap(1), []);\n  const {\n    arrow,\n    cube,\n    cubeList,\n    cylinder,\n    filledPolygon,\n    glText,\n    grid,\n    instancedLineList,\n    laserScan,\n    linedConvexHull,\n    lineList,\n    lineStrip,\n    pointcloud,\n    points,\n    poseMarker,\n    radarPointCluster,\n    sphere,\n    sphereList,\n    triangleList,\n    ...rest\n  } = markersByType;\n  const additionalMarkers = hooks.renderAdditionalMarkers(rest);\n\n  // GLTextAtlas download is shared among all instances of World, but we should only load the GLText command once we\n  // have the pregenerated atlas available.\n  const [glTextAtlasInfo, setGlTextAtlasInfo] = useState<GLTextAtlasStatus>({\n    status: \"LOADING\",\n    glTextAtlas: undefined,\n  });\n  useEffect(() => {\n    let mounted = true;\n    glTextAtlasPromise.then((atlas) => {\n      if (mounted) {\n        setGlTextAtlasInfo({ status: \"LOADED\", glTextAtlas: atlas });\n      }\n    });\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  // Group all line strips and line lists into as few markers as possible\n  const groupedLines = groupLinesIntoInstancedLineLists([...lineList, ...lineStrip]);\n\n  return (\n    <>\n      <OccupancyGrids layerIndex={layerIndex + LAYER_INDEX_OCCUPANCY_GRIDS} getMapPalette={hooks.getMapPalette}>\n        {grid}\n      </OccupancyGrids>\n      {additionalMarkers}\n      {/* Render PointClouds first so other markers with the same zIndex can show on top of PointClouds. */}\n      <PointClouds\n        sphericalRangeScale={sphericalRangeScale}\n        layerIndex={layerIndex}\n        clearCachedMarkers={clearCachedMarkers}>\n        {pointcloud}\n      </PointClouds>\n      <Arrows layerIndex={layerIndex}>{arrow}</Arrows>\n      <Points layerIndex={layerIndex} useWorldSpaceSize={hooks.useWorldspacePointSize}>\n        {points}\n      </Points>\n      <Triangles layerIndex={layerIndex}>{triangleList}</Triangles>\n      <Spheres layerIndex={layerIndex}>{[...sphere, ...sphereList]}</Spheres>\n      <Cylinders layerIndex={layerIndex}>{cylinder}</Cylinders>\n      <Cubes layerIndex={layerIndex}>{[...cube, ...cubeList]}</Cubes>\n      <hooks.PoseMarkers layerIndex={layerIndex}>{poseMarker}</hooks.PoseMarkers>\n      <LaserScans layerIndex={layerIndex} laserScanVert={hooks.LaserScanVert}>\n        {laserScan}\n      </LaserScans>\n      {glTextAtlasInfo.status === \"LOADED\" && (\n        <GLText\n          layerIndex={layerIndex + LAYER_INDEX_TEXT}\n          alphabet={ALPHABET}\n          scaleInvariantFontSize={14}\n          autoBackgroundColor={autoTextBackgroundColor}\n          textAtlas={glTextAtlasInfo.glTextAtlas}>\n          {glText}\n        </GLText>\n      )}\n      <FilledPolygons layerIndex={layerIndex}>{filledPolygon}</FilledPolygons>\n      <Lines getChildrenForHitmap={getChildrenForHitmap} layerIndex={layerIndex}>\n        {[...instancedLineList, ...groupedLines]}\n      </Lines>\n      <LinedConvexHulls layerIndex={layerIndex}>{linedConvexHull}</LinedConvexHulls>\n      <RadarPointClusters>{radarPointCluster}</RadarPointClusters>\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { memoize } from \"lodash\";\n\n// The textureAtlasData.bin texture is a hardcoded text atlas, and it is tied to the values in the textAtlas.json. I\n// generated this by modifying the GLText command from regl-worldview and capturing the output of the\n// `memoizedGenerateAtlas` function there. I used a max texture width of 2048 to ensure that this works on all computers\n// using Webviz (max texture width is system-dependent but should always be at least 2048), and also used the default\n// hardcoded alphabet that Webviz uses.\n\nimport textAtlas from \"./textAtlas.json\";\n// $FlowFixMe flow doesn't like file-loader\nimport glTextAtlasUrl from \"./textureAtlasData.bin\";\n\nconst errorMessage = \"Error fetching /textureAtlasData for GLText, generating it client-side\";\n\nexport type TextAtlas = {|\n  textureData: Uint8Array,\n  textureWidth: number,\n  textureHeight: number,\n  charInfo: { [char: string]: {| x: number, y: number, width: number |} },\n|};\n\nasync function getTextAtlas(): Promise<?TextAtlas> {\n  // Don't try to fetch this in tests, it won't work.\n  if (process.env.NODE_ENV === \"test\") {\n    return;\n  }\n\n  let textureData;\n  try {\n    const textureDataResponse = await fetch(glTextAtlasUrl);\n    if (textureDataResponse.status === 200) {\n      const buffer = await textureDataResponse.arrayBuffer();\n      textureData = new Uint8Array(buffer, 0, buffer.byteLength);\n    }\n  } catch (error) {\n    console.error(errorMessage, error);\n    return;\n  }\n\n  if (!textureData) {\n    console.error(errorMessage);\n    return;\n  }\n\n  const expectedSize = textAtlas.textureWidth * textAtlas.textureHeight;\n  if (textureData.length !== expectedSize) {\n    console.error(`Expected texture size of ${expectedSize} but got ${textureData.length}`);\n    return;\n  }\n\n  return {\n    textureData,\n    ...textAtlas,\n  };\n}\n\nexport default memoize<[], Promise<?TextAtlas>>(getTextAtlas);\n","module.exports = __webpack_public_path__ + \"a5cc226f0370fe371ed7141761495798.bin\";","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { groupBy, toPairs } from \"lodash\";\n\nimport type { LineListMarker, LineStripMarker, InstancedLineListMarker } from \"webviz-core/src/types/Messages\";\nimport { COLORS, MARKER_MSG_TYPES } from \"webviz-core/src/util/globalConstants\";\nimport { emptyPose } from \"webviz-core/src/util/Pose\";\n\n// Group multiple line strip and line list markers into as few as possible.\n// This reduces the amount of draw calls required to render line them and increases performance.\n// For improved performance, make sure inputs are either line strips or lists. Other\n// marker types will be not be grouped together and will be returned as is.\nexport function groupLinesIntoInstancedLineLists(\n  markers: (LineListMarker | LineStripMarker)[]\n): (InstancedLineListMarker | LineStripMarker)[] {\n  const resultMarkers = [];\n\n  // Group instances by type, namespace and scale - scale because we can't set it on each instance, and namespace\n  // because it's what's determines marker groupings that can be turned on/off in the topic selector.\n  const groups = groupBy(\n    markers,\n    ({ scale, ns, type }) => `ns:${ns}_type:${type}_scalex:${scale.x}_scaley:${scale.y}_scalez:${scale.z}`\n  );\n\n  const INFINITE_POSITION = { x: NaN, y: NaN, z: NaN };\n  const INFINITE_COLOR = COLORS.CLEAR;\n  const INFINITE_POSE = emptyPose();\n  const INFINITE_METADATA = {};\n\n  for (const [id: string, messageList: any[]] of toPairs(groups)) {\n    const baseMessage = messageList[0];\n    const isLineStrip = baseMessage.type === MARKER_MSG_TYPES.LINE_STRIP;\n    const allColors = []; // accumulated colors\n    const allPoints = []; // accumulated positions\n    const metadataByIndex = [];\n    const poses = [];\n\n    for (let messageIdx = 0; messageIdx < messageList.length; messageIdx++) {\n      const message = messageList[messageIdx];\n      const points = message.points || [];\n      const colors = message.colors || [];\n      if (points.length === 0) {\n        // Ignore markers with no points\n        continue;\n      }\n\n      if (isLineStrip) {\n        // We want to keep corners joined between lines in the same strip. The <Lines>\n        // commands will handle corners automatically for line strips, but doesn't know how to rendered individual\n        // strips since all of them are grouped together. For that reason, we add some extra points\n        // to create invisible lines from/to infinity in between each of the strips. This ends\n        // up rendering only the strips as if they were individual commands.\n        // Since we also need to support selection, we need to add poses and metadata for each of those\n        // new points or else the <Lines> command won't work correctly.\n        // In practice, this process results in redundant data in each of the grouped markers, but\n        // the performance cost is low.\n\n        if (messageIdx > 0) {\n          // If this is not the first strip, we need to add a line from infinity to the\n          // first point that we want to render. By repeating the first point in the strip,\n          // we also make sure gradients look correctly in the final rendered image.\n          allPoints.push(points[0]);\n          allColors.push(INFINITE_COLOR);\n          poses.push(INFINITE_POSE);\n          metadataByIndex.push(INFINITE_METADATA);\n        }\n\n        // Accumulate positions and colors\n        extend(allPoints, points);\n        extend(allColors, colors);\n\n        // In case no point colors are provided or there are not enough values, we use the provided\n        // color for the marker (or a default value)\n        fillExtend(allColors, message.color || COLORS.WHITE, points.length - colors.length);\n\n        // Accumulate poses for each points, if they're provided in the marker\n        if (message.poses && message.poses.length > 0) {\n          extend(poses, message.poses);\n        }\n\n        // Accumulate metadata and poses\n        fillExtend(metadataByIndex, message, points.length);\n        fillExtend(poses, message.pose, points.length - (message.poses ? message.poses.length : 0));\n\n        if (message.closed) {\n          // If this is a closed marker, we need to add an extra point to generate a new line\n          // from the last element to the first one. We also need to add the metadata and a pose\n          // that correspond to that point.\n          allPoints.push(points[0]);\n          allColors.push(colors.length > 0 ? colors[0] : message.color || COLORS.WHITE);\n          metadataByIndex.push(message);\n          poses.push(message.poses ? message.poses[0] : message.pose);\n        }\n\n        if (messageIdx < messageList.length - 1) {\n          // If there are more strips in the same group, we add a line to infinity\n          // The next strip will deal with connecting it with its first point (see above).\n          // By repeating the last point in the strip we ensure gradients look\n          // correctly in the final rendered image.\n          allPoints.push(...[allPoints[allPoints.length - 1], INFINITE_POSITION]);\n          allColors.push(...[INFINITE_COLOR, INFINITE_COLOR]);\n          poses.push(...[INFINITE_POSE, INFINITE_POSE]);\n          metadataByIndex.push(...[INFINITE_METADATA, INFINITE_METADATA]);\n        }\n      } else {\n        // If the marker is already a line list, just add the points to the list, validating that points\n        // are paired correctly.\n        const lineListPoints = validateLineList(points);\n\n        // Point colors, if present, need to be validated in the same way as positions\n        const lineListColors = colors ? validateLineList(colors) : [];\n\n        // Accumulate positions and colors\n        extend(allPoints, lineListPoints);\n        extend(allColors, lineListColors);\n\n        // In case no point colors are provided or there are not enough values, we use the provided\n        // color for the marker (or a default value)\n        fillExtend(allColors, message.color || COLORS.WHITE, lineListPoints.length - lineListColors.length);\n\n        // Both points share the same pose\n        const posesPerInstance = Math.floor(lineListPoints.length / 2);\n        fillExtend(poses, message.pose, posesPerInstance);\n\n        fillExtend(metadataByIndex, message, lineListPoints.length);\n      }\n    }\n\n    if (isLineStrip) {\n      // After all strips have been processed, we need to remove the last metadata and pose\n      // That is because there are N - 1 lines in a strip consisting of N points (and it's easier\n      // to do it here than inside the loop above).\n      metadataByIndex.pop();\n      poses.pop();\n    }\n\n    // Extract common properties from base marker\n    const { header, action, ns, scale, blend, depth } = baseMessage;\n    resultMarkers.push(\n      ({\n        header,\n        action,\n        ns,\n        scale,\n        pose: emptyPose(),\n        colors: allColors,\n        points: allPoints,\n        poses,\n        blend,\n        depth,\n        metadataByIndex,\n        id,\n        // $FlowFixMe - doesn't understand how to handle the type field in markers\n        type: isLineStrip ? MARKER_MSG_TYPES.LINE_STRIP : MARKER_MSG_TYPES.INSTANCED_LINE_LIST,\n        primitive: isLineStrip ? \"line strip\" : \"lines\",\n      }: LineStripMarker | InstancedLineListMarker)\n    );\n  }\n\n  return resultMarkers;\n}\n\nfunction extend<T>(arr1: T[], arr2: T[]) {\n  arr2.forEach((v) => arr1.push(v));\n}\n\n// fillExtend and extend are a bit faster than alternatives that use filling or spreading to\n// achieve the same purpose, and groupPredictionMarkersIntoInstancedMarkers is a fairly heavy\n// function.\nfunction fillExtend<T>(arr: T[], value: T, n: number): void {\n  for (let i = 0; i < n; ++i) {\n    arr.push(value);\n  }\n}\n\n// For line lists, we need to check if the input array contains an\n// even number of elements. Otherwise, drop the last one since it\n// does not represent a valid line.\nfunction validateLineList<T>(points: T[]): T[] {\n  if (points.length % 2 !== 0) {\n    points.pop();\n  }\n  return points;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport { default as PoseMarkers } from \"./PoseMarkers\";\nexport { default as LaserScans } from \"./LaserScans\";\nexport { default as OccupancyGrids } from \"./OccupancyGrids\";\nexport { default as PointClouds } from \"./PointClouds\";\nexport { default as LinedConvexHulls } from \"./LinedConvexHulls\";\nexport { default as OverlayProjector } from \"./OverlayProjector\";\nexport { default as RadarPointClusters } from \"./RadarPointClusters\";\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { range } from \"lodash\";\nimport * as React from \"react\";\nimport {\n  Command,\n  withPose,\n  toRGBA,\n  type Regl,\n  type CommonCommandProps,\n  nonInstancedGetChildrenForHitmap,\n} from \"regl-worldview\";\n\nimport type { LaserScan } from \"webviz-core/src/types/Messages\";\n\nexport const DEFAULT_FLAT_COLOR = { r: 0.5, g: 0.5, b: 1, a: 1 };\n\nconst getLaserScan = (vert) => (regl: Regl) =>\n  withPose({\n    primitive: \"points\",\n    vert,\n    frag: `\n  precision mediump float;\n  varying vec4 vColor;\n  uniform bool isCircle;\n  void main () {\n    if (isCircle && length(gl_PointCoord * 2.0 - 1.0) > 1.0) {\n      discard;\n    }\n\n    gl_FragColor = vColor;\n  }\n  `,\n\n    uniforms: {\n      pointSize: (context, props) => (props.settings && props.settings.pointSize) || 4,\n      isCircle: (context, props) => (props.settings && props.settings.pointShape === \"circle\") || false,\n      // Color is not included in the LaserScan message - it's only included if the color is added by\n      // getChildrenForHitmap.\n      isHitmap: (context, props) => !!props.color,\n\n      angle_min: regl.prop(\"angle_min\"),\n      angle_increment: regl.prop(\"angle_increment\"),\n      range_min: regl.prop(\"range_min\"),\n      range_max: regl.prop(\"range_max\"),\n\n      color: (context, props) => toRGBA(props.settings?.overrideColor || DEFAULT_FLAT_COLOR),\n    },\n\n    attributes: {\n      index: (context, props) => range(props.ranges.length),\n      range: regl.prop(\"ranges\"),\n      intensity: (context, props) =>\n        props.intensities.length === props.ranges.length\n          ? props.intensities\n          : new Float32Array(props.ranges.length).fill(1),\n      hitmapColor: (context, props) => {\n        let color = [0, 0, 0, 1];\n        if (props.color) {\n          color = Array.isArray(props.color) ? props.color : toRGBA(props.color);\n        }\n        return new Array(props.ranges.length).fill(color);\n      },\n    },\n\n    count: regl.prop(\"ranges.length\"),\n  });\n\ntype Props = {\n  ...CommonCommandProps,\n  laserScanVert: string,\n  children: LaserScan[],\n};\n\nexport default function LaserScans(props: Props) {\n  const command = React.useMemo(() => getLaserScan(props.laserScanVert), [props.laserScanVert]);\n  return <Command getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...props} reglCommand={command} />;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { Command, withPose, pointToVec3, defaultBlend, type CommonCommandProps } from \"regl-worldview\";\n\nimport { TextureCache } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/utils\";\nimport type { OccupancyGridMessage } from \"webviz-core/src/types/Messages\";\n\nconst getOccupancyGrids = (getMapPalette: (string) => Uint8Array) => (regl: any) => {\n  // make a buffer holding the verticies of a 1x1 plane\n  // it will be resized in the shader\n  const positionBuffer = regl.buffer([0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0]);\n\n  const cache = new TextureCache(regl);\n  const paletteTextures = new Map<Uint8Array, any>();\n\n  return withPose({\n    primitive: \"triangle strip\",\n\n    vert: `\n    precision lowp float;\n\n    uniform mat4 projection, view;\n    uniform vec3 offset;\n    uniform vec4 orientation;\n    uniform float width, height, resolution, alpha;\n\n    attribute vec3 point;\n\n    #WITH_POSE\n\n    varying vec2 uv;\n    varying float vAlpha;\n\n    void main () {\n      // set the texture uv to the unscaled vertext point\n      uv = vec2(point.x, point.y);\n\n      // compute the plane vertex dimensions\n      float planeWidth = width * resolution;\n      float planeHeight = height * resolution;\n\n      // rotate the point by the ogrid orientation & scale the point by the plane vertex dimensions\n      vec3 position = rotate(point, orientation) * vec3(planeWidth, planeHeight, 1.);\n\n      // move the vertex by the marker offset\n      vec3 loc = applyPose(position + offset);\n      vAlpha = alpha;\n      gl_Position = projection * view * vec4(loc, 1);\n    }\n    `,\n    frag: `\n    precision lowp float;\n\n    varying vec2 uv;\n    varying float vAlpha;\n\n    uniform sampler2D palette;\n    uniform sampler2D data;\n\n    void main () {\n      // look up the point in our data texture corresponding to\n      // the current point being shaded\n      vec4 point = texture2D(data, uv);\n\n      // vec2(point.a, 0.5) is similar to textelFetch for webGL 1.0\n      // it looks up a point along our 1 dimentional palette\n      // http://www.lighthouse3d.com/tutorials/glsl-tutorial/texture-coordinates/\n      gl_FragColor = texture2D(palette, vec2(point.a, 0.5));\n      gl_FragColor.a *= vAlpha;\n    }\n    `,\n    blend: defaultBlend,\n\n    depth: { enable: true, mask: false },\n\n    attributes: {\n      point: positionBuffer,\n    },\n\n    uniforms: {\n      width: regl.prop(\"info.width\"),\n      height: regl.prop(\"info.height\"),\n      resolution: regl.prop(\"info.resolution\"),\n      // make alpha a uniform so in the future it can be controlled by topic settings\n      alpha: (context: any, props: OccupancyGridMessage) => {\n        return props.alpha || 0.5;\n      },\n      offset: (context: any, props: OccupancyGridMessage) => {\n        return pointToVec3(props.info.origin.position);\n      },\n      orientation: (context: any, props: OccupancyGridMessage) => {\n        const { x, y, z, w } = props.info.origin.orientation;\n        return [x, y, z, w];\n      },\n      palette: (context: any, props: OccupancyGridMessage) => {\n        const palette = getMapPalette(props.map);\n        // track which palettes we've uploaded as textures\n        let texture = paletteTextures.get(palette);\n        if (texture) {\n          return texture;\n        }\n        // if we haven't already uploaded this palette, upload it to the GPU\n        texture = regl.texture({\n          format: \"rgba\",\n          type: \"uint8\",\n          mipmap: false,\n          data: palette,\n          width: 256,\n          height: 1,\n        });\n        paletteTextures.set(palette, texture);\n        return texture;\n      },\n      data: (context: any, props: any) => {\n        return cache.get(props);\n      },\n    },\n\n    count: 4,\n  });\n};\n\ntype Props = {\n  ...CommonCommandProps,\n  getMapPalette: (string) => Uint8Array,\n  children: OccupancyGridMessage[],\n};\n\nexport default function OccupancyGrids(props: Props) {\n  // We can click through OccupancyGrids.\n  const command = React.useMemo(() => getOccupancyGrids(props.getMapPalette), [props.getMapPalette]);\n  return <Command getChildrenForHitmap={null} {...props} reglCommand={command} />;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useRef, useState } from \"react\";\nimport {\n  Command,\n  withPose,\n  type Regl,\n  type CommonCommandProps,\n  type AssignNextColorsFn,\n  type MouseEventObject,\n  vec4ToRGBA,\n} from \"regl-worldview\";\n\nimport { FLOAT_SIZE } from \"./buffers\";\nimport { decodeMarker } from \"./decodeMarker\";\nimport { updateMarkerCache } from \"./memoization\";\nimport {\n  type MemoizedMarker,\n  type MemoizedVertexBuffer,\n  type VertexBuffer,\n  DEFAULT_FLAT_COLOR,\n  DEFAULT_MIN_COLOR,\n  DEFAULT_MAX_COLOR,\n} from \"./types\";\nimport VertexBufferCache from \"./VertexBufferCache\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { toRgba } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/PointClouds/selection\";\nimport type { PointCloud } from \"webviz-core/src/types/Messages\";\n\nconst COLOR_MODE_FLAT = 0;\nconst COLOR_MODE_RGB = 1;\nconst COLOR_MODE_BGR = -1;\nconst COLOR_MODE_GRADIENT = 2;\nconst COLOR_MODE_RAINBOW = 3;\n\n// Implements a custom caching mechanism for vertex buffers.\n// Any memoized vertex buffer needs to be re-created whenever the Regl context\n// changes. That happens mostly when resizing the canvas or adding/removing new\n// panels on Webviz. Whenever Regl context changes, pointCloud() is called again\n// and creates new instances for both position and color caches, leading to regenerating\n// all buffers again.\n// Memoized buffers are automatically deleted by WebGL whenever its context\n// changes. There's no need to manually delete them.\nconst makePointCloudCommand = () => {\n  // The same vertex buffer can be used for both positions and colors (see comments in color attribute below).\n  // For that reason, we need to keep two independent caches.\n  // We need to instantiate them outside of the actual command in order to provide independent\n  // caches for each render pass. This prevents reseting caches when calling <PointClouds />\n  // multiple times for the same frame, like when implementing highlighting.\n  const positionBufferCache = new VertexBufferCache();\n  const colorBufferCache = new VertexBufferCache();\n\n  return (regl: Regl) => {\n    const getCachedBuffer = (cache: VertexBufferCache, vertexBuffer: VertexBuffer): MemoizedVertexBuffer => {\n      const { buffer, offset, stride } = vertexBuffer;\n      let memoized = cache.get(vertexBuffer);\n      if (\n        !memoized ||\n        memoized.vertexBuffer.buffer !== buffer ||\n        memoized.offset !== FLOAT_SIZE * offset ||\n        memoized.stride !== FLOAT_SIZE * stride\n      ) {\n        // If this is a new vertex buffer or if its content has changed somehow\n        // (rendering to hitmap or different settings), create a new memoized\n        // GPU buffer with the correct offset and stride and add it to the cache.\n        memoized = {\n          vertexBuffer,\n          buffer: regl.buffer(buffer),\n          offset: FLOAT_SIZE * offset,\n          stride: FLOAT_SIZE * stride,\n          divisor: 0,\n        };\n        cache.set(vertexBuffer, memoized);\n      }\n      return memoized;\n    };\n\n    const pointCloudCommand = withPose({\n      primitive: \"points\",\n      vert: `\n      precision mediump float;\n\n      // this comes from the camera\n      uniform mat4 projection, view;\n\n      #WITH_POSE\n\n      attribute vec3 position;\n      attribute vec3 color; // color values in range [0-255]\n\n      uniform float pointSize;\n      uniform int colorMode;\n      uniform vec4 flatColor;\n      uniform vec4 minGradientColor;\n      uniform vec4 maxGradientColor;\n      uniform float minColorFieldValue;\n      uniform float maxColorFieldValue;\n\n      varying vec3 fragColor;\n\n      float getFieldValue() {\n        return color.x;\n      }\n\n      float getFieldValue_UNORM() {\n        float value = getFieldValue();\n        float colorFieldRange = maxColorFieldValue - minColorFieldValue;\n        if (abs(colorFieldRange) < 0.00001) {\n          return 0.0;\n        }\n        return max(0.0, min((value - minColorFieldValue) / colorFieldRange, 1.0));\n      }\n\n      vec3 gradientColor() {\n        float pct = getFieldValue_UNORM();\n        return mix(minGradientColor, maxGradientColor, pct).rgb;\n      }\n\n      // taken from http://docs.ros.org/jade/api/rviz/html/c++/point__cloud__transformers_8cpp_source.html\n      // line 47\n      vec3 rainbowColor() {\n        float pct = getFieldValue_UNORM();\n        float h = (1.0 - pct) * 5.0 + 1.0;\n        float i = floor(h);\n        float f = fract(h);\n        // if i is even\n        if (mod(i, 2.0) < 1.0) {\n          f = 1.0 - f;\n        }\n        float n = 1.0 - f;\n        vec3 ret = vec3(0);\n        if (i <= 1.0) {\n          ret = vec3(n, 0.0, 1.0);\n        } else if (i == 2.0) {\n          ret = vec3(0.0, n, 1.0);\n        } else if (i == 3.0) {\n          ret = vec3(0.0, 1.0, n);\n        } else if (i == 4.0) {\n          ret = vec3(n, 1.0, 0.0);\n        } else {\n          ret = vec3(1.0, n, 0.0);\n        }\n        return 255.0 * ret;\n      }\n\n      void main () {\n        gl_PointSize = pointSize;\n        vec3 p = applyPose(position);\n        gl_Position = projection * view * vec4(p, 1);\n\n        if (colorMode == ${COLOR_MODE_GRADIENT}) {\n          fragColor = gradientColor();\n        } else if (colorMode == ${COLOR_MODE_RAINBOW}) {\n          fragColor = rainbowColor();\n        } else if (colorMode == ${COLOR_MODE_BGR}) {\n          fragColor = vec3(color.b, color.g, color.r);\n        } else if (colorMode == ${COLOR_MODE_RGB}) {\n          fragColor = color;\n        } else {\n          fragColor = flatColor.rgb;\n        }\n      }\n    `,\n      frag: `\n      precision mediump float;\n      varying vec3 fragColor;\n      uniform bool isCircle;\n      void main () {\n        if (isCircle) {\n          // gl_PointCoord give us the coordinate of this pixel relative to the current point's position\n          // In order to render a circle, we normalize and compute the distance from the current point.\n          // Discard any fragments that are too far away from the center\n          vec3 normal;\n          normal.xy = gl_PointCoord * 2.0 - 1.0;\n          float r2 = dot(normal.xy, normal.xy);\n          if (r2 > 1.0) {\n            discard;\n          }\n        }\n        gl_FragColor = vec4(fragColor / 255.0, 1.0);\n      }\n    `,\n      attributes: {\n        position: (context, props) => {\n          return getCachedBuffer(positionBufferCache, props.positionBuffer);\n        },\n        color: (context, props) => {\n          const { hitmapColors, settings, blend } = props;\n          const { colorMode } = settings;\n          if (hitmapColors) {\n            // If colors are provided, we use those instead what is indicated by colorMode\n            // This is a common scenario when rendering to the hitmap, for example.\n            // Unfortunately, we cannot memoize hitmap colors since new objects can be added\n            // to the scene hierarchy at any time.\n            return hitmapColors;\n          }\n\n          if (blend?.color) {\n            // If a constant color is provided for blending, ignore point colors. Send positions\n            // instead (see comments below).\n            return getCachedBuffer(positionBufferCache, props.positionBuffer);\n          }\n\n          // If we're using \"flat\" color mode, we pass the actual color in a uniform (see uniforms below)\n          // But we still need to provide some color buffer, even if it's not going to be used.\n          // Instead of creating a dummy buffer, we just send the one we have for position.\n          // TODO (Hernan): I tried using the constant option provided by Regl, but it leads to\n          // visual artifacts. I need to check if this is a bug in Regl.\n          const colorBuffer = !colorMode || colorMode.mode === \"flat\" ? props.positionBuffer : props.colorBuffer;\n          return getCachedBuffer(colorBufferCache, colorBuffer);\n        },\n      },\n\n      uniforms: {\n        pointSize: (context, props) => {\n          return props.settings?.pointSize || 2;\n        },\n        isCircle: (context, props) => {\n          return props.settings?.pointShape ? props.settings?.pointShape === \"circle\" : true;\n        },\n        colorMode: (context, props) => {\n          const { settings, is_bigendian, hitmapColors, blend } = props;\n          if (hitmapColors) {\n            // We're providing a colors array in RGB format\n            return COLOR_MODE_RGB;\n          }\n\n          if (blend?.color) {\n            // Force to `flat` mode if constant color is required for blending.\n            return COLOR_MODE_FLAT;\n          }\n\n          const { colorMode } = settings;\n          if (colorMode.mode === \"flat\") {\n            return COLOR_MODE_FLAT;\n          } else if (colorMode.mode === \"gradient\") {\n            return COLOR_MODE_GRADIENT;\n          } else if (colorMode.mode === \"rainbow\") {\n            return COLOR_MODE_RAINBOW;\n          }\n          return is_bigendian ? COLOR_MODE_RGB : COLOR_MODE_BGR;\n        },\n        flatColor: (context, props) => {\n          if (props.blend && props.blend.color) {\n            // Use constant color for blending.\n            return toRgba(vec4ToRGBA(props.blend.color));\n          }\n          return toRgba(props.settings.colorMode.flatColor || DEFAULT_FLAT_COLOR);\n        },\n        minGradientColor: (context, props) => {\n          return toRgba(props.settings.colorMode.minColor || DEFAULT_MIN_COLOR);\n        },\n        maxGradientColor: (context, props) => {\n          return toRgba(props.settings.colorMode.maxColor || DEFAULT_MAX_COLOR);\n        },\n        minColorFieldValue: (context, props) => {\n          return props.minColorValue;\n        },\n        maxColorFieldValue: (context, props) => {\n          return props.maxColorValue;\n        },\n      },\n\n      count: (context, props) => {\n        return props.pointCount;\n      },\n    });\n\n    const command = regl(pointCloudCommand);\n\n    return (props: any) => {\n      // Call 'onPreRender' for both caches before rendering a frame.\n      positionBufferCache.onPreRender();\n      colorBufferCache.onPreRender();\n\n      if (props.length > 0) {\n        const { depth, blend } = props[0];\n        if (depth || blend) {\n          // If there are custom rendering states, we create a new command\n          // with those values to render the markers. NOTE: This assumes that all\n          // markers will be rendered with the same overrides, which might not\n          // be the case in the future.\n          regl({\n            ...pointCloudCommand,\n            depth,\n            blend,\n          })(props);\n        } else {\n          command(props);\n        }\n      }\n\n      // Call 'onPostRender' for both caches after rendering a frame\n      // This will delete any unused GPU buffer and prevent memory leaks.\n      positionBufferCache.onPostRender();\n      colorBufferCache.onPostRender();\n    };\n  };\n};\n\nfunction instancedGetChildrenForHitmap<\n  T: {\n    hitmapColors?: Uint8Array | number[],\n    width?: number,\n    height?: number,\n    settings?: {\n      pointSize?: number,\n    },\n  }\n>(props: T[], assignNextColors: AssignNextColorsFn, excludedObjects: MouseEventObject[]): T[] {\n  return filterMap(props, (prop) => {\n    // exclude all points if one has been interacted with because iterating through all points\n    // in pointcloud object is expensive\n    const isInExcludedObjects = excludedObjects.find(({ object }) => object === prop);\n    if (isInExcludedObjects) {\n      return null;\n    }\n    const hitmapProp = { ...prop };\n    const { width, height } = prop;\n    if (!width || !height) {\n      return null;\n    }\n    const instanceCount = Math.ceil(width * height);\n    if (instanceCount < 1) {\n      return null;\n    }\n    const idColors = assignNextColors(prop, instanceCount);\n    const allColors = [];\n    idColors.forEach((color) => {\n      allColors.push(color[0] * 255);\n      allColors.push(color[1] * 255);\n      allColors.push(color[2] * 255);\n    });\n    hitmapProp.hitmapColors = allColors;\n    // expand the interaction area\n    hitmapProp.settings = hitmapProp.settings ? { ...hitmapProp.settings } : {};\n    hitmapProp.settings.pointSize = (hitmapProp.settings.pointSize || 2) * 5;\n    return hitmapProp;\n  });\n}\n\ntype Props = {\n  ...CommonCommandProps,\n  children: PointCloud[],\n  sphericalRangeScale?: number,\n  clearCachedMarkers?: boolean,\n};\n\nexport default function PointClouds({ children, clearCachedMarkers, sphericalRangeScale, ...rest }: Props) {\n  const [command] = useState(() => makePointCloudCommand());\n  const markerCache = useRef(new Map<Uint8Array, MemoizedMarker>());\n  markerCache.current = updateMarkerCache(markerCache.current, children, sphericalRangeScale);\n  const decodedMarkers = !clearCachedMarkers\n    ? [...markerCache.current.values()].map((decoded) => decoded.marker)\n    : children.map((m) => decodeMarker(m, sphericalRangeScale));\n  return (\n    <Command getChildrenForHitmap={instancedGetChildrenForHitmap} {...rest} reglCommand={command}>\n      {decodedMarkers}\n    </Command>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\n\nimport { decodeMarker } from \"./decodeMarker\";\nimport type { MemoizedMarker, PointCloudMarker } from \"./types\";\n\n// Implement manual memoization for markers.\n// When rendering point clouds, we always receive the markers that need to be drawn so there's no\n// need to keep track of instances that are not rendered anymore.\nexport function updateMarkerCache(\n  existing: Map<Uint8Array, MemoizedMarker>,\n  markers: PointCloudMarker[],\n  sphericalRangeScale?: number\n): Map<Uint8Array, MemoizedMarker> {\n  const markerCache = new Map<Uint8Array, MemoizedMarker>();\n  markers.forEach((marker) => {\n    let decoded = existing.get(marker.data);\n    // Check if a decoded marker already exists in cache. If not, decode it and save it for later use\n    // Compare 'settings' by deep-equality since they may be change by user. Also, the instance is different when re-rendering Layout\n    // Compare 'hitmapColors' by reference because the same marker msg may contain different values\n    if (!decoded || !isEqual(marker.settings, decoded.settings) || marker.hitmapColors !== decoded.hitmapColors) {\n      decoded = {\n        marker: decodeMarker(marker, sphericalRangeScale),\n        settings: marker.settings,\n        hitmapColors: marker.hitmapColors,\n      };\n    }\n    markerCache.set(marker.data, decoded);\n  });\n  return markerCache;\n}\n\n// Get a memoized marker, if one exists in cache\n// This function is used for testing purposes\nexport function memoizedMarker(cache: Map<Uint8Array, MemoizedMarker>, marker: PointCloudMarker): ?PointCloudMarker {\n  return cache.get(marker.data)?.marker;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { MemoizedVertexBuffer, VertexBuffer } from \"./types\";\n\n// Implements a double buffer caching for vertex buffers.\n// We keep track of both the current and the previous frames to tell\n// which vertex buffer are not used anymore and need to be deleted.\nexport default class VertexBufferCache {\n  _current = new Map<Float32Array, MemoizedVertexBuffer>();\n  _previous = new Map<Float32Array, MemoizedVertexBuffer>();\n\n  // Call this method before rendering to initialize\n  // the cache for the current frame.\n  onPreRender() {\n    this._previous = this._current;\n    this._current = new Map<Float32Array, MemoizedVertexBuffer>();\n  }\n\n  // Get a vertex buffer from the cache.\n  get(key: VertexBuffer): ?MemoizedVertexBuffer {\n    const { buffer } = key;\n    let existing = this._current.get(buffer);\n    if (existing) {\n      // The vertex buffer exists in the current frame\n      return existing;\n    }\n    existing = this._previous.get(buffer);\n    if (existing) {\n      // The vertex buffer was not used in the current frame yet\n      // but there is valid cached instance in the previous frame.\n      // Move the cached value to the current frame to prevent it\n      // from being deleted when executing onPostRender().\n      this.set(key, existing);\n      this._previous.delete(buffer);\n      return existing;\n    }\n    // The vertex buffer has not being cached neither in the current\n    // nor in the previous frame.\n    return null;\n  }\n\n  // Set a cached value for a vertex buffer\n  set(key: VertexBuffer, value: MemoizedVertexBuffer) {\n    const existing = this._current.get(key.buffer);\n    if (existing) {\n      if (existing === value) {\n        // Nothing to do\n        return;\n      }\n      // A vertex buffer should not change in the same frame,\n      // but if it does, we need override the existing cached value\n      // and delete it's buffer.\n      this._deleteBuffer(existing);\n    }\n    this._current.set(key.buffer, value);\n  }\n\n  // Call this function after rendering a frame to delete unused buffers\n  onPostRender() {\n    this._previous.forEach(this._deleteBuffer);\n    this._previous.clear();\n  }\n\n  _deleteBuffer(cached: MemoizedVertexBuffer) {\n    const { buffer } = cached;\n    if (buffer) {\n      // Destroy GPU buffer\n      buffer.destroy();\n    } else {\n      console.warn(\"Cannot destroy buffer\", cached);\n    }\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport flatMap from \"lodash/flatMap\";\nimport uniqBy from \"lodash/uniqBy\";\nimport qh from \"quickhull3d\";\nimport * as React from \"react\";\nimport {\n  Triangles,\n  Lines,\n  type Line,\n  type TriangleList,\n  type CommonCommandProps,\n  getChildrenForHitmapWithOriginalMarker,\n  nonInstancedGetChildrenForHitmap,\n  shouldConvert,\n  pointToVec3,\n  vec4ToRGBA,\n} from \"regl-worldview\";\n\ntype Props = {\n  children: Line[],\n  ...CommonCommandProps,\n};\n\nfunction getTriangleChildrenForHitmap(props: Line[], assignNextColors, excludedObjects): TriangleList[] {\n  // This getChildrenForHitmap function takes lines and returns triangles.\n  const triangles = props\n    .map((line) => {\n      // Make sure all points are in vec3 format and unique.\n      const points = uniqBy(\n        line.points.map((point) => (shouldConvert(point) ? pointToVec3(point) : point)),\n        ([x, y, z]) => `${x}:${y}:${z}`\n      );\n      // We need a minimum of 4 points to do the convex hull algorithm.\n      if (points.length < 4) {\n        return null;\n      }\n      // Try to run hulling on the face indices. If there is an error, discard the result.\n      let faceIndices;\n      try {\n        faceIndices = qh(points);\n      } catch (error) {\n        console.error(error);\n        return null;\n      }\n\n      // From the point indices of each face, find the points and flatmap to get the points of the triangles.\n      const trianglePoints = flatMap(faceIndices, ([index1, index2, index3]) => {\n        return [points[index1], points[index2], points[index3]];\n      });\n      const convertedColor = typeof line.color.r === \"number\" ? line.color : vec4ToRGBA(line.color);\n      return {\n        pose: line.pose,\n        scale: line.scale,\n        color: convertedColor,\n        points: trianglePoints,\n        originalMarker: line.originalMarker,\n      };\n    })\n    .filter(Boolean);\n\n  return getChildrenForHitmapWithOriginalMarker(triangles, assignNextColors, excludedObjects);\n}\n\nexport default function LinedConvexHulls({ children, ...rest }: Props) {\n  return (\n    <React.Fragment>\n      {/* Render all the lines, even if we can't generate a convex hull from them. */}\n      <Lines getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...rest}>\n        {children}\n      </Lines>\n      <Triangles getChildrenForHitmap={getTriangleChildrenForHitmap} {...rest}>\n        {/*\n         * These Line objects are not renderable by the Triangle shader. But since we're only rendering them inside the\n         * hitmap, we convert them from lines to triangle objects in the `getTriangleChildrenForHitmap` function above.\n         */}\n        {children.map((line) => ({ ...line, originalMarker: line, onlyRenderInHitmap: true }))}\n      </Triangles>\n    </React.Fragment>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport {\n  Command,\n  nonInstancedGetChildrenForHitmap,\n  withPose,\n  type Regl,\n  type CommonCommandProps,\n  type Vec4,\n} from \"regl-worldview\";\n\nimport type { RadarPointClusterSettings } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/RadarPointClusterSettingsEditor\";\nimport type { Pose, RadarPointCluster } from \"webviz-core/src/types/Messages\";\n\nconst DEFAULT_POINT_SIZE = 4;\n\ntype ClusterWithSettingsAndPose = $ReadOnly<\n  RadarPointCluster & {|\n    pose: Pose,\n    settings?: RadarPointClusterSettings,\n  |}\n>;\n\ntype ClusterWithSettingsAndPoseAndColors = $ReadOnly<ClusterWithSettingsAndPose & {| colors: Vec4 |}>;\n\nfunction mapMarker(marker: ClusterWithSettingsAndPoseAndColors) {\n  const { points, pose, settings = {} } = marker;\n  const channel = settings.channel ?? \"radial_vel\";\n  const minPoint = settings.minPoint ?? -10;\n  const maxPoint = settings.maxPoint ?? 10;\n  const pointShape = settings.pointShape ?? \"circle\";\n  const pointSize = settings.pointSize ?? DEFAULT_POINT_SIZE;\n\n  const ranges = new Float32Array(points.length);\n  const azimuths = new Float32Array(points.length);\n  const elevations = new Float32Array(points.length);\n  const vals = new Array(points.length);\n\n  for (let i = 0; i < points.length; i++) {\n    ranges[i] = points[i].range;\n    azimuths[i] = points[i].azimuth_angle_0;\n    elevations[i] = points[i].elevation_angle;\n    vals[i] = points[i][channel];\n  }\n\n  const colors =\n    marker.colors.length > 0\n      ? marker.colors\n      : vals.map((val) => {\n          if (val < minPoint) {\n            return [1, 0, 0, 1];\n          } else if (val > maxPoint) {\n            return [1, 0, 1, 1];\n          }\n          const fraction = (val - minPoint) / (maxPoint - minPoint);\n          if (fraction < 0.333) {\n            return [1 - fraction, 1, 0, 1];\n          } else if (fraction < 0.667) {\n            return [0, 1, fraction - 0.333, 1];\n          }\n          return [0, 1.667 - fraction, 1, 1];\n        });\n\n  return {\n    ranges,\n    azimuths,\n    elevations,\n    colors,\n    pose,\n    pointSize,\n    pointShape,\n    channel,\n    minPoint,\n    maxPoint,\n  };\n}\n\nconst radarPointCluster = (regl: Regl) => {\n  const radarPointClusterCommand = withPose({\n    primitive: \"points\",\n    vert: `\n      precision mediump float;\n\n      // this comes from the camera\n      uniform mat4 projection, view;\n\n      #WITH_POSE\n\n      attribute float range;\n      attribute float azimuth;\n      attribute float elevation;\n      attribute vec4 color;\n\n      uniform float pointSize;\n      uniform float minPoint;\n      uniform float maxPoint;\n      varying vec4 fragColor;\n\n      void main () {\n        gl_PointSize = pointSize;\n        vec3 p = applyPose(vec3(range * cos(azimuth)*cos(elevation), range * sin(azimuth), range * sin(elevation)));\n        gl_Position = projection * view * vec4(p, 1);\n        fragColor = color;\n      }\n  `,\n    frag: `\n      precision mediump float;\n      varying vec4 fragColor;\n      uniform bool isCircle;\n      void main () {\n        if (isCircle) {\n          vec3 normal;\n          normal.xy = gl_PointCoord * 2.0 - 1.0;\n          float r2 = dot(normal.xy, normal.xy);\n\n          if (r2 > 1.0) {\n            discard;\n          }\n        }\n\n        gl_FragColor = fragColor;\n      }\n  `,\n    attributes: {\n      range: regl.prop(\"ranges\"),\n      azimuth: regl.prop(\"azimuths\"),\n      elevation: regl.prop(\"elevations\"),\n      color: regl.prop(\"colors\"),\n    },\n\n    uniforms: {\n      pointSize: (context, { pointSize }) => pointSize,\n      isCircle: (context, { pointShape }) => pointShape === \"circle\",\n      channel: (context, { channel }) => channel,\n      minPoint: (context, { minPoint }) => minPoint,\n      maxPoint: (context, { maxPoint }) => maxPoint,\n    },\n\n    count: (context, props) => {\n      return props.ranges.length;\n    },\n  });\n\n  const command = regl(radarPointClusterCommand);\n\n  return (props: any) => {\n    const arr = Array.isArray(props) ? props : [props];\n    const mapped = arr.map(mapMarker);\n    command(mapped);\n  };\n};\n\ntype Props = { ...CommonCommandProps, children: ClusterWithSettingsAndPose[] };\n\nfunction getChildrenForHitmap(props, assignNextIds, excludedObjects) {\n  // We need colors to be able to assign them correctly in the shader.\n  const hitmapProps = nonInstancedGetChildrenForHitmap(props, assignNextIds, excludedObjects);\n  // make the points easier to click.\n  hitmapProps.forEach((prop) => {\n    prop.pointSize = 5 * (prop.pointSize || DEFAULT_POINT_SIZE);\n  });\n  return hitmapProps;\n}\n\nexport default function RadarPointClusters(props: Props) {\n  // Hitmap code needs a `colors` member to work properly, and we can't add it inside the hitmap\n  // code or the object identity breaks.\n  const propsWithColors = React.useMemo(\n    () => ({\n      ...props,\n      children: props.children.map((child) => ({ ...child, colors: [] })),\n    }),\n    [props]\n  );\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...propsWithColors} reglCommand={radarPointCluster} />;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { FeatureSettings } from \"webviz-core/src/components/ExperimentalFeatures/types\";\n\nexport type WorldContextType = $ReadOnly<{\n  // Not an exact type -- could have extra properties from hooks.\n  experimentalFeatures: FeatureSettings,\n}>;\n\n// Data used in World and child components when \"fancy\" things won't work in a Worker.\nconst WorldContext = React.createContext<?WorldContextType>();\n\nexport function useWorldContext(): WorldContextType {\n  const context = React.useContext(WorldContext);\n  if (!context) {\n    throw new Error(\"Tried to use WorldContext outside a <WorldContext.Provider />\");\n  }\n  return context;\n}\n\nexport default WorldContext;\n","// @flow\n//\n//  Copyright (c) 2020-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport Reconciler from \"react-reconciler\";\n\nconst NO_CONTEXT = {};\n\nconst hostConfig = {\n  getRootHostContext() {\n    return NO_CONTEXT;\n  },\n  getChildHostContext() {\n    return NO_CONTEXT;\n  },\n  getPublicInstance(instance) {\n    return instance;\n  },\n  createInstance() {\n    return {};\n  },\n  appendInitialChild() {},\n  finalizeInitialChildren() {\n    return false;\n  },\n  prepareUpdate() {},\n  shouldSetTextContent() {\n    return false;\n  },\n  createTextInstance() {\n    return {};\n  },\n  scheduleTimeout: setTimeout,\n  cancelTimeout: clearTimeout,\n  noTimeout: -1,\n  prepareForCommit() {\n    // Must return null here: https://github.com/facebook/react/tree/master/packages/react-reconciler#prepareforcommitcontainerinfo\n    return null;\n  },\n  resetAfterCommit() {},\n  now: Date.now,\n  isPrimaryRenderer: false, // ???\n\n  warnsIfNotActing: true, // not important?\n  supportsMutation: true,\n  supportsPersistence: false,\n\n  // Mutation things?\n  commitMount() {},\n  commitUpdate() {},\n  commitTextUpdate() {},\n  appendChild() {},\n  appendChildToContainer() {},\n  insertBefore() {},\n  insertInContainerBefore() {},\n  removeChild() {},\n  removeChildFromContainer() {},\n  clearContainer() {},\n  hideInstance() {},\n  hideTextInstance() {},\n  unhideInstance() {},\n  unhideTextInstance() {},\n  resetTextContent() {},\n};\n\nconst reconcilerInstance = Reconciler(hostConfig);\n\n// This reconciler is used by web workers that need to take advance of React hooks\n// and other mechanisms without actually rendering to the DOM (such as when rendering\n// 3D objects in the 3D Panel). HTML elements and events have no effect at all.\nconst render = (element: any, parentObject: any) => {\n  // element: This is the react element for App component\n  // parentObject: This is the host root element to which the rendered app will be attached.\n  // callback: if specified will be called after render is done.\n\n  const isAsync = true;\n  const container = reconcilerInstance.createContainer(parentObject, isAsync); // Creates root fiber node.\n\n  const parentComponent = null; // Since there is no parent (since this is the root fiber). We set parentComponent to null.\n  reconcilerInstance.updateContainer(element, container, parentComponent);\n};\n\nexport default render;\n","// @flow\n//\n//  Copyright (c) 2021-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { TransformElement } from \".\";\nimport useArbitraryPreloadedMessageDataItems from \"webviz-core/src/components/MessagePathSyntax/useArbitraryPreloadedMessageDataItems\";\nimport { quaternionFromRpy } from \"webviz-core/src/util/quaternionFromEuler\";\n\nexport function parseUrdf(urdf: string): TransformElement[] {\n  const ret = [];\n  const joints = new DOMParser().parseFromString(urdf, \"text/xml\").getElementsByTagName(\"joint\");\n  for (const joint of joints) {\n    if (joint.getAttribute(\"type\") !== \"fixed\") {\n      continue;\n    }\n    const childFrame = joint.getElementsByTagName(\"child\")[0].getAttribute(\"link\");\n    const parentFrame = joint.getElementsByTagName(\"parent\")[0].getAttribute(\"link\");\n    const originNode = joint.getElementsByTagName(\"origin\")[0];\n    const xyz = originNode.getAttribute(\"xyz\");\n    const rpy = originNode.getAttribute(\"rpy\");\n    if (!childFrame || !parentFrame || !xyz || !rpy) {\n      continue;\n    }\n    const [x, y, z] = xyz.split(\" \").map(Number);\n    const [roll, pitch, yaw] = rpy.split(\" \").map(Number);\n    const pose = { position: { x, y, z }, orientation: quaternionFromRpy({ roll, pitch, yaw }) };\n    ret.push({ childFrame, parentFrame, pose });\n  }\n  return ret;\n}\n\nexport default function useStaticTransformsData(staticTransformPath: ?string): TransformElement[] {\n  const dataItems = useArbitraryPreloadedMessageDataItems(staticTransformPath || \"\");\n  return React.useMemo(() => {\n    if (!dataItems || !dataItems?.[0]?.value) {\n      return [];\n    }\n    return parseUrdf((dataItems[0].value: any));\n  }, [dataItems]);\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { useMemo } from \"react\";\n\nimport parseRosPath from \"./parseRosPath\";\nimport {\n  fillInGlobalVariablesInPath,\n  getMessagePathDataItems,\n  type MessagePathDataItem,\n} from \"./useCachedGetMessagePathDataItems\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\n\nexport default function useArbitraryPreloadedMessageDataItems(path: string, bigInts: ?true): ?(MessagePathDataItem[]) {\n  const rosPath = useMemo(() => parseRosPath(path), [path]);\n  const { topics: providerTopics, datatypes } = PanelAPI.useDataSourceInfo();\n  const { globalVariables } = useGlobalVariables();\n  const filledInPath = useMemo(() => rosPath && fillInGlobalVariablesInPath(rosPath, globalVariables), [\n    globalVariables,\n    rosPath,\n  ]);\n\n  const arbitraryTopicMessage = PanelAPI.useArbitraryTopicMessage(rosPath?.topicName || \"\");\n  return useMemo(() => {\n    if (arbitraryTopicMessage && filledInPath) {\n      return getMessagePathDataItems(\n        // recieveTime is not useful here, since the message is completely arbitrary.\n        { message: arbitraryTopicMessage, topic: filledInPath.topicName, receiveTime: { sec: 0, nsec: 0 } },\n        filledInPath,\n        providerTopics,\n        datatypes,\n        bigInts\n      );\n    }\n  }, [arbitraryTopicMessage, bigInts, datatypes, filledInPath, providerTopics]);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// Based on http://schteppe.github.io/cannon.js/docs/files/src_math_Quaternion.js.html\n// TODO(JP): Replace with glmatrix quat#fromEuler (http://glmatrix.net/docs/quat.js.html#line355).\nexport default function quaternionFromEuler({ x, y, z }: { x: number, y: number, z: number }) {\n  const c1 = Math.cos(x / 2);\n  const c2 = Math.cos(y / 2);\n  const c3 = Math.cos(z / 2);\n  const s1 = Math.sin(x / 2);\n  const s2 = Math.sin(y / 2);\n  const s3 = Math.sin(z / 2);\n\n  return {\n    x: s1 * c2 * c3 + c1 * s2 * s3,\n    y: c1 * s2 * c3 - s1 * c2 * s3,\n    z: c1 * c2 * s3 + s1 * s2 * c3,\n    w: c1 * c2 * c3 - s1 * s2 * s3,\n  };\n}\n\nexport function quaternionFromRpy({ roll, pitch, yaw }: { roll: number, pitch: number, yaw: number }) {\n  // Adapted from https://github.com/iory/scikit-robot/blob/master/skrobot/coordinates/math.py#L857\n  const { x, y, z, w } = quaternionFromEuler({ x: -roll, y: -pitch, z: -yaw });\n  return { x: -x, y: -y, z: -z, w };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { useAllExperimentalFeatures } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport type { FeatureSettings } from \"webviz-core/src/components/ExperimentalFeatures/types\";\nimport { useShallowMemo } from \"webviz-core/src/util/hooks\";\n\n// Used for getting the value to _set_ the context (not for getting the value from the context.)\n// Only works in the main thread. In the worker thread the context needs to come from an Rpc.\nexport default function useWorldContextValue(): $ReadOnly<{| experimentalFeatures: FeatureSettings |}> {\n  return useShallowMemo({ experimentalFeatures: useAllExperimentalFeatures() });\n}\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"Layout.worker.js?01d4378ee6553c298662\");\n};"],"sourceRoot":""}